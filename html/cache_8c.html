<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: plugin/innodb_memcached/daemon_memcached/daemon/cache.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('cache_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">cache.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;<a class="el" href="string_8h_source.html">string.h</a>&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;inttypes.h&gt;</code><br />
<code>#include &quot;<a class="el" href="cache_8h_source.html">cache.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:abb452686968e48b67397da5f97445f5b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;&#160;&#160;char</td></tr>
<tr class="separator:abb452686968e48b67397da5f97445f5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e9886d74aaee76545e83dd09011727"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8c.html#a65e9886d74aaee76545e83dd09011727">false</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a65e9886d74aaee76545e83dd09011727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41f9c5fb8b08eb5dc3edce4dcb37fee7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8c.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a41f9c5fb8b08eb5dc3edce4dcb37fee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de3ed741dadc9c979a4ff17c0a9116e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8c.html#a8de3ed741dadc9c979a4ff17c0a9116e">NDEBUG</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a8de3ed741dadc9c979a4ff17c0a9116e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a631fa31e902ac58f80d0374ffed1d486"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8c.html#a631fa31e902ac58f80d0374ffed1d486">cache_create</a> (const char *<a class="el" href="persisted__variable_8cc.html#a02b8247840db27f85191d734d51598fa">name</a>, size_t bufsize, size_t align, <a class="el" href="cache_8h.html#a565b39d1034d5aaccafd0e996904eebc">cache_constructor_t</a> *constructor, <a class="el" href="cache_8h.html#a7ac51941cc19301c6ce8b7c4a3d5dd9c">cache_destructor_t</a> *destructor)</td></tr>
<tr class="memdesc:a631fa31e902ac58f80d0374ffed1d486"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an object cache.  <a href="#a631fa31e902ac58f80d0374ffed1d486">More...</a><br /></td></tr>
<tr class="separator:a631fa31e902ac58f80d0374ffed1d486"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab145c069f111ce7a16b49ec500a22659"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8c.html#ab145c069f111ce7a16b49ec500a22659">get_object</a> (void *ptr)</td></tr>
<tr class="separator:ab145c069f111ce7a16b49ec500a22659"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81a74098387faa1e105aa3e9e1d60a5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8c.html#a81a74098387faa1e105aa3e9e1d60a5e">cache_destroy</a> (<a class="el" href="structcache__t.html">cache_t</a> *cache)</td></tr>
<tr class="memdesc:a81a74098387faa1e105aa3e9e1d60a5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy an object cache.  <a href="#a81a74098387faa1e105aa3e9e1d60a5e">More...</a><br /></td></tr>
<tr class="separator:a81a74098387faa1e105aa3e9e1d60a5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc4f3f91247554c4961a0cb8acc298f"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8c.html#a6cc4f3f91247554c4961a0cb8acc298f">cache_alloc</a> (<a class="el" href="structcache__t.html">cache_t</a> *cache)</td></tr>
<tr class="memdesc:a6cc4f3f91247554c4961a0cb8acc298f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate an object from the cache.  <a href="#a6cc4f3f91247554c4961a0cb8acc298f">More...</a><br /></td></tr>
<tr class="separator:a6cc4f3f91247554c4961a0cb8acc298f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa95f3ca19274c8c6ae89379af02671f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8c.html#aa95f3ca19274c8c6ae89379af02671f7">cache_free</a> (<a class="el" href="structcache__t.html">cache_t</a> *cache, void *object)</td></tr>
<tr class="memdesc:aa95f3ca19274c8c6ae89379af02671f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return an object back to the cache.  <a href="#aa95f3ca19274c8c6ae89379af02671f7">More...</a><br /></td></tr>
<tr class="separator:aa95f3ca19274c8c6ae89379af02671f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6eb94ba2de80d22549df5b6f447e1166"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8c.html#a6eb94ba2de80d22549df5b6f447e1166">initial_pool_size</a> = 64</td></tr>
<tr class="separator:a6eb94ba2de80d22549df5b6f447e1166"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="abb452686968e48b67397da5f97445f5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb452686968e48b67397da5f97445f5b">&#9670;&nbsp;</a></span>bool</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define bool&#160;&#160;&#160;char</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a65e9886d74aaee76545e83dd09011727"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65e9886d74aaee76545e83dd09011727">&#9670;&nbsp;</a></span>false</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define false&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8de3ed741dadc9c979a4ff17c0a9116e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8de3ed741dadc9c979a4ff17c0a9116e">&#9670;&nbsp;</a></span>NDEBUG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NDEBUG&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a41f9c5fb8b08eb5dc3edce4dcb37fee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41f9c5fb8b08eb5dc3edce4dcb37fee7">&#9670;&nbsp;</a></span>true</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define true&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6cc4f3f91247554c4961a0cb8acc298f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc4f3f91247554c4961a0cb8acc298f">&#9670;&nbsp;</a></span>cache_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* cache_alloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate an object from the cache. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>the handle to the object cache to allocate from </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to an initialized object from the cache, or NULL if the allocation cannot be satisfied. </dd></dl>

</div>
</div>
<a id="a631fa31e902ac58f80d0374ffed1d486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a631fa31e902ac58f80d0374ffed1d486">&#9670;&nbsp;</a></span>cache_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcache__t.html">cache_t</a>* cache_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bufsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>align</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cache_8h.html#a565b39d1034d5aaccafd0e996904eebc">cache_constructor_t</a> *&#160;</td>
          <td class="paramname"><em>constructor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cache_8h.html#a7ac51941cc19301c6ce8b7c4a3d5dd9c">cache_destructor_t</a> *&#160;</td>
          <td class="paramname"><em>destructor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create an object cache. </p>
<p>The object cache will let you allocate objects of the same size. It is fully MT safe, so you may allocate objects from multiple threads without having to do any syncrhonization in the application code.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>the name of the object cache. This name may be used for debug purposes and may help you track down what kind of object you have problems with (buffer overruns, leakage etc) </td></tr>
    <tr><td class="paramname">bufsize</td><td>the size of each object in the cache </td></tr>
    <tr><td class="paramname">align</td><td>the alignment requirements of the objects in the cache. </td></tr>
    <tr><td class="paramname">constructor</td><td>the function to be called to initialize memory when we need to allocate more memory from the os. </td></tr>
    <tr><td class="paramname">destructor</td><td>the function to be called before we release the memory back to the os. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a handle to an object cache if successful, NULL otherwise. </dd></dl>

</div>
</div>
<a id="a81a74098387faa1e105aa3e9e1d60a5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81a74098387faa1e105aa3e9e1d60a5e">&#9670;&nbsp;</a></span>cache_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cache_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy an object cache. </p>
<p>Destroy and invalidate an object cache. You should return all buffers allocated with cache_alloc by using cache_free before calling this function. Not doing so results in undefined behavior (the buffers may or may not be invalidated)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>the handle to the object cache to destroy. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa95f3ca19274c8c6ae89379af02671f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa95f3ca19274c8c6ae89379af02671f7">&#9670;&nbsp;</a></span>cache_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cache_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return an object back to the cache. </p>
<p>The caller should return the object in an initialized state so that the object may be returned in an expected state from cache_alloc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>handle to the object cache to return the object to </td></tr>
    <tr><td class="paramname">ptr</td><td>pointer to the object to return. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab145c069f111ce7a16b49ec500a22659"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab145c069f111ce7a16b49ec500a22659">&#9670;&nbsp;</a></span>get_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* get_object </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6eb94ba2de80d22549df5b6f447e1166"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eb94ba2de80d22549df5b6f447e1166">&#9670;&nbsp;</a></span>initial_pool_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int initial_pool_size = 64</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b4c3aec6cd8f28418150dce663061cfa.html">plugin</a></li><li class="navelem"><a class="el" href="dir_75f487b2efaae217b3d011b02f98b420.html">innodb_memcached</a></li><li class="navelem"><a class="el" href="dir_693350f0d84512f42310cf9ce90f7aa8.html">daemon_memcached</a></li><li class="navelem"><a class="el" href="dir_27d4167ebc6ed14ecaa625f927405536.html">daemon</a></li><li class="navelem"><a class="el" href="cache_8c.html">cache.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
