<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Log_event_handler Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classLog__event__handler.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classLog__event__handler-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Log_event_handler Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Abstract superclass for handling logging to slow/general logs.  
 <a href="classLog__event__handler.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="log_8h_source.html">log.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Log_event_handler:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classLog__event__handler.png" usemap="#Log_5Fevent_5Fhandler_map" alt=""/>
  <map id="Log_5Fevent_5Fhandler_map" name="Log_5Fevent_5Fhandler_map">
<area href="classLog__to__csv__event__handler.html" title="Class responsible for table based logging. " alt="Log_to_csv_event_handler" shape="rect" coords="0,56,165,80"/>
<area href="classLog__to__file__event__handler.html" title="Class responsible for file based logging. " alt="Log_to_file_event_handler" shape="rect" coords="175,56,340,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acac8707abc330ab60c0c7531479e2de2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLog__event__handler.html#acac8707abc330ab60c0c7531479e2de2">Log_event_handler</a> ()</td></tr>
<tr class="separator:acac8707abc330ab60c0c7531479e2de2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac680039470e30301b8eaaee975820bba"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLog__event__handler.html#ac680039470e30301b8eaaee975820bba">~Log_event_handler</a> ()</td></tr>
<tr class="separator:ac680039470e30301b8eaaee975820bba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addcebceb6531cc89a8a23784bba21263"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLog__event__handler.html#addcebceb6531cc89a8a23784bba21263">log_slow</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> current_utime, <a class="el" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> query_start_arg, const char *user_host, size_t user_host_len, <a class="el" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> query_utime, <a class="el" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> lock_utime, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> is_command, const char *sql_text, size_t sql_text_len, struct <a class="el" href="structSystem__status__var.html">System_status_var</a> *query_start_status)=0</td></tr>
<tr class="memdesc:addcebceb6531cc89a8a23784bba21263"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log a query to the slow log.  <a href="#addcebceb6531cc89a8a23784bba21263">More...</a><br /></td></tr>
<tr class="separator:addcebceb6531cc89a8a23784bba21263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f98b8c0b48eb846877fe9d2496560e"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLog__event__handler.html#aa9f98b8c0b48eb846877fe9d2496560e">log_general</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> event_utime, const char *user_host, size_t user_host_len, <a class="el" href="my__thread__local_8h.html#a507db6035f89ca9c3d96c1ed3b987fcc">my_thread_id</a> <a class="el" href="my__thr__init_8cc.html#a670cae2ed1025603c1d5b6712d264645">thread_id</a>, const char *command_type, size_t command_type_len, const char *sql_text, size_t sql_text_len, const <a class="el" href="structCHARSET__INFO.html">CHARSET_INFO</a> *client_cs)=0</td></tr>
<tr class="memdesc:aa9f98b8c0b48eb846877fe9d2496560e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log command to the general log.  <a href="#aa9f98b8c0b48eb846877fe9d2496560e">More...</a><br /></td></tr>
<tr class="separator:aa9f98b8c0b48eb846877fe9d2496560e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Abstract superclass for handling logging to slow/general logs. </p>
<p>Currently has two subclasses, for table and file based logging. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="acac8707abc330ab60c0c7531479e2de2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acac8707abc330ab60c0c7531479e2de2">&#9670;&nbsp;</a></span>Log_event_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Log_event_handler::Log_event_handler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac680039470e30301b8eaaee975820bba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac680039470e30301b8eaaee975820bba">&#9670;&nbsp;</a></span>~Log_event_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual Log_event_handler::~Log_event_handler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa9f98b8c0b48eb846877fe9d2496560e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9f98b8c0b48eb846877fe9d2496560e">&#9670;&nbsp;</a></span>log_general()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Log_event_handler::log_general </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a>&#160;</td>
          <td class="paramname"><em>event_utime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>user_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>user_host_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__thread__local_8h.html#a507db6035f89ca9c3d96c1ed3b987fcc">my_thread_id</a>&#160;</td>
          <td class="paramname"><em>thread_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>command_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>command_type_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sql_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sql_text_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structCHARSET__INFO.html">CHARSET_INFO</a> *&#160;</td>
          <td class="paramname"><em>client_cs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log command to the general log. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>THD of the query </td></tr>
    <tr><td class="paramname">event_utime</td><td>Command start timestamp in micro seconds </td></tr>
    <tr><td class="paramname">user_host</td><td>The pointer to the string with user@host info </td></tr>
    <tr><td class="paramname">user_host_len</td><td>Length of the user_host string. this is computed once and passed to all general log event handlers </td></tr>
    <tr><td class="paramname">thread_id</td><td>Id of the thread, issued a query </td></tr>
    <tr><td class="paramname">command_type</td><td>The type of the command being logged </td></tr>
    <tr><td class="paramname">command_type_len</td><td>The length of the string above </td></tr>
    <tr><td class="paramname">sql_text</td><td>The very text of the query being executed </td></tr>
    <tr><td class="paramname">sql_text_len</td><td>The length of sql_text string </td></tr>
    <tr><td class="paramname">client_cs</td><td>Character set to use for strings</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function attempts to never call my_error(). This is necessary, because general logging happens already after a statement status has been sent to the client, so the client can not see the error anyway. Besides, the error is not related to the statement being executed and is internal, and thus should be handled internally (</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>OK </td></tr>
    <tr><td class="paramname">true</td><td>error occurred </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classLog__to__file__event__handler.html#a12ff588bc533408269bc14984bccd8b1">Log_to_file_event_handler</a>, and <a class="el" href="classLog__to__csv__event__handler.html#afe80af9e2144ed4e5848dff749a9b782">Log_to_csv_event_handler</a>.</p>

</div>
</div>
<a id="addcebceb6531cc89a8a23784bba21263"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addcebceb6531cc89a8a23784bba21263">&#9670;&nbsp;</a></span>log_slow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Log_event_handler::log_slow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a>&#160;</td>
          <td class="paramname"><em>current_utime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a>&#160;</td>
          <td class="paramname"><em>query_start_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>user_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>user_host_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a>&#160;</td>
          <td class="paramname"><em>query_utime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a>&#160;</td>
          <td class="paramname"><em>lock_utime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>is_command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sql_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sql_text_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSystem__status__var.html">System_status_var</a> *&#160;</td>
          <td class="paramname"><em>query_start_status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log a query to the slow log. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>THD of the query </td></tr>
    <tr><td class="paramname">current_utime</td><td>Current timestamp in microseconds </td></tr>
    <tr><td class="paramname">query_start_arg</td><td>Command start timestamp in microseconds </td></tr>
    <tr><td class="paramname">user_host</td><td>The pointer to the string with user@host info </td></tr>
    <tr><td class="paramname">user_host_len</td><td>Length of the user_host string </td></tr>
    <tr><td class="paramname">query_utime</td><td>Number of microseconds query execution took </td></tr>
    <tr><td class="paramname">lock_utime</td><td>Number of microseconds the query was locked </td></tr>
    <tr><td class="paramname">is_command</td><td>The flag which determines whether the sql_text is a query or an administrator command </td></tr>
    <tr><td class="paramname">sql_text</td><td>The query or administrator in textual form </td></tr>
    <tr><td class="paramname">sql_text_len</td><td>The length of sql_text string </td></tr>
    <tr><td class="paramname">query_start_status</td><td>Pointer to a snapshot of thd-&gt;status_var taken at the start of execution</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if error, false otherwise. </dd></dl>

<p>Implemented in <a class="el" href="classLog__to__file__event__handler.html#a0651c308b72dba6fb1dca7e4491ed313">Log_to_file_event_handler</a>, and <a class="el" href="classLog__to__csv__event__handler.html#ad69b222d2706507218fb42a785f6fbe5">Log_to_csv_event_handler</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>sql/<a class="el" href="log_8h_source.html">log.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classLog__event__handler.html">Log_event_handler</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
