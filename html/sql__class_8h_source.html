<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: sql/sql_class.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sql__class_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">sql_class.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="sql__class_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* Copyright (c) 2000, 2020, Oracle and/or its affiliates.</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">   This program is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">   it under the terms of the GNU General Public License, version 2.0,</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">   as published by the Free Software Foundation.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">   This program is also distributed with certain software (including</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">   but not limited to OpenSSL) that is licensed under separate terms,</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">   as designated in a particular file or component or in included license</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">   documentation.  The authors of MySQL hereby grant you an additional</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">   permission to link the program and your derivative works with the</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">   separately licensed software that they have included with MySQL.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">   This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">   GNU General Public License, version 2.0, for more details.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">   You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">   along with this program; if not, write to the Free Software</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA */</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#ifndef SQL_CLASS_INCLUDED</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#define SQL_CLASS_INCLUDED</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">  This file contains the declaration of the THD class and classes which THD</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">  depends on. It should contain as little else as possible to increase</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">  cohesion and reduce coupling. Since THD is used in many places, many files</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">  are dependent on this header and thus require recompilation if it changes.</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">  Historically this file contained &quot;Classes in mysql&quot;.</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;my_config.h&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;stdarg.h&gt;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="string_8h.html">string.h</a>&gt;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#ifdef HAVE_SYS_TIME_H</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="time_8h.html">sys/time.h</a>&gt;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;atomic&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;bitset&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;new&gt;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="dur__prop_8h.html">dur_prop.h</a>&quot;</span>  <span class="comment">// durability_properties</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lex__string_8h.html">lex_string.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="m__ctype_8h.html">m_ctype.h</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="map__helpers_8h.html">map_helpers.h</a>&quot;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__alloc_8h.html">my_alloc.h</a>&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__base_8h.html">my_base.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__command_8h.html">my_command.h</a>&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__compiler_8h.html">my_compiler.h</a>&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__dbug_8h.html">my_dbug.h</a>&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__inttypes_8h.html">my_inttypes.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__io_8h.html">my_io.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__psi__config_8h.html">my_psi_config.h</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__sqlcommand_8h.html">my_sqlcommand.h</a>&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__sys_8h.html">my_sys.h</a>&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__table__map_8h.html">my_table_map.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__thread__local_8h.html">my_thread_local.h</a>&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="my__thread__bits_8h.html">mysql/components/services/my_thread_bits.h</a>&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mysql__cond__bits_8h.html">mysql/components/services/mysql_cond_bits.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mysql__mutex__bits_8h.html">mysql/components/services/mysql_mutex_bits.h</a>&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psi__idle__bits_8h.html">mysql/components/services/psi_idle_bits.h</a>&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psi__stage__bits_8h.html">mysql/components/services/psi_stage_bits.h</a>&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psi__statement__bits_8h.html">mysql/components/services/psi_statement_bits.h</a>&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psi__thread__bits_8h.html">mysql/components/services/psi_thread_bits.h</a>&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psi__transaction__bits_8h.html">mysql/components/services/psi_transaction_bits.h</a>&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psi_2mysql__mutex_8h.html">mysql/psi/mysql_mutex.h</a>&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mysql__statement_8h.html">mysql/psi/mysql_statement.h</a>&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mysql__thread_8h.html">mysql/psi/mysql_thread.h</a>&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psi__base_8h.html">mysql/psi/psi_base.h</a>&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__type_8h.html">mysql/thread_type.h</a>&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mysql__com_8h.html">mysql_com.h</a>&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mysql__com__server_8h.html">mysql_com_server.h</a>&quot;</span>  <span class="comment">// NET_SERVER</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;mysqld_error.h&quot;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pfs__thread__provider_8h.html">pfs_thread_provider.h</a>&quot;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="prealloced__array_8h.html">prealloced_array.h</a>&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sql__security__ctx_8h.html">sql/auth/sql_security_ctx.h</a>&quot;</span>  <span class="comment">// Security_context</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="current__thd_8h.html">sql/current_thd.h</a>&quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="string__type_8h.html">sql/dd/string_type.h</a>&quot;</span>      <span class="comment">// dd::string_type</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="discrete__interval_8h.html">sql/discrete_interval.h</a>&quot;</span>   <span class="comment">// Discrete_interval</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="locked__tables__list_8h.html">sql/locked_tables_list.h</a>&quot;</span>  <span class="comment">// enum_locked_tables_mode</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mdl_8h.html">sql/mdl.h</a>&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="opt__costmodel_8h.html">sql/opt_costmodel.h</a>&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="opt__trace__context_8h.html">sql/opt_trace_context.h</a>&quot;</span>  <span class="comment">// Opt_trace_context</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="psi__memory__key_8h.html">sql/psi_memory_key.h</a>&quot;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="query__options_8h.html">sql/query_options.h</a>&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="resource__group__basic__types_8h.html">sql/resourcegroups/resource_group_basic_types.h</a>&quot;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rpl__context_8h.html">sql/rpl_context.h</a>&quot;</span>  <span class="comment">// Rpl_thd_context</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rpl__gtid_8h.html">sql/rpl_gtid.h</a>&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="session__tracker_8h.html">sql/session_tracker.h</a>&quot;</span>  <span class="comment">// Session_tracker</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sql__connect_8h.html">sql/sql_connect.h</a>&quot;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sql__const_8h.html">sql/sql_const.h</a>&quot;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sql__digest__stream_8h.html">sql/sql_digest_stream.h</a>&quot;</span>  <span class="comment">// sql_digest_state</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sql__error_8h.html">sql/sql_error.h</a>&quot;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sql__list_8h.html">sql/sql_list.h</a>&quot;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sql__plugin__ref_8h.html">sql/sql_plugin_ref.h</a>&quot;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sys__vars__resource__mgr_8h.html">sql/sys_vars_resource_mgr.h</a>&quot;</span>  <span class="comment">// Session_sysvar_resource_manager</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="system__variables_8h.html">sql/system_variables.h</a>&quot;</span>       <span class="comment">// system_variables</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="transaction__info_8h.html">sql/transaction_info.h</a>&quot;</span>       <span class="comment">// Ha_trx_info</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xa_8h.html">sql/xa.h</a>&quot;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sql__string_8h.html">sql_string.h</a>&quot;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="template__utils_8h.html">template_utils.h</a>&quot;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thr__lock_8h.html">thr_lock.h</a>&quot;</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="violite_8h.html">violite.h</a>&quot;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keyword">enum</span> <a class="code" href="sql_2field_8h.html#a46645b5c37cb3b92ce921432738cfa1d">enum_check_fields</a> : int;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keyword">enum</span> <a class="code" href="sql_2handler_8h.html#a9eca5571cb03b2bea1246c948d9244fb">enum_tx_isolation</a> : int;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">enum</span> <a class="code" href="sql_2handler_8h.html#af40f16fb4f6b573dcc6763e7a847c7ae">ha_notification_type</a> : int;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keyword">class </span><a class="code" href="classItem.html">Item</a>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">class </span><a class="code" href="classParser__state.html">Parser_state</a>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keyword">class </span><a class="code" href="dbug_8cc.html#a8c097a59d344c89887c5f4cbdbcf493e">PROFILING</a>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keyword">class </span><a class="code" href="classQuery__tables__list.html">Query_tables_list</a>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">class </span><a class="code" href="classRelay__log__info.html">Relay_log_info</a>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keyword">class </span><a class="code" href="classTHD.html">THD</a>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">class </span><a class="code" href="classpartition__info.html">partition_info</a>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keyword">class </span><a class="code" href="classProtocol.html">Protocol</a>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keyword">class </span><a class="code" href="classProtocol__binary.html">Protocol_binary</a>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keyword">class </span><a class="code" href="classProtocol__classic.html">Protocol_classic</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keyword">class </span><a class="code" href="classProtocol__text.html">Protocol_text</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keyword">class </span><a class="code" href="classmem__root__deque.html">mem_root_deque</a>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keyword">class </span><a class="code" href="classsp__rcontext.html">sp_rcontext</a>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">class </span><a class="code" href="classuser__var__entry.html">user_var_entry</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">struct </span><a class="code" href="structLEX.html">LEX</a>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">struct </span><a class="code" href="structLEX__USER.html">LEX_USER</a>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">struct </span><a class="code" href="structTABLE.html">TABLE</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">struct </span><a class="code" href="structTABLE__LIST.html">TABLE_LIST</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keyword">struct </span>timeval;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">struct </span><a class="code" href="structUser__level__lock.html">User_level_lock</a>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keyword">struct </span><a class="code" href="structYYLTYPE.html">YYLTYPE</a>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacedd.html">dd</a> {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">namespace </span>cache {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">class </span>Dictionary_client;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keyword">class </span>DD_kill_immunizer;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}  <span class="comment">// namespace dd</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keyword">class </span><a class="code" href="classInternal__error__handler.html">Internal_error_handler</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keyword">class </span><a class="code" href="classModification__plan.html">Modification_plan</a>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">class </span><a class="code" href="classQuery__result.html">Query_result</a>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keyword">class </span><a class="code" href="classReprepare__observer.html">Reprepare_observer</a>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">class </span><a class="code" href="classRows__log__event.html">Rows_log_event</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keyword">class </span><a class="code" href="classTime__zone.html">Time_zone</a>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keyword">class </span><a class="code" href="classsp__cache.html">sp_cache</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">struct </span><a class="code" href="structBinlog__user__var__event.html">Binlog_user_var_event</a>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keyword">struct </span><a class="code" href="structLOG__INFO.html">LOG_INFO</a>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="sql__class_8h.html#abaa3d24af1f0096472c4efb11a59bfbc">  157</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structuser__conn.html">user_conn</a> <a class="code" href="structuser__conn.html">USER_CONN</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">struct </span><a class="code" href="structMYSQL__LOCK.html">MYSQL_LOCK</a>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a class="code" href="sql__class_8h.html#a992081146e42306b19cfed116c03d71d">thd_enter_cond</a>(<span class="keywordtype">void</span> *opaque_thd, <a class="code" href="structmysql__cond__t.html">mysql_cond_t</a> *cond,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                               <a class="code" href="structmysql__mutex__t.html">mysql_mutex_t</a> *<a class="code" href="memcached_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>,</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                               <span class="keyword">const</span> <a class="code" href="structPSI__stage__info__v1.html">PSI_stage_info</a> *stage,</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                               <a class="code" href="structPSI__stage__info__v1.html">PSI_stage_info</a> *old_stage,</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">char</span> *src_function, <span class="keyword">const</span> <span class="keywordtype">char</span> *src_file,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                               <span class="keywordtype">int</span> src_line);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a class="code" href="sql__class_8h.html#a4e026d8e1d2fc237283f978b1b931ccb">thd_exit_cond</a>(<span class="keywordtype">void</span> *opaque_thd, <span class="keyword">const</span> <a class="code" href="structPSI__stage__info__v1.html">PSI_stage_info</a> *stage,</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span> *src_function, <span class="keyword">const</span> <span class="keywordtype">char</span> *src_file,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                              <span class="keywordtype">int</span> src_line);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a class="code" href="sql__class_8h.html#a1e56ac35f2f3cb474eabccda7c5bc1b1">thd_enter_stage</a>(<span class="keywordtype">void</span> *opaque_thd,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                <span class="keyword">const</span> <a class="code" href="structPSI__stage__info__v1.html">PSI_stage_info</a> *new_stage,</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                <a class="code" href="structPSI__stage__info__v1.html">PSI_stage_info</a> *old_stage,</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">char</span> *src_function, <span class="keyword">const</span> <span class="keywordtype">char</span> *src_file,</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                <span class="keywordtype">int</span> src_line);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a class="code" href="sql__class_8h.html#aa932766edc1bc08140164f5360f25bb4">thd_set_waiting_for_disk_space</a>(<span class="keywordtype">void</span> *opaque_thd,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">bool</span> waiting);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="sql__class_8h.html#af58f6a473017480ee4410ba9ac0cc119">  179</a></span>&#160;<span class="preprocessor">#define THD_STAGE_INFO(thd, stage) \</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">  (thd)-&gt;enter_stage(&amp;stage, NULL, __func__, __FILE__, __LINE__)</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="sql__class_8h.html#a0edbc223d7288eb5d53f953fdef5e685">empty_c_string</a>[1];</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">  We preallocate data for several storage engine plugins.</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">  so: innodb + bdb + ndb + binlog + myisam + myisammrg + archive +</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">      example + csv + heap + blackhole + federated + 0</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">  (yes, the sum is deliberately inaccurate)</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="sql__class_8h.html#a4a184b0ed2cd02bf976cbc962ab73de9">  190</a></span>&#160;constexpr <span class="keywordtype">size_t</span> <a class="code" href="sql__class_8h.html#a4a184b0ed2cd02bf976cbc962ab73de9">PREALLOC_NUM_HA</a> = 15;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">  To be used for pool-of-threads (implemented differently on various OSs)</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="classthd__scheduler.html">  195</a></span>&#160;<span class="keyword">class </span><a class="code" href="classthd__scheduler.html">thd_scheduler</a> {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="classthd__scheduler.html#a4f6594bdef996f0d8b68ae7f442d6a99">  197</a></span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="classthd__scheduler.html#a4f6594bdef996f0d8b68ae7f442d6a99">data</a>; <span class="comment">/* scheduler-specific data structure */</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classthd__scheduler.html#a82d870430f2bc6a6a372009336995a81">  199</a></span>&#160;  <a class="code" href="classthd__scheduler.html#a82d870430f2bc6a6a372009336995a81">thd_scheduler</a>() : data(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>) {}</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="classthd__scheduler.html#aa99c727a71a45dc2126c973ce796d137">  201</a></span>&#160;  <a class="code" href="classthd__scheduler.html#aa99c727a71a45dc2126c973ce796d137">~thd_scheduler</a>() {}</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;};</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<a class="code" href="group__psi__abi__thread.html#ga2b98ed163438e5b60ff305f2bb143420">PSI_thread</a> *<a class="code" href="sql__class_8h.html#ab1b767dc054df6f88b991bb7fb140df6">thd_get_psi</a>(<a class="code" href="classTHD.html">THD</a> *thd);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keywordtype">void</span> <a class="code" href="sql__class_8h.html#ac8425312a45cdb33ee7b064490f21b54">thd_set_psi</a>(<a class="code" href="classTHD.html">THD</a> *thd, <a class="code" href="group__psi__abi__thread.html#ga2b98ed163438e5b60ff305f2bb143420">PSI_thread</a> *psi);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">  the struct aggregates two paramenters that identify an event</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">  uniquely in scope of communication of a particular master and slave couple.</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">  I.e there can not be 2 events from the same staying connected master which</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">  have the same coordinates.</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">  @note</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">  Such identifier is not yet unique generally as the event originating master</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">  is resetable. Also the crashed master can be replaced with some other.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="structrpl__event__coordinates.html">  216</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structrpl__event__coordinates.html">rpl_event_coordinates</a> {</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="structrpl__event__coordinates.html#aa9adb347385c31e998f55f447eda8c4e">  217</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="structrpl__event__coordinates.html#aa9adb347385c31e998f55f447eda8c4e">file_name</a>;  <span class="comment">// binlog file name (directories stripped)</span></div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="structrpl__event__coordinates.html#a819645c3714eaa0680bb1518e09be0d9">  218</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a378b5b2448c7170f4b6bd225583e8a19">my_off_t</a> <a class="code" href="structrpl__event__coordinates.html#a819645c3714eaa0680bb1518e09be0d9">pos</a>;     <span class="comment">// event&#39;s position in the binlog file</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;} <a class="code" href="sql__class_8h.html#afc2c9357b900b1cb53799a03c186f9ea">LOG_POS_COORD</a>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="sql__class_8h.html#a36a7f8c16240698ed33e30d91ef51a4f">  221</a></span>&#160;<span class="preprocessor">#define THD_SENTRY_MAGIC 0xfeedd1ff</span></div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="sql__class_8h.html#a69a348773d951b9610b0a8ac540fc526">  222</a></span>&#160;<span class="preprocessor">#define THD_SENTRY_GONE 0xdeadbeef</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="sql__class_8h.html#a60077be54f1bd573e8e886a24565a8ca">  224</a></span>&#160;<span class="preprocessor">#define THD_CHECK_SENTRY(thd) DBUG_ASSERT(thd-&gt;dbug_sentry == THD_SENTRY_MAGIC)</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classQuery__arena.html">  226</a></span>&#160;<span class="keyword">class </span><a class="code" href="classQuery__arena.html">Query_arena</a> {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">    List of items created for this query. Every item adds itself to the list</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">    on creation (see Item::Item() for details)</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a7395e69c19fc73f34f92e3707c0a86db">  232</a></span>&#160;  <a class="code" href="classItem.html">Item</a> *<a class="code" href="classQuery__arena.html#a7395e69c19fc73f34f92e3707c0a86db">m_item_list</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="classQuery__arena.html#aedfc1e8a96654eb8bccb81c0e311f7bd">  235</a></span>&#160;  <a class="code" href="structMEM__ROOT.html">MEM_ROOT</a> *<a class="code" href="classQuery__arena.html#aedfc1e8a96654eb8bccb81c0e311f7bd">mem_root</a>;  <span class="comment">// Pointer to current memroot</span><span class="comment"></span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">  /// To check whether a reprepare operation is active</span></div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a4ffeb989016e51b18c4259d1545a5985">  237</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> is_repreparing{<span class="keyword">false</span>};</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">    The states reflects three different life cycles for three</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">    different types of statements:</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">    Prepared statement: STMT_INITIALIZED -&gt; STMT_PREPARED -&gt; STMT_EXECUTED.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">    Stored procedure:   STMT_INITIALIZED_FOR_SP -&gt; STMT_EXECUTED.</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">    Other statements:   STMT_REGULAR_EXECUTION never changes.</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1">  245</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1">enum_state</a> {</div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1a1d6bee88e60dccfcc5360fca442c2e46">  246</a></span>&#160;    STMT_INITIALIZED = 0,</div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1ab085ab91ded7dc4e4a4e4639b2f6b495">  247</a></span>&#160;    STMT_INITIALIZED_FOR_SP = 1,</div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1a951f08ab2d630176472b3dd8b47f0918">  248</a></span>&#160;    STMT_PREPARED = 2,</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1a402ebc6bacdf990a440c43ecfb6eeb61">  249</a></span>&#160;    STMT_REGULAR_EXECUTION = 3,</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1ab560fa4fe95f54865efd144518651fc9">  250</a></span>&#160;    STMT_EXECUTED = 4,</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1a22866b8101b54b1546f23188f0749460">  251</a></span>&#160;    STMT_ERROR = -1</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  };</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">    State and state changes in SP:</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">    1) When state is STMT_INITIALIZED_FOR_SP, objects in the item tree are</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">       created on the statement memroot. This is enforced through</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">       ps_arena_holder checking the state.</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">    2) After the first execute (call p1()), this state should change to</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">       STMT_EXECUTED. Objects will be created on the execution memroot and will</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">       be destroyed at the end of each execution.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">    3) In case an ER_NEED_REPREPARE error occurs, state should be changed to</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">       STMT_INITIALIZED_FOR_SP and objects will again be created on the</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">       statement memroot. At the end of this execution, state should change to</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">       STMT_EXECUTED.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a8572a9bd5bdb18d54ffba079d0fdea2d">  268</a></span>&#160;  <a class="code" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1">enum_state</a> <a class="code" href="classQuery__arena.html#a8572a9bd5bdb18d54ffba079d0fdea2d">state</a>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a79593347c4c7cabb2b94ae6370c18bab">  271</a></span>&#160;  <a class="code" href="classQuery__arena.html#a79593347c4c7cabb2b94ae6370c18bab">Query_arena</a>(<a class="code" href="structMEM__ROOT.html">MEM_ROOT</a> *mem_root_arg, <span class="keyword">enum</span> <a class="code" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1">enum_state</a> state_arg)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      : m_item_list(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>), mem_root(mem_root_arg), state(state_arg) {}</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">    This constructor is used only when Query_arena is created as</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">    backup storage for another instance of Query_arena.</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="classQuery__arena.html#ac04e25b87dac73f6e2683d67ba271a01">  278</a></span>&#160;  <a class="code" href="classQuery__arena.html#ac04e25b87dac73f6e2683d67ba271a01">Query_arena</a>()</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      : m_item_list(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>), mem_root(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>), state(STMT_INITIALIZED) {}</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keyword">virtual</span> ~<a class="code" href="classQuery__arena.html">Query_arena</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a469f3d1f39bd9a5dba08de062112852e">  283</a></span>&#160;  <a class="code" href="classItem.html">Item</a> *<a class="code" href="classQuery__arena.html#a469f3d1f39bd9a5dba08de062112852e">item_list</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_item_list; }</div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a65dc9833a47539c56429de4835a958f7">  284</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classQuery__arena.html#a65dc9833a47539c56429de4835a958f7">reset_item_list</a>() { m_item_list = <span class="keyword">nullptr</span>; }</div><div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a8ae60662f431cb7ad3beef1716458e2f">  285</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classQuery__arena.html#a8ae60662f431cb7ad3beef1716458e2f">set_item_list</a>(<a class="code" href="classItem.html">Item</a> *item) { m_item_list = item; }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordtype">void</span> add_item(<a class="code" href="classItem.html">Item</a> *item);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="group__Runtime__Environment.html#gaf3ca455b4e3e525a662ef572d60f9290">free_items</a>();</div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="classQuery__arena.html#abdf099c0fd4c83bcf7edcc8520c34a12">  288</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classQuery__arena.html#abdf099c0fd4c83bcf7edcc8520c34a12">set_state</a>(<a class="code" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1">enum_state</a> state_arg) { state = state_arg; }</div><div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a06a57f3132f744a6e85b6408e12f9d32">  289</a></span>&#160;  <a class="code" href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1">enum_state</a> <a class="code" href="classQuery__arena.html#a06a57f3132f744a6e85b6408e12f9d32">get_state</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> state; }</div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a54aac863df5e185baa158e9e72c52b5b">  290</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classQuery__arena.html#a54aac863df5e185baa158e9e72c52b5b">is_stmt_prepare</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> state == STMT_INITIALIZED; }</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="classQuery__arena.html#ad3d9dcdae4be8fe97434af23ec52cecc">  291</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classQuery__arena.html#ad3d9dcdae4be8fe97434af23ec52cecc">is_stmt_prepare_or_first_sp_execute</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)state &lt; (int)STMT_PREPARED;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a132c87657a795ccc9d2e9db8abaa8ac3">  294</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classQuery__arena.html#a132c87657a795ccc9d2e9db8abaa8ac3">is_stmt_prepare_or_first_stmt_execute</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)state &lt;= (int)STMT_PREPARED;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  }<span class="comment"></span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">  /// @returns true if a regular statement, ie not prepared and not stored proc</span></div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a7a5e86f5a1af6e9b6c59069a1bedb037">  298</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classQuery__arena.html#a7a5e86f5a1af6e9b6c59069a1bedb037">is_regular</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> state == STMT_REGULAR_EXECUTION; }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="classQuery__arena.html#ac346ad1bfff92bfacb74f312f57d744a">  300</a></span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="classQuery__arena.html#ac346ad1bfff92bfacb74f312f57d744a">alloc</a>(<span class="keywordtype">size_t</span> size) { <span class="keywordflow">return</span> mem_root-&gt;<a class="code" href="structMEM__ROOT.html#a1762b39f7ab09bb12891f445d6bbcda2">Alloc</a>(size); }</div><div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a11e9af1383e888193664168276bcef5c">  301</a></span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="classQuery__arena.html#a11e9af1383e888193664168276bcef5c">mem_calloc</a>(<span class="keywordtype">size_t</span> size) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">void</span> *ptr;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span> ((ptr = mem_root-&gt;<a class="code" href="structMEM__ROOT.html#a1762b39f7ab09bb12891f445d6bbcda2">Alloc</a>(size))) memset(ptr, 0, size);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">return</span> ptr;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a1b32bd738ceabcfecbac6d4aa8433a0d">  307</a></span>&#160;  T *<a class="code" href="classQuery__arena.html#a1b32bd738ceabcfecbac6d4aa8433a0d">alloc_typed</a>() {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">void</span> *m = alloc(<span class="keyword">sizeof</span>(T));</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">return</span> m == <span class="keyword">nullptr</span> ? <a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a> : <span class="keyword">new</span> (m) T;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classQuery__arena.html#aa669d228545b9648c156efeed3ba02d6">  312</a></span>&#160;  T *<a class="code" href="classQuery__arena.html#aa669d228545b9648c156efeed3ba02d6">memdup_typed</a>(<span class="keyword">const</span> T *<a class="code" href="sql__servers_8cc.html#a664bdac526e13ad70b21edf13c1a0e64">mem</a>) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>T *<span class="keyword">&gt;</span>(<a class="code" href="group__MYSYS.html#ga3c52003b570b762bc82527771487a305">memdup_root</a>(mem_root, mem, <span class="keyword">sizeof</span>(T)));</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div><div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="classQuery__arena.html#ab1c88786a7adf53e61fa30f32a1ed409">  315</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="classQuery__arena.html#ab1c88786a7adf53e61fa30f32a1ed409">mem_strdup</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *str) { <span class="keywordflow">return</span> <a class="code" href="group__MYSYS.html#gaf9a1809cc617261f4e10df31ad4039b9">strdup_root</a>(mem_root, str); }</div><div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="classQuery__arena.html#a6c35aaf846a0de86b5f8e0960f5648d2">  316</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="classQuery__arena.html#a6c35aaf846a0de86b5f8e0960f5648d2">strmake</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *str, <span class="keywordtype">size_t</span> size)<span class="keyword"> const </span>{</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__MYSYS.html#gaa9cde2cb17c7b3008c8b06016c20194a">strmake_root</a>(mem_root, str, size);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="classQuery__arena.html#aef63eda408fe634c472acb7a268a0869">  319</a></span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="classQuery__arena.html#aef63eda408fe634c472acb7a268a0869">memdup</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *str, <span class="keywordtype">size_t</span> size) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__MYSYS.html#ga3c52003b570b762bc82527771487a305">memdup_root</a>(mem_root, str, size);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">    Copies memory-managing members from `set`. No references are kept to it.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">    @param set A Query_arena from which members are copied.</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordtype">void</span> set_query_arena(<span class="keyword">const</span> <a class="code" href="classQuery__arena.html">Query_arena</a> &amp;<span class="keyword">set</span>);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">    Copy the current arena to `backup` and set the current</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">    arena to match `source`</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">    @param source A Query_arena from which members are copied.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">    @param backup A Query_arena to which members are first saved.</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">void</span> swap_query_arena(<span class="keyword">const</span> <a class="code" href="classQuery__arena.html">Query_arena</a> &amp;source, <a class="code" href="classQuery__arena.html">Query_arena</a> *<a class="code" href="myisampack_8cc.html#ac9a4b7317723254f2c79bffcd3265666">backup</a>);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;};</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keyword">class </span><a class="code" href="classPrepared__statement.html">Prepared_statement</a>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">  Container for all prepared statements created/used in a connection.</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">  Prepared statements in Prepared_statement_map have unique id</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">  (guaranteed by id assignment in Prepared_statement::Prepared_statement).</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">  Non-empty statement names are unique too: attempt to insert a new statement</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">  with duplicate name causes older statement to be deleted.</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">  Prepared statements are auto-deleted when they are removed from the map</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">  and when the map is deleted.</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="classPrepared__statement__map.html">  355</a></span>&#160;<span class="keyword">class </span><a class="code" href="classPrepared__statement__map.html">Prepared_statement_map</a> {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="classPrepared__statement__map.html">Prepared_statement_map</a>();</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">    Insert a new statement to the thread-local prepared statement map.</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">    If there was an old statement with the same name, replace it with the</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">    new one. Otherwise, check if max_prepared_stmt_count is not reached yet,</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">    increase prepared_stmt_count, and insert the new statement. It&#39;s okay</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">    to delete an old statement and fail to insert the new one.</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">    All named prepared statements are also present in names_hash.</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">    Prepared statement names in names_hash are unique.</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">    The statement is added only if prepared_stmt_count &lt; max_prepard_stmt_count</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">    m_last_found_statement always points to a valid statement or is 0</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">    @retval 0  success</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">    @retval 1  error: out of resources or max_prepared_stmt_count limit has been</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">                      reached. An error is sent to the client, the statement</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">                      is deleted.</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacedd__cache__unittest.html#a764c739a313dbbad860dde98a463a4f3">insert</a>(<a class="code" href="classPrepared__statement.html">Prepared_statement</a> *<a class="code" href="structstatement.html">statement</a>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">  /** Find prepared statement by name. */</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="classPrepared__statement.html">Prepared_statement</a> *find_by_name(<span class="keyword">const</span> <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> &amp;<a class="code" href="sslopt-case_8h.html#ae00b773898ac853cec38cdf7a08b8e89">name</a>);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">  /** Find prepared statement by ID. */</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <a class="code" href="classPrepared__statement.html">Prepared_statement</a> *<a class="code" href="namespacedblwr_1_1recv.html#a4d87e29e585a1f0ddb67f6f0b3b2d0ea">find</a>(<a class="code" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> <span class="keywordtype">id</span>);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">  /** Erase all prepared statements (calls Prepared_statement destructor). */</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordtype">void</span> erase(<a class="code" href="classPrepared__statement.html">Prepared_statement</a> *statement);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordtype">void</span> claim_memory_ownership(<span class="keywordtype">bool</span> claim);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespaceVt100.html#a4aa812918902b1f6f03db9eff1f0acca">reset</a>();</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  ~<a class="code" href="classPrepared__statement__map.html">Prepared_statement_map</a>();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="classPrepared__statement__map.html#ad157f743044ec2dc7b41cd2bcd23d6eb">  395</a></span>&#160;  <a class="code" href="classmalloc__unordered__map.html">malloc_unordered_map&lt;ulong, std::unique_ptr&lt;Prepared_statement&gt;</a>&gt; <a class="code" href="classPrepared__statement__map.html#ad157f743044ec2dc7b41cd2bcd23d6eb">st_hash</a>;</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="classPrepared__statement__map.html#acc204498db24519d9db042d9973829fd">  396</a></span>&#160;  <a class="code" href="classcollation__unordered__map.html">collation_unordered_map&lt;std::string, Prepared_statement *&gt;</a> <a class="code" href="classPrepared__statement__map.html#acc204498db24519d9db042d9973829fd">names_hash</a>;</div><div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="classPrepared__statement__map.html#a67d532a9be8ddd03a53acae3b0493dac">  397</a></span>&#160;  <a class="code" href="classPrepared__statement.html">Prepared_statement</a> *<a class="code" href="classPrepared__statement__map.html#a67d532a9be8ddd03a53acae3b0493dac">m_last_found_statement</a>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;};</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">  A registry for item tree transformations performed during</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">  query optimization. We register only those changes which require</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">  a rollback to re-execute a prepared statement or stored procedure</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">  yet another time.</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="classItem__change__record.html">  407</a></span>&#160;<span class="keyword">class </span><a class="code" href="classItem__change__record.html">Item_change_record</a> : <span class="keyword">public</span> <a class="code" href="classilink.html">ilink</a>&lt;Item_change_record&gt; {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// not used</span></div><div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="classItem__change__record.html#aa05441ac007b42a66d1c7307a9ba4642">  410</a></span>&#160;  <a class="code" href="classItem__change__record.html#aa05441ac007b42a66d1c7307a9ba4642">Item_change_record</a>() {}</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="classItem__change__record.html#a65dc90734e440a2d4da93c546f9e851c">  413</a></span>&#160;  <a class="code" href="classItem__change__record.html#a65dc90734e440a2d4da93c546f9e851c">Item_change_record</a>(<a class="code" href="classItem.html">Item</a> **place, <a class="code" href="classItem.html">Item</a> *new_value)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      : place(place), <a class="code" href="server_8cc.html#aa815e54d471702b29f65174ee1f47280">old_value</a>(*place), new_value(new_value) {}</div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classItem__change__record.html#aa65017793bdf6f41344109d7cb00a51b">  415</a></span>&#160;  <a class="code" href="classItem.html">Item</a> **<a class="code" href="classItem__change__record.html#aa65017793bdf6f41344109d7cb00a51b">place</a>;</div><div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="classItem__change__record.html#a5eae8545914da07cc08d2304f825f3f6">  416</a></span>&#160;  <a class="code" href="classItem.html">Item</a> *<a class="code" href="classItem__change__record.html#a5eae8545914da07cc08d2304f825f3f6">old_value</a>;</div><div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="classItem__change__record.html#acac78e3f5ed6a66679acd178f941a7c5">  417</a></span>&#160;  <a class="code" href="classItem.html">Item</a> *<a class="code" href="classItem__change__record.html#acac78e3f5ed6a66679acd178f941a7c5">new_value</a>;</div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="classItem__change__record.html#a3fbfb1b13d0c0f240932ef28f92f6bd1">  418</a></span>&#160;  <span class="keywordtype">bool</span> m_cancel{<span class="keyword">false</span>};</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;};</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="sql__class_8h.html#af8d5b2c7cc3fbc0f7dddcb915021bed5">  421</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="classI__List.html">I_List&lt;Item_change_record&gt;</a> <a class="code" href="sql__class_8h.html#af8d5b2c7cc3fbc0f7dddcb915021bed5">Item_change_list</a>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">  Class that holds information about tables which were opened and locked</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">  by the thread. It is also used to save/restore this information in</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">  push_open_tables_state()/pop_open_tables_state().</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html">  429</a></span>&#160;<span class="keyword">class </span><a class="code" href="classOpen__tables__state.html">Open_tables_state</a> {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">    A stack of Reprepare_observer-instances. The top most instance is the</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">    currently active one. This stack is used during execution of prepared</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">    statements and stored programs in order to detect metadata changes.</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">    The locking subsystem reports a metadata change if the top-most item is not</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">    NULL.</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">    When Open_tables_state part of THD is reset to open a system or</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">    INFORMATION_SCHEMA table, NULL is temporarily pushed to avoid spurious</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">    ER_NEED_REPREPARE errors -- system and INFORMATION_SCHEMA tables are not</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">    subject to metadata version tracking.</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">    A stack is used here for the convenience -- in some cases we need to</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">    temporarily override/disable current Reprepare_observer-instance.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">    NOTE: This is not a list of observers, only the top-most element will be</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">    notified in case of a metadata change.</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">    @sa check_and_update_table_version()</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#afedfe3c414cc165f61ff46cc9d2dd6ac">  451</a></span>&#160;  <a class="code" href="classPrealloced__array.html">Prealloced_array&lt;Reprepare_observer *, 4&gt;</a> <a class="code" href="classOpen__tables__state.html#afedfe3c414cc165f61ff46cc9d2dd6ac">m_reprepare_observers</a>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#afed6746977711436977cafbf738456da">  454</a></span>&#160;  <a class="code" href="classReprepare__observer.html">Reprepare_observer</a> *<a class="code" href="classOpen__tables__state.html#afed6746977711436977cafbf738456da">get_reprepare_observer</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">return</span> m_reprepare_observers.<a class="code" href="classPrealloced__array.html#abe9bdf6bb8bca24028cbf148f2cd2bb2">size</a>() &gt; 0 ? m_reprepare_observers.<a class="code" href="classPrealloced__array.html#ae5d02fc5111d71dc962d4da25b598446">back</a>()</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                            : <a class="code" href="types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#a932fda84cbe964ed4d60986df6b52939">  459</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classOpen__tables__state.html#a932fda84cbe964ed4d60986df6b52939">push_reprepare_observer</a>(<a class="code" href="classReprepare__observer.html">Reprepare_observer</a> *o) {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    m_reprepare_observers.<a class="code" href="classPrealloced__array.html#a006de3e49114ae44f3899e1e464fb93e">push_back</a>(o);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#ad083bb3ef57825565efbe36b2e2b4679">  463</a></span>&#160;  <a class="code" href="classReprepare__observer.html">Reprepare_observer</a> *<a class="code" href="classOpen__tables__state.html#ad083bb3ef57825565efbe36b2e2b4679">pop_reprepare_observer</a>() {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="classReprepare__observer.html">Reprepare_observer</a> *retval = m_reprepare_observers.<a class="code" href="classPrealloced__array.html#ae5d02fc5111d71dc962d4da25b598446">back</a>();</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    m_reprepare_observers.<a class="code" href="classPrealloced__array.html#a92d3037ced30fd2ab494d0c102406b5c">pop_back</a>();</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">return</span> retval;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#aeae43d7bcaa5f4a62d21e0c978c667bb">  469</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classOpen__tables__state.html#aeae43d7bcaa5f4a62d21e0c978c667bb">reset_reprepare_observers</a>() { m_reprepare_observers.<a class="code" href="classPrealloced__array.html#a624d17ca3684b1e7220f0343eb2360fd">clear</a>(); }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">    List of regular tables in use by this thread. Contains persistent base</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">    tables that were opened with @see open_tables().</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#a4e89b13dfb91c0b4d5bf33965c2eb704">  476</a></span>&#160;  <a class="code" href="structTABLE.html">TABLE</a> *<a class="code" href="classOpen__tables__state.html#a4e89b13dfb91c0b4d5bf33965c2eb704">open_tables</a>;<span class="comment"></span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">    List of temporary tables used by this thread. Contains user-level</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">    temporary tables, created with CREATE TEMPORARY TABLE, and</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">    intermediate tables used in ALTER TABLE implementation.</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#ae7f147f0ac9ab667b16b8e8d8ec8e42d">  482</a></span>&#160;  <a class="code" href="structTABLE.html">TABLE</a> *<a class="code" href="classOpen__tables__state.html#ae7f147f0ac9ab667b16b8e8d8ec8e42d">temporary_tables</a>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">    During a MySQL session, one can lock tables in two modes: automatic</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">    or manual. In automatic mode all necessary tables are locked just before</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">    statement execution, and all acquired locks are stored in &#39;lock&#39;</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">    member. Unlocking takes place automatically as well, when the</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">    statement ends.</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">    Manual mode comes into play when a user issues a &#39;LOCK TABLES&#39;</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">    statement. In this mode the user can only use the locked tables.</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">    Trying to use any other tables will give an error.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">    The locked tables are also stored in this member, however,</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">    thd-&gt;locked_tables_mode is turned on.  Manual locking is described in</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">    the &#39;LOCK_TABLES&#39; chapter of the MySQL manual.</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">    See also lock_tables() for details.</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#a043bd361333c7c44f57dcab18c17061a">  497</a></span>&#160;  <a class="code" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *<a class="code" href="classOpen__tables__state.html#a043bd361333c7c44f57dcab18c17061a">lock</a>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">    CREATE-SELECT keeps an extra lock for the table being</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">    created. This field is used to keep the extra lock available for</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">    lower level routines, which would otherwise miss that lock.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#a56d538ef4412d61201d0c3fe686b859b">  504</a></span>&#160;  <a class="code" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *<a class="code" href="classOpen__tables__state.html#a56d538ef4412d61201d0c3fe686b859b">extra_lock</a>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">    Enum enum_locked_tables_mode and locked_tables_mode member are</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">    used to indicate whether the so-called &quot;locked tables mode&quot; is on,</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">    and what kind of mode is active.</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">    Locked tables mode is used when it&#39;s necessary to open and</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">    lock many tables at once, for usage across multiple</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">    (sub-)statements.</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">    This may be necessary either for queries that use stored functions</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">    and triggers, in which case the statements inside functions and</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">    triggers may be executed many times, or for implementation of</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">    LOCK TABLES, in which case the opened tables are reused by all</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">    subsequent statements until a call to UNLOCK TABLES.</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">    The kind of locked tables mode employed for stored functions and</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">    triggers is also called &quot;prelocked mode&quot;.</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">    In this mode, first open_tables() call to open the tables used</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">    in a statement analyses all functions used by the statement</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">    and adds all indirectly used tables to the list of tables to</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">    open and lock.</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">    It also marks the parse tree of the statement as requiring</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">    prelocking. After that, lock_tables() locks the entire list</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">    of tables and changes THD::locked_tables_modeto LTM_PRELOCKED.</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">    All statements executed inside functions or triggers</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">    use the prelocked tables, instead of opening their own ones.</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">    Prelocked mode is turned off automatically once close_thread_tables()</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">    of the main statement is called.</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00534"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#acccde8a1d2a6789f8a7240921fcafd6c">  534</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="locked__tables__list_8h.html#a77fee489173235058762d07e721b7476">enum_locked_tables_mode</a> locked_tables_mode;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#aac1eaac32c0fbbea08c46f2cb1eadc71">  536</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classOpen__tables__state.html#aac1eaac32c0fbbea08c46f2cb1eadc71">enum_flags</a> {</div><div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#aac1eaac32c0fbbea08c46f2cb1eadc71a159a968c7ac15bc8ba2cadacdd97e5d7">  537</a></span>&#160;    BACKUPS_AVAIL = (1<a class="code" href="unionU.html">U</a> &lt;&lt; 0), <span class="comment">/* There are backups available. */</span></div><div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#aac1eaac32c0fbbea08c46f2cb1eadc71ad23abc61fcaaa9c0bd3d52821424c467">  538</a></span>&#160;    SYSTEM_TABLES = (1<a class="code" href="unionU.html">U</a> &lt;&lt; 1)  <span class="comment">/* We are opening system tables. */</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  };</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">    Flags with information about the open tables state.</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#a60a4ab3e19e0797f87560a21de81e5f1">  544</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classOpen__tables__state.html#a60a4ab3e19e0797f87560a21de81e5f1">state_flags</a>;<span class="comment"></span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">     This constructor initializes Open_tables_state instance which can only</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">     be used as backup storage. To prepare Open_tables_state instance for</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">     operations which open/lock/close tables (e.g. open_table()) one has to</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">     call init_open_tables_state().</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="classOpen__tables__state.html#a5e82eec8650504f34423f5889e9a1e3d">  551</a></span>&#160;  <a class="code" href="classOpen__tables__state.html#a5e82eec8650504f34423f5889e9a1e3d">Open_tables_state</a>()</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      : m_reprepare_observers(<a class="code" href="group__psi__abi.html#ga0a3b1290ecc0e31cb8a6e4e5402b6f18">PSI_INSTRUMENT_ME</a>), state_flags(0<a class="code" href="unionU.html">U</a>) {}</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordtype">void</span> set_open_tables_state(<a class="code" href="classOpen__tables__state.html">Open_tables_state</a> *state);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordtype">void</span> reset_open_tables_state();</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;};</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">  Storage for backup of Open_tables_state. Must</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">  be used only to open system tables (TABLE_CATEGORY_SYSTEM</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">  and TABLE_CATEGORY_LOG).</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="classOpen__tables__backup.html">  565</a></span>&#160;<span class="keyword">class </span><a class="code" href="classOpen__tables__backup.html">Open_tables_backup</a> : <span class="keyword">public</span> <a class="code" href="classOpen__tables__state.html">Open_tables_state</a> {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">    When we backup the open tables state to open a system</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">    table or tables, we want to save state of metadata</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">    locks which were acquired before the backup. It is used</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">    to release metadata locks on system tables after they are</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">    no longer used.</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00574"></a><span class="lineno"><a class="line" href="classOpen__tables__backup.html#a790db3d7c6d12288c1b72b7fa571916c">  574</a></span>&#160;  <a class="code" href="classMDL__savepoint.html">MDL_savepoint</a> <a class="code" href="classOpen__tables__backup.html#a790db3d7c6d12288c1b72b7fa571916c">mdl_system_tables_svp</a>;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;};</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">  Enum that represents which phase of secondary engine optimization</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">  the current statement is in.</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00581"></a><span class="lineno"><a class="line" href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56e">  581</a></span>&#160;<span class="keyword">enum class</span> <a class="code" href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56e">Secondary_engine_optimization</a> {<span class="comment"></span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">    The current statement should only use tables from primary storage</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">    engines. Use of secondary storage engines is disabled.</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <a class="code" href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56eaa11a38b780db1a59973d7f3a270ce2aa">PRIMARY_ONLY</a>,</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">    The current statement should only use tables from the primary</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">    storage engine. However, use of secondary storage engines is not</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">    disabled, so the optimizer may choose to trigger a repreparation</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">    against the secondary storage engine if it believes that use of a</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">    secondary storage engine is beneficial.</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <a class="code" href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56eae6e50391869cd06da36e384421075226">PRIMARY_TENTATIVELY</a>,</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">    The current statement should use tables from a secondary storage</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">    engine if possible. Otherwise, fall back to using tables from</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">    primary storage engine only.</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <a class="code" href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56ea371b09d93ca01e09a42fbd5a2a423f8e">SECONDARY</a>,</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;};</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">  @class Sub_statement_state</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">  @brief Used to save context when executing a function or trigger</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">/* Defines used for Sub_statement_state::in_sub_stmt */</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="sql__class_8h.html#aeb0a0face3a42bad387bd4c52eca168e">  612</a></span>&#160;<span class="preprocessor">#define SUB_STMT_TRIGGER 1</span></div><div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="sql__class_8h.html#a9b034c65544968be172fe65dcd4a59fa">  613</a></span>&#160;<span class="preprocessor">#define SUB_STMT_FUNCTION 2</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="classSub__statement__state.html">  615</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSub__statement__state.html">Sub_statement_state</a> {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00617"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#a14a0148e85ad293a49b8e8e1a2d80aa4">  617</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classSub__statement__state.html#a14a0148e85ad293a49b8e8e1a2d80aa4">option_bits</a>;</div><div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#ada987c1cb09b53610f447020706c9c5c">  618</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classSub__statement__state.html#ada987c1cb09b53610f447020706c9c5c">first_successful_insert_id_in_prev_stmt</a>;</div><div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#a47a31bd174b892769cc4c118e62478e3">  619</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classSub__statement__state.html#a47a31bd174b892769cc4c118e62478e3">first_successful_insert_id_in_cur_stmt</a>;</div><div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#a7c02ea0eec10dd2578eeee32458c4175">  620</a></span>&#160;  <a class="code" href="classDiscrete__intervals__list.html">Discrete_intervals_list</a> <a class="code" href="classSub__statement__state.html#a7c02ea0eec10dd2578eeee32458c4175">auto_inc_intervals_forced</a>;</div><div class="line"><a name="l00621"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#a5adfbca8da11219bed70f1ff632a2bfa">  621</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classSub__statement__state.html#a5adfbca8da11219bed70f1ff632a2bfa">current_found_rows</a>;</div><div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#a676f7969061279fc814bf6bc4b57c2da">  622</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classSub__statement__state.html#a676f7969061279fc814bf6bc4b57c2da">previous_found_rows</a>;</div><div class="line"><a name="l00623"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#a66e7075e6515d6711d3d4f57a5621f1d">  623</a></span>&#160;  <a class="code" href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a> num_truncated_fields, <a class="code" href="classSub__statement__state.html#a66e7075e6515d6711d3d4f57a5621f1d">sent_row_count</a>, examined_row_count;</div><div class="line"><a name="l00624"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#a2d5af94f344fed20f2c5f0d1b2140606">  624</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> <a class="code" href="classSub__statement__state.html#a2d5af94f344fed20f2c5f0d1b2140606">client_capabilities</a>;</div><div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#ac1c3ff29c863989156ff247bcee41181">  625</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classSub__statement__state.html#ac1c3ff29c863989156ff247bcee41181">in_sub_stmt</a>;</div><div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#a2a79b5f1892b00dbde5fda6cb4067157">  626</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classSub__statement__state.html#a2a79b5f1892b00dbde5fda6cb4067157">enable_slow_log</a>;</div><div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#a56e72213cc63778f23a19c92569652c6">  627</a></span>&#160;  <a class="code" href="structSAVEPOINT.html">SAVEPOINT</a> *<a class="code" href="classSub__statement__state.html#a56e72213cc63778f23a19c92569652c6">savepoints</a>;</div><div class="line"><a name="l00628"></a><span class="lineno"><a class="line" href="classSub__statement__state.html#a71746e8341568af6fb93b9acfc268507">  628</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="sql_2field_8h.html#a46645b5c37cb3b92ce921432738cfa1d">enum_check_fields</a> check_for_truncated_fields;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;};</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="sql__class_8h.html#a76570ebd7443e3c05c9f2487f484dbc7">  631</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">char</span> <span class="keyword">const</span> *<a class="code" href="sql__class_8h.html#a76570ebd7443e3c05c9f2487f484dbc7">show_system_thread</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240b">enum_thread_type</a> thread) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#define RETURN_NAME_AS_STRING(NAME) \</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor">  case (NAME):                      \</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">    return #NAME</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keywordflow">switch</span> (thread) {</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacebuf.html">buf</a>[64];</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba2c90ddde90548084c5f8293a874e7290">NON_SYSTEM_THREAD</a>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba4eeba491e7a1a8e7e960c531b179f394">SYSTEM_THREAD_SLAVE_IO</a>);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baadaddfd06f0dc6795a60005e7041f187">SYSTEM_THREAD_SLAVE_SQL</a>);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240bafbfeb61465ecf9701c5607578a34e334">SYSTEM_THREAD_NDBCLUSTER_BINLOG</a>);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba507007b21210c8e36cfdfdf95eb33560">SYSTEM_THREAD_EVENT_SCHEDULER</a>);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baf0fd6f2211b556e963a48a1f3a421ade">SYSTEM_THREAD_EVENT_WORKER</a>);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baedcfb5129894e0b118d44d0283ae669d">SYSTEM_THREAD_INFO_REPOSITORY</a>);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba65fce7bbaee140f7979c86de907a4927">SYSTEM_THREAD_SLAVE_WORKER</a>);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba646d234189bccb1b51baf6d3fe9c9e4d">SYSTEM_THREAD_COMPRESS_GTID_TABLE</a>);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba38ad19872f53d6ef2e7815f4efd4c348">SYSTEM_THREAD_BACKGROUND</a>);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baca5f11f9495bcd708e19d0d41e863d56">SYSTEM_THREAD_DD_INITIALIZE</a>);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba8973dd3c3c6eefc671cd7d1f1d4bfaa3">SYSTEM_THREAD_DD_RESTART</a>);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baa79beba3ce7bf907b74714487ef9d18f">SYSTEM_THREAD_SERVER_INITIALIZE</a>);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <a class="code" href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a>(<a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba4a3f2f45c5962e9908dac1097fc396e1">SYSTEM_THREAD_INIT_FILE</a>);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      sprintf(buf, <span class="stringliteral">&quot;&lt;UNKNOWN SYSTEM THREAD: %d&gt;&quot;</span>, thread);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">return</span> buf;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="preprocessor">#undef RETURN_NAME_AS_STRING</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;}</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">  Storage engine specific thread local data.</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="structHa__data.html">  662</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structHa__data.html">Ha_data</a> {<span class="comment"></span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">    Storage engine specific thread local data.</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">    Lifetime: one user connection.</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="structHa__data.html#a3d0c3a6cda3a19f09f21b17193e0feab">  667</a></span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="structHa__data.html#a3d0c3a6cda3a19f09f21b17193e0feab">ha_ptr</a>;<span class="comment"></span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">    A memorizer to engine specific &quot;native&quot; transaction object to provide</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">    storage engine detach-re-attach facility.</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">    The server level transaction object can dissociate from storage engine</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">    transactions. The released &quot;native&quot; transaction reference</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">    can be hold in the member until it is reconciled later.</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">    Lifetime: Depends on caller of @c hton::replace_native_transaction_in_thd.</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">    For instance in the case of slave server applier handling XA transaction</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">    it is from XA START to XA PREPARE.</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00678"></a><span class="lineno"><a class="line" href="structHa__data.html#a1ab76d76afcd5a91c33e6466ece6b6cc">  678</a></span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="structHa__data.html#a1ab76d76afcd5a91c33e6466ece6b6cc">ha_ptr_backup</a>;<span class="comment"></span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">    0: Life time: one statement within a transaction. If @@autocommit is</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">    on, also represents the entire transaction.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">    @sa trans_register_ha()</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">    1: Life time: one transaction within a connection.</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">    If the storage engine does not participate in a transaction,</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">    this should not be used.</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">    @sa trans_register_ha()</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00689"></a><span class="lineno"><a class="line" href="structHa__data.html#ae2fb313f1dc84d3edf32aea7d4f4e1e4">  689</a></span>&#160;  <a class="code" href="classHa__trx__info.html">Ha_trx_info</a> ha_info[2];</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">    NULL: engine is not bound to this thread</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">    non-NULL: engine is bound to this thread, engine shutdown forbidden</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="structHa__data.html#a8df0e23f95ddefe6e2639d7e8b07a4cc">  695</a></span>&#160;  <a class="code" href="structst__plugin__int.html">plugin_ref</a> <a class="code" href="structHa__data.html#a8df0e23f95ddefe6e2639d7e8b07a4cc">lock</a>;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno"><a class="line" href="structHa__data.html#a4263cded81cce8451aea9d97e6cc8fd4">  697</a></span>&#160;  <a class="code" href="structHa__data.html#a4263cded81cce8451aea9d97e6cc8fd4">Ha_data</a>() : ha_ptr(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>), ha_ptr_backup(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>), lock(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>) {}</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;};</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">  An instance of the global read lock in a connection.</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">  Implemented in lock.cc.</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html">  705</a></span>&#160;<span class="keyword">class </span><a class="code" href="classGlobal__read__lock.html">Global_read_lock</a> {</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00707"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30">  707</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30">enum_grl_state</a> {</div><div class="line"><a name="l00708"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30ae5cdc8d264fb06c6eb605e8e5540d01a">  708</a></span>&#160;    <a class="code" href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30ae5cdc8d264fb06c6eb605e8e5540d01a">GRL_NONE</a>,</div><div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30a6480c459ce00b17959b844ffb141327e">  709</a></span>&#160;    <a class="code" href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30a6480c459ce00b17959b844ffb141327e">GRL_ACQUIRED</a>,</div><div class="line"><a name="l00710"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30a3b6a859c52150238d68b355af8001709">  710</a></span>&#160;    GRL_ACQUIRED_AND_BLOCKS_COMMIT</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  };</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#a9ca6e13d1fea6ecfc78312f0ef957429">  713</a></span>&#160;  <a class="code" href="classGlobal__read__lock.html#a9ca6e13d1fea6ecfc78312f0ef957429">Global_read_lock</a>()</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      : m_state(GRL_NONE),</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        m_mdl_global_shared_lock(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>),</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        m_mdl_blocks_commits_lock(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>) {}</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordtype">bool</span> lock_global_read_lock(<a class="code" href="classTHD.html">THD</a> *thd);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordtype">void</span> unlock_global_read_lock(<a class="code" href="classTHD.html">THD</a> *thd);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">    Used by innodb memcached server to check if any connections</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">    have global read lock</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#abff09417a0643d98f92e2cd9f8e21a0d">  725</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classGlobal__read__lock.html#abff09417a0643d98f92e2cd9f8e21a0d">global_read_lock_active</a>() { <span class="keywordflow">return</span> m_atomic_active_requests &gt; 0; }</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">    Check if this connection can acquire protection against GRL and</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">    emit error if otherwise.</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#a04314b8c54f52b54e75650cbc832b7de">  731</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classGlobal__read__lock.html#a04314b8c54f52b54e75650cbc832b7de">can_acquire_protection</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">if</span> (m_state) {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <a class="code" href="group__MYSYS.html#ga19ebf963aef6b242322e15e01811972e">my_error</a>(ER_CANT_UPDATE_WITH_READLOCK, <a class="code" href="test__mysql__runtime__error_8cc.html#ab3b3804e3bf2734c0f4f1c72f30df1bd">MYF</a>(0));</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordtype">bool</span> make_global_read_lock_block_commit(<a class="code" href="classTHD.html">THD</a> *thd);</div><div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#a8c34d4b48148521722d6b7451444dbab">  739</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classGlobal__read__lock.html#a8c34d4b48148521722d6b7451444dbab">is_acquired</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_state != GRL_NONE; }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordtype">void</span> set_explicit_lock_duration(<a class="code" href="classTHD.html">THD</a> *thd);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="group__Locking.html#ga94fe72a2ec087e3457aafd2a1911dc60">  743</a></span>&#160;  <span class="keyword">static</span> std::atomic&lt;int32&gt; <a class="code" href="group__Locking.html#ga94fe72a2ec087e3457aafd2a1911dc60">m_atomic_active_requests</a>;</div><div class="line"><a name="l00744"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#a61224701430e9c30777782128db67367">  744</a></span>&#160;  <a class="code" href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30">enum_grl_state</a> <a class="code" href="classGlobal__read__lock.html#a61224701430e9c30777782128db67367">m_state</a>;<span class="comment"></span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">    In order to acquire the global read lock, the connection must</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">    acquire shared metadata lock in GLOBAL namespace, to prohibit</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">    all DDL.</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00750"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#a184e5ade656ab4c0a269875930239847">  750</a></span>&#160;  <a class="code" href="classMDL__ticket.html">MDL_ticket</a> *<a class="code" href="classGlobal__read__lock.html#a184e5ade656ab4c0a269875930239847">m_mdl_global_shared_lock</a>;<span class="comment"></span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">    Also in order to acquire the global read lock, the connection</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">    must acquire a shared metadata lock in COMMIT namespace, to</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">    prohibit commits.</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00756"></a><span class="lineno"><a class="line" href="classGlobal__read__lock.html#a0f511b352f4515d70c6bb317b053f7de">  756</a></span>&#160;  <a class="code" href="classMDL__ticket.html">MDL_ticket</a> *<a class="code" href="classGlobal__read__lock.html#a0f511b352f4515d70c6bb317b053f7de">m_mdl_blocks_commits_lock</a>;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;};</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a class="code" href="sql__class_8h.html#a18b65ea9518785d74749b5e323b41fb3">my_message_sql</a>(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> error, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, <a class="code" href="my__inttypes_8h.html#a0db1f888c3bc329e7b0b340dbd41eb2b">myf</a> MyFlags);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">  This class keeps the context of transactional DDL statements. Currently only</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">  CREATE TABLE with START TRANSACTION uses this context.</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00765"></a><span class="lineno"><a class="line" href="classTransactional__ddl__context.html">  765</a></span>&#160;<span class="keyword">class </span><a class="code" href="classTransactional__ddl__context.html">Transactional_ddl_context</a> {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="classTransactional__ddl__context.html#a849ea5f3991362649bec50c68d1dc171">  767</a></span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classTransactional__ddl__context.html#a849ea5f3991362649bec50c68d1dc171">Transactional_ddl_context</a>(<a class="code" href="classTHD.html">THD</a> *thd) : m_thd(thd) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(m_thd != <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="classTransactional__ddl__context.html#a3444b5909669bd002b8e9b73f166b589">  771</a></span>&#160;  <a class="code" href="classTransactional__ddl__context.html#a3444b5909669bd002b8e9b73f166b589">~Transactional_ddl_context</a>() {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(!m_hton);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    post_ddl();</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  }</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacedd.html#abb73bd0d1f34e0e4727e0f0e453f1f5b">init</a>(<a class="code" href="namespacedd.html#ac738a3a18c0b1423ab2dca5f1d227296">dd::String_type</a> db, <a class="code" href="namespacedd.html#ac738a3a18c0b1423ab2dca5f1d227296">dd::String_type</a> tablename,</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <span class="keyword">const</span> <a class="code" href="structhandlerton.html">handlerton</a> *hton);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno"><a class="line" href="classTransactional__ddl__context.html#ac515746762e97a70c2c8d157578f2019">  779</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTransactional__ddl__context.html#ac515746762e97a70c2c8d157578f2019">inited</a>() { <span class="keywordflow">return</span> m_hton != <span class="keyword">nullptr</span>; }</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="sql__cmd__srs_8cc.html#ae1f3a7aed6d381dcd98b265913716fd4">rollback</a>();</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordtype">void</span> post_ddl();</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">// The current thread.</span></div><div class="line"><a name="l00787"></a><span class="lineno"><a class="line" href="classTransactional__ddl__context.html#a6ec1cab7dc229733074a070352d00ab3">  787</a></span>&#160;  <a class="code" href="classTHD.html">THD</a> *m_thd{<span class="keyword">nullptr</span>};</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="comment">// Handlerton pointer to table&#39;s engine begin created.</span></div><div class="line"><a name="l00790"></a><span class="lineno"><a class="line" href="classTransactional__ddl__context.html#adba4efa7411c269e7e0ca281fd970ea2">  790</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structhandlerton.html">handlerton</a> *m_hton{<span class="keyword">nullptr</span>};</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">// Schema and table name being created.</span></div><div class="line"><a name="l00793"></a><span class="lineno"><a class="line" href="classTransactional__ddl__context.html#aa6cac606e84de94be715f0ee7267086d">  793</a></span>&#160;  <a class="code" href="namespacedd.html#ac738a3a18c0b1423ab2dca5f1d227296">dd::String_type</a> m_db{};</div><div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="classTransactional__ddl__context.html#a2199b2688aeb4a112933ea9c53937927">  794</a></span>&#160;  <a class="code" href="namespacedd.html#ac738a3a18c0b1423ab2dca5f1d227296">dd::String_type</a> m_tablename{};</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;};</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">  @class THD</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">  For each client connection we create a separate thread with THD serving as</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">  a thread/connection descriptor</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno"><a class="line" href="classTHD.html">  803</a></span>&#160;<span class="keyword">class </span><a class="code" href="classTHD.html">THD</a> : <span class="keyword">public</span> <a class="code" href="classMDL__context__owner.html">MDL_context_owner</a>,</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="keyword">public</span> <a class="code" href="classQuery__arena.html">Query_arena</a>,</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <span class="keyword">public</span> <a class="code" href="classOpen__tables__state.html">Open_tables_state</a> {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00807"></a><span class="lineno"><a class="line" href="classTHD.html#a981c4dd14384944b09235ee7d00855f4">  807</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a981c4dd14384944b09235ee7d00855f4">is_stmt_prepare</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(0);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classQuery__arena.html#a54aac863df5e185baa158e9e72c52b5b">Query_arena::is_stmt_prepare</a>();</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno"><a class="line" href="classTHD.html#afcc9975b25b793a4670694a4d5fd447d">  812</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#afcc9975b25b793a4670694a4d5fd447d">is_stmt_prepare_or_first_sp_execute</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(0);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classQuery__arena.html#ad3d9dcdae4be8fe97434af23ec52cecc">Query_arena::is_stmt_prepare_or_first_sp_execute</a>();</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno"><a class="line" href="classTHD.html#ac8b2cdba46110af2a0378d44eba00de4">  817</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#ac8b2cdba46110af2a0378d44eba00de4">is_stmt_prepare_or_first_stmt_execute</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(0);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classQuery__arena.html#a132c87657a795ccc9d2e9db8abaa8ac3">Query_arena::is_stmt_prepare_or_first_stmt_execute</a>();</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno"><a class="line" href="classTHD.html#aa925a3479a17297908fc462a7ce305bd">  822</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#aa925a3479a17297908fc462a7ce305bd">is_regular</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(0);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classQuery__arena.html#a7a5e86f5a1af6e9b6c59069a1bedb037">Query_arena::is_regular</a>();</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  }</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="classTHD.html#a2d86c71c6d2786d5a084c104aa99b3e3">  828</a></span>&#160;  <a class="code" href="classMDL__context.html">MDL_context</a> <a class="code" href="classTHD.html#a2d86c71c6d2786d5a084c104aa99b3e3">mdl_context</a>;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">    MARK_COLUMNS_NONE:  Means mark_used_colums is not set and no indicator to</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">                        handler of fields used is set</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">    MARK_COLUMNS_READ:  Means a bit in read set is set to inform handler</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">                        that the field is to be read. Update covering_keys</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">                        and merge_keys too.</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">    MARK_COLUMNS_WRITE: Means a bit is set in write set to inform handler</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">                        that it needs to update this field in write_row</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">                        and update_row.</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">    MARK_COLUMNS_TEMP:  Mark bit in read set, but ignore key sets.</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">                        Used by filesort().</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00842"></a><span class="lineno"><a class="line" href="classTHD.html#a6ea3f3ee9c020330aacc3649f9f5e7da">  842</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="sql__const_8h.html#ad827c9bf54cb2308ac2bbe77108e11d3">enum_mark_columns</a> mark_used_columns;<span class="comment"></span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">    Used by Item::check_column_privileges() to tell which privileges</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">    to check for.</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">    Set to ~0ULL before starting to resolve a statement.</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">    Set to desired privilege mask before calling a resolver function that will</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">    call Item::check_column_privileges().</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">    After use, restore previous value as current value.</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00851"></a><span class="lineno"><a class="line" href="classTHD.html#a8e1cec2bf1439b840ae7547805c53a22">  851</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> <a class="code" href="classTHD.html#a8e1cec2bf1439b840ae7547805c53a22">want_privilege</a>;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">    The lex to hold the parsed tree of conventional (non-prepared) queries.</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">    Whereas for prepared and stored procedure statements we use an own lex</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">    instance for each new query, for conventional statements we reuse</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">    the same lex. (@see mysql_parse for details).</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00860"></a><span class="lineno"><a class="line" href="classTHD.html#aa4bc77c43005680d2bffde550b99aa23">  860</a></span>&#160;  std::unique_ptr&lt;LEX&gt; <a class="code" href="classTHD.html#aa4bc77c43005680d2bffde550b99aa23">main_lex</a>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00863"></a><span class="lineno"><a class="line" href="classTHD.html#a58f36f97d354993f4adf64f22133a7a4">  863</a></span>&#160;  <a class="code" href="structLEX.html">LEX</a> *<a class="code" href="classTHD.html#a58f36f97d354993f4adf64f22133a7a4">lex</a>;                                        <span class="comment">// parse tree descriptor</span></div><div class="line"><a name="l00864"></a><span class="lineno"><a class="line" href="classTHD.html#a582a85b74619b34867ee0cfe1b5c54ce">  864</a></span>&#160;  <a class="code" href="classdd_1_1cache_1_1Dictionary__client.html">dd::cache::Dictionary_client</a> *<a class="code" href="classTHD.html#a582a85b74619b34867ee0cfe1b5c54ce">dd_client</a>() const  <span class="comment">// Get the dictionary client.</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">return</span> m_dd_client.get();</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00870"></a><span class="lineno"><a class="line" href="classTHD.html#a081a29897480566f439d7e2c53799328">  870</a></span>&#160;  std::unique_ptr&lt;dd::cache::Dictionary_client&gt; <a class="code" href="classTHD.html#a081a29897480566f439d7e2c53799328">m_dd_client</a>;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">    The query associated with this statement.</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00875"></a><span class="lineno"><a class="line" href="classTHD.html#a493e0d425484963d8d6d85d24db56677">  875</a></span>&#160;  <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> <a class="code" href="classTHD.html#a493e0d425484963d8d6d85d24db56677">m_query_string</a>;</div><div class="line"><a name="l00876"></a><span class="lineno"><a class="line" href="classTHD.html#a6498a61496362873bf74c31f7bf87141">  876</a></span>&#160;  <a class="code" href="classString.html">String</a> <a class="code" href="classTHD.html#a6498a61496362873bf74c31f7bf87141">m_normalized_query</a>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">    Currently selected catalog.</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno"><a class="line" href="classTHD.html#a52fe5e91658cebc3e820e204e411bf3b">  882</a></span>&#160;  <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> <a class="code" href="classTHD.html#a52fe5e91658cebc3e820e204e411bf3b">m_catalog</a>;<span class="comment"></span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">    Name of the current (default) database.</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">    If there is the current (default) database, &quot;db&quot; contains its name. If</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">    there is no current (default) database, &quot;db&quot; is NULL and &quot;db_length&quot; is</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">    0. In other words, &quot;db&quot;, &quot;db_length&quot; must either be NULL, or contain a</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">    valid database name.</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">    @note this attribute is set and alloced by the slave SQL thread (for</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">    the THD of that thread); that thread is (and must remain, for now) the</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">    only responsible for freeing this member.</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00895"></a><span class="lineno"><a class="line" href="classTHD.html#a500ab088f76574561fcfc910968b88fd">  895</a></span>&#160;  <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> <a class="code" href="classTHD.html#a500ab088f76574561fcfc910968b88fd">m_db</a>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">    Resource group context indicating the current resource group</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">    and the name of the resource group to switch to during execution</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">    of a query.</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00902"></a><span class="lineno"><a class="line" href="classTHD.html#afa33b073b2f66a05dcc43bfe1357484e">  902</a></span>&#160;  <a class="code" href="structresourcegroups_1_1Resource__group__ctx.html">resourcegroups::Resource_group_ctx</a> <a class="code" href="classTHD.html#afa33b073b2f66a05dcc43bfe1357484e">m_resource_group_ctx</a>;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">    In some cases, we may want to modify the query (i.e. replace</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">    passwords with their hashes before logging the statement etc.).</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">    In case the query was rewritten, the original query will live in</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">    m_query_string, while the rewritten query lives in rewritten_query.</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">    If rewritten_query is empty, m_query_string should be logged.</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">    If rewritten_query is non-empty, the rewritten query it contains</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">    should be used in logs (general log, slow query log, binary log).</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">    Currently, password obfuscation is the only rewriting we do; more</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">    may follow at a later date, both pre- and post parsing of the query.</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">    Rewriting of binloggable statements must preserve all pertinent</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">    information.</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">    Similar restrictions as for m_query_string (see there) hold for locking:</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">    - Value may only be (re)set from owning thread (current_thd)</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">    - Value must be modified using (reset|swap)_rewritten_query().</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">      Doing so will protect the update with LOCK_thd_query.</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">    - The owner (current_thd) may read the value without holding the lock.</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">    - Other threads may read the value, but must hold LOCK_thd_query to do so.</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00926"></a><span class="lineno"><a class="line" href="classTHD.html#adaed45bcb64200391d6d368d609a7c3e">  926</a></span>&#160;  <a class="code" href="classString.html">String</a> <a class="code" href="classTHD.html#adaed45bcb64200391d6d368d609a7c3e">m_rewritten_query</a>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">/* Used to execute base64 coded binlog events in MySQL server */</span></div><div class="line"><a name="l00930"></a><span class="lineno"><a class="line" href="classTHD.html#adb224252d8f140238876bd4c4de594ba">  930</a></span>&#160;  <a class="code" href="classRelay__log__info.html">Relay_log_info</a> *<a class="code" href="classTHD.html#adb224252d8f140238876bd4c4de594ba">rli_fake</a>;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">/* Slave applier execution context */</span></div><div class="line"><a name="l00932"></a><span class="lineno"><a class="line" href="classTHD.html#a3fa3f267d7ce6e0af0504fc0b17345db">  932</a></span>&#160;  <a class="code" href="classRelay__log__info.html">Relay_log_info</a> *<a class="code" href="classTHD.html#a3fa3f267d7ce6e0af0504fc0b17345db">rli_slave</a>;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">/* Is transaction commit still pending */</span></div><div class="line"><a name="l00935"></a><span class="lineno"><a class="line" href="classTHD.html#a3c77e3ccae824537f33d184d445cae84">  935</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a3c77e3ccae824537f33d184d445cae84">tx_commit_pending</a>;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">    The function checks whether the thread is processing queries from binlog,</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">    as automatically generated by mysqlbinlog.</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">    @return true  when the thread is a binlog applier</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00943"></a><span class="lineno"><a class="line" href="classTHD.html#a9e7283725175fd8a9c6d6cae4401f85a">  943</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a9e7283725175fd8a9c6d6cae4401f85a">is_binlog_applier</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordflow">return</span> rli_fake &amp;&amp; variables.pseudo_slave_mode;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  }</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">    When the thread is a binlog or slave applier it detaches the engine</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">    ha_data associated with it and memorizes the fact of that.</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordtype">void</span> rpl_detach_engine_ha_data();</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">    When the thread is a binlog or slave applier it reattaches the engine</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">    ha_data associated with it and memorizes the fact of that.</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keywordtype">void</span> rpl_reattach_engine_ha_data();</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">    @return true   when the current binlog (rli_fake) or slave (rli_slave)</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">                   applier thread has detached the engine ha_data,</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">                   see @c rpl_detach_engine_ha_data.</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">    @note The detached transaction applier resets a memo</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">          mark at once with this check.</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordtype">bool</span> rpl_unflag_detached_engine_ha_data() <span class="keyword">const</span>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordtype">void</span> reset_for_next_command();</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">    Constant for THD::where initialization in the beginning of every query.</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">    It&#39;s needed because we do not save/restore THD::where normally during</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">    primary (non subselect) query execution.</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00975"></a><span class="lineno"><a class="line" href="classTHD.html#af5d1905438f291bca24b789a0253c15d">  975</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="classTHD.html#af5d1905438f291bca24b789a0253c15d">DEFAULT_WHERE</a>;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">  /** Aditional network instrumentation for the server only. */</span></div><div class="line"><a name="l00978"></a><span class="lineno"><a class="line" href="classTHD.html#ad98e6a9f1b843728ea53ed9723edc21e">  978</a></span>&#160;  <a class="code" href="structNET__SERVER.html">NET_SERVER</a> <a class="code" href="classTHD.html#ad98e6a9f1b843728ea53ed9723edc21e">m_net_server_extension</a>;<span class="comment"></span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">    Hash for user variables.</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">    User variables are per session,</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">    but can also be monitored outside of the session,</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">    so a lock is needed to prevent race conditions.</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">    Protected by @c LOCK_thd_data.</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <a class="code" href="classcollation__unordered__map.html">collation_unordered_map&lt;std::string, unique_ptr_with_deleter&lt;user_var_entry&gt;</a>&gt;</div><div class="line"><a name="l00987"></a><span class="lineno"><a class="line" href="classTHD.html#ab440393d119c6b3607c7d35f79f2a426">  987</a></span>&#160;      user_vars{<a class="code" href="m__ctype_8h.html#a3d5e399bacf45a3a3263a2dad25dfd1a">system_charset_info</a>, <a class="code" href="psi__memory__key_8cc.html#a4b3137a40e6a83872737a2343d378464">key_memory_user_var_entry</a>};</div><div class="line"><a name="l00988"></a><span class="lineno"><a class="line" href="classTHD.html#a94e20982b1b428b69507f87789b727a4">  988</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structrand__struct.html">rand_struct</a> rand;                      <span class="comment">// used for authentication</span></div><div class="line"><a name="l00989"></a><span class="lineno"><a class="line" href="classTHD.html#ace66d6d175889b62f3260264cfac216a">  989</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structSystem__variables.html">System_variables</a> variables;            <span class="comment">// Changeable local variables</span></div><div class="line"><a name="l00990"></a><span class="lineno"><a class="line" href="classTHD.html#ae82d0612c74fedc72b09bc695204b3f9">  990</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structSystem__status__var.html">System_status_var</a> status_var;          <span class="comment">// Per thread statistic vars</span></div><div class="line"><a name="l00991"></a><span class="lineno"><a class="line" href="classTHD.html#a0c32070602a983dc5effd97fc6ec7dbd">  991</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structSystem__status__var.html">System_status_var</a> *<a class="code" href="classTHD.html#a0c32070602a983dc5effd97fc6ec7dbd">initial_status_var</a>; <span class="comment">/* used by show status */</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="comment">// has status_var already been added to global_status_var?</span></div><div class="line"><a name="l00993"></a><span class="lineno"><a class="line" href="classTHD.html#a59efd33ea1ebf92b45c2f9232f564bef">  993</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a59efd33ea1ebf92b45c2f9232f564bef">status_var_aggregated</a>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">    Session&#39;s connection attributes for the connected client</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00998"></a><span class="lineno"><a class="line" href="classTHD.html#ae96ffa9182f5eba1bffaca8e02d61bca">  998</a></span>&#160;  std::vector&lt;char&gt; <a class="code" href="classTHD.html#ae96ffa9182f5eba1bffaca8e02d61bca">m_connection_attributes</a>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">    Current query cost.</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">    @sa system_status_var::last_query_cost</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01004"></a><span class="lineno"><a class="line" href="classTHD.html#a79ff94d7479786a5458794323702b415"> 1004</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classTHD.html#a79ff94d7479786a5458794323702b415">m_current_query_cost</a>;<span class="comment"></span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">    Current query partial plans.</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">    @sa system_status_var::last_query_partial_plans</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01009"></a><span class="lineno"><a class="line" href="classTHD.html#ab9d706bbac951a79e8cd6c5cead314f8"> 1009</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classTHD.html#ab9d706bbac951a79e8cd6c5cead314f8">m_current_query_partial_plans</a>;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">    Clear the query costs attributes for the current query.</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01014"></a><span class="lineno"><a class="line" href="classTHD.html#a2f49b86d2427fa0f37c93e13f9ac080f"> 1014</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a2f49b86d2427fa0f37c93e13f9ac080f">clear_current_query_costs</a>() {</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    m_current_query_cost = 0.0;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    m_current_query_partial_plans = 0;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  }</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">    Save the current query costs attributes in</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">    the thread session status.</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">    Use this method only after the query execution is completed,</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">    so that</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">      @code SHOW SESSION STATUS like &#39;last_query_%&#39; @endcode</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">      @code SELECT * from performance_schema.session_status</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">      WHERE VARIABLE_NAME like &#39;last_query_%&#39; @endcode</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">    actually reports the previous query, not itself.</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01029"></a><span class="lineno"><a class="line" href="classTHD.html#a31946409c286050e84c4c9db94249e6b"> 1029</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a31946409c286050e84c4c9db94249e6b">save_current_query_costs</a>() {</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(!status_var_aggregated);</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    status_var.last_query_cost = m_current_query_cost;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    status_var.last_query_partial_plans = m_current_query_partial_plans;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  }</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"><a class="line" href="classTHD.html#a51a6b836dd5eb7125b21d0093002052f"> 1035</a></span>&#160;  <a class="code" href="structTHR__LOCK__INFO.html">THR_LOCK_INFO</a> <a class="code" href="classTHD.html#a51a6b836dd5eb7125b21d0093002052f">lock_info</a>;  <span class="comment">// Locking info of this thread</span><span class="comment"></span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">    Protects THD data accessed from other threads.</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">    The attributes protected are:</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">    - thd-&gt;is_killable (used by KILL statement and shutdown).</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">    - thd-&gt;user_vars (user variables, inspected by monitoring)</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">    Is locked when THD is deleted.</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01043"></a><span class="lineno"><a class="line" href="classTHD.html#abfe23d3b671f93b0cf0a43a5aa39eeac"> 1043</a></span>&#160;  <a class="code" href="structmysql__mutex__t.html">mysql_mutex_t</a> <a class="code" href="classTHD.html#abfe23d3b671f93b0cf0a43a5aa39eeac">LOCK_thd_data</a>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">    Protects THD::m_query_string. No other mutexes should be locked</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">    while having this mutex locked.</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01049"></a><span class="lineno"><a class="line" href="classTHD.html#a07baac420f0da8360412ae766d318d69"> 1049</a></span>&#160;  <a class="code" href="structmysql__mutex__t.html">mysql_mutex_t</a> <a class="code" href="classTHD.html#a07baac420f0da8360412ae766d318d69">LOCK_thd_query</a>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">    Protects THD::variables while being updated. This should be taken inside</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">    of LOCK_thd_data and outside of LOCK_global_system_variables.</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01055"></a><span class="lineno"><a class="line" href="classTHD.html#abe268aadf4ed6516048624af38a0a3aa"> 1055</a></span>&#160;  <a class="code" href="structmysql__mutex__t.html">mysql_mutex_t</a> <a class="code" href="classTHD.html#abe268aadf4ed6516048624af38a0a3aa">LOCK_thd_sysvar</a>;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">    Protects THD::m_protocol when it gets removed in x plugin.</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01060"></a><span class="lineno"><a class="line" href="classTHD.html#a9c3c62ef19781a3beb4e38541a7ca32d"> 1060</a></span>&#160;  <a class="code" href="structmysql__mutex__t.html">mysql_mutex_t</a> <a class="code" href="classTHD.html#a9c3c62ef19781a3beb4e38541a7ca32d">LOCK_thd_protocol</a>;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">    Protects query plan (SELECT/UPDATE/DELETE&#39;s) from being freed/changed</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">    while another thread explains it. Following structures are protected by</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">    this mutex:</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">      THD::Query_plan</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">      Modification_plan</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">      SELECT_LEX::join</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">      JOIN::plan_state</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">      Tree of SELECT_LEX_UNIT after THD::Query_plan was set till</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">        THD::Query_plan cleanup</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">      JOIN_TAB::select-&gt;quick</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">    Code that changes objects above should take this mutex.</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">    Explain code takes this mutex to block changes to named structures to</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">    avoid crashes in following functions:</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">      explain_single_table_modification</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">      explain_query</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">      Sql_cmd_explain_other_thread::execute</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">    When doing EXPLAIN CONNECTION:</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">      all explain code assumes that this mutex is already taken.</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">    When doing ordinary EXPLAIN:</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">      the mutex does need to be taken (no need to protect reading my own data,</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">      moreover EXPLAIN CONNECTION can&#39;t run on an ordinary EXPLAIN).</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l01086"></a><span class="lineno"><a class="line" href="classTHD.html#a4bb6eed9b07c387d15945293a4794f9d"> 1086</a></span>&#160;  <a class="code" href="structmysql__mutex__t.html">mysql_mutex_t</a> <a class="code" href="classTHD.html#a4bb6eed9b07c387d15945293a4794f9d">LOCK_query_plan</a>;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">  /// Locks the query plan of this THD</span></div><div class="line"><a name="l01090"></a><span class="lineno"><a class="line" href="classTHD.html#a37e72044a3dfadd3fa34de75532a0b4a"> 1090</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a37e72044a3dfadd3fa34de75532a0b4a">lock_query_plan</a>() { <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_query_plan); }</div><div class="line"><a name="l01091"></a><span class="lineno"><a class="line" href="classTHD.html#a1392e83d82ac8244b141f4444af3618d"> 1091</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a1392e83d82ac8244b141f4444af3618d">unlock_query_plan</a>() { <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_query_plan); }</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">  /** All prepared statements of this connection. */</span></div><div class="line"><a name="l01094"></a><span class="lineno"><a class="line" href="classTHD.html#a842ff08d35ef75b18b37c208786149a8"> 1094</a></span>&#160;  <a class="code" href="classPrepared__statement__map.html">Prepared_statement_map</a> <a class="code" href="classTHD.html#a842ff08d35ef75b18b37c208786149a8">stmt_map</a>;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">    A pointer to the stack frame of handle_one_connection(),</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">    which is called first in the thread for handling a client</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01099"></a><span class="lineno"><a class="line" href="classTHD.html#a5f3e30c9303f0878c5e7ab4296d9e952"> 1099</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classTHD.html#a5f3e30c9303f0878c5e7ab4296d9e952">thread_stack</a>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">    @note</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">    Some members of THD (currently &#39;Statement::db&#39;,</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">    &#39;catalog&#39; and &#39;query&#39;)  are set and alloced by the slave SQL thread</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">    (for the THD of that thread); that thread is (and must remain, for now)</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">    the only responsible for freeing these 3 members. If you add members</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">    here, and you add code to set them in replication, don&#39;t forget to</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">    free_them_and_set_them_to_0 in replication properly. For details see</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">    the &#39;err:&#39; label of the handle_slave_sql() in sql/slave.cc.</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">    @see handle_slave_sql</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div><div class="line"><a name="l01114"></a><span class="lineno"><a class="line" href="classTHD.html#af5301183e91d96e8e0cca048ff7083fd"> 1114</a></span>&#160;  <a class="code" href="classSecurity__context.html">Security_context</a> <a class="code" href="classTHD.html#af5301183e91d96e8e0cca048ff7083fd">m_main_security_ctx</a>;</div><div class="line"><a name="l01115"></a><span class="lineno"><a class="line" href="classTHD.html#ad52e81c7674fe28c61cf204a03bafb2e"> 1115</a></span>&#160;  <a class="code" href="classSecurity__context.html">Security_context</a> *<a class="code" href="classTHD.html#ad52e81c7674fe28c61cf204a03bafb2e">m_security_ctx</a>;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"><a class="line" href="classTHD.html#ac2911fedb9ff1914d809c258e4655fb2"> 1117</a></span>&#160;  <a class="code" href="classSecurity__context.html">Security_context</a> *<a class="code" href="classTHD.html#ac2911fedb9ff1914d809c258e4655fb2">security_context</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_security_ctx; }</div><div class="line"><a name="l01118"></a><span class="lineno"><a class="line" href="classTHD.html#a39b62a8daf61f31dafd623484fa95156"> 1118</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a39b62a8daf61f31dafd623484fa95156">set_security_context</a>(<a class="code" href="classSecurity__context.html">Security_context</a> *sctx) { m_security_ctx = sctx; }</div><div class="line"><a name="l01119"></a><span class="lineno"><a class="line" href="classTHD.html#a3feb1df736e43c287b46c7d422b71842"> 1119</a></span>&#160;  <a class="code" href="classList.html">List&lt;Security_context&gt;</a> <a class="code" href="classTHD.html#a3feb1df736e43c287b46c7d422b71842">m_view_ctx_list</a>;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">    @note</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">    The optional password validation plugin doesn&#39;t have any API for</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">    temporally disable its functionality for a particular session.</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">    To get around this issue we introduce a boolean variable in the THD</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">    which we check before each call to the password validation plugin.</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">    Password validation is invoked from within the authentication plugin</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">    in the generate_authentication_string() method.</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">    @see generate_authentication_string</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01132"></a><span class="lineno"><a class="line" href="classTHD.html#ace47d2f0ac593685063f1252e9a144e6"> 1132</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#ace47d2f0ac593685063f1252e9a144e6">m_disable_password_validation</a>;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">    Points to info-string that we show in SHOW PROCESSLIST</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">    You are supposed to update thd-&gt;proc_info only if you have coded</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">    a time-consuming piece that MySQL can get stuck in for a long time.</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">    Set it using the  thd_proc_info(THD *thread, const char *message)</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">    macro/function.</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">    This member is accessed and assigned without any synchronization.</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">    Therefore, it may point only to constant (statically</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">    allocated) strings, which memory won&#39;t go away over time.</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01146"></a><span class="lineno"><a class="line" href="classTHD.html#a3a40d1058616e2c316f051523eea992b"> 1146</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classTHD.html#a3a40d1058616e2c316f051523eea992b">proc_info</a>;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"><a class="line" href="classTHD.html#a3021f8a2de3bbc8cec238e22e508dfd3"> 1148</a></span>&#160;  std::unique_ptr&lt;Protocol_text&gt; <a class="code" href="classTHD.html#a3021f8a2de3bbc8cec238e22e508dfd3">protocol_text</a>;      <span class="comment">// Normal protocol</span></div><div class="line"><a name="l01149"></a><span class="lineno"><a class="line" href="classTHD.html#a2488437f2c5fe89407cdbfbb9df6bc36"> 1149</a></span>&#160;  std::unique_ptr&lt;Protocol_binary&gt; <a class="code" href="classTHD.html#a2488437f2c5fe89407cdbfbb9df6bc36">protocol_binary</a>;  <span class="comment">// Binary protocol</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"><a class="line" href="classTHD.html#a72aa3496415e426b5563b78f191f2098"> 1151</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classProtocol.html">Protocol</a> *<a class="code" href="classTHD.html#a72aa3496415e426b5563b78f191f2098">get_protocol</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_protocol; }</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"><a class="line" href="classTHD.html#adc377898f02fc86ef0205abef975d941"> 1153</a></span>&#160;  <a class="code" href="classProtocol.html">Protocol</a> *<a class="code" href="classTHD.html#adc377898f02fc86ef0205abef975d941">get_protocol</a>() { <span class="keywordflow">return</span> m_protocol; }</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"><a class="line" href="classTHD.html#a77cfc7cf32448166f4a510a4e7c8361d"> 1155</a></span>&#160;  <a class="code" href="violite_8h.html#aea8851f79253c53aede5ec790c65d572">SSL_handle</a> <a class="code" href="classTHD.html#a77cfc7cf32448166f4a510a4e7c8361d">get_ssl</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="preprocessor">#ifndef DBUG_OFF</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="current__thd_8cc.html#a325e4fbea847aaf44935eb9784a607a4">current_thd</a> != <span class="keyword">this</span>) {</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">        When inspecting this thread from monitoring,</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">        the monitoring thread MUST lock LOCK_thd_data,</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">        to be allowed to safely inspect SSL status variables.</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <a class="code" href="group__psi__api__mutex.html#gaccf61aa4a9e6108ac938a184d7b8efd7">mysql_mutex_assert_owner</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    }</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">return</span> m_SSL;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  }</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">    Asserts that the protocol is of type text or binary and then</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">    returns the m_protocol casted to Protocol_classic. This method</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">    is needed to prevent misuse of pluggable protocols by legacy code</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01174"></a><span class="lineno"><a class="line" href="classTHD.html#a088b42aed329e44798a9a7f8a937a0ba"> 1174</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classProtocol__classic.html">Protocol_classic</a> *<a class="code" href="classTHD.html#a088b42aed329e44798a9a7f8a937a0ba">get_protocol_classic</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(is_classic_protocol());</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="template__utils_8h.html#abaa3204566f2da1d5876a24eb4f0e5cd">pointer_cast</a>&lt;<span class="keyword">const</span> <a class="code" href="classProtocol__classic.html">Protocol_classic</a> *&gt;(m_protocol);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  }</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"><a class="line" href="classTHD.html#ad5d9b3752ab439d42e6b67f276f52405"> 1179</a></span>&#160;  <a class="code" href="classProtocol__classic.html">Protocol_classic</a> *<a class="code" href="classTHD.html#ad5d9b3752ab439d42e6b67f276f52405">get_protocol_classic</a>() {</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(is_classic_protocol());</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="template__utils_8h.html#abaa3204566f2da1d5876a24eb4f0e5cd">pointer_cast</a>&lt;<a class="code" href="classProtocol__classic.html">Protocol_classic</a> *&gt;(m_protocol);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l01185"></a><span class="lineno"><a class="line" href="classTHD.html#a63f8bccb7359184a45a29a7b20853cd0"> 1185</a></span>&#160;  <a class="code" href="classProtocol.html">Protocol</a> *<a class="code" href="classTHD.html#a63f8bccb7359184a45a29a7b20853cd0">m_protocol</a>;  <span class="comment">// Current protocol</span><span class="comment"></span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">    SSL data attached to this connection.</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">    This is an opaque pointer,</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">    When building with SSL, this pointer is non NULL</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">    only if the connection is using SSL.</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">    When building without SSL, this pointer is always NULL.</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">    The SSL data can be inspected to read per thread</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">    status variables,</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">    and this can be inspected while the thread is running.</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01196"></a><span class="lineno"><a class="line" href="classTHD.html#a2850b4cc0e5d9812523649f3736eb17f"> 1196</a></span>&#160;  <a class="code" href="violite_8h.html#aea8851f79253c53aede5ec790c65d572">SSL_handle</a> m_SSL = {<span class="keyword">nullptr</span>};</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">     Query plan for EXPLAINable commands, should be locked with</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">     LOCK_query_plan before using.</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01203"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html"> 1203</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classTHD_1_1Query__plan.html">Query_plan</a> {</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l01205"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html#a28a4e3b14be2ea2e7916a05a2fe60f9f"> 1205</a></span>&#160;    <a class="code" href="classTHD.html">THD</a> *<span class="keyword">const</span> <a class="code" href="classTHD_1_1Query__plan.html#a28a4e3b14be2ea2e7916a05a2fe60f9f">thd</a>;<span class="comment"></span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">    /// Original sql_command;</span></div><div class="line"><a name="l01207"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html#ad2ef3e6cea7dc62c489c785ea4b99435"> 1207</a></span>&#160;<span class="comment"></span>    <a class="code" href="my__sqlcommand_8h.html#a46bba265a20f1784df6b9802aec4122a">enum_sql_command</a> <a class="code" href="classTHD_1_1Query__plan.html#ad2ef3e6cea7dc62c489c785ea4b99435">sql_command</a>;<span class="comment"></span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">    /// LEX of topmost statement</span></div><div class="line"><a name="l01209"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html#a848e5cee2fa1d0bb5be1697dc7bd78ae"> 1209</a></span>&#160;<span class="comment"></span>    <a class="code" href="structLEX.html">LEX</a> *<a class="code" href="classTHD_1_1Query__plan.html#a848e5cee2fa1d0bb5be1697dc7bd78ae">lex</a>;<span class="comment"></span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">    /// Query plan for UPDATE/DELETE/INSERT/REPLACE</span></div><div class="line"><a name="l01211"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html#a908901cfb52de0265f0dc8070e181be1"> 1211</a></span>&#160;<span class="comment"></span>    <span class="keyword">const</span> <a class="code" href="classModification__plan.html">Modification_plan</a> *<a class="code" href="classTHD_1_1Query__plan.html#a908901cfb52de0265f0dc8070e181be1">modification_plan</a>;<span class="comment"></span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">    /// True if query is run in prepared statement</span></div><div class="line"><a name="l01213"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html#a8a7b1abb6ae755b06eb3df0d7929fc68"> 1213</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="classTHD_1_1Query__plan.html#a8a7b1abb6ae755b06eb3df0d7929fc68">is_ps</a>;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classTHD_1_1Query__plan.html">Query_plan</a>(<span class="keyword">const</span> <a class="code" href="classTHD_1_1Query__plan.html">Query_plan</a> &amp;);    <span class="comment">///&lt; not defined</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment"></span>    <a class="code" href="classTHD_1_1Query__plan.html">Query_plan</a> &amp;operator=(<span class="keyword">const</span> <a class="code" href="classTHD_1_1Query__plan.html">Query_plan</a> &amp;);  <span class="comment">///&lt; not defined</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;   <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">    /// Asserts that current_thd has locked this plan, if it does not own it.</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> assert_plan_is_locked_if_other() const</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="preprocessor">#ifdef DBUG_OFF</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    }</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        ;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div><div class="line"><a name="l01228"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html#ac6115abd499ade3e0fd2967259869b84"> 1228</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classTHD_1_1Query__plan.html#ac6115abd499ade3e0fd2967259869b84">Query_plan</a>(<a class="code" href="classTHD.html">THD</a> *thd_arg)</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        : thd(thd_arg),</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;          sql_command(<a class="code" href="my__sqlcommand_8h.html#a46bba265a20f1784df6b9802aec4122aa80dbd5557446de815aaf1ee96602b232">SQLCOM_END</a>),</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;          lex(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>),</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;          modification_plan(<a class="code" href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>),</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;          is_ps(<a class="code" href="config__static_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>) {}</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">      Set query plan.</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment">      @note This function takes THD::LOCK_query_plan mutex.</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordtype">void</span> set_query_plan(<a class="code" href="my__sqlcommand_8h.html#a46bba265a20f1784df6b9802aec4122a">enum_sql_command</a> sql_cmd, <a class="code" href="structLEX.html">LEX</a> *lex_arg, <span class="keywordtype">bool</span> ps);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">      The 4 getters below expect THD::LOCK_query_plan to be already taken</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">      if called from another thread.</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01246"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html#aa3c37e23c685aef2ce233f9f8e4d69e3"> 1246</a></span>&#160;    <a class="code" href="my__sqlcommand_8h.html#a46bba265a20f1784df6b9802aec4122a">enum_sql_command</a> <a class="code" href="classTHD_1_1Query__plan.html#aa3c37e23c685aef2ce233f9f8e4d69e3">get_command</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      assert_plan_is_locked_if_other();</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="keywordflow">return</span> sql_command;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    }</div><div class="line"><a name="l01250"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html#a0727e4959844b99f616f89426ce1339d"> 1250</a></span>&#160;    <a class="code" href="structLEX.html">LEX</a> *<a class="code" href="classTHD_1_1Query__plan.html#a0727e4959844b99f616f89426ce1339d">get_lex</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      assert_plan_is_locked_if_other();</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="keywordflow">return</span> lex;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    }</div><div class="line"><a name="l01254"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html#a98588f3282ffeeef08f24554d2318f9f"> 1254</a></span>&#160;    <a class="code" href="classModification__plan.html">Modification_plan</a> <span class="keyword">const</span> *<a class="code" href="classTHD_1_1Query__plan.html#a98588f3282ffeeef08f24554d2318f9f">get_modification_plan</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      assert_plan_is_locked_if_other();</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="keywordflow">return</span> modification_plan;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    }</div><div class="line"><a name="l01258"></a><span class="lineno"><a class="line" href="classTHD_1_1Query__plan.html#a74b6dd2bac1275e0e8fae5ee4175e9f3"> 1258</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classTHD_1_1Query__plan.html#a74b6dd2bac1275e0e8fae5ee4175e9f3">is_ps_query</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      assert_plan_is_locked_if_other();</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="keywordflow">return</span> is_ps;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    }</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordtype">bool</span> is_single_table_plan() <span class="keyword">const</span>;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keywordtype">void</span> set_modification_plan(<a class="code" href="classModification__plan.html">Modification_plan</a> *plan_arg);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  } query_plan;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div><div class="line"><a name="l01267"></a><span class="lineno"><a class="line" href="classTHD.html#a88c407aadf9c279bc94eaf21f77e9175"> 1267</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> &amp;<a class="code" href="classTHD.html#a88c407aadf9c279bc94eaf21f77e9175">catalog</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_catalog; }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"><a class="line" href="classTHD.html#a1197110cf6918c978e7b31581f6166bc"> 1269</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a1197110cf6918c978e7b31581f6166bc">set_catalog</a>(<span class="keyword">const</span> <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> &amp;catalog) { m_catalog = catalog; }</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l01272"></a><span class="lineno"><a class="line" href="classTHD.html#a3559e1ca5768b59d02e522e4b2de2d5b"> 1272</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classTHD.html#a3559e1ca5768b59d02e522e4b2de2d5b">m_current_stage_key</a>;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="comment">// See comment in THD::enter_cond about why SUPPRESS_TSAN is needed.</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="keywordtype">void</span> enter_stage(<span class="keyword">const</span> <a class="code" href="structPSI__stage__info__v1.html">PSI_stage_info</a> *stage, <a class="code" href="structPSI__stage__info__v1.html">PSI_stage_info</a> *old_stage,</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">char</span> *calling_func, <span class="keyword">const</span> <span class="keywordtype">char</span> *calling_file,</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> calling_line) <a class="code" href="my__compiler_8h.html#a939e6ad65d8ab9567f0718ca5810b3f0">SUPPRESS_TSAN</a>;</div><div class="line"><a name="l01279"></a><span class="lineno"><a class="line" href="classTHD.html#acb1cc6e175db738ea3d29e2a2a222447"> 1279</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classTHD.html#acb1cc6e175db738ea3d29e2a2a222447">get_proc_info</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> proc_info; }</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">    Used in error messages to tell user in what part of MySQL we found an</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">    error. E. g. when where= &quot;having clause&quot;, if fix_fields() fails, user</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">    will know that the error was in having clause.</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01286"></a><span class="lineno"><a class="line" href="classTHD.html#aa509977e70035eb587af42bb49f9ba2c"> 1286</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classTHD.html#aa509977e70035eb587af42bb49f9ba2c">where</a>;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"><a class="line" href="classTHD.html#a4f37982d59c36a6e1d69407175ee78c3"> 1288</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> <a class="code" href="classTHD.html#a4f37982d59c36a6e1d69407175ee78c3">max_client_packet_length</a>;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <a class="code" href="classcollation__unordered__map.html">collation_unordered_map&lt;std::string, unique_ptr_my_free&lt;TABLE_LIST&gt;</a>&gt;</div><div class="line"><a name="l01291"></a><span class="lineno"><a class="line" href="classTHD.html#ae2be9a0d9e72699d449d89a8ace067fb"> 1291</a></span>&#160;      handler_tables_hash{&amp;<a class="code" href="m__ctype_8h.html#aa4bc5bb4f339afec426049fee727d701">my_charset_latin1</a>,</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                          <a class="code" href="psi__memory__key_8cc.html#a26ad70c4235eb554a4b8088ebac2a020">key_memory_THD_handler_tables_hash</a>};</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">    A thread can hold named user-level locks. This variable</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">    contains granted tickets if a lock is present. See item_func.cc and</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">    chapter &#39;Miscellaneous functions&#39;, for functions GET_LOCK, RELEASE_LOCK.</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01298"></a><span class="lineno"><a class="line" href="classTHD.html#af56714cfb45904e30da5bdb86f80b79c"> 1298</a></span>&#160;  <a class="code" href="classmalloc__unordered__map.html">malloc_unordered_map&lt;std::string, User_level_lock *&gt;</a> ull_hash{</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <a class="code" href="psi__memory__key_8cc.html#abf35066bd8735e191b6f89455113e2c5">key_memory_User_level_lock</a>};</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="preprocessor">#ifndef DBUG_OFF</span></div><div class="line"><a name="l01301"></a><span class="lineno"><a class="line" href="classTHD.html#a269884bb8e788099217d1193c94afac6"> 1301</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#a269884bb8e788099217d1193c94afac6">dbug_sentry</a>;  <span class="comment">// watch out for memory corruption</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01303"></a><span class="lineno"><a class="line" href="classTHD.html#a8757a413abb6e86235bab3d2a1654877"> 1303</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a8757a413abb6e86235bab3d2a1654877">is_killable</a>;<span class="comment"></span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">    Mutex protecting access to current_mutex and current_cond.</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01307"></a><span class="lineno"><a class="line" href="classTHD.html#aca83b78be787a3204ea98dadcc5e563d"> 1307</a></span>&#160;  <a class="code" href="structmysql__mutex__t.html">mysql_mutex_t</a> <a class="code" href="classTHD.html#aca83b78be787a3204ea98dadcc5e563d">LOCK_current_cond</a>;<span class="comment"></span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="comment">    The mutex used with current_cond.</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">    @see current_cond</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01312"></a><span class="lineno"><a class="line" href="classTHD.html#a60d919e5c76951f61a779289aac88d90"> 1312</a></span>&#160;  std::atomic&lt;mysql_mutex_t *&gt; <a class="code" href="classTHD.html#a60d919e5c76951f61a779289aac88d90">current_mutex</a>;<span class="comment"></span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">    Pointer to the condition variable the thread owning this THD</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">    is currently waiting for. If the thread is not waiting, the</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment">    value is NULL. Set by THD::enter_cond().</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment">    If this thread is killed (shutdown or KILL stmt), another</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">    thread will broadcast on this condition variable so that the</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">    thread can be unstuck.</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01322"></a><span class="lineno"><a class="line" href="classTHD.html#a01e09067c0d8094567f5c9f2828c57ee"> 1322</a></span>&#160;  std::atomic&lt;mysql_cond_t *&gt; <a class="code" href="classTHD.html#a01e09067c0d8094567f5c9f2828c57ee">current_cond</a>;<span class="comment"></span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">    Condition variable used for waiting by the THR_LOCK.c subsystem.</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01326"></a><span class="lineno"><a class="line" href="classTHD.html#a2df5aa03cfed8d6a6a9bb4111f6c54c8"> 1326</a></span>&#160;  <a class="code" href="structmysql__cond__t.html">mysql_cond_t</a> <a class="code" href="classTHD.html#a2df5aa03cfed8d6a6a9bb4111f6c54c8">COND_thr_lock</a>;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">    Type of current query: COM_STMT_PREPARE, COM_QUERY, etc.</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">    Set from first byte of the packet in do_command()</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01333"></a><span class="lineno"><a class="line" href="classTHD.html#ac7aabf0386d5b94dd2e3dd3c84999531"> 1333</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="my__command_8h.html#ae2ff1badf13d2b8099af8b47831281e1">enum_server_command</a> m_command;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l01336"></a><span class="lineno"><a class="line" href="classTHD.html#a0851c50664c485cd1292a135f76e0307"> 1336</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a0851c50664c485cd1292a135f76e0307">m_is_admin_conn</a>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l01339"></a><span class="lineno"><a class="line" href="classTHD.html#a5478e43509784ed9c9fd8d288c5ada1f"> 1339</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a5478e43509784ed9c9fd8d288c5ada1f">set_admin_connection</a>(<span class="keywordtype">bool</span> admin) { m_is_admin_conn = admin; }</div><div class="line"><a name="l01340"></a><span class="lineno"><a class="line" href="classTHD.html#a631142d04eb8c4c54b27f17b7055e108"> 1340</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a631142d04eb8c4c54b27f17b7055e108">is_admin_connection</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_is_admin_conn; }</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div><div class="line"><a name="l01342"></a><span class="lineno"><a class="line" href="classTHD.html#ac407896beb3240309f98167990b58d50"> 1342</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classTHD.html#ac407896beb3240309f98167990b58d50">unmasked_server_id</a>;</div><div class="line"><a name="l01343"></a><span class="lineno"><a class="line" href="classTHD.html#add6ff58faa84ff475d19466ff6bde705"> 1343</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classTHD.html#add6ff58faa84ff475d19466ff6bde705">server_id</a>;</div><div class="line"><a name="l01344"></a><span class="lineno"><a class="line" href="classTHD.html#aa94228d38f66fefe787d037ee54cd69b"> 1344</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classTHD.html#aa94228d38f66fefe787d037ee54cd69b">file_id</a>;  <span class="comment">// for LOAD DATA INFILE</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <span class="comment">/* remote (peer) port */</span></div><div class="line"><a name="l01346"></a><span class="lineno"><a class="line" href="classTHD.html#aab3f62b3bd2dcc75b35c73a18f0e7bd6"> 1346</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> <a class="code" href="classTHD.html#aab3f62b3bd2dcc75b35c73a18f0e7bd6">peer_port</a>;</div><div class="line"><a name="l01347"></a><span class="lineno"><a class="line" href="classTHD.html#aa2af1dddc36e51f94e08c1525ca24ee3"> 1347</a></span>&#160;  <span class="keyword">struct </span>timeval start_time;</div><div class="line"><a name="l01348"></a><span class="lineno"><a class="line" href="classTHD.html#a6f6a992714d494e8794bc6f19ad5b8a5"> 1348</a></span>&#160;  <span class="keyword">struct </span>timeval user_time;</div><div class="line"><a name="l01349"></a><span class="lineno"><a class="line" href="classTHD.html#a50a475b6f4adf6739ea32108d0f41575"> 1349</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> start_utime, <a class="code" href="classTHD.html#a50a475b6f4adf6739ea32108d0f41575">utime_after_lock</a>;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">    Type of lock to be used for all DML statements, except INSERT, in cases</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">    when lock is not specified explicitly.  Set to TL_WRITE or</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">    TL_WRITE_LOW_PRIORITY depending on whether low_priority_updates option is</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">    off or on.</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01357"></a><span class="lineno"><a class="line" href="classTHD.html#a90953a8bea3f7b428cb451397f276304"> 1357</a></span>&#160;  <a class="code" href="thr__lock_8h.html#a43801b0a0281484bf8f90c80d701ccb3">thr_lock_type</a> <a class="code" href="classTHD.html#a90953a8bea3f7b428cb451397f276304">update_lock_default</a>;<span class="comment"></span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">    Type of lock to be used for INSERT statement if lock is not specified</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">    explicitly. Set to TL_WRITE_CONCURRENT_INSERT or TL_WRITE_LOW_PRIORITY</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">    depending on whether low_priority_updates option is off or on.</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01363"></a><span class="lineno"><a class="line" href="classTHD.html#a2e75626e242da066a9c4bcbfacf7263d"> 1363</a></span>&#160;  <a class="code" href="thr__lock_8h.html#a43801b0a0281484bf8f90c80d701ccb3">thr_lock_type</a> <a class="code" href="classTHD.html#a2e75626e242da066a9c4bcbfacf7263d">insert_lock_default</a>;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="comment">/* &lt;&gt; 0 if we are inside of trigger or stored function. */</span></div><div class="line"><a name="l01366"></a><span class="lineno"><a class="line" href="classTHD.html#aac65dac79ad504434faf434fac2e638c"> 1366</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#aac65dac79ad504434faf434fac2e638c">in_sub_stmt</a>;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">    Used by fill_status() to avoid acquiring LOCK_status mutex twice</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">    when this function is called recursively (e.g. queries</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">    that contains SELECT on I_S.GLOBAL_STATUS with subquery on the</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">    same I_S table).</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">    Incremented each time fill_status() function is entered and</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">    decremented each time before it returns from the function.</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01376"></a><span class="lineno"><a class="line" href="classTHD.html#a15d25a98d6d23440c0bf3aa037d9f3dd"> 1376</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#a15d25a98d6d23440c0bf3aa037d9f3dd">fill_status_recursion_level</a>;</div><div class="line"><a name="l01377"></a><span class="lineno"><a class="line" href="classTHD.html#a064818560c0ef3bc537f52b63499f3be"> 1377</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#a064818560c0ef3bc537f52b63499f3be">fill_variables_recursion_level</a>;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="comment">/* container for handler&#39;s private per-connection data */</span></div><div class="line"><a name="l01381"></a><span class="lineno"><a class="line" href="classTHD.html#a7cbc0c059d0a5d108698e4e387505837"> 1381</a></span>&#160;  <a class="code" href="classPrealloced__array.html">Prealloced_array&lt;Ha_data, PREALLOC_NUM_HA&gt;</a> <a class="code" href="classTHD.html#a7cbc0c059d0a5d108698e4e387505837">ha_data</a>;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">    Retrieve Ha_data for a given slot. Each handler has a fixed slot nr.</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01387"></a><span class="lineno"><a class="line" href="classTHD.html#a7b69b5cbd027a1e48a58fc2fe76476e7"> 1387</a></span>&#160;  <a class="code" href="structHa__data.html">Ha_data</a> *<a class="code" href="classTHD.html#a7b69b5cbd027a1e48a58fc2fe76476e7">get_ha_data</a>(<span class="keywordtype">int</span> slot) { <span class="keywordflow">return</span> &amp;ha_data[slot]; }</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">    Copy ha_data into the provided argument. Used by Attachble_transaction.</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01392"></a><span class="lineno"><a class="line" href="classTHD.html#adccdd5e05e006547b17e17206f364469"> 1392</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#adccdd5e05e006547b17e17206f364469">backup_ha_data</a>(<a class="code" href="classPrealloced__array.html">Prealloced_array&lt;Ha_data, PREALLOC_NUM_HA&gt;</a> *<a class="code" href="myisampack_8cc.html#ac9a4b7317723254f2c79bffcd3265666">backup</a>) {</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">      Protect with LOCK_thd_data avoid accessing ha_data while it</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">      is being modified.</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;this-&gt;LOCK_thd_data);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    *backup = ha_data;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;this-&gt;LOCK_thd_data);</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  }</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">    Restore ha_data from the provided backup copy.</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">    Used by Attachable_Transaction.</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01406"></a><span class="lineno"><a class="line" href="classTHD.html#ad6eba27979fa58eaf6af0b55777e440e"> 1406</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ad6eba27979fa58eaf6af0b55777e440e">restore_ha_data</a>(</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="keyword">const</span> <a class="code" href="classPrealloced__array.html">Prealloced_array&lt;Ha_data, PREALLOC_NUM_HA&gt;</a> &amp;<a class="code" href="myisampack_8cc.html#ac9a4b7317723254f2c79bffcd3265666">backup</a>) {</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">      Protect with LOCK_thd_data to avoid e.g. KILL CONNECTION</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">      reading ha_data while it is being modified.</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;this-&gt;LOCK_thd_data);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    ha_data = <a class="code" href="myisampack_8cc.html#ac9a4b7317723254f2c79bffcd3265666">backup</a>;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;this-&gt;LOCK_thd_data);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  }</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">    Position of first event in Binlog</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">    *after* last event written by this</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">    thread.</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01422"></a><span class="lineno"><a class="line" href="classTHD.html#a0f4215af86cc9ad1bc0fbbd6aaa72aa8"> 1422</a></span>&#160;  <a class="code" href="structrpl__event__coordinates.html">rpl_event_coordinates</a> <a class="code" href="classTHD.html#a0f4215af86cc9ad1bc0fbbd6aaa72aa8">binlog_next_event_pos</a>;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <span class="keywordtype">void</span> set_next_event_pos(<span class="keyword">const</span> <span class="keywordtype">char</span> *_filename, <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> _pos);</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <span class="keywordtype">void</span> clear_next_event_pos();</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">     Ptr to row event extra data to be written to Binlog /</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">     received from Binlog.</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01431"></a><span class="lineno"><a class="line" href="classTHD.html#a51890b2f30585a8d6c96a9bed162ead0"> 1431</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *<a class="code" href="classTHD.html#a51890b2f30585a8d6c96a9bed162ead0">binlog_row_event_extra_data</a>;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="keywordtype">int</span> binlog_setup_trx_data();</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">    Public interface to write RBR events to the binlog</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="keywordtype">int</span> binlog_write_table_map(<a class="code" href="structTABLE.html">TABLE</a> *table, <span class="keywordtype">bool</span> is_transactional,</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                             <span class="keywordtype">bool</span> binlog_rows_query);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keywordtype">int</span> binlog_write_row(<a class="code" href="structTABLE.html">TABLE</a> *table, <span class="keywordtype">bool</span> is_transactional,</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                       <span class="keyword">const</span> <a class="code" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *<a class="code" href="app__data_8cc.html#a4104c7043ba0f61a452a016adfd1869d">new_data</a>,</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *extra_row_info);</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="keywordtype">int</span> binlog_delete_row(<a class="code" href="structTABLE.html">TABLE</a> *table, <span class="keywordtype">bool</span> is_transactional,</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                        <span class="keyword">const</span> <a class="code" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *old_data,</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *extra_row_info);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="keywordtype">int</span> binlog_update_row(<a class="code" href="structTABLE.html">TABLE</a> *table, <span class="keywordtype">bool</span> is_transactional,</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                        <span class="keyword">const</span> <a class="code" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *old_data, <span class="keyword">const</span> <a class="code" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *<a class="code" href="app__data_8cc.html#a4104c7043ba0f61a452a016adfd1869d">new_data</a>,</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                        <span class="keyword">const</span> <a class="code" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *extra_row_info);</div><div class="line"><a name="l01449"></a><span class="lineno"><a class="line" href="classTHD.html#a6633fff886be7782ae52532dbf827344"> 1449</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a6633fff886be7782ae52532dbf827344">set_server_id</a>(<a class="code" href="my__inttypes_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> sid) { server_id = sid; }</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">    Member functions to handle pending event for row-level logging.</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class</span> RowsEventT&gt;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <a class="code" href="classRows__log__event.html">Rows_log_event</a> *binlog_prepare_pending_rows_event(</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <a class="code" href="structTABLE.html">TABLE</a> *table, <a class="code" href="my__inttypes_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> serv_id, <span class="keywordtype">size_t</span> needed, <span class="keywordtype">bool</span> is_transactional,</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *extra_row_info, <a class="code" href="my__inttypes_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> source_part_id = INT_MAX);</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <a class="code" href="classRows__log__event.html">Rows_log_event</a> *binlog_get_pending_rows_event(<span class="keywordtype">bool</span> is_transactional) <span class="keyword">const</span>;</div><div class="line"><a name="l01459"></a><span class="lineno"><a class="line" href="classTHD.html#a7778162d67f41c9593424726538b3f72"> 1459</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classTHD.html#a7778162d67f41c9593424726538b3f72">binlog_flush_pending_rows_event</a>(<span class="keywordtype">bool</span> stmt_end) {</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="keywordflow">return</span> (binlog_flush_pending_rows_event(stmt_end, <span class="keyword">false</span>) ||</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            binlog_flush_pending_rows_event(stmt_end, <span class="keyword">true</span>));</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  }</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="keywordtype">int</span> binlog_flush_pending_rows_event(<span class="keywordtype">bool</span> stmt_end, <span class="keywordtype">bool</span> is_transactional);</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">    Determine the binlog format of the current statement.</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">    @retval 0 if the current statement will be logged in statement</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">    format.</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">    @retval nonzero if the current statement will be logged in row</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">    format.</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01473"></a><span class="lineno"><a class="line" href="classTHD.html#a7d8d7dc34cf8a15e129843a9d6419262"> 1473</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classTHD.html#a7d8d7dc34cf8a15e129843a9d6419262">is_current_stmt_binlog_format_row</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(current_stmt_binlog_format == <a class="code" href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bcacca4d39ed26658ad08e83887217a3e57">BINLOG_FORMAT_STMT</a> ||</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                current_stmt_binlog_format == <a class="code" href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bca9fc57580019e63df209ad5271b483db8">BINLOG_FORMAT_ROW</a>);</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">return</span> current_stmt_binlog_format == <a class="code" href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bca9fc57580019e63df209ad5271b483db8">BINLOG_FORMAT_ROW</a>;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  }</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">    Determine if binlogging is currently disabled for this session.</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment">    There are two ways that binlogging can be disabled:</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">     1. The binary log file is closed (globally). This can happen for</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">        two reasons: either --skip-log-bin was used on the command line,</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">        or a binlog write error happened when binlog_error_action=IGNORE_ERROR.</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">     2. The binary log is disabled on session level. This can happen for</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">        two reasons: either the user has set @@session.sql_log_bin = 0,</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">        or the server code has internally disabled the binary log (by</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">        either setting thd-&gt;variables.option_bits &amp;= ~OPTION_BIN_LOG or</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">        creating a Disable_binlog_guard object).</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">    Even if this function returns true and the binary log is disabled,</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">    it is possible that the statement will be written to the binary log,</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">    in the cases where the server has merely temporarily disabled binary</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">    logging.</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">    And even if this function returns false and the binary log is</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">    enabled, it is possible that the statement will not be written to</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment">    the binary log, e.g. in case it is a no-op, it fails, it gets rolled</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">    back, or some other session closes the binary log due to a write</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">    error when using binlog_error_action=IGNORE_ERROR.</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">    @retval true The binary log is currently disabled for the statement.</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">    @retval false The binary log is currently enabled for the statement.</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="keywordtype">bool</span> is_current_stmt_binlog_disabled() <span class="keyword">const</span>;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">    Determine if binlogging is currently disabled for this session.</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">    If the binary log is disabled for this thread (either by log_bin=0 or</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">    sql_log_bin=0 or by log_slave_updates=0 for a slave thread), then the</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">    statement will not be written to the binary log.</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">    @retval true The binary log is currently disabled for the statement.</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">    @retval false The binary log is currently enabled for the statement.</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="keywordtype">bool</span> is_current_stmt_binlog_log_slave_updates_disabled() <span class="keyword">const</span>;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">    Determine if binloging is enabled in row format and write set extraction is</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">    enabled for this session</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">    @retval true  if is enable</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">    @retval false otherwise</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <span class="keywordtype">bool</span> is_current_stmt_binlog_row_enabled_with_write_set_extraction() <span class="keyword">const</span>;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment">  /** Tells whether the given optimizer_switch flag is on */</span></div><div class="line"><a name="l01532"></a><span class="lineno"><a class="line" href="classTHD.html#a72249f9440b501f408eb710518ff5870"> 1532</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a72249f9440b501f408eb710518ff5870">optimizer_switch_flag</a>(<a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="hp__test1_8cc.html#adf916204820072417ed73a32de1cefcf">flag</a>)<span class="keyword"> const </span>{</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="keywordflow">return</span> (variables.optimizer_switch &amp; flag);</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  }</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"><a class="line" href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4"> 1536</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4">binlog_filter_state</a> {</div><div class="line"><a name="l01537"></a><span class="lineno"><a class="line" href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4a7da8c1a8d0dec904be4f12f34cd7877f"> 1537</a></span>&#160;    <a class="code" href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4a7da8c1a8d0dec904be4f12f34cd7877f">BINLOG_FILTER_UNKNOWN</a>,</div><div class="line"><a name="l01538"></a><span class="lineno"><a class="line" href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4a66eced0095aeef3ff100a9140d5fcb26"> 1538</a></span>&#160;    <a class="code" href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4a66eced0095aeef3ff100a9140d5fcb26">BINLOG_FILTER_CLEAR</a>,</div><div class="line"><a name="l01539"></a><span class="lineno"><a class="line" href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4aebafcdd308f8b2a37c4f5941eb57b31c"> 1539</a></span>&#160;    BINLOG_FILTER_SET</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  };</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01542"></a><span class="lineno"><a class="line" href="classTHD.html#a4bb5d57ac2b0ff5fd4041cb4ac38a5d4"> 1542</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a4bb5d57ac2b0ff5fd4041cb4ac38a5d4">reset_binlog_local_stmt_filter</a>() {</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    m_binlog_filter_state = BINLOG_FILTER_UNKNOWN;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  }</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"><a class="line" href="classTHD.html#a0b900818471bdf035f73ae1a94585c5b"> 1546</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a0b900818471bdf035f73ae1a94585c5b">clear_binlog_local_stmt_filter</a>() {</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(m_binlog_filter_state == BINLOG_FILTER_UNKNOWN);</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    m_binlog_filter_state = BINLOG_FILTER_CLEAR;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  }</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div><div class="line"><a name="l01551"></a><span class="lineno"><a class="line" href="classTHD.html#a8f64f234afe77623840e171722df19d4"> 1551</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a8f64f234afe77623840e171722df19d4">set_binlog_local_stmt_filter</a>() {</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(m_binlog_filter_state == BINLOG_FILTER_UNKNOWN);</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    m_binlog_filter_state = BINLOG_FILTER_SET;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  }</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"><a class="line" href="classTHD.html#a510136f4a756403fb083308df2fb003d"> 1556</a></span>&#160;  <a class="code" href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4">binlog_filter_state</a> <a class="code" href="classTHD.html#a510136f4a756403fb083308df2fb003d">get_binlog_local_stmt_filter</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keywordflow">return</span> m_binlog_filter_state;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  }</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">  /** Holds active timer object */</span></div><div class="line"><a name="l01561"></a><span class="lineno"><a class="line" href="classTHD.html#a0624d627df806876ea2739e8fc1c7191"> 1561</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structTHD__timer__info.html">THD_timer_info</a> *<a class="code" href="classTHD.html#a0624d627df806876ea2739e8fc1c7191">timer</a>;<span class="comment"></span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">    After resetting(cancelling) timer, current timer object is cached</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">    with timer_cache timer to reuse.</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01566"></a><span class="lineno"><a class="line" href="classTHD.html#a6f87c01afcdc38d1d35febe203c8fbed"> 1566</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structTHD__timer__info.html">THD_timer_info</a> *<a class="code" href="classTHD.html#a6f87c01afcdc38d1d35febe203c8fbed">timer_cache</a>;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">    Indicates that the command which is under execution should ignore the</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">    &#39;read_only&#39; and &#39;super_read_only&#39; options.</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01573"></a><span class="lineno"><a class="line" href="classTHD.html#a9ed6f3917f069b1e274706b563277efa"> 1573</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a9ed6f3917f069b1e274706b563277efa">skip_readonly_check</a>;<span class="comment"></span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">    Indicate if the current statement should be discarded</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">    instead of written to the binlog.</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">    This is used to discard special statements, such as</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">    DML or DDL that affects only &#39;local&#39; (non replicated)</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="comment">    tables, such as performance_schema.*</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01581"></a><span class="lineno"><a class="line" href="classTHD.html#aa31637e09b425d1f831eb14c7766ec40"> 1581</a></span>&#160;  <a class="code" href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4">binlog_filter_state</a> <a class="code" href="classTHD.html#aa31637e09b425d1f831eb14c7766ec40">m_binlog_filter_state</a>;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">    Indicates the format in which the current statement will be</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">    logged.  This can only be set from @c decide_logging_format().</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01587"></a><span class="lineno"><a class="line" href="classTHD.html#a413bc5f40af312f9423dab928f87b533"> 1587</a></span>&#160;  <a class="code" href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bc">enum_binlog_format</a> <a class="code" href="classTHD.html#a413bc5f40af312f9423dab928f87b533">current_stmt_binlog_format</a>;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">    Bit field for the state of binlog warnings.</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment">    The first Lex::BINLOG_STMT_UNSAFE_COUNT bits list all types of</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">    unsafeness that the current statement has.</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">    This must be a member of THD and not of LEX, because warnings are</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">    detected and issued in different places (@c</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">    decide_logging_format() and @c binlog_query(), respectively).</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">    Between these calls, the THD-&gt;lex object may change; e.g., if a</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">    stored routine is invoked.  Only THD persists between the calls.</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01601"></a><span class="lineno"><a class="line" href="classTHD.html#ad2b97fa1c383b8e79ad17d51c015729e"> 1601</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classTHD.html#ad2b97fa1c383b8e79ad17d51c015729e">binlog_unsafe_warning_flags</a>;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment">    Number of outstanding table maps, i.e., table maps in the</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="comment">    transaction cache.</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01607"></a><span class="lineno"><a class="line" href="classTHD.html#ae5a349f788655802500578e93c0b218d"> 1607</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#ae5a349f788655802500578e93c0b218d">binlog_table_maps</a>;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment">    MTS: db names listing to be updated by the query databases</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01611"></a><span class="lineno"><a class="line" href="classTHD.html#a95a15e2f06bddac703c87fafa474324b"> 1611</a></span>&#160;  <a class="code" href="classList.html">List&lt;char&gt;</a> *<a class="code" href="classTHD.html#a95a15e2f06bddac703c87fafa474324b">binlog_accessed_db_names</a>;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment">    The binary log position of the transaction.</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment">    The file and position are zero if the current transaction has not</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="comment">    been written to the binary log.</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment">    @see set_trans_pos</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">    @see get_trans_pos</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment">    @todo Similar information is kept in the patch for BUG#11762277</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="comment">    and by the master/slave heartbeat implementation.  We should merge</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment">    these positions instead of maintaining three different ones.</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">   */</span><span class="comment"></span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">  /**@{*/</span></div><div class="line"><a name="l01627"></a><span class="lineno"><a class="line" href="classTHD.html#aeb1fbff27dc70e02622ab59965ad31dc"> 1627</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classTHD.html#aeb1fbff27dc70e02622ab59965ad31dc">m_trans_log_file</a>;</div><div class="line"><a name="l01628"></a><span class="lineno"><a class="line" href="classTHD.html#aae563ffb7ad386c1152eaf2067009425"> 1628</a></span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="classTHD.html#aae563ffb7ad386c1152eaf2067009425">m_trans_fixed_log_file</a>;</div><div class="line"><a name="l01629"></a><span class="lineno"><a class="line" href="classTHD.html#a32210906fc43174f9affe0cc13ce86a7"> 1629</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a378b5b2448c7170f4b6bd225583e8a19">my_off_t</a> <a class="code" href="classTHD.html#a32210906fc43174f9affe0cc13ce86a7">m_trans_end_pos</a>;<span class="comment"></span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment">  /**@}*/</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="comment">// NOTE: Ideally those two should be in Protocol,</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="comment">// but currently its design doesn&#39;t allow that.</span></div><div class="line"><a name="l01633"></a><span class="lineno"><a class="line" href="classTHD.html#ab77dc649d04a41008e69003736eb24d9"> 1633</a></span>&#160;  <a class="code" href="structNET.html">NET</a> <a class="code" href="classTHD.html#ab77dc649d04a41008e69003736eb24d9">net</a>;        <span class="comment">// client connection descriptor</span></div><div class="line"><a name="l01634"></a><span class="lineno"><a class="line" href="classTHD.html#a80e02419914f3da098e1a8794551bf09"> 1634</a></span>&#160;  <a class="code" href="classString.html">String</a> <a class="code" href="classTHD.html#a80e02419914f3da098e1a8794551bf09">packet</a>;  <span class="comment">// dynamic buffer for network I/O</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l01636"></a><span class="lineno"><a class="line" href="classTHD.html#af0bf2465e33617b91b60ba9e6cde41be"> 1636</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#af0bf2465e33617b91b60ba9e6cde41be">set_skip_readonly_check</a>() { skip_readonly_check = <span class="keyword">true</span>; }</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div><div class="line"><a name="l01638"></a><span class="lineno"><a class="line" href="classTHD.html#a8fadccd09476d7b1041f55a28d3071d5"> 1638</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a8fadccd09476d7b1041f55a28d3071d5">is_cmd_skip_readonly</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> skip_readonly_check; }</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div><div class="line"><a name="l01640"></a><span class="lineno"><a class="line" href="classTHD.html#af65e652f6d1e80fb99d771a0498c3638"> 1640</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#af65e652f6d1e80fb99d771a0498c3638">reset_skip_readonly_check</a>() {</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="keywordflow">if</span> (skip_readonly_check) skip_readonly_check = <span class="keyword">false</span>;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  }</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <span class="keywordtype">void</span> issue_unsafe_warnings();</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div><div class="line"><a name="l01646"></a><span class="lineno"><a class="line" href="classTHD.html#ab26acc1bf65cde84b61d0e6d5981d238"> 1646</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#ab26acc1bf65cde84b61d0e6d5981d238">get_binlog_table_maps</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> binlog_table_maps; }</div><div class="line"><a name="l01647"></a><span class="lineno"><a class="line" href="classTHD.html#a121f1ddee2f3c663bd68f3d859c0b98b"> 1647</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a121f1ddee2f3c663bd68f3d859c0b98b">clear_binlog_table_maps</a>() { binlog_table_maps = 0; }</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">    MTS: accessor to binlog_accessed_db_names list</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01652"></a><span class="lineno"><a class="line" href="classTHD.html#a3f35983a2342c6d2c336a1a444d83954"> 1652</a></span>&#160;  <a class="code" href="classList.html">List&lt;char&gt;</a> *<a class="code" href="classTHD.html#a3f35983a2342c6d2c336a1a444d83954">get_binlog_accessed_db_names</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">return</span> binlog_accessed_db_names;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  }</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <span class="comment">/* MTS: method inserts a new unique name into binlog_updated_dbs */</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keywordtype">void</span> add_to_binlog_accessed_dbs(<span class="keyword">const</span> <span class="keywordtype">char</span> *db);</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l01660"></a><span class="lineno"><a class="line" href="classTHD.html#abd0f16981c46e67c8680050ed49c6c4c"> 1660</a></span>&#160;  std::unique_ptr&lt;Transaction_ctx&gt; <a class="code" href="classTHD.html#abd0f16981c46e67c8680050ed49c6c4c">m_transaction</a>;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="comment">  /** An utility struct for @c Attachable_trx */</span></div><div class="line"><a name="l01663"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html"> 1663</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structTHD_1_1Transaction__state.html">Transaction_state</a> {</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <a class="code" href="structTHD_1_1Transaction__state.html">Transaction_state</a>();</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    ~<a class="code" href="structTHD_1_1Transaction__state.html">Transaction_state</a>();</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="myisampack_8cc.html#ac9a4b7317723254f2c79bffcd3265666">backup</a>(<a class="code" href="classTHD.html">THD</a> *thd);</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keywordtype">void</span> restore(<a class="code" href="classTHD.html">THD</a> *thd);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="comment">    /// SQL-command.</span></div><div class="line"><a name="l01670"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#ac960c86a277dab53f956387cfc71076b"> 1670</a></span>&#160;<span class="comment"></span>    <a class="code" href="my__sqlcommand_8h.html#a46bba265a20f1784df6b9802aec4122a">enum_sql_command</a> <a class="code" href="structTHD_1_1Transaction__state.html#ac960c86a277dab53f956387cfc71076b">m_sql_command</a>;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;</div><div class="line"><a name="l01672"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#acec40d0653caba7a96345b1d0edf810b"> 1672</a></span>&#160;    <a class="code" href="classQuery__tables__list.html">Query_tables_list</a> *<a class="code" href="structTHD_1_1Transaction__state.html#acec40d0653caba7a96345b1d0edf810b">m_query_tables_list</a>;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="comment">    /// Open-tables state.</span></div><div class="line"><a name="l01675"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#a852fc16165720425d815f8fa340004bb"> 1675</a></span>&#160;<span class="comment"></span>    <a class="code" href="classOpen__tables__backup.html">Open_tables_backup</a> <a class="code" href="structTHD_1_1Transaction__state.html#a852fc16165720425d815f8fa340004bb">m_open_tables_state</a>;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">    /// SQL_MODE.</span></div><div class="line"><a name="l01678"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#aa75d025169affd7b5f534d0f957f310e"> 1678</a></span>&#160;<span class="comment"></span>    <a class="code" href="dd__event_8h.html#a20f7f65896651c6fcc973f518670c5a8">sql_mode_t</a> <a class="code" href="structTHD_1_1Transaction__state.html#aa75d025169affd7b5f534d0f957f310e">m_sql_mode</a>;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment">    /// Transaction isolation level.</span></div><div class="line"><a name="l01681"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#ae56fe056be6e8bdf69992129d16460bb"> 1681</a></span>&#160;<span class="comment"></span>    <a class="code" href="sql_2handler_8h.html#a9eca5571cb03b2bea1246c948d9244fb">enum_tx_isolation</a> <a class="code" href="structTHD_1_1Transaction__state.html#ae56fe056be6e8bdf69992129d16460bb">m_tx_isolation</a>;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">    /// Ha_data array.</span></div><div class="line"><a name="l01684"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#a5be46bfecab41065dd08fb6f516183dd"> 1684</a></span>&#160;<span class="comment"></span>    <a class="code" href="classPrealloced__array.html">Prealloced_array&lt;Ha_data, PREALLOC_NUM_HA&gt;</a> <a class="code" href="structTHD_1_1Transaction__state.html#a5be46bfecab41065dd08fb6f516183dd">m_ha_data</a>;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="comment">    /// Transaction_ctx instance.</span></div><div class="line"><a name="l01687"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#a7f25a09d4e97f679b6e3ee6319939da3"> 1687</a></span>&#160;<span class="comment"></span>    <a class="code" href="classTransaction__ctx.html">Transaction_ctx</a> *<a class="code" href="structTHD_1_1Transaction__state.html#a7f25a09d4e97f679b6e3ee6319939da3">m_trx</a>;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="comment">    /// Transaction read-only state.</span></div><div class="line"><a name="l01690"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#aa0989674f66b8c84e64352912641aa34"> 1690</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="structTHD_1_1Transaction__state.html#aa0989674f66b8c84e64352912641aa34">m_tx_read_only</a>;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">    /// THD options.</span></div><div class="line"><a name="l01693"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#a2efe31a690d4bc6004f11a498cff3e0e"> 1693</a></span>&#160;<span class="comment"></span>    <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="structTHD_1_1Transaction__state.html#a2efe31a690d4bc6004f11a498cff3e0e">m_thd_option_bits</a>;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">    /// Current transaction instrumentation.</span></div><div class="line"><a name="l01696"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#a53a636d02fde2a2c515d28d5b1e012c5"> 1696</a></span>&#160;<span class="comment"></span>    <a class="code" href="group__psi__abi__transaction.html#ga88504a3aa3d24a2e5011a80ded544639">PSI_transaction_locker</a> *<a class="code" href="structTHD_1_1Transaction__state.html#a53a636d02fde2a2c515d28d5b1e012c5">m_transaction_psi</a>;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment">    /// Server status flags.</span></div><div class="line"><a name="l01699"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#a64d33e1562b53a7d6833330576dd2616"> 1699</a></span>&#160;<span class="comment"></span>    <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="structTHD_1_1Transaction__state.html#a64d33e1562b53a7d6833330576dd2616">m_server_status</a>;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">    /// THD::in_lock_tables value.</span></div><div class="line"><a name="l01702"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#a1661eeb9498f218a59eb495bdb0bb0a5"> 1702</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code" href="structTHD_1_1Transaction__state.html#a1661eeb9498f218a59eb495bdb0bb0a5">m_in_lock_tables</a>;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">      Current time zone (i.e. @@session.time_zone) usage indicator.</span></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">      Saving it allows data-dictionary code to read timestamp values</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment">      as datetimes from system tables without disturbing user&#39;s statement.</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">      TODO: We need to change DD code not to use @@session.time_zone at all and</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment">      stick to UTC for internal storage of timestamps in DD objects.</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01713"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#a77fa377fa88e669a548677a28a5b601f"> 1713</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structTHD_1_1Transaction__state.html#a77fa377fa88e669a548677a28a5b601f">m_time_zone_used</a>;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="comment">      Transaction rollback request flag.</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment">      InnoDB can try to access table definition while rolling back regular</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment">      transaction. So we need to be able to start attachable transaction</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="comment">      without being affected by, and affecting, the rollback state of regular</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment">      transaction.</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01723"></a><span class="lineno"><a class="line" href="structTHD_1_1Transaction__state.html#a7846e38cc12d856d71f807d26f032a2d"> 1723</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structTHD_1_1Transaction__state.html#a7846e38cc12d856d71f807d26f032a2d">m_transaction_rollback_request</a>;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  };</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l01727"></a><span class="lineno"><a class="line" href="classTHD.html#afa3c413607ea1ff67a8c17500a9de27bae71b344111f6a0f7a3427e989682d308"> 1727</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classTHD.html#afa3c413607ea1ff67a8c17500a9de27b">enum_reset_lex</a> { <a class="code" href="classTHD.html#afa3c413607ea1ff67a8c17500a9de27bae71b344111f6a0f7a3427e989682d308">RESET_LEX</a>, DO_NOT_RESET_LEX };</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="comment">    Class representing read-only attachable transaction, encapsulates</span></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="comment">    knowledge how to backup state of current transaction, start</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="comment">    read-only attachable transaction in SE, finalize it and then restore</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="comment">    state of original transaction back. Also serves as a base class for</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment">    read-write attachable transaction implementation.</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01737"></a><span class="lineno"><a class="line" href="classTHD_1_1Attachable__trx.html"> 1737</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a> {</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a>(<a class="code" href="classTHD.html">THD</a> *thd, <a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a> *prev_trx);</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a>();</div><div class="line"><a name="l01741"></a><span class="lineno"><a class="line" href="classTHD_1_1Attachable__trx.html#a767726c2f48805d924ae0914df7e388c"> 1741</a></span>&#160;    <a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a> *<a class="code" href="classTHD_1_1Attachable__trx.html#a767726c2f48805d924ae0914df7e388c">get_prev_attachable_trx</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      <span class="keywordflow">return</span> m_prev_attachable_trx;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    }</div><div class="line"><a name="l01744"></a><span class="lineno"><a class="line" href="classTHD_1_1Attachable__trx.html#aa25f9429edea2c8b370c1bedb4d2534c"> 1744</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD_1_1Attachable__trx.html#aa25f9429edea2c8b370c1bedb4d2534c">is_read_only</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;   <span class="keyword">protected</span>:<span class="comment"></span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">    /// THD instance.</span></div><div class="line"><a name="l01748"></a><span class="lineno"><a class="line" href="classTHD_1_1Attachable__trx.html#a396ad49c62693f5571c366ee07fd5342"> 1748</a></span>&#160;<span class="comment"></span>    <a class="code" href="classTHD.html">THD</a> *<a class="code" href="classTHD_1_1Attachable__trx.html#a396ad49c62693f5571c366ee07fd5342">m_thd</a>;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div><div class="line"><a name="l01750"></a><span class="lineno"><a class="line" href="classTHD_1_1Attachable__trx.html#ac27a855c8b5dd7217a1bf75a0f53bf87"> 1750</a></span>&#160;    <a class="code" href="classTHD.html#afa3c413607ea1ff67a8c17500a9de27b">enum_reset_lex</a> <a class="code" href="classTHD_1_1Attachable__trx.html#ac27a855c8b5dd7217a1bf75a0f53bf87">m_reset_lex</a>;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="comment">      Attachable_trx which was active for the THD before when this</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment">      transaction was started (NULL in most cases).</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01756"></a><span class="lineno"><a class="line" href="classTHD_1_1Attachable__trx.html#a92624bc0abefbce5c1bbab69c1f71de4"> 1756</a></span>&#160;    <a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a> *<a class="code" href="classTHD_1_1Attachable__trx.html#a92624bc0abefbce5c1bbab69c1f71de4">m_prev_attachable_trx</a>;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">    /// Transaction state data.</span></div><div class="line"><a name="l01759"></a><span class="lineno"><a class="line" href="classTHD_1_1Attachable__trx.html#a475be4429ac336c26e6d397073bb9b95"> 1759</a></span>&#160;<span class="comment"></span>    <a class="code" href="structTHD_1_1Transaction__state.html">Transaction_state</a> <a class="code" href="classTHD_1_1Attachable__trx.html#a475be4429ac336c26e6d397073bb9b95">m_trx_state</a>;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a>(<span class="keyword">const</span> <a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a> &amp;);</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a> &amp;operator=(<span class="keyword">const</span> <a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a> &amp;);</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  };</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="comment">    A derived from THD::Attachable_trx class allows updates in</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="comment">    the attachable transaction. Callers of the class methods must</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment">    make sure the attachable_rw won&#39;t cause deadlock with the main transaction.</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment">    The destructor does not invoke ha_commit_{stmt,trans} nor ha_rollback_trans</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">    on purpose.</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">    Burden to terminate the read-write instance also lies on the caller!</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">    In order to use this interface it *MUST* prove that no side effect to</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">    the global transaction state can be inflicted by a chosen method.</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment">    This class is being used only by class Gtid_table_access_context by</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment">    replication and by dd::info_schema::Table_statistics.</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div><div class="line"><a name="l01780"></a><span class="lineno"><a class="line" href="classTHD_1_1Attachable__trx__rw.html"> 1780</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classTHD_1_1Attachable__trx__rw.html">Attachable_trx_rw</a> : <span class="keyword">public</span> <a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a> {</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l01782"></a><span class="lineno"><a class="line" href="classTHD_1_1Attachable__trx__rw.html#a5fb435203bcde9ecf360e5d8b47a1011"> 1782</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classTHD_1_1Attachable__trx__rw.html#a5fb435203bcde9ecf360e5d8b47a1011">is_read_only</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classTHD_1_1Attachable__trx__rw.html">Attachable_trx_rw</a>(<a class="code" href="classTHD.html">THD</a> *thd);</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <a class="code" href="classTHD_1_1Attachable__trx__rw.html">Attachable_trx_rw</a>(<span class="keyword">const</span> <a class="code" href="classTHD_1_1Attachable__trx__rw.html">Attachable_trx_rw</a> &amp;);</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <a class="code" href="classTHD_1_1Attachable__trx__rw.html">Attachable_trx_rw</a> &amp;operator=(<span class="keyword">const</span> <a class="code" href="classTHD_1_1Attachable__trx__rw.html">Attachable_trx_rw</a> &amp;);</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  };</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"><a class="line" href="classTHD.html#ab090db60e886ed772da28766076263c1"> 1790</a></span>&#160;  <a class="code" href="classTHD_1_1Attachable__trx.html">Attachable_trx</a> *<a class="code" href="classTHD.html#ab090db60e886ed772da28766076263c1">m_attachable_trx</a>;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l01793"></a><span class="lineno"><a class="line" href="classTHD.html#aa3d11bd2de65c90fe1933cfd311263f9"> 1793</a></span>&#160;  <a class="code" href="classTransaction__ctx.html">Transaction_ctx</a> *<a class="code" href="classTHD.html#aa3d11bd2de65c90fe1933cfd311263f9">get_transaction</a>() { <span class="keywordflow">return</span> m_transaction.get(); }</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div><div class="line"><a name="l01795"></a><span class="lineno"><a class="line" href="classTHD.html#a61ae989e5c3c2e0dfa3c8701ddb8067d"> 1795</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classTransaction__ctx.html">Transaction_ctx</a> *<a class="code" href="classTHD.html#a61ae989e5c3c2e0dfa3c8701ddb8067d">get_transaction</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_transaction.get(); }</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment">    Changes the Transaction_ctx instance within THD-object. The previous</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment">    Transaction_ctx instance is destroyed.</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment">    @note this is a THD-internal operation which MUST NOT be used outside.</span></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">    @param transaction_ctx new Transaction_ctx instance to be associated with</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment">    the THD-object.</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="keywordtype">void</span> set_transaction(<a class="code" href="classTransaction__ctx.html">Transaction_ctx</a> *transaction_ctx);</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div><div class="line"><a name="l01808"></a><span class="lineno"><a class="line" href="classTHD.html#af67488547215fbfa878c19666e6fa242"> 1808</a></span>&#160;  <a class="code" href="classGlobal__read__lock.html">Global_read_lock</a> <a class="code" href="classTHD.html#af67488547215fbfa878c19666e6fa242">global_read_lock</a>;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div><div class="line"><a name="l01810"></a><span class="lineno"><a class="line" href="classTHD.html#ac2c6df17a0df0bea1f65f105ef0862ca"> 1810</a></span>&#160;  <a class="code" href="structVio.html">Vio</a> *active_vio = {<span class="keyword">nullptr</span>};</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <span class="comment">/* Active network vio for clone remote connection. */</span></div><div class="line"><a name="l01813"></a><span class="lineno"><a class="line" href="classTHD.html#a477885d654fa4823ade34f80518ab38f"> 1813</a></span>&#160;  <a class="code" href="structVio.html">Vio</a> *clone_vio = {<span class="keyword">nullptr</span>};</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment">    This is used to track transient changes to items during optimization of a</span></div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="comment">    prepared statement/stored procedure. Change objects are created by</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="comment">    change_item_tree() in memory root of THD, and freed by</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="comment">    rollback_item_tree_changes(). Changes recorded here are rolled back at</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="comment">    the end of execution.</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="comment">    Transient changes require the following conditions:</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="comment">    - The statement is not regular (ie. it is prepared or part of SP).</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment">    - The change is performed outside preparation code (ie. it is</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment">      performed during the optimization phase).</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="comment">    - The change is applied to non-transient items (ie. items that have</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="comment">      been created before or during preparation, not items that have been</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="comment">      created in the optimization phase. Notice that the tree of AND/OR</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="comment">      conditions is always as transient objects during optimization.</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="comment">      Doing this should be quite harmless, though.)</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="comment">    change_item_tree() only records changes to non-regular statements.</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="comment">    It is also ensured that no changes are applied in preparation phase by</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="comment">    asserting that the list of items is empty (see Sql_cmd_dml::prepare()).</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment">    Other constraints are not enforced, in particular care must be taken</span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="comment">    so that all changes made during optimization to non-transient Items in</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">    non-regular statements must be recorded.</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01838"></a><span class="lineno"><a class="line" href="classTHD.html#acc88998f9c885e791268e290ff505b86"> 1838</a></span>&#160;  <a class="code" href="classI__List.html">Item_change_list</a> <a class="code" href="classTHD.html#acc88998f9c885e791268e290ff505b86">change_list</a>;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="comment">    A permanent memory area of the statement. For conventional</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="comment">    execution, the parsed tree and execution runtime reside in the same</span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment">    memory root. In this case stmt_arena points to THD. In case of</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment">    a prepared statement or a stored procedure statement, thd-&gt;mem_root</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment">    conventionally points to runtime memory, and thd-&gt;stmt_arena</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment">    points to the memory of the PS/SP, where the parsed tree of the</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment">    statement resides. Whenever you need to perform a permanent</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment">    transformation of a parsed tree, you should allocate new memory in</span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment">    stmt_arena, to allow correct re-execution of PS/SP.</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment">    Note: in the parser, stmt_arena == thd, even for PS/SP.</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01852"></a><span class="lineno"><a class="line" href="classTHD.html#a40cb4e81f0ca5ef0ac6042752f84f5be"> 1852</a></span>&#160;  <a class="code" href="classQuery__arena.html">Query_arena</a> *<a class="code" href="classTHD.html#a40cb4e81f0ca5ef0ac6042752f84f5be">stmt_arena</a>;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment">    map for tables that will be updated for a multi-table update query</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment">    statement, for other query statements, this will be zero.</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01858"></a><span class="lineno"><a class="line" href="classTHD.html#abd20d43f3f290fbdcfe5628ca014b30a"> 1858</a></span>&#160;  <a class="code" href="my__table__map_8h.html#a82b78abeba8cfb8e3df3e082f42b6cff">table_map</a> <a class="code" href="classTHD.html#abd20d43f3f290fbdcfe5628ca014b30a">table_map_for_update</a>;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <span class="comment">/* Tells if LAST_INSERT_ID(#) was called for the current statement */</span></div><div class="line"><a name="l01861"></a><span class="lineno"><a class="line" href="classTHD.html#af0ac9641bfb593a6fc22cba1042083c8"> 1861</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#af0ac9641bfb593a6fc22cba1042083c8">arg_of_last_insert_id_function</a>;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment">    ALL OVER THIS FILE, &quot;insert_id&quot; means &quot;*automatically generated* value for</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment">    insertion into an auto_increment column&quot;.</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment">    This is the first autogenerated insert id which was *successfully*</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment">    inserted by the previous statement (exactly, if the previous statement</span></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment">    didn&#39;t successfully insert an autogenerated insert id, then it&#39;s the one</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">    of the statement before, etc).</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="comment">    It can also be set by SET LAST_INSERT_ID=# or SELECT LAST_INSERT_ID(#).</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="comment">    It is returned by LAST_INSERT_ID().</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01874"></a><span class="lineno"><a class="line" href="classTHD.html#a26b476d12e88c240b6115dcb10961f45"> 1874</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classTHD.html#a26b476d12e88c240b6115dcb10961f45">first_successful_insert_id_in_prev_stmt</a>;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="comment">    Variant of the above, used for storing in statement-based binlog. The</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="comment">    difference is that the one above can change as the execution of a stored</span></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="comment">    function progresses, while the one below is set once and then does not</span></div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="comment">    change (which is the value which statement-based binlog needs).</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01881"></a><span class="lineno"><a class="line" href="classTHD.html#a070a0ce589c0116c5aa8fcf5e5014727"> 1881</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classTHD.html#a070a0ce589c0116c5aa8fcf5e5014727">first_successful_insert_id_in_prev_stmt_for_binlog</a>;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment">    This is the first autogenerated insert id which was *successfully*</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment">    inserted by the current statement. It is maintained only to set</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="comment">    first_successful_insert_id_in_prev_stmt when statement ends.</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01887"></a><span class="lineno"><a class="line" href="classTHD.html#a0d59225e08125bb900e41cb91c532f95"> 1887</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classTHD.html#a0d59225e08125bb900e41cb91c532f95">first_successful_insert_id_in_cur_stmt</a>;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="comment">    We follow this logic:</span></div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="comment">    - when stmt starts, first_successful_insert_id_in_prev_stmt contains the</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="comment">    first insert id successfully inserted by the previous stmt.</span></div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="comment">    - as stmt makes progress, handler::insert_id_for_cur_row changes;</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment">    every time get_auto_increment() is called,</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">    auto_inc_intervals_in_cur_stmt_for_binlog is augmented with the</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">    reserved interval (if statement-based binlogging).</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="comment">    - at first successful insertion of an autogenerated value,</span></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="comment">    first_successful_insert_id_in_cur_stmt is set to</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="comment">    handler::insert_id_for_cur_row.</span></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="comment">    - when stmt goes to binlog,</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="comment">    auto_inc_intervals_in_cur_stmt_for_binlog is binlogged if</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="comment">    non-empty.</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment">    - when stmt ends, first_successful_insert_id_in_prev_stmt is set to</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="comment">    first_successful_insert_id_in_cur_stmt.</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="comment">    stmt_depends_on_first_successful_insert_id_in_prev_stmt is set when</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="comment">    LAST_INSERT_ID() is used by a statement.</span></div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="comment">    If it is set, first_successful_insert_id_in_prev_stmt_for_binlog will be</span></div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="comment">    stored in the statement-based binlog.</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment">    This variable is CUMULATIVE along the execution of a stored function or</span></div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="comment">    trigger: if one substatement sets it to 1 it will stay 1 until the</span></div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="comment">    function/trigger ends, thus making sure that</span></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="comment">    first_successful_insert_id_in_prev_stmt_for_binlog does not change anymore</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">    and is propagated to the caller for binlogging.</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01916"></a><span class="lineno"><a class="line" href="classTHD.html#a812eba45c251221a8a3e0cf9450c7cf2"> 1916</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a812eba45c251221a8a3e0cf9450c7cf2">stmt_depends_on_first_successful_insert_id_in_prev_stmt</a>;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment">    List of auto_increment intervals reserved by the thread so far, for</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment">    storage in the statement-based binlog.</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">    Note that its minimum is not first_successful_insert_id_in_cur_stmt:</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="comment">    assuming a table with an autoinc column, and this happens:</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment">    INSERT INTO ... VALUES(3);</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="comment">    SET INSERT_ID=3; INSERT IGNORE ... VALUES (NULL);</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment">    then the latter INSERT will insert no rows</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment">    (first_successful_insert_id_in_cur_stmt == 0), but storing &quot;INSERT_ID=3&quot;</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">    in the binlog is still needed; the list&#39;s minimum will contain 3.</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="comment">    This variable is cumulative: if several statements are written to binlog</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="comment">    as one (stored functions or triggers are used) this list is the</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment">    concatenation of all intervals reserved by all statements.</span></div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01931"></a><span class="lineno"><a class="line" href="classTHD.html#a7bb3d82e62fc0c437b4c5dba80135a0c"> 1931</a></span>&#160;  <a class="code" href="classDiscrete__intervals__list.html">Discrete_intervals_list</a> <a class="code" href="classTHD.html#a7bb3d82e62fc0c437b4c5dba80135a0c">auto_inc_intervals_in_cur_stmt_for_binlog</a>;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <span class="comment">/* Used by replication and SET INSERT_ID */</span></div><div class="line"><a name="l01933"></a><span class="lineno"><a class="line" href="classTHD.html#a18fe76ce7eafdfc3072f349f8e0993c1"> 1933</a></span>&#160;  <a class="code" href="classDiscrete__intervals__list.html">Discrete_intervals_list</a> <a class="code" href="classTHD.html#a18fe76ce7eafdfc3072f349f8e0993c1">auto_inc_intervals_forced</a>;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="comment">    There is BUG#19630 where statement-based replication of stored</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="comment">    functions/triggers with two auto_increment columns breaks.</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment">    We however ensure that it works when there is 0 or 1 auto_increment</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment">    column; our rules are</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment">    a) on master, while executing a top statement involving substatements,</span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment">    first top- or sub- statement to generate auto_increment values wins the</span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">    exclusive right to see its values be written to binlog (the write</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment">    will be done by the statement or its caller), and the losers won&#39;t see</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment">    their values be written to binlog.</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="comment">    b) on slave, while replicating a top statement involving substatements,</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="comment">    first top- or sub- statement to need to read auto_increment values from</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="comment">    the master&#39;s binlog wins the exclusive right to read them (so the losers</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;<span class="comment">    won&#39;t read their values from binlog but instead generate on their own).</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="comment">    a) implies that we mustn&#39;t backup/restore</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="comment">    auto_inc_intervals_in_cur_stmt_for_binlog.</span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment">    b) implies that we mustn&#39;t backup/restore auto_inc_intervals_forced.</span></div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="comment">    If there are more than 1 auto_increment columns, then intervals for</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="comment">    different columns may mix into the</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="comment">    auto_inc_intervals_in_cur_stmt_for_binlog list, which is logically wrong,</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="comment">    but there is no point in preventing this mixing by preventing intervals</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="comment">    from the secondly inserted column to come into the list, as such</span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment">    prevention would be wrong too.</span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">    What will happen in the case of</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment">    INSERT INTO t1 (auto_inc) VALUES(NULL);</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment">    where t1 has a trigger which inserts into an auto_inc column of t2, is</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="comment">    that in binlog we&#39;ll store the interval of t1 and the interval of t2 (when</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="comment">    we store intervals, soon), then in slave, t1 will use both intervals, t2</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="comment">    will use none; if t1 inserts the same number of rows as on master,</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="comment">    normally the 2nd interval will not be used by t1, which is fine. t2&#39;s</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="comment">    values will be wrong if t2&#39;s internal auto_increment counter is different</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="comment">    from what it was on master (which is likely). In 5.1, in mixed binlogging</span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment">    mode, row-based binlogging is used for such cases where two</span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">    auto_increment columns are inserted.</span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01970"></a><span class="lineno"><a class="line" href="classTHD.html#a51e54aaf9ff69cdf5991f30ffc56d814"> 1970</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a51e54aaf9ff69cdf5991f30ffc56d814">record_first_successful_insert_id_in_cur_stmt</a>(<a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> id_arg) {</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">if</span> (first_successful_insert_id_in_cur_stmt == 0)</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      first_successful_insert_id_in_cur_stmt = id_arg;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  }</div><div class="line"><a name="l01974"></a><span class="lineno"><a class="line" href="classTHD.html#ad144721886ad0ea1a5a7d879bbfd6a3a"> 1974</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classTHD.html#ad144721886ad0ea1a5a7d879bbfd6a3a">read_first_successful_insert_id_in_prev_stmt</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="keywordflow">if</span> (!stmt_depends_on_first_successful_insert_id_in_prev_stmt) {</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      <span class="comment">/* It&#39;s the first time we read it */</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      first_successful_insert_id_in_prev_stmt_for_binlog =</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;          first_successful_insert_id_in_prev_stmt;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      stmt_depends_on_first_successful_insert_id_in_prev_stmt = <span class="keyword">true</span>;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    }</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <span class="keywordflow">return</span> first_successful_insert_id_in_prev_stmt;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  }</div><div class="line"><a name="l01983"></a><span class="lineno"><a class="line" href="classTHD.html#aa7c77b86e7141e1d080ae0fab1c2372d"> 1983</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#aa7c77b86e7141e1d080ae0fab1c2372d">reset_first_successful_insert_id</a>() {</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    arg_of_last_insert_id_function = <span class="keyword">false</span>;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    first_successful_insert_id_in_prev_stmt = 0;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    first_successful_insert_id_in_cur_stmt = 0;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    first_successful_insert_id_in_prev_stmt_for_binlog = 0;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    stmt_depends_on_first_successful_insert_id_in_prev_stmt = <span class="keyword">false</span>;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  }</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="comment">    Used by Intvar_log_event::do_apply_event() and by &quot;SET INSERT_ID=#&quot;</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment">    (mysqlbinlog). We&#39;ll soon add a variant which can take many intervals in</span></div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment">    argument.</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l01996"></a><span class="lineno"><a class="line" href="classTHD.html#a897accff2c6929a400f95a1156d7d106"> 1996</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a897accff2c6929a400f95a1156d7d106">force_one_auto_inc_interval</a>(<a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> next_id) {</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    auto_inc_intervals_forced.<a class="code" href="classDiscrete__intervals__list.html#ade0cbb03dcd687e4dc5ce572834a077a">clear</a>();  <span class="comment">// in case of multiple SET INSERT_ID</span></div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    auto_inc_intervals_forced.<a class="code" href="classDiscrete__intervals__list.html#a58a5310a1fb8451c1b1db37142456b0d">append</a>(next_id, ULLONG_MAX, 0);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  }</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="comment">    Stores the result of the FOUND_ROWS() function.  Set at query end, stable</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="comment">    throughout the query.</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02005"></a><span class="lineno"><a class="line" href="classTHD.html#a774cee2b08db68e391dc0ac83c976f0e"> 2005</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classTHD.html#a774cee2b08db68e391dc0ac83c976f0e">previous_found_rows</a>;<span class="comment"></span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="comment">    Dynamic, collected and set also in subqueries. Not stable throughout query.</span></div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment">    previous_found_rows is a snapshot of this take at query end making it</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="comment">    stable throughout the next query, see update_previous_found_rows.</span></div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02011"></a><span class="lineno"><a class="line" href="classTHD.html#a5a7c9c815ab5f4227d6904a0b47b1c3f"> 2011</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classTHD.html#a5a7c9c815ab5f4227d6904a0b47b1c3f">current_found_rows</a>;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment">    Indicate if the gtid_executed table is being operated implicitly</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="comment">    within current transaction. This happens because we are inserting</span></div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment">    a GTID specified through SET GTID_NEXT by user client or</span></div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">    slave SQL thread/workers.</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02019"></a><span class="lineno"><a class="line" href="classTHD.html#a82b245d235b2cf892ad20143b0991b9e"> 2019</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a82b245d235b2cf892ad20143b0991b9e">is_operating_gtid_table_implicitly</a>;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="comment">    Indicate that a sub-statement is being operated implicitly</span></div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">    within current transaction.</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment">    As we don&#39;t want that this implicit sub-statement to consume the</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="comment">    GTID of the actual transaction, we set it true at the beginning of</span></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment">    the sub-statement and set it false again after &quot;committing&quot; the</span></div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">    sub-statement.</span></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment">    When it is true, the applier will not save the transaction owned</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment">    gtid into mysql.gtid_executed table before transaction prepare, as</span></div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">    it does when binlog is disabled, or binlog is enabled and</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">    log_slave_updates is disabled.</span></div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">    Also the flag is made to defer updates to the slave info table from</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment">    intermediate commits by non-atomic DDL.</span></div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">    Rpl_info_table::do_flush_info(), rpl_rli.h::is_atomic_ddl_commit_on_slave()</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">    uses this flag.</span></div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02036"></a><span class="lineno"><a class="line" href="classTHD.html#af3feadcfbb9a7835b7941945c6cd0828"> 2036</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#af3feadcfbb9a7835b7941945c6cd0828">is_operating_substatement_implicitly</a>;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">    Stores the result of ROW_COUNT() function.</span></div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">    ROW_COUNT() function is a MySQL extention, but we try to keep it</span></div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">    similar to ROW_COUNT member of the GET DIAGNOSTICS stack of the SQL</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment">    standard (see SQL99, part 2, search for ROW_COUNT). It&#39;s value is</span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">    implementation defined for anything except INSERT, DELETE, UPDATE.</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">    ROW_COUNT is assigned according to the following rules:</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment">      - In my_ok():</span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">        - for DML statements: to the number of affected rows;</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment">        - for DDL statements: to 0.</span></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">      - In my_eof(): to -1 to indicate that there was a result set.</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">        We derive this semantics from the JDBC specification, where int</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">        java.sql.Statement.getUpdateCount() is defined to (sic) &quot;return the</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">        current result as an update count; if the result is a ResultSet</span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment">        object or there are no more results, -1 is returned&quot;.</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">      - In my_error(): to -1 to be compatible with the MySQL C API and</span></div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">        MySQL ODBC driver.</span></div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">      - For SIGNAL statements: to 0 per WL#2110 specification (see also</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">        sql_signal.cc comment). Zero is used since that&#39;s the &quot;default&quot;</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">        value of ROW_COUNT in the Diagnostics Area.</span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div><div class="line"><a name="l02068"></a><span class="lineno"><a class="line" href="classTHD.html#a1696473d387286f44b9fbcde5b2b8ed9"> 2068</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a9c0acdcb1b083d30069a62cee1ece644">longlong</a> <a class="code" href="classTHD.html#a1696473d387286f44b9fbcde5b2b8ed9">m_row_count_func</a>; <span class="comment">/* For the ROW_COUNT() function */</span></div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l02071"></a><span class="lineno"><a class="line" href="classTHD.html#a73557dd67cd09b87e5ccce960a9e526d"> 2071</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="my__inttypes_8h.html#a9c0acdcb1b083d30069a62cee1ece644">longlong</a> <a class="code" href="classTHD.html#a73557dd67cd09b87e5ccce960a9e526d">get_row_count_func</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_row_count_func; }</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div><div class="line"><a name="l02073"></a><span class="lineno"><a class="line" href="classTHD.html#a10f09c5b2fac2e86a201789257d28cd7"> 2073</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a10f09c5b2fac2e86a201789257d28cd7">set_row_count_func</a>(<a class="code" href="my__inttypes_8h.html#a9c0acdcb1b083d30069a62cee1ece644">longlong</a> row_count_func) {</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    m_row_count_func = row_count_func;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  }</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;</div><div class="line"><a name="l02077"></a><span class="lineno"><a class="line" href="classTHD.html#a92a32a2541d0592a3afe5321ff586235"> 2077</a></span>&#160;  <a class="code" href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a> <a class="code" href="classTHD.html#a92a32a2541d0592a3afe5321ff586235">num_truncated_fields</a>;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">    Number of rows we actually sent to the client, including &quot;synthetic&quot;</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">    rows in ROLLUP etc.</span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02084"></a><span class="lineno"><a class="line" href="classTHD.html#a42c2486e95914d7934387bc0317076ea"> 2084</a></span>&#160;  <a class="code" href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a> <a class="code" href="classTHD.html#a42c2486e95914d7934387bc0317076ea">m_sent_row_count</a>;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="comment">    Number of rows read and/or evaluated for a statement. Used for</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="comment">    slow log reporting.</span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="comment">    An examined row is defined as a row that is read and/or evaluated</span></div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;<span class="comment">    according to a statement condition, including in</span></div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="comment">    create_sort_index(). Rows may be counted more than once, e.g., a</span></div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="comment">    statement including ORDER BY could possibly evaluate the row in</span></div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="comment">    filesort() before reading it for e.g. update.</span></div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02096"></a><span class="lineno"><a class="line" href="classTHD.html#a97e400a6c324a58b6cfd0baac7780751"> 2096</a></span>&#160;  <a class="code" href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a> <a class="code" href="classTHD.html#a97e400a6c324a58b6cfd0baac7780751">m_examined_row_count</a>;</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l02099"></a><span class="lineno"><a class="line" href="classTHD.html#a3caf0d8f3abc4f1fcf34d330263d9b75"> 2099</a></span>&#160;  <a class="code" href="structuser__conn.html">USER_CONN</a> *<a class="code" href="classTHD.html#a3caf0d8f3abc4f1fcf34d330263d9b75">m_user_connect</a>;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="keywordtype">void</span> set_user_connect(<a class="code" href="structuser__conn.html">USER_CONN</a> *uc);</div><div class="line"><a name="l02103"></a><span class="lineno"><a class="line" href="classTHD.html#a6733b5ac8a0aceab948c6b4f4322c9af"> 2103</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structuser__conn.html">USER_CONN</a> *<a class="code" href="classTHD.html#a6733b5ac8a0aceab948c6b4f4322c9af">get_user_connect</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_user_connect; }</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="keywordtype">void</span> increment_user_connections_counter();</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <span class="keywordtype">void</span> decrement_user_connections_counter();</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <span class="keywordtype">void</span> increment_con_per_hour_counter();</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="keywordtype">void</span> increment_updates_counter();</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <span class="keywordtype">void</span> increment_questions_counter();</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="keywordtype">void</span> time_out_user_resource_limits();</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l02117"></a><span class="lineno"><a class="line" href="classTHD.html#aa5c0af5c320332468ef8b620ba83c2c7"> 2117</a></span>&#160;  <a class="code" href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a> <a class="code" href="classTHD.html#aa5c0af5c320332468ef8b620ba83c2c7">get_sent_row_count</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_sent_row_count; }</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;</div><div class="line"><a name="l02119"></a><span class="lineno"><a class="line" href="classTHD.html#a391cecc5b7f91691c6a69a1155a1d541"> 2119</a></span>&#160;  <a class="code" href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a> <a class="code" href="classTHD.html#a391cecc5b7f91691c6a69a1155a1d541">get_examined_row_count</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_examined_row_count; }</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <span class="keywordtype">void</span> set_sent_row_count(<a class="code" href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a> <a class="code" href="memcached_8c.html#a9e8f65e2f04446eb0a2f098411dacf9b">count</a>);</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <span class="keywordtype">void</span> inc_sent_row_count(<a class="code" href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a> count);</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="keywordtype">void</span> inc_examined_row_count(<a class="code" href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a> count);</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <span class="keywordtype">void</span> inc_status_created_tmp_disk_tables();</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <span class="keywordtype">void</span> inc_status_created_tmp_tables();</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <span class="keywordtype">void</span> inc_status_select_full_join();</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="keywordtype">void</span> inc_status_select_full_range_join();</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  <span class="keywordtype">void</span> inc_status_select_range();</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="keywordtype">void</span> inc_status_select_range_check();</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  <span class="keywordtype">void</span> inc_status_select_scan();</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="keywordtype">void</span> inc_status_sort_merge_passes();</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <span class="keywordtype">void</span> inc_status_sort_range();</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="keywordtype">void</span> inc_status_sort_rows(<a class="code" href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a> count);</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="keywordtype">void</span> inc_status_sort_scan();</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <span class="keywordtype">void</span> set_status_no_index_used();</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  <span class="keywordtype">void</span> set_status_no_good_index_used();</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;</div><div class="line"><a name="l02140"></a><span class="lineno"><a class="line" href="classTHD.html#a7d0d5b2c8084adc97c39a9106bdd036c"> 2140</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structCHARSET__INFO.html">CHARSET_INFO</a> *<a class="code" href="classTHD.html#a7d0d5b2c8084adc97c39a9106bdd036c">db_charset</a>;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="preprocessor">#if defined(ENABLED_PROFILING)</span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  std::unique_ptr&lt;PROFILING&gt; profiling;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">  /** Current stage progress instrumentation. */</span></div><div class="line"><a name="l02146"></a><span class="lineno"><a class="line" href="classTHD.html#a09b38235fdaa6cba46555ba5b8af0fac"> 2146</a></span>&#160;  <a class="code" href="structPSI__stage__progress__v1.html">PSI_stage_progress</a> *<a class="code" href="classTHD.html#a09b38235fdaa6cba46555ba5b8af0fac">m_stage_progress_psi</a>;<span class="comment"></span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment">  /** Current statement digest. */</span></div><div class="line"><a name="l02148"></a><span class="lineno"><a class="line" href="classTHD.html#a0afd485c2df4248421caa96fc2d69b22"> 2148</a></span>&#160;  <a class="code" href="structsql__digest__state.html">sql_digest_state</a> *<a class="code" href="classTHD.html#a0afd485c2df4248421caa96fc2d69b22">m_digest</a>;<span class="comment"></span></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment">  /** Current statement digest token array. */</span></div><div class="line"><a name="l02150"></a><span class="lineno"><a class="line" href="classTHD.html#a3139a05451a8fb331fc5fda3b9000deb"> 2150</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="classTHD.html#a3139a05451a8fb331fc5fda3b9000deb">m_token_array</a>;<span class="comment"></span></div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="comment">  /** Top level statement digest. */</span></div><div class="line"><a name="l02152"></a><span class="lineno"><a class="line" href="classTHD.html#aff118031188614eca7a3954a0b8505b4"> 2152</a></span>&#160;  <a class="code" href="structsql__digest__state.html">sql_digest_state</a> <a class="code" href="classTHD.html#aff118031188614eca7a3954a0b8505b4">m_digest_state</a>;</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="comment">  /** Current statement instrumentation. */</span></div><div class="line"><a name="l02155"></a><span class="lineno"><a class="line" href="classTHD.html#a080358e9f81acc7851daf28249e66fab"> 2155</a></span>&#160;  <a class="code" href="group__psi__abi__statement.html#gadc11814f47e2d3907a2459116a8ba7ab">PSI_statement_locker</a> *<a class="code" href="classTHD.html#a080358e9f81acc7851daf28249e66fab">m_statement_psi</a>;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="preprocessor">#ifdef HAVE_PSI_STATEMENT_INTERFACE</span></div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="comment">  /** Current statement instrumentation state. */</span></div><div class="line"><a name="l02158"></a><span class="lineno"><a class="line" href="classTHD.html#a2a3514bd66bfed7e8be6d8d138ca364f"> 2158</a></span>&#160;  <a class="code" href="structPSI__statement__locker__state__v1.html">PSI_statement_locker_state</a> <a class="code" href="classTHD.html#a2a3514bd66bfed7e8be6d8d138ca364f">m_statement_state</a>;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_PSI_STATEMENT_INTERFACE */</span><span class="preprocessor"></span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="comment">  /** Current transaction instrumentation. */</span></div><div class="line"><a name="l02162"></a><span class="lineno"><a class="line" href="classTHD.html#a6963970384186fdc5af8ec638ccb259a"> 2162</a></span>&#160;  <a class="code" href="group__psi__abi__transaction.html#ga88504a3aa3d24a2e5011a80ded544639">PSI_transaction_locker</a> *<a class="code" href="classTHD.html#a6963970384186fdc5af8ec638ccb259a">m_transaction_psi</a>;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="preprocessor">#ifdef HAVE_PSI_TRANSACTION_INTERFACE</span></div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment">  /** Current transaction instrumentation state. */</span></div><div class="line"><a name="l02165"></a><span class="lineno"><a class="line" href="classTHD.html#a09acfa83c5541b5351122e0e79c468d2"> 2165</a></span>&#160;  <a class="code" href="structPSI__transaction__locker__state__v1.html">PSI_transaction_locker_state</a> <a class="code" href="classTHD.html#a09acfa83c5541b5351122e0e79c468d2">m_transaction_state</a>;</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_PSI_TRANSACTION_INTERFACE */</span><span class="preprocessor"></span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="comment">  /** Idle instrumentation. */</span></div><div class="line"><a name="l02169"></a><span class="lineno"><a class="line" href="classTHD.html#ab2e036d6f69a8c3354caf79985deee73"> 2169</a></span>&#160;  <a class="code" href="group__psi__abi__idle.html#ga625c939a19042bc1890a893123430e61">PSI_idle_locker</a> *<a class="code" href="classTHD.html#ab2e036d6f69a8c3354caf79985deee73">m_idle_psi</a>;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="preprocessor">#ifdef HAVE_PSI_IDLE_INTERFACE</span></div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment">  /** Idle instrumentation state. */</span></div><div class="line"><a name="l02172"></a><span class="lineno"><a class="line" href="classTHD.html#aefa31e20d51632b18162108e6a7c9ddf"> 2172</a></span>&#160;  <a class="code" href="structPSI__idle__locker__state__v1.html">PSI_idle_locker_state</a> <a class="code" href="classTHD.html#aefa31e20d51632b18162108e6a7c9ddf">m_idle_state</a>;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_PSI_IDLE_INTERFACE */</span><span class="preprocessor"></span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment">  /** True if the server code is IDLE for this connection. */</span></div><div class="line"><a name="l02175"></a><span class="lineno"><a class="line" href="classTHD.html#adb00a587a780046fe38f27be18f79d76"> 2175</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#adb00a587a780046fe38f27be18f79d76">m_server_idle</a>;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">    Id of current query. Statement can be reused to execute several queries</span></div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment">    query_id is global in context of the whole MySQL server.</span></div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">    ID is automatically generated from mutex-protected counter.</span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">    It&#39;s used in handler code for various purposes: to check which columns</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment">    from table are necessary for this select, to check if it&#39;s necessary to</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">    update auto-updatable fields (like auto_increment and timestamp).</span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02185"></a><span class="lineno"><a class="line" href="classTHD.html#a5cd1849ef51bdf3c5a853d47f9a0c741"> 2185</a></span>&#160;  <a class="code" href="binlog_8h.html#a12a2cc906d37cadce17ce6455271a09a">query_id_t</a> <a class="code" href="classTHD.html#a5cd1849ef51bdf3c5a853d47f9a0c741">query_id</a>;</div><div class="line"><a name="l02186"></a><span class="lineno"><a class="line" href="classTHD.html#a33269b783c4ed83ae7df446486b8bc30"> 2186</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> <a class="code" href="classTHD.html#a33269b783c4ed83ae7df446486b8bc30">col_access</a>;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  <span class="comment">/* Statement id is thread-wide. This counter is used to generate ids */</span></div><div class="line"><a name="l02189"></a><span class="lineno"><a class="line" href="classTHD.html#a2272ebb8c9b59a2d51e137b5dbcfe107"> 2189</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> <a class="code" href="classTHD.html#a2272ebb8c9b59a2d51e137b5dbcfe107">statement_id_counter</a>;</div><div class="line"><a name="l02190"></a><span class="lineno"><a class="line" href="classTHD.html#a76589a8167a8f4c9c816194f25bb0ee5"> 2190</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> rand_saved_seed1, <a class="code" href="classTHD.html#a76589a8167a8f4c9c816194f25bb0ee5">rand_saved_seed2</a>;</div><div class="line"><a name="l02191"></a><span class="lineno"><a class="line" href="classTHD.html#a376ffc6c7396ce30002addf504ddd331"> 2191</a></span>&#160;  <a class="code" href="my__thread__bits_8h.html#a86fa057db30de4141b1c0723e005cb88">my_thread_t</a> <a class="code" href="classTHD.html#a376ffc6c7396ce30002addf504ddd331">real_id</a>; <span class="comment">/* For debugging */</span><span class="comment"></span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">                       /**</span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">                         This counter is 32 bit because of the client protocol.</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">                     </span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">                         @note It is not meant to be used for my_thread_self(), see @c real_id for</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">                         this.</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">                     </span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">                         @note Set to reserved_thread_id on initialization. This is a magic</span></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">                         value that is only to be used for temporary THDs not present in</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">                         the global THD list.</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">                       */</span></div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l02203"></a><span class="lineno"><a class="line" href="classTHD.html#a6277c56db1fa8a31ca2413e9e1b896de"> 2203</a></span>&#160;  <a class="code" href="my__thread__local_8h.html#a507db6035f89ca9c3d96c1ed3b987fcc">my_thread_id</a> <a class="code" href="classTHD.html#a6277c56db1fa8a31ca2413e9e1b896de">m_thread_id</a>;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">    Assign a value to m_thread_id by calling</span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">    Global_THD_manager::get_new_thread_id().</span></div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;  <span class="keywordtype">void</span> set_new_thread_id();</div><div class="line"><a name="l02211"></a><span class="lineno"><a class="line" href="classTHD.html#a3591aefeafcb7af9d70f295029a26b2e"> 2211</a></span>&#160;  <a class="code" href="my__thread__local_8h.html#a507db6035f89ca9c3d96c1ed3b987fcc">my_thread_id</a> <a class="code" href="classTHD.html#a3591aefeafcb7af9d70f295029a26b2e">thread_id</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_thread_id; }</div><div class="line"><a name="l02212"></a><span class="lineno"><a class="line" href="classTHD.html#af4cbdda1c4ce71d589429534b8297fe3"> 2212</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#af4cbdda1c4ce71d589429534b8297fe3">tmp_table</a>;</div><div class="line"><a name="l02213"></a><span class="lineno"><a class="line" href="classTHD.html#a8510c1d76b680fa087c73c09402389f2"> 2213</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#a8510c1d76b680fa087c73c09402389f2">server_status</a>, open_options;</div><div class="line"><a name="l02214"></a><span class="lineno"><a class="line" href="classTHD.html#a909c901657292c8a63001a183452d8ca"> 2214</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240b">enum_thread_type</a> system_thread;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <span class="comment">// Check if this THD belongs to a system thread.</span></div><div class="line"><a name="l02217"></a><span class="lineno"><a class="line" href="classTHD.html#a545a10790e3f8bca0f18c6a5e46dead4"> 2217</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a545a10790e3f8bca0f18c6a5e46dead4">is_system_thread</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> system_thread != <a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba2c90ddde90548084c5f8293a874e7290">NON_SYSTEM_THREAD</a>; }</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  <span class="comment">// Check if this THD belongs to a dd bootstrap system thread.</span></div><div class="line"><a name="l02220"></a><span class="lineno"><a class="line" href="classTHD.html#a4e6591d86a3b396427a04e17f583a0bd"> 2220</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a4e6591d86a3b396427a04e17f583a0bd">is_dd_system_thread</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="keywordflow">return</span> system_thread == <a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baca5f11f9495bcd708e19d0d41e863d56">SYSTEM_THREAD_DD_INITIALIZE</a> ||</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;           system_thread == <a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba8973dd3c3c6eefc671cd7d1f1d4bfaa3">SYSTEM_THREAD_DD_RESTART</a>;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  }</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  <span class="comment">// Check if this THD belongs to the initialize system thread. The</span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  <span class="comment">// initialize thread executes statements that are compiled into the</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;  <span class="comment">// server.</span></div><div class="line"><a name="l02228"></a><span class="lineno"><a class="line" href="classTHD.html#acad2df81d059520f15ef12114b9b3a09"> 2228</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#acad2df81d059520f15ef12114b9b3a09">is_initialize_system_thread</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    <span class="keywordflow">return</span> system_thread == <a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baa79beba3ce7bf907b74714487ef9d18f">SYSTEM_THREAD_SERVER_INITIALIZE</a>;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  }</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;  <span class="comment">// Check if this THD is executing statements passed through a init file.</span></div><div class="line"><a name="l02233"></a><span class="lineno"><a class="line" href="classTHD.html#a96fe0e9626d34012250088f2cb021f00"> 2233</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a96fe0e9626d34012250088f2cb021f00">is_init_file_system_thread</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keywordflow">return</span> system_thread == <a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba4a3f2f45c5962e9908dac1097fc396e1">SYSTEM_THREAD_INIT_FILE</a>;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;  }</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <span class="comment">// Check if this THD belongs to a bootstrap system thread. Note that</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="comment">// this thread type may execute statements submitted by the user.</span></div><div class="line"><a name="l02239"></a><span class="lineno"><a class="line" href="classTHD.html#ae6769e533bc4c0e9e994ebeba81ed4fc"> 2239</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#ae6769e533bc4c0e9e994ebeba81ed4fc">is_bootstrap_system_thread</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="keywordflow">return</span> is_dd_system_thread() || is_initialize_system_thread() ||</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;           is_init_file_system_thread();</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  }</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  <span class="comment">// Check if this THD belongs to a server upgrade thread. Server upgrade</span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  <span class="comment">// threads execute statements that are compiled into the server.</span></div><div class="line"><a name="l02246"></a><span class="lineno"><a class="line" href="classTHD.html#a47f166c02353a5893c2c1607e02af6b4"> 2246</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a47f166c02353a5893c2c1607e02af6b4">is_server_upgrade_thread</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordflow">return</span> system_thread == <a class="code" href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba8adaca290bf553cb8483a337167704b4">SYSTEM_THREAD_SERVER_UPGRADE</a>;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  }</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="comment">    Current or next transaction isolation level.</span></div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="comment">    When a connection is established, the value is taken from</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment">    @@session.tx_isolation (default transaction isolation for</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="comment">    the session), which is in turn taken from @@global.tx_isolation</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment">    (the global value).</span></div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="comment">    If there is no transaction started, this variable</span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment">    holds the value of the next transaction&#39;s isolation level.</span></div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment">    When a transaction starts, the value stored in this variable</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="comment">    becomes &quot;actual&quot;.</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment">    At transaction commit or rollback, we assign this variable</span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment">    again from @@session.tx_isolation.</span></div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment">    The only statement that can otherwise change the value</span></div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment">    of this variable is SET TRANSACTION ISOLATION LEVEL.</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment">    Its purpose is to effect the isolation level of the next</span></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment">    transaction in this session. When this statement is executed,</span></div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="comment">    the value in this variable is changed. However, since</span></div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">    this statement is only allowed when there is no active</span></div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">    transaction, this assignment (naturally) only affects the</span></div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="comment">    upcoming transaction.</span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">    At the end of the current active transaction the value is</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">    be reset again from @@session.tx_isolation, as described</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment">    above.</span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02274"></a><span class="lineno"><a class="line" href="classTHD.html#a307269c284bbbbbb0d319ed39c91782f"> 2274</a></span>&#160;  <a class="code" href="sql_2handler_8h.html#a9eca5571cb03b2bea1246c948d9244fb">enum_tx_isolation</a> <a class="code" href="classTHD.html#a307269c284bbbbbb0d319ed39c91782f">tx_isolation</a>;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="comment">    Current or next transaction access mode.</span></div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="comment">    See comment above regarding tx_isolation.</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02279"></a><span class="lineno"><a class="line" href="classTHD.html#a7bc1ddd59b3944ce978b8664b631a1fa"> 2279</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a7bc1ddd59b3944ce978b8664b631a1fa">tx_read_only</a>;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="comment">    Transaction cannot be rolled back must be given priority.</span></div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="comment">    When two transactions conflict inside InnoDB, the one with</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment">    greater priority wins.</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02285"></a><span class="lineno"><a class="line" href="classTHD.html#abc08035d1164b66c0d5c5ac232523dba"> 2285</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classTHD.html#abc08035d1164b66c0d5c5ac232523dba">tx_priority</a>;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="comment">    All transactions executed by this thread will have high</span></div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="comment">    priority mode, independent of tx_priority value.</span></div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02290"></a><span class="lineno"><a class="line" href="classTHD.html#a4f79a3c90670c42ec40412c2955b3f4d"> 2290</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classTHD.html#a4f79a3c90670c42ec40412c2955b3f4d">thd_tx_priority</a>;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;</div><div class="line"><a name="l02292"></a><span class="lineno"><a class="line" href="classTHD.html#ab24e1cfc4d4c1b560238f62d1b582236"> 2292</a></span>&#160;  <a class="code" href="sql_2field_8h.html#a46645b5c37cb3b92ce921432738cfa1d">enum_check_fields</a> <a class="code" href="classTHD.html#ab24e1cfc4d4c1b560238f62d1b582236">check_for_truncated_fields</a>;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  <span class="comment">// For user variables replication</span></div><div class="line"><a name="l02295"></a><span class="lineno"><a class="line" href="classTHD.html#a9a8643ad137c40e64e67ba38b7be6ba7"> 2295</a></span>&#160;  <a class="code" href="classPrealloced__array.html">Prealloced_array&lt;Binlog_user_var_event *, 2&gt;</a> <a class="code" href="classTHD.html#a9a8643ad137c40e64e67ba38b7be6ba7">user_var_events</a>;</div><div class="line"><a name="l02296"></a><span class="lineno"><a class="line" href="classTHD.html#ac3b669eb637e00446c2248701ce6e927"> 2296</a></span>&#160;  <a class="code" href="structMEM__ROOT.html">MEM_ROOT</a> *<a class="code" href="classTHD.html#ac3b669eb637e00446c2248701ce6e927">user_var_events_alloc</a>; <span class="comment">/* Allocate above array elements here */</span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="comment">    Used by MYSQL_BIN_LOG to maintain the commit queue for binary log</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment">    group commit.</span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02302"></a><span class="lineno"><a class="line" href="classTHD.html#a98af9dcb3ae920e8365d49953baed28e"> 2302</a></span>&#160;  <a class="code" href="classTHD.html">THD</a> *<a class="code" href="classTHD.html#a98af9dcb3ae920e8365d49953baed28e">next_to_commit</a>;</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment">    The member is served for marking a query that CREATEs or ALTERs</span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="comment">    a table declared with a TIMESTAMP column as dependent on</span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="comment">    @@session.explicit_defaults_for_timestamp.</span></div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment">    Is set to true by parser, unset at the end of the query.</span></div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="comment">    Possible marking in checked by binary logger.</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02311"></a><span class="lineno"><a class="line" href="classTHD.html#aab9c733d38c73363911a3d444c7023a3"> 2311</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#aab9c733d38c73363911a3d444c7023a3">binlog_need_explicit_defaults_ts</a>;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="comment">     Functions to set and get transaction position.</span></div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="comment">     These functions are used to set the transaction position for the</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment">     transaction written when committing this transaction.</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment">   */</span><span class="comment"></span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment">  /**@{*/</span></div><div class="line"><a name="l02320"></a><span class="lineno"><a class="line" href="classTHD.html#a36cdfb0312655df3749f0726274f4893"> 2320</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a36cdfb0312655df3749f0726274f4893">set_trans_pos</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacefile.html">file</a>, <a class="code" href="my__inttypes_8h.html#a378b5b2448c7170f4b6bd225583e8a19">my_off_t</a> <a class="code" href="do__ctype_8cc.html#ab5ad9aa3d3e725ca44ebfa85e0b1020d">pos</a>) {</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <a class="code" href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a>;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(((file == <span class="keyword">nullptr</span>) &amp;&amp; (pos == 0)) ||</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                ((file != <span class="keyword">nullptr</span>) &amp;&amp; (pos != 0)));</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keywordflow">if</span> (file) {</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      <a class="code" href="my__dbug_8h.html#a3770d2ff545ed3e4b714d20014e663df">DBUG_PRINT</a>(<span class="stringliteral">&quot;enter&quot;</span>, (<span class="stringliteral">&quot;file: %s, pos: %llu&quot;</span>, file, pos));</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      <span class="comment">// Only the file name should be used, not the full path</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      m_trans_log_file = file + <a class="code" href="group__MYSYS.html#gabcbcbc02c3972135cae6f04693507d85">dirname_length</a>(file);</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="keywordflow">if</span> (!m_trans_fixed_log_file)</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        m_trans_fixed_log_file = (<span class="keywordtype">char</span> *)main_mem_root.Alloc(<a class="code" href="my__io_8h.html#a0fd6678904889e4aeff1402c35e890da">FN_REFLEN</a> + 1);</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(strlen(m_trans_log_file) &lt;= <a class="code" href="my__io_8h.html#a0fd6678904889e4aeff1402c35e890da">FN_REFLEN</a>);</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      strcpy(m_trans_fixed_log_file, m_trans_log_file);</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      m_trans_log_file = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      m_trans_fixed_log_file = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    m_trans_end_pos = <a class="code" href="do__ctype_8cc.html#ab5ad9aa3d3e725ca44ebfa85e0b1020d">pos</a>;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <a class="code" href="my__dbug_8h.html#a3770d2ff545ed3e4b714d20014e663df">DBUG_PRINT</a>(<span class="stringliteral">&quot;return&quot;</span>,</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;               (<span class="stringliteral">&quot;m_trans_log_file: %s, m_trans_fixed_log_file: %s, &quot;</span></div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                <span class="stringliteral">&quot;m_trans_end_pos: %llu&quot;</span>,</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                m_trans_log_file, m_trans_fixed_log_file, m_trans_end_pos));</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;  }</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;</div><div class="line"><a name="l02345"></a><span class="lineno"><a class="line" href="classTHD.html#a14a9d44f36d35decd324684c4ff78fc5"> 2345</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a14a9d44f36d35decd324684c4ff78fc5">get_trans_pos</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> **file_var, <a class="code" href="my__inttypes_8h.html#a378b5b2448c7170f4b6bd225583e8a19">my_off_t</a> *pos_var)<span class="keyword"> const </span>{</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    <a class="code" href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a>;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <span class="keywordflow">if</span> (file_var) *file_var = m_trans_log_file;</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <span class="keywordflow">if</span> (pos_var) *pos_var = m_trans_end_pos;</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    <a class="code" href="my__dbug_8h.html#a3770d2ff545ed3e4b714d20014e663df">DBUG_PRINT</a>(<span class="stringliteral">&quot;return&quot;</span>,</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;               (<span class="stringliteral">&quot;file: %s, pos: %llu&quot;</span>, file_var ? *file_var : <span class="stringliteral">&quot;&lt;none&gt;&quot;</span>,</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                pos_var ? *pos_var : 0));</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  }</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;</div><div class="line"><a name="l02355"></a><span class="lineno"><a class="line" href="classTHD.html#a397100c599ecc8901529e2d7355bd993"> 2355</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a397100c599ecc8901529e2d7355bd993">get_trans_fixed_pos</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> **file_var, <a class="code" href="my__inttypes_8h.html#a378b5b2448c7170f4b6bd225583e8a19">my_off_t</a> *pos_var)<span class="keyword"> const </span>{</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    <a class="code" href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a>;</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <span class="keywordflow">if</span> (file_var) *file_var = m_trans_fixed_log_file;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    <span class="keywordflow">if</span> (pos_var) *pos_var = m_trans_end_pos;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    <a class="code" href="my__dbug_8h.html#a3770d2ff545ed3e4b714d20014e663df">DBUG_PRINT</a>(<span class="stringliteral">&quot;return&quot;</span>,</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;               (<span class="stringliteral">&quot;file: %s, pos: %llu&quot;</span>, file_var ? *file_var : <span class="stringliteral">&quot;&lt;none&gt;&quot;</span>,</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                pos_var ? *pos_var : 0));</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  }</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="comment">  /**@}*/</span></div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment">    Error code from committing or rolling back the transaction.</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02370"></a><span class="lineno"><a class="line" href="classTHD.html#af51413ab3ce883addff226fa9603ab12"> 2370</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classTHD.html#af51413ab3ce883addff226fa9603ab12">Commit_error</a> {</div><div class="line"><a name="l02371"></a><span class="lineno"><a class="line" href="classTHD.html#af51413ab3ce883addff226fa9603ab12a3b99e39e7077b28cc82534adf5b8956a"> 2371</a></span>&#160;    CE_NONE = 0,</div><div class="line"><a name="l02372"></a><span class="lineno"><a class="line" href="classTHD.html#af51413ab3ce883addff226fa9603ab12ae14add6a3fc0dacf3245451c39a03cf7"> 2372</a></span>&#160;    <a class="code" href="classTHD.html#af51413ab3ce883addff226fa9603ab12ae14add6a3fc0dacf3245451c39a03cf7">CE_FLUSH_ERROR</a>,</div><div class="line"><a name="l02373"></a><span class="lineno"><a class="line" href="classTHD.html#af51413ab3ce883addff226fa9603ab12a7e76c1f9b8f6b4a65ddf8039d02eef49"> 2373</a></span>&#160;    <a class="code" href="classTHD.html#af51413ab3ce883addff226fa9603ab12a7e76c1f9b8f6b4a65ddf8039d02eef49">CE_SYNC_ERROR</a>,</div><div class="line"><a name="l02374"></a><span class="lineno"><a class="line" href="classTHD.html#af51413ab3ce883addff226fa9603ab12a4ac4de4fe90c120618f88b3b0f32af7c"> 2374</a></span>&#160;    <a class="code" href="classTHD.html#af51413ab3ce883addff226fa9603ab12a4ac4de4fe90c120618f88b3b0f32af7c">CE_COMMIT_ERROR</a>,</div><div class="line"><a name="l02375"></a><span class="lineno"><a class="line" href="classTHD.html#af51413ab3ce883addff226fa9603ab12a61cbc66e3a70d3ea071a8ee147831ae5"> 2375</a></span>&#160;    CE_ERROR_COUNT</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  } commit_error;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="comment">    Define durability properties that engines may check to</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="comment">    improve performance.</span></div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02382"></a><span class="lineno"><a class="line" href="classTHD.html#a779e49dc3d554a9e40d71c4607a61627"> 2382</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="dur__prop_8h.html#acb10b3b16320b8c588102ef06a5dd87f">durability_properties</a> durability_property;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment">    If checking this in conjunction with a wait condition, please</span></div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="comment">    include a check after enter_cond() if you want to avoid a race</span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">    condition. For details see the implementation of awake(),</span></div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">    especially the &quot;broadcast&quot; part.</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02390"></a><span class="lineno"><a class="line" href="classTHD.html#ae917ceb9a297bbe6abdde1897af5c9d2"> 2390</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classTHD.html#ae917ceb9a297bbe6abdde1897af5c9d2">killed_state</a> {</div><div class="line"><a name="l02391"></a><span class="lineno"><a class="line" href="classTHD.html#ae917ceb9a297bbe6abdde1897af5c9d2af45a59c927d363f7d1615d451704077b"> 2391</a></span>&#160;    NOT_KILLED = 0,</div><div class="line"><a name="l02392"></a><span class="lineno"><a class="line" href="classTHD.html#ae917ceb9a297bbe6abdde1897af5c9d2a5971d807f08ebf4524fb957afa09f3cf"> 2392</a></span>&#160;    <a class="code" href="group__group__cs__shutdown__kill__constants.html#gga06133bb686f1030c73086378cab8d27bae76eb4d20fb50e864e6b84a956c2f843">KILL_CONNECTION</a> = ER_SERVER_SHUTDOWN,</div><div class="line"><a name="l02393"></a><span class="lineno"><a class="line" href="classTHD.html#ae917ceb9a297bbe6abdde1897af5c9d2a0d73ae0931bfb7e3a7bb633400525862"> 2393</a></span>&#160;    <a class="code" href="group__group__cs__shutdown__kill__constants.html#gga06133bb686f1030c73086378cab8d27bacc26796d601d054d19882287328ca780">KILL_QUERY</a> = ER_QUERY_INTERRUPTED,</div><div class="line"><a name="l02394"></a><span class="lineno"><a class="line" href="classTHD.html#ae917ceb9a297bbe6abdde1897af5c9d2aadaeac9662b457741c87fdfcaba7f450"> 2394</a></span>&#160;    KILL_TIMEOUT = ER_QUERY_TIMEOUT,</div><div class="line"><a name="l02395"></a><span class="lineno"><a class="line" href="classTHD.html#ae917ceb9a297bbe6abdde1897af5c9d2a661f0161440898a423743183f65b8102"> 2395</a></span>&#160;    KILLED_NO_VALUE <span class="comment">/* means neither of the states */</span></div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  };</div><div class="line"><a name="l02397"></a><span class="lineno"><a class="line" href="classTHD.html#ad428f042d033a86b6618d8c2ca9aaf9e"> 2397</a></span>&#160;  std::atomic&lt;killed_state&gt; <a class="code" href="classTHD.html#ad428f042d033a86b6618d8c2ca9aaf9e">killed</a>;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="comment">    Whether we are currently in the execution phase of an EXPLAIN ANALYZE query.</span></div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment">    If so, send_kill_message() won&#39;t actually set an error; we will add a</span></div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="comment">    warning near the end of the execution instead.</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02404"></a><span class="lineno"><a class="line" href="classTHD.html#a2ef80d8bac1540a6cc5e5d043d9da82d"> 2404</a></span>&#160;  <span class="keywordtype">bool</span> running_explain_analyze = <span class="keyword">false</span>;</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="comment">    When operation on DD tables is in progress then THD is set to kill immune</span></div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment">    mode.</span></div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">    This member holds DD_kill_immunizer object created to make DD operations</span></div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">    immune from the kill operations. Member also indicated whether THD is in</span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">    kill immune mode or not.</span></div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02413"></a><span class="lineno"><a class="line" href="classTHD.html#a28d503de7aaffbb8677d4e3eb6bf81b8"> 2413</a></span>&#160;  <a class="code" href="classdd_1_1DD__kill__immunizer.html">dd::DD_kill_immunizer</a> *<a class="code" href="classTHD.html#a28d503de7aaffbb8677d4e3eb6bf81b8">kill_immunizer</a>;</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;  <span class="comment">/* scramble - random string sent to client on handshake */</span></div><div class="line"><a name="l02416"></a><span class="lineno"><a class="line" href="classTHD.html#a3ebc9909a251654194c104be4f7d230d"> 2416</a></span>&#160;  <span class="keywordtype">char</span> <a class="code" href="mysql__com_8h.html#a2bc4c09a6ed0698c89d441028d76a648">scramble</a>[<a class="code" href="mysql__com_8h.html#a45f11cf97b6dec62756b92cbb96f7418">SCRAMBLE_LENGTH</a> + 1];</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">  /// @todo: slave_thread is completely redundant, we should use &#39;system_thread&#39;</span></div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="comment">  /// instead /sven</span></div><div class="line"><a name="l02420"></a><span class="lineno"><a class="line" href="classTHD.html#a23d4ed19f8e834ad0e09db758e74debc"> 2420</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a23d4ed19f8e834ad0e09db758e74debc">slave_thread</a>;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;</div><div class="line"><a name="l02422"></a><span class="lineno"><a class="line" href="classTHD.html#afa937eb13c356a986e428cf1b6663ba6"> 2422</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> <a class="code" href="classTHD.html#afa937eb13c356a986e428cf1b6663ba6">password</a>;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="comment">    Set to true if execution of the current compound statement</span></div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">    can not continue. In particular, disables activation of</span></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="comment">    CONTINUE or EXIT handlers of stored routines.</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="comment">    Reset in the end of processing of the current user request, in</span></div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">    @see mysql_reset_thd_for_next_command().</span></div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02432"></a><span class="lineno"><a class="line" href="classTHD.html#a23f1f9abc2c8558fb84e9f2f01572111"> 2432</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a23f1f9abc2c8558fb84e9f2f01572111">m_is_fatal_error</a>;</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">    Set by a storage engine to request the entire</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment">    transaction (that possibly spans multiple engines) to</span></div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="comment">    rollback. Reset in ha_rollback.</span></div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02440"></a><span class="lineno"><a class="line" href="classTHD.html#aaa7a6c6f69c0f88b6af26f5296865494"> 2440</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#aaa7a6c6f69c0f88b6af26f5296865494">transaction_rollback_request</a>;<span class="comment"></span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="comment">    true if we are in a sub-statement and the current error can</span></div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="comment">    not be safely recovered until we left the sub-statement mode.</span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment">    In particular, disables activation of CONTINUE and EXIT</span></div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="comment">    handlers inside sub-statements. E.g. if it is a deadlock</span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment">    error and requires a transaction-wide rollback, this flag is</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="comment">    raised (traditionally, MySQL first has to close all the reads</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="comment">    via @see handler::ha_index_or_rnd_end() and only then perform</span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">    the rollback).</span></div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="comment">    Reset to false when we leave the sub-statement mode.</span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02452"></a><span class="lineno"><a class="line" href="classTHD.html#a703cd04c9100ea7bc6df0445ee8bac5f"> 2452</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a703cd04c9100ea7bc6df0445ee8bac5f">is_fatal_sub_stmt_error</a>;</div><div class="line"><a name="l02453"></a><span class="lineno"><a class="line" href="classTHD.html#a98047940059e31cedbb2a68a2bca28df"> 2453</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a98047940059e31cedbb2a68a2bca28df">query_start_usec_used</a>;</div><div class="line"><a name="l02454"></a><span class="lineno"><a class="line" href="classTHD.html#ae3ad672c82efb1dfb7873d385bc658a8"> 2454</a></span>&#160;  <span class="keywordtype">bool</span> rand_used, <a class="code" href="classTHD.html#ae3ad672c82efb1dfb7873d385bc658a8">time_zone_used</a>;</div><div class="line"><a name="l02455"></a><span class="lineno"><a class="line" href="classTHD.html#afda156ec9ec7f901b4d3f2bcd20cf46f"> 2455</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#afda156ec9ec7f901b4d3f2bcd20cf46f">in_lock_tables</a>;<span class="comment"></span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment">    True if a slave error. Causes the slave to stop. Not the same</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment">    as the statement execution error (is_error()), since</span></div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment">    a statement may be expected to return an error, e.g. because</span></div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">    it returned an error on master, and this is OK on the slave.</span></div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02462"></a><span class="lineno"><a class="line" href="classTHD.html#a95686cf0c1182e013d9423db326b7892"> 2462</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a95686cf0c1182e013d9423db326b7892">is_slave_error</a>;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="comment">  /**  is set if some thread specific value(s) used in a statement. */</span></div><div class="line"><a name="l02465"></a><span class="lineno"><a class="line" href="classTHD.html#af97d8d03f26deab5d14993ce8ad498cf"> 2465</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#af97d8d03f26deab5d14993ce8ad498cf">thread_specific_used</a>;<span class="comment"></span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="comment">    is set if a statement accesses a temporary table created through</span></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="comment">    CREATE TEMPORARY TABLE.</span></div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02470"></a><span class="lineno"><a class="line" href="classTHD.html#ae06f4d9c6079af9667b0c5fffe999ae2"> 2470</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#ae06f4d9c6079af9667b0c5fffe999ae2">charset_is_system_charset</a>, charset_is_collation_connection;</div><div class="line"><a name="l02471"></a><span class="lineno"><a class="line" href="classTHD.html#aa6abe91dfbd5b85812c0b888255f9540"> 2471</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#aa6abe91dfbd5b85812c0b888255f9540">charset_is_character_set_filesystem</a>;</div><div class="line"><a name="l02472"></a><span class="lineno"><a class="line" href="classTHD.html#a6c976f8f022417df827670e90d919da7"> 2472</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a6c976f8f022417df827670e90d919da7">enable_slow_log</a>; <span class="comment">/* enable slow log for current statement */</span></div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  <span class="comment">/* set during loop of derived table processing */</span></div><div class="line"><a name="l02474"></a><span class="lineno"><a class="line" href="classTHD.html#a51b1256db4ab889d94e04e91e2278deb"> 2474</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a51b1256db4ab889d94e04e91e2278deb">derived_tables_processing</a>;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  <span class="comment">// Set while parsing INFORMATION_SCHEMA system views.</span></div><div class="line"><a name="l02476"></a><span class="lineno"><a class="line" href="classTHD.html#a9d034145d1ab360d7c639df5d06c88c6"> 2476</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a9d034145d1ab360d7c639df5d06c88c6">parsing_system_view</a>;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="comment">  /** Current SP-runtime context. */</span></div><div class="line"><a name="l02479"></a><span class="lineno"><a class="line" href="classTHD.html#a8a57c506360e6f165b28c2ccb76bc4d9"> 2479</a></span>&#160;  <a class="code" href="classsp__rcontext.html">sp_rcontext</a> *<a class="code" href="classTHD.html#a8a57c506360e6f165b28c2ccb76bc4d9">sp_runtime_ctx</a>;</div><div class="line"><a name="l02480"></a><span class="lineno"><a class="line" href="classTHD.html#acc2dfaeff7fe8328447716eb221e5e53"> 2480</a></span>&#160;  <a class="code" href="classsp__cache.html">sp_cache</a> *<a class="code" href="classTHD.html#acc2dfaeff7fe8328447716eb221e5e53">sp_proc_cache</a>;</div><div class="line"><a name="l02481"></a><span class="lineno"><a class="line" href="classTHD.html#abb273b15863db167e5591be73a6413ca"> 2481</a></span>&#160;  <a class="code" href="classsp__cache.html">sp_cache</a> *<a class="code" href="classTHD.html#abb273b15863db167e5591be73a6413ca">sp_func_cache</a>;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="comment">  /** number of name_const() substitutions, see sp_head.cc:subst_spvars() */</span></div><div class="line"><a name="l02484"></a><span class="lineno"><a class="line" href="classTHD.html#ad9803661804b24613cc97d5cb42fb8e8"> 2484</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#ad9803661804b24613cc97d5cb42fb8e8">query_name_consts</a>;</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="comment">    If we do a purge of binary logs, log index info of the threads</span></div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="comment">    that are currently reading it needs to be adjusted. To do that</span></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="comment">    each thread that is using LOG_INFO needs to adjust the pointer to it</span></div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02491"></a><span class="lineno"><a class="line" href="classTHD.html#aed48431daf356f5e62044248c424b76f"> 2491</a></span>&#160;  <a class="code" href="structLOG__INFO.html">LOG_INFO</a> *<a class="code" href="classTHD.html#aed48431daf356f5e62044248c424b76f">current_linfo</a>;</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;  <span class="comment">/* Used by the sys_var class to store temporary values */</span></div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;  <span class="keyword">union </span>{</div><div class="line"><a name="l02494"></a><span class="lineno"><a class="line" href="classTHD.html#a86ea5ed5d26bc93bebd3eb13403965ec"> 2494</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a86ea5ed5d26bc93bebd3eb13403965ec">bool_value</a>;</div><div class="line"><a name="l02495"></a><span class="lineno"><a class="line" href="classTHD.html#a52d5774258fd38d6a434953ee94915e0"> 2495</a></span>&#160;    <span class="keywordtype">long</span> <a class="code" href="classTHD.html#a52d5774258fd38d6a434953ee94915e0">long_value</a>;</div><div class="line"><a name="l02496"></a><span class="lineno"><a class="line" href="classTHD.html#abe2eb9fbdca2b08427543ca967060c50"> 2496</a></span>&#160;    <a class="code" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> <a class="code" href="classTHD.html#abe2eb9fbdca2b08427543ca967060c50">ulong_value</a>;</div><div class="line"><a name="l02497"></a><span class="lineno"><a class="line" href="classTHD.html#ae3ded25e710e145f8ce3ece524a07e31"> 2497</a></span>&#160;    <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classTHD.html#ae3ded25e710e145f8ce3ece524a07e31">ulonglong_value</a>;</div><div class="line"><a name="l02498"></a><span class="lineno"><a class="line" href="classTHD.html#a3fde14709d1dd755050cde00400e1ea0"> 2498</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classTHD.html#a3fde14709d1dd755050cde00400e1ea0">double_value</a>;</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;  } sys_var_tmp;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;  <span class="keyword">struct </span>{</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="comment">      If true, mysql_bin_log::write(Log_event) call will not write events to</span></div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="comment">      binlog, and maintain 2 below variables instead (use</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="comment">      mysql_bin_log.start_union_events to turn this on)</span></div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02507"></a><span class="lineno"><a class="line" href="classTHD.html#acfd365279829b128edbb75e113d68db0"> 2507</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#acfd365279829b128edbb75e113d68db0">do_union</a>;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">      If true, at least one mysql_bin_log::write(Log_event) call has been</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">      made after last mysql_bin_log.start_union_events() call.</span></div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02512"></a><span class="lineno"><a class="line" href="classTHD.html#ad74dd2ff7880807d0fc97364aa35b870"> 2512</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#ad74dd2ff7880807d0fc97364aa35b870">unioned_events</a>;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">      If true, at least one mysql_bin_log::write(Log_event e), where</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment">      e.cache_stmt == true call has been made after last</span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="comment">      mysql_bin_log.start_union_events() call.</span></div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02518"></a><span class="lineno"><a class="line" href="classTHD.html#aae909fabc9ab6a6e16b5b6de2361b38f"> 2518</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#aae909fabc9ab6a6e16b5b6de2361b38f">unioned_events_trans</a>;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="comment">      &#39;queries&#39; (actually SP statements) that run under inside this binlog</span></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment">      union have thd-&gt;query_id &gt;= first_query_id.</span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02524"></a><span class="lineno"><a class="line" href="classTHD.html#ac2448f4024806acc55a714a168855983"> 2524</a></span>&#160;    <a class="code" href="binlog_8h.html#a12a2cc906d37cadce17ce6455271a09a">query_id_t</a> <a class="code" href="classTHD.html#ac2448f4024806acc55a714a168855983">first_query_id</a>;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;  } binlog_evt_union;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="comment">    Internal parser state.</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="comment">    Note that since the parser is not re-entrant, we keep only one parser</span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment">    state here. This member is valid only when executing code during parsing.</span></div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02532"></a><span class="lineno"><a class="line" href="classTHD.html#a906df227b978f39c5acddf6d1458b559"> 2532</a></span>&#160;  <a class="code" href="classParser__state.html">Parser_state</a> *<a class="code" href="classTHD.html#a906df227b978f39c5acddf6d1458b559">m_parser_state</a>;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;</div><div class="line"><a name="l02534"></a><span class="lineno"><a class="line" href="classTHD.html#ae97e7460f8e8aa02c0ab93d1de3b1247"> 2534</a></span>&#160;  <a class="code" href="classLocked__tables__list.html">Locked_tables_list</a> <a class="code" href="classTHD.html#ae97e7460f8e8aa02c0ab93d1de3b1247">locked_tables_list</a>;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;</div><div class="line"><a name="l02536"></a><span class="lineno"><a class="line" href="classTHD.html#a9337218e2983f33f407ef76046f31bfa"> 2536</a></span>&#160;  <a class="code" href="classpartition__info.html">partition_info</a> *<a class="code" href="classTHD.html#a9337218e2983f33f407ef76046f31bfa">work_part_info</a>;</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="comment">    Array of active audit plugins which have been used by this THD.</span></div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="comment">    This list is later iterated to invoke release_thd() on those</span></div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;<span class="comment">    plugins.</span></div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02543"></a><span class="lineno"><a class="line" href="classTHD.html#aa9d10434713933cd9e9a5c9ae1450b88"> 2543</a></span>&#160;  <a class="code" href="classPlugin__array.html">Plugin_array</a> <a class="code" href="classTHD.html#aa9d10434713933cd9e9a5c9ae1450b88">audit_class_plugins</a>;<span class="comment"></span></div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="comment">    Array of bits indicating which audit classes have already been</span></div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="comment">    added to the list of audit plugins which are currently in use.</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02548"></a><span class="lineno"><a class="line" href="classTHD.html#a28e51949e4e855dfa954c7c57903b54b"> 2548</a></span>&#160;  <a class="code" href="classPrealloced__array.html">Prealloced_array&lt;unsigned long, 11&gt;</a> <a class="code" href="classTHD.html#a28e51949e4e855dfa954c7c57903b54b">audit_class_mask</a>;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="preprocessor">#if defined(ENABLED_DEBUG_SYNC)</span></div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;  <span class="comment">/* Debug Sync facility. See debug_sync.cc. */</span></div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;  <span class="keyword">struct </span>st_debug_sync_control *debug_sync_control;</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* defined(ENABLED_DEBUG_SYNC) */</span><span class="preprocessor"></span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;  <span class="comment">// We don&#39;t want to load/unload plugins for unit tests.</span></div><div class="line"><a name="l02556"></a><span class="lineno"><a class="line" href="classTHD.html#ae8446418aabab529bcf8e8781e7d36f3"> 2556</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#ae8446418aabab529bcf8e8781e7d36f3">m_enable_plugins</a>;</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="comment">    Audit API events are generated, when this flag is true. The flag</span></div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment">    is initially true, but it can be set false in some cases, e.g.</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="comment">    Session Service&#39;s THDs are created with auditing disabled. Auditing</span></div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="comment">    is enabled on MYSQL_AUDIT_CONNECTION_CONNECT event.</span></div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02564"></a><span class="lineno"><a class="line" href="classTHD.html#a78e5a9c411bd4733de72d41fd58aed1a"> 2564</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a78e5a9c411bd4733de72d41fd58aed1a">m_audited</a>;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;  <a class="code" href="classTHD.html">THD</a>(<span class="keywordtype">bool</span> enable_plugins = <span class="keyword">true</span>);</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="comment">    The THD dtor is effectively split in two:</span></div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="comment">      THD::release_resources() and ~THD().</span></div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="comment">    We want to minimize the time we hold LOCK_thd_list,</span></div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="comment">    so when destroying a global thread, do:</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="comment">    thd-&gt;release_resources()</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="comment">    Global_THD_manager::get_instance()-&gt;remove_thd();</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="comment">    delete thd;</span></div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;  ~<a class="code" href="classTHD.html">THD</a>() <span class="keyword">override</span>;</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;  <span class="keywordtype">void</span> release_resources();</div><div class="line"><a name="l02582"></a><span class="lineno"><a class="line" href="classTHD.html#af39e05df2c6ac87fa5d540b0387c951d"> 2582</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#af39e05df2c6ac87fa5d540b0387c951d">release_resources_done</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_release_resources_done; }</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l02585"></a><span class="lineno"><a class="line" href="classTHD.html#a83ab8f537e924f564e8a7f2b11a34c2a"> 2585</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a83ab8f537e924f564e8a7f2b11a34c2a">m_release_resources_done</a>;</div><div class="line"><a name="l02586"></a><span class="lineno"><a class="line" href="classTHD.html#a417a79b17f99e2341ac8f3a8775d6992"> 2586</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a417a79b17f99e2341ac8f3a8775d6992">cleanup_done</a>;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;  <span class="keywordtype">void</span> cleanup(<span class="keywordtype">void</span>);</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespacedd.html#abb73bd0d1f34e0e4727e0f0e453f1f5b">init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="comment">    Initialize memory roots necessary for query processing and (!)</span></div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="comment">    pre-allocate memory for it. We can&#39;t do that in THD constructor because</span></div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="comment">    there are use cases (acl_init, watcher threads,</span></div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="comment">    killing mysqld) where it&#39;s vital to not allocate excessive and not used</span></div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="comment">    memory. Note, that we still don&#39;t return error from init_query_mem_roots()</span></div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="comment">    if preallocation fails, we should notice that at the first call to</span></div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="comment">    alloc_root.</span></div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;  <span class="keywordtype">void</span> init_query_mem_roots();</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;  <span class="keywordtype">void</span> cleanup_connection(<span class="keywordtype">void</span>);</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;  <span class="keywordtype">void</span> cleanup_after_query();</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  <span class="keywordtype">void</span> store_globals();</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;  <span class="keywordtype">void</span> restore_globals();</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;</div><div class="line"><a name="l02607"></a><span class="lineno"><a class="line" href="classTHD.html#aaac435d3e63d575c72bcecde44c44b31"> 2607</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#aaac435d3e63d575c72bcecde44c44b31">set_active_vio</a>(<a class="code" href="structVio.html">Vio</a> *vio) {</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    active_vio = vio;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;  }</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;</div><div class="line"><a name="l02613"></a><span class="lineno"><a class="line" href="classTHD.html#a314e110052f1994be7d732d484f6d84c"> 2613</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a314e110052f1994be7d732d484f6d84c">set_ssl</a>(<a class="code" href="structVio.html">Vio</a> *vio) {</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    m_SSL = (<a class="code" href="namespacemysql__protocol_1_1Capabilities.html#a87a15ae15ae06d1484d11f8480e0e645">SSL</a> *)vio-&gt;<a class="code" href="structVio.html#abb1ac2cee2fe25bc3964866f27c3c051">ssl_arg</a>;</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;  }</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;</div><div class="line"><a name="l02619"></a><span class="lineno"><a class="line" href="classTHD.html#a4c93c37902bc696c3aa2046e26e00d8b"> 2619</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a4c93c37902bc696c3aa2046e26e00d8b">clear_active_vio</a>() {</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    active_vio = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    m_SSL = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;  }</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;<span class="comment">  /** Set active clone network Vio for remote clone.</span></div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="comment">  @param[in] vio network vio */</span></div><div class="line"><a name="l02628"></a><span class="lineno"><a class="line" href="classTHD.html#a5b4ce043dec5c4eaea92708335db8ae6"> 2628</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a5b4ce043dec5c4eaea92708335db8ae6">set_clone_vio</a>(<a class="code" href="structVio.html">Vio</a> *vio) {</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    clone_vio = vio;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;  }</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="comment">  /** Clear clone network Vio for remote clone. */</span></div><div class="line"><a name="l02635"></a><span class="lineno"><a class="line" href="classTHD.html#a427aaab42cc8a799234d0a97e4621a8c"> 2635</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a427aaab42cc8a799234d0a97e4621a8c">clear_clone_vio</a>() {</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    clone_vio = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  }</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="comment">  /** Check if clone network Vio is active. */</span></div><div class="line"><a name="l02642"></a><span class="lineno"><a class="line" href="classTHD.html#acd9e4c9442ecb192a501cb6f3555b195"> 2642</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#acd9e4c9442ecb192a501cb6f3555b195">check_clone_vio</a>() {</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespaceundo.html#af16fb6085ef2e93316f4b550861c179c">is_active</a> = (clone_vio != <span class="keyword">nullptr</span>);</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    <span class="keywordflow">return</span> (is_active);</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  }</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="comment">  /** Shutdown clone vio, if active. */</span></div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  <span class="keywordtype">void</span> shutdown_clone_vio();</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  <a class="code" href="violite_8h.html#add2537fe635a53ad239256865059b033">enum_vio_type</a> get_vio_type() <span class="keyword">const</span>;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;  <span class="keywordtype">void</span> shutdown_active_vio();</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;  <span class="keywordtype">void</span> awake(<a class="code" href="classTHD.html#ae917ceb9a297bbe6abdde1897af5c9d2">THD::killed_state</a> state_to_set);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="comment">  /** Disconnect the associated communication endpoint. */</span></div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;  <span class="keywordtype">void</span> disconnect(<span class="keywordtype">bool</span> server_shutdown = <span class="keyword">false</span>);</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;</div><div class="line"><a name="l02660"></a><span class="lineno"><a class="line" href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4"> 2660</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4">enum_binlog_query_type</a> {</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    <span class="comment">/* The query can be logged in row format or in statement format. */</span></div><div class="line"><a name="l02662"></a><span class="lineno"><a class="line" href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4a483bc88a82baec686bcb2b98bb6c4ff8"> 2662</a></span>&#160;    <a class="code" href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4a483bc88a82baec686bcb2b98bb6c4ff8">ROW_QUERY_TYPE</a>,</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="comment">/* The query has to be logged in statement format. */</span></div><div class="line"><a name="l02665"></a><span class="lineno"><a class="line" href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4abdd8ab0f7264a80fc11ceb4fb9a17e2c"> 2665</a></span>&#160;    <a class="code" href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4abdd8ab0f7264a80fc11ceb4fb9a17e2c">STMT_QUERY_TYPE</a>,</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div><div class="line"><a name="l02667"></a><span class="lineno"><a class="line" href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4a9534ccdabac1e87ee56c7540975eda22"> 2667</a></span>&#160;    QUERY_TYPE_COUNT</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  };</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;  <span class="keywordtype">int</span> binlog_query(<a class="code" href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4">enum_binlog_query_type</a> qtype, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="myisam__ftdump_8cc.html#af26982218484ec3fdcb8f7d92e864a9b">query</a>,</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                   <span class="keywordtype">size_t</span> query_len, <span class="keywordtype">bool</span> is_trans, <span class="keywordtype">bool</span> direct,</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                   <span class="keywordtype">bool</span> suppress_use, <span class="keywordtype">int</span> errcode);</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  <span class="comment">// Begin implementation of MDL_context_owner interface.</span></div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;</div><div class="line"><a name="l02676"></a><span class="lineno"><a class="line" href="classTHD.html#a2300257d01cd62fda2c76054c7494f82"> 2676</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a2300257d01cd62fda2c76054c7494f82">enter_cond</a>(<a class="code" href="structmysql__cond__t.html">mysql_cond_t</a> *cond, <a class="code" href="structmysql__mutex__t.html">mysql_mutex_t</a> *<a class="code" href="memcached_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>,</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                  <span class="keyword">const</span> <a class="code" href="structPSI__stage__info__v1.html">PSI_stage_info</a> *stage, <a class="code" href="structPSI__stage__info__v1.html">PSI_stage_info</a> *old_stage,</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">char</span> *src_function, <span class="keyword">const</span> <span class="keywordtype">char</span> *src_file,</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                  <span class="keywordtype">int</span> src_line)<span class="keyword"> override </span>{</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    <a class="code" href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a>;</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <a class="code" href="group__psi__api__mutex.html#gaccf61aa4a9e6108ac938a184d7b8efd7">mysql_mutex_assert_owner</a>(mutex);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="comment">      Sic: We don&#39;t lock LOCK_current_cond here.</span></div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment">      If we did, we could end up in deadlock with THD::awake()</span></div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="comment">      which locks current_mutex while LOCK_current_cond is locked.</span></div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    current_mutex = <a class="code" href="memcached_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>;</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    current_cond = cond;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    enter_stage(stage, old_stage, src_function, src_file, src_line);</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;  }</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;</div><div class="line"><a name="l02693"></a><span class="lineno"><a class="line" href="classTHD.html#a677f0f9fffc3a94edeb1e82d4760f699"> 2693</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a677f0f9fffc3a94edeb1e82d4760f699">exit_cond</a>(<span class="keyword">const</span> <a class="code" href="structPSI__stage__info__v1.html">PSI_stage_info</a> *stage, <span class="keyword">const</span> <span class="keywordtype">char</span> *src_function,</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">char</span> *src_file, <span class="keywordtype">int</span> src_line)<span class="keyword"> override </span>{</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <a class="code" href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a>;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="comment">      current_mutex must be unlocked _before_ LOCK_current_cond is</span></div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment">      locked (if that would not be the case, you&#39;ll get a deadlock if someone</span></div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="comment">      does a THD::awake() on you).</span></div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <a class="code" href="group__psi__api__mutex.html#ga5d4432144c24f6cf89f761417dd1c1c6">mysql_mutex_assert_not_owner</a>(current_mutex.load());</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_current_cond);</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    current_mutex = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    current_cond = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_current_cond);</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    enter_stage(stage, <span class="keyword">nullptr</span>, src_function, src_file, src_line);</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;  }</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;</div><div class="line"><a name="l02710"></a><span class="lineno"><a class="line" href="classTHD.html#a6f59ec56969f12878961fa605966d3c3"> 2710</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classTHD.html#a6f59ec56969f12878961fa605966d3c3">is_killed</a>() const <a class="code" href="hash_8c.html#ab4646d77540701d2eb2c877effbe5739">final</a> { <span class="keywordflow">return</span> killed; }</div><div class="line"><a name="l02711"></a><span class="lineno"><a class="line" href="classTHD.html#a5d23050388716b61772b6d92ab169efd"> 2711</a></span>&#160;  <a class="code" href="classTHD.html">THD</a> *<a class="code" href="classTHD.html#a5d23050388716b61772b6d92ab169efd">get_thd</a>()<span class="keyword"> override </span>{ <span class="keywordflow">return</span> <span class="keyword">this</span>; }</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="comment">    A callback to the server internals that is used to address</span></div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="comment">    special cases of the locking protocol.</span></div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="comment">    Invoked when acquiring an exclusive lock, for each thread that</span></div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="comment">    has a conflicting shared metadata lock.</span></div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;<span class="comment">    This function aborts waiting of the thread on a data lock, to make</span></div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;<span class="comment">    it notice the pending exclusive lock and back off.</span></div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;<span class="comment">    @note This function does not wait for the thread to give away its</span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;<span class="comment">          locks. Waiting is done outside for all threads at once.</span></div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span class="comment">    @param ctx_in_use           The MDL context owner (thread) to wake up.</span></div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;<span class="comment">    @param needs_thr_lock_abort Indicates that to wake up thread</span></div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="comment">                                this call needs to abort its waiting</span></div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="comment">                                on table-level lock.</span></div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;  <span class="keywordtype">void</span> notify_shared_lock(<a class="code" href="classMDL__context__owner.html">MDL_context_owner</a> *ctx_in_use,</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                          <span class="keywordtype">bool</span> needs_thr_lock_abort) <span class="keyword">override</span>;</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;  <span class="keywordtype">bool</span> notify_hton_pre_acquire_exclusive(<span class="keyword">const</span> <a class="code" href="structMDL__key.html">MDL_key</a> *mdl_key,</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                                         <span class="keywordtype">bool</span> *victimized) <span class="keyword">override</span>;</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  <span class="keywordtype">void</span> notify_hton_post_release_exclusive(<span class="keyword">const</span> <a class="code" href="structMDL__key.html">MDL_key</a> *mdl_key) <span class="keyword">override</span>;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;<span class="comment">    Provide thread specific random seed for MDL_context&#39;s PRNG.</span></div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="comment">    Note that even if two connections will request seed during handling of</span></div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="comment">    statements which were started at exactly the same time, and thus will</span></div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="comment">    get the same values in PRNG at the start, they will naturally diverge</span></div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="comment">    soon, since calls to PRNG in MDL subsystem are affected by many factors</span></div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="comment">    making process quite random. OTOH the fact that we use time as a seed</span></div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;<span class="comment">    gives more randomness and thus better coverage in tests as opposed to</span></div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="comment">    using thread_id for the same purpose.</span></div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02749"></a><span class="lineno"><a class="line" href="classTHD.html#a42aa99eda44ef4933b022773bf396a3d"> 2749</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#a42aa99eda44ef4933b022773bf396a3d">get_rand_seed</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> (<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>)start_utime; }</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  <span class="comment">// End implementation of MDL_context_owner interface.</span></div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;</div><div class="line"><a name="l02753"></a><span class="lineno"><a class="line" href="classTHD.html#a8bc04f94c98c0c02830391aae8cac05b"> 2753</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a8bc04f94c98c0c02830391aae8cac05b">is_strict_mode</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    <span class="keywordflow">return</span> (variables.sql_mode &amp;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;            (<a class="code" href="system__variables_8h.html#a2279a47c49e41b76069e24d5061aa905">MODE_STRICT_TRANS_TABLES</a> | <a class="code" href="system__variables_8h.html#ad004a34722cec86fb70352d7386e8013">MODE_STRICT_ALL_TABLES</a>));</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;  }</div><div class="line"><a name="l02757"></a><span class="lineno"><a class="line" href="classTHD.html#a7a1ba495765a2c8dafac08d048bed709"> 2757</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="structCHARSET__INFO.html">CHARSET_INFO</a> *<a class="code" href="classTHD.html#a7a1ba495765a2c8dafac08d048bed709">collation</a>() {</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    <span class="keywordflow">return</span> variables.collation_server ? variables.collation_server</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                                      : <a class="code" href="group__MYSYS.html#ga6fe5765f3b92d4dadad6f28e56957899">default_charset_info</a>;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  }</div><div class="line"><a name="l02761"></a><span class="lineno"><a class="line" href="classTHD.html#ad41e300171a192db94fce0cb9f79d425"> 2761</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classTime__zone.html">Time_zone</a> *<a class="code" href="classTHD.html#ad41e300171a192db94fce0cb9f79d425">time_zone</a>() {</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    time_zone_used = <span class="keyword">true</span>;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    <span class="keywordflow">return</span> variables.time_zone;</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;  }</div><div class="line"><a name="l02765"></a><span class="lineno"><a class="line" href="classTHD.html#a98462dbdca947ea962a2e1fac10bb865"> 2765</a></span>&#160;  time_t <a class="code" href="classTHD.html#a98462dbdca947ea962a2e1fac10bb865">query_start_in_secs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> start_time.tv_sec; }</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;  timeval query_start_timeval_trunc(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> decimals);</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;  <span class="keywordtype">void</span> set_time();</div><div class="line"><a name="l02768"></a><span class="lineno"><a class="line" href="classTHD.html#ab3b03b54670b3f7c7225d9fc7a496652"> 2768</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ab3b03b54670b3f7c7225d9fc7a496652">set_time</a>(<span class="keyword">const</span> <span class="keyword">struct</span> timeval *t) {</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    user_time = *t;</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    set_time();</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;  }</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  <span class="keywordtype">void</span> set_time_after_lock();</div><div class="line"><a name="l02773"></a><span class="lineno"><a class="line" href="classTHD.html#aa8f160f74031563e5a49704c4a2ca6d2"> 2773</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#aa8f160f74031563e5a49704c4a2ca6d2">is_fsp_truncate_mode</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    <span class="keywordflow">return</span> (variables.sql_mode &amp; <a class="code" href="system__variables_8h.html#a9a3d5e8862316e95457e7859e792ffe5">MODE_TIME_TRUNCATE_FRACTIONAL</a>);</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  }</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="comment">   Evaluate the current time, and if it exceeds the long-query-time</span></div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="comment">   setting, mark the query as slow.</span></div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  <span class="keywordtype">void</span> update_slow_query_status();</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;</div><div class="line"><a name="l02783"></a><span class="lineno"><a class="line" href="classTHD.html#aff87818ded40571a9ea74ee93ac81d94"> 2783</a></span>&#160;  <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <a class="code" href="classTHD.html#aff87818ded40571a9ea74ee93ac81d94">found_rows</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> previous_found_rows; }</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment">    Call when it is clear that the query is ended and we have collected the</span></div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="comment">    right value for current_found_rows. Calling this method makes a snapshot of</span></div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="comment">    that value and makes it ready and stable for subsequent FOUND_ROWS() call</span></div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;<span class="comment">    in the next statement.</span></div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02791"></a><span class="lineno"><a class="line" href="classTHD.html#abe809757af06d33d391f553d930ec663"> 2791</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#abe809757af06d33d391f553d930ec663">update_previous_found_rows</a>() {</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    previous_found_rows = current_found_rows;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  }</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="comment">    Returns true if session is in a multi-statement transaction mode.</span></div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment">    OPTION_NOT_AUTOCOMMIT: When autocommit is off, a multi-statement</span></div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="comment">    transaction is implicitly started on the first statement after a</span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="comment">    previous transaction has been ended.</span></div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="comment">    OPTION_BEGIN: Regardless of the autocommit status, a multi-statement</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="comment">    transaction can be explicitly started with the statements &quot;START</span></div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="comment">    TRANSACTION&quot;, &quot;BEGIN [WORK]&quot;, &quot;[COMMIT | ROLLBACK] AND CHAIN&quot;, etc.</span></div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="comment">    Note: this doesn&#39;t tell you whether a transaction is active.</span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="comment">    A session can be in multi-statement transaction mode, and yet</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="comment">    have no active transaction, e.g., in case of:</span></div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="comment">    set \@\@autocommit=0;</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="comment">    set \@a= 3;                                    &lt;-- these statements don&#39;t</span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;<span class="comment">    set transaction isolation level serializable;  &lt;-- start an active</span></div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;<span class="comment">    flush tables;                                  &lt;-- transaction</span></div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="comment">    I.e. for the above scenario this function returns true, even</span></div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="comment">    though no active transaction has begun.</span></div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="comment">    @sa in_active_multi_stmt_transaction()</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02818"></a><span class="lineno"><a class="line" href="classTHD.html#ace4dd3359d802d88be920471d65b2ec1"> 2818</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#ace4dd3359d802d88be920471d65b2ec1">in_multi_stmt_transaction_mode</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <span class="keywordflow">return</span> variables.option_bits &amp; (<a class="code" href="query__options_8h.html#a8d83dd7bcb6b71b786015c699693043f">OPTION_NOT_AUTOCOMMIT</a> | <a class="code" href="query__options_8h.html#af3ef29bb91e9565fd2e313f2816b4355">OPTION_BEGIN</a>);</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;  }<span class="comment"></span></div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="comment">    true if the session is in a multi-statement transaction mode</span></div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="comment">    (@sa in_multi_stmt_transaction_mode()) *and* there is an</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="comment">    active transaction, i.e. there is an explicit start of a</span></div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment">    transaction with BEGIN statement, or implicit with a</span></div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="comment">    statement that uses a transactional engine.</span></div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="comment">    For example, these scenarios don&#39;t start an active transaction</span></div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="comment">    (even though the server is in multi-statement transaction mode):</span></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;<span class="comment">    @verbatim</span></div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;<span class="comment">    set @@autocommit=0;</span></div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;<span class="comment">    select * from nontrans_table;</span></div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="comment">    set @var = true;</span></div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="comment">    flush tables;</span></div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="comment">    @endverbatim</span></div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;<span class="comment">    Note, that even for a statement that starts a multi-statement</span></div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;<span class="comment">    transaction (i.e. select * from trans_table), this</span></div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="comment">    flag won&#39;t be set until we open the statement&#39;s tables</span></div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;<span class="comment">    and the engines register themselves for the transaction</span></div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="comment">    (see trans_register_ha()),</span></div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="comment">    hence this method is reliable to use only after</span></div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="comment">    open_tables() has completed.</span></div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;<span class="comment">    Why do we need a flag?</span></div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;<span class="comment">    ----------------------</span></div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;<span class="comment">    We need to maintain a (at first glance redundant)</span></div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;<span class="comment">    session flag, rather than looking at thd-&gt;transaction.all.ha_list</span></div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;<span class="comment">    because of explicit start of a transaction with BEGIN.</span></div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="comment">    I.e. in case of</span></div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="comment">    BEGIN;</span></div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;<span class="comment">    select * from nontrans_t1; &lt;-- in_active_multi_stmt_transaction() is true</span></div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02856"></a><span class="lineno"><a class="line" href="classTHD.html#acd098dcfcff6ec6b1501a283e21e817b"> 2856</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#acd098dcfcff6ec6b1501a283e21e817b">in_active_multi_stmt_transaction</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <span class="keywordflow">return</span> server_status &amp; <a class="code" href="mysql__com_8h.html#a1d854e841086925be1883e4d7b4e8cada1f53c7403e030b7699ed3b4ad237012b">SERVER_STATUS_IN_TRANS</a>;</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;  }</div><div class="line"><a name="l02859"></a><span class="lineno"><a class="line" href="classTHD.html#a5f975240beaa300ea8df45d13fd8b5da"> 2859</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a5f975240beaa300ea8df45d13fd8b5da">fill_information_schema_tables</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    <span class="keywordflow">return</span> !stmt_arena-&gt;<a class="code" href="classQuery__arena.html#a54aac863df5e185baa158e9e72c52b5b">is_stmt_prepare</a>();</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  }</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;  <span class="keywordtype">bool</span> convert_string(<a class="code" href="structMYSQL__LEX__STRING.html">LEX_STRING</a> *to, <span class="keyword">const</span> <a class="code" href="structCHARSET__INFO.html">CHARSET_INFO</a> *to_cs,</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *from, <span class="keywordtype">size_t</span> from_length,</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                      <span class="keyword">const</span> <a class="code" href="structCHARSET__INFO.html">CHARSET_INFO</a> *from_cs, <span class="keywordtype">bool</span> <a class="code" href="error__handler_8cc.html#a82ac7afffb412aab613d35b74421ba40">report_error</a> = <span class="keyword">false</span>);</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;  <span class="keywordtype">int</span> send_explain_fields(<a class="code" href="classQuery__result.html">Query_result</a> *<a class="code" href="structresult.html">result</a>);</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="comment">    Clear the current error, if any.</span></div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;<span class="comment">    We do not clear is_fatal_error or is_fatal_sub_stmt_error since we</span></div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;<span class="comment">    assume this is never called if the fatal error is set.</span></div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;<span class="comment">    @todo: To silence an error, one should use Internal_error_handler</span></div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="comment">    mechanism. In future this function will be removed.</span></div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02876"></a><span class="lineno"><a class="line" href="classTHD.html#ae66b7e9449e141780dd88efcaba98c16"> 2876</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ae66b7e9449e141780dd88efcaba98c16">clear_error</a>() {</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <a class="code" href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a>;</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    <span class="keywordflow">if</span> (get_stmt_da()-&gt;is_error()) get_stmt_da()-&gt;reset_diagnostics_area();</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    is_slave_error = <span class="keyword">false</span>;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;  }</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  <span class="keywordtype">bool</span> is_classic_protocol() <span class="keyword">const</span>;</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;<span class="comment">  /** Return false if connection to client is broken. */</span></div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="node__connection_8h.html#ac81c8c488b37932224b37520e063ea83">is_connected</a>() <span class="keyword">final</span>;</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="comment">    Mark the current error as fatal. Warning: this does not</span></div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="comment">    set any error, it sets a property of the error, so must be</span></div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="comment">    followed or prefixed with my_error().</span></div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02893"></a><span class="lineno"><a class="line" href="classTHD.html#a65a43f30f696f95840ae621146a44405"> 2893</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a65a43f30f696f95840ae621146a44405">fatal_error</a>() { m_is_fatal_error = <span class="keyword">true</span>; }</div><div class="line"><a name="l02894"></a><span class="lineno"><a class="line" href="classTHD.html#addf196e6878180910d06b7a51f727651"> 2894</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#addf196e6878180910d06b7a51f727651">is_fatal_error</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_is_fatal_error; }<span class="comment"></span></div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;<span class="comment">    true if there is an error in the error stack.</span></div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;<span class="comment">    Please use this method instead of direct access to</span></div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;<span class="comment">    net.report_error.</span></div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;<span class="comment">    If true, the current (sub)-statement should be aborted.</span></div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;<span class="comment">    The main difference between this member and is_fatal_error</span></div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;<span class="comment">    is that a fatal error can not be handled by a stored</span></div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;<span class="comment">    procedure continue handler, whereas a normal error can.</span></div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;<span class="comment">    To raise this flag, use my_error().</span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02908"></a><span class="lineno"><a class="line" href="classTHD.html#a30a1cef179fd744cca1fca66e4c35a67"> 2908</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a30a1cef179fd744cca1fca66e4c35a67">is_error</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> get_stmt_da()-&gt;is_error(); }</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;<span class="comment">  /// Returns first Diagnostics Area for the current statement.</span></div><div class="line"><a name="l02911"></a><span class="lineno"><a class="line" href="classTHD.html#a305a07e95c586b3280fe993a80c74542"> 2911</a></span>&#160;<span class="comment"></span>  <a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> *<a class="code" href="classTHD.html#a305a07e95c586b3280fe993a80c74542">get_stmt_da</a>() { <span class="keywordflow">return</span> m_stmt_da; }</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;<span class="comment">  /// Returns first Diagnostics Area for the current statement.</span></div><div class="line"><a name="l02914"></a><span class="lineno"><a class="line" href="classTHD.html#a1bbd5e45d9e0771810084e4299bc1631"> 2914</a></span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> *<a class="code" href="classTHD.html#a1bbd5e45d9e0771810084e4299bc1631">get_stmt_da</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_stmt_da; }</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;<span class="comment">  /// Returns the second Diagnostics Area for the current statement.</span></div><div class="line"><a name="l02917"></a><span class="lineno"><a class="line" href="classTHD.html#ab3cae918b100630fb0c073dbd4c42013"> 2917</a></span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> *<a class="code" href="classTHD.html#ab3cae918b100630fb0c073dbd4c42013">get_stacked_da</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    <span class="keywordflow">return</span> get_stmt_da()-&gt;<a class="code" href="classDiagnostics__area.html#a37dd3ff9b2f6177d72b9345768d34eca">stacked_da</a>();</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  }</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;<span class="comment">    Returns thread-local Diagnostics Area for parsing.</span></div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;<span class="comment">    We need to have a clean DA in case errors or warnings are thrown</span></div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;<span class="comment">    during parsing, but we can&#39;t just reset the main DA in case we</span></div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;<span class="comment">    have a diagnostic statement on our hand that needs the old DA</span></div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;<span class="comment">    to answer questions about the previous execution.</span></div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;<span class="comment">    Keeping a static per-thread DA for parsing is less costly than</span></div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;<span class="comment">    allocating a temporary one for each statement we parse.</span></div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02930"></a><span class="lineno"><a class="line" href="classTHD.html#a1df1b6f4a7a8446001c9691f8e5153bc"> 2930</a></span>&#160;  <a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> *<a class="code" href="classTHD.html#a1df1b6f4a7a8446001c9691f8e5153bc">get_parser_da</a>() { <span class="keywordflow">return</span> &amp;m_parser_da; }</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;<span class="comment">    Returns thread-local Diagnostics Area to be used by query rewrite plugins.</span></div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="comment">    Query rewrite plugins use their own diagnostics area. The reason is that</span></div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;<span class="comment">    they are invoked right before and right after parsing, and we don&#39;t want</span></div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;<span class="comment">    conditions raised by plugins in either statement nor parser DA until we</span></div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="comment">    know which type of statement we have parsed.</span></div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="comment">    @note The diagnostics area is instantiated the first time it is asked for.</span></div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02941"></a><span class="lineno"><a class="line" href="classTHD.html#ac7322cad4b0ee57fbfd13c42a5ed76c2"> 2941</a></span>&#160;  <a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> *<a class="code" href="classTHD.html#ac7322cad4b0ee57fbfd13c42a5ed76c2">get_query_rewrite_plugin_da</a>() {</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <span class="keywordflow">return</span> m_query_rewrite_plugin_da_ptr;</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;  }</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;<span class="comment">    Push the given Diagnostics Area on top of the stack, making</span></div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;<span class="comment">    it the new first Diagnostics Area. Conditions in the new second</span></div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;<span class="comment">    Diagnostics Area will be copied to the new first Diagnostics Area.</span></div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;<span class="comment">    @param da   Diagnostics Area to be come the top of</span></div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;<span class="comment">                the Diagnostics Area stack.</span></div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;<span class="comment">    @param copy_conditions</span></div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;<span class="comment">                Copy the conditions from the new second Diagnostics Area</span></div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;<span class="comment">                to the new first Diagnostics Area, as per SQL standard.</span></div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02956"></a><span class="lineno"><a class="line" href="classTHD.html#aa99d434000b1e2572b741a69e34b8980"> 2956</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#aa99d434000b1e2572b741a69e34b8980">push_diagnostics_area</a>(<a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> *da,</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                             <span class="keywordtype">bool</span> copy_conditions = <span class="keyword">true</span>) {</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    get_stmt_da()-&gt;push_diagnostics_area(<span class="keyword">this</span>, da, copy_conditions);</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    m_stmt_da = da;</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;  }</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;<span class="comment">  /// Pop the top DA off the Diagnostics Area stack.</span></div><div class="line"><a name="l02963"></a><span class="lineno"><a class="line" href="classTHD.html#a2c8dc7fd2104d419ed6d70d99deda127"> 2963</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a2c8dc7fd2104d419ed6d70d99deda127">pop_diagnostics_area</a>() {</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    m_stmt_da = get_stmt_da()-&gt;pop_diagnostics_area();</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  }</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;<span class="comment">    Inserts the new protocol at the top of the protocol stack, and make it</span></div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;<span class="comment">    the current protocol for this thd.</span></div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;<span class="comment">    @param protocol Protocol to be inserted.</span></div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;  <span class="keywordtype">void</span> push_protocol(<a class="code" href="classProtocol.html">Protocol</a> *<a class="code" href="memcached_8h.html#add2ec924c0f221790d7235ffb2e615cd">protocol</a>);</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ProtocolClass&gt;</div><div class="line"><a name="l02976"></a><span class="lineno"><a class="line" href="classTHD.html#a37a1810b18a4a60ef7a89f2f8cf01ab1"> 2976</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a37a1810b18a4a60ef7a89f2f8cf01ab1">push_protocol</a>(<span class="keyword">const</span> std::unique_ptr&lt;ProtocolClass&gt; &amp;protocol) {</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    push_protocol(protocol.get());</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;  }</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;<span class="comment">    Pops the top protocol of the Protocol stack and sets the previous one</span></div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="comment">    as the current protocol.</span></div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;  <span class="keywordtype">void</span> pop_protocol();</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l02987"></a><span class="lineno"><a class="line" href="classTHD.html#ad9748d74b75b90a1be5195cfbcb7fc51"> 2987</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structCHARSET__INFO.html">CHARSET_INFO</a> *<a class="code" href="classTHD.html#ad9748d74b75b90a1be5195cfbcb7fc51">charset</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> variables.character_set_client; }</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;  <span class="keywordtype">void</span> update_charset();</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;<span class="comment">    Record a transient change to a pointer to an Item within another Item.</span></div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l02993"></a><span class="lineno"><a class="line" href="classTHD.html#abfc621ef5e64ce7878efa9d32ca2d04d"> 2993</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#abfc621ef5e64ce7878efa9d32ca2d04d">change_item_tree</a>(<a class="code" href="classItem.html">Item</a> **place, <a class="code" href="classItem.html">Item</a> *new_value) {</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;    <span class="comment">/* TODO: check for OOM condition here */</span></div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    <span class="keywordflow">if</span> (!stmt_arena-&gt;<a class="code" href="classQuery__arena.html#a7a5e86f5a1af6e9b6c59069a1bedb037">is_regular</a>()) {</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      <a class="code" href="my__dbug_8h.html#a3770d2ff545ed3e4b714d20014e663df">DBUG_PRINT</a>(<span class="stringliteral">&quot;info&quot;</span>, (<span class="stringliteral">&quot;change_item_tree place %p old_value %p new_value %p&quot;</span>,</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                          place, *place, new_value));</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      nocheck_register_item_tree_change(place, new_value);</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    }</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    *place = new_value;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;  }</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;<span class="comment">    Remember that place was updated with new_value so it can be restored</span></div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;<span class="comment">    by rollback_item_tree_changes().</span></div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;<span class="comment">    @param[in] place the location that will change, and whose old value</span></div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;<span class="comment">               we need to remember for restoration</span></div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;<span class="comment">    @param[in] new_value new value about to be inserted into *place</span></div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;  <span class="keywordtype">void</span> nocheck_register_item_tree_change(<a class="code" href="classItem.html">Item</a> **place, <a class="code" href="classItem.html">Item</a> *new_value);</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;<span class="comment">    Restore locations set by calls to nocheck_register_item_tree_change().</span></div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  <span class="keywordtype">void</span> rollback_item_tree_changes();</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;<span class="comment">    Cleanup statement parse state (parse tree, lex) and execution</span></div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;<span class="comment">    state after execution of a non-prepared SQL statement.</span></div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;  <span class="keywordtype">void</span> end_statement();</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;  <span class="keywordtype">void</span> send_kill_message() <span class="keyword">const</span>;</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;  <span class="keywordtype">void</span> reset_n_backup_open_tables_state(<a class="code" href="classOpen__tables__backup.html">Open_tables_backup</a> *<a class="code" href="myisampack_8cc.html#ac9a4b7317723254f2c79bffcd3265666">backup</a>,</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                                        <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> add_state_flags);</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  <span class="keywordtype">void</span> restore_backup_open_tables_state(<a class="code" href="classOpen__tables__backup.html">Open_tables_backup</a> *backup);</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;  <span class="keywordtype">void</span> reset_sub_statement_state(<a class="code" href="classSub__statement__state.html">Sub_statement_state</a> *backup, <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> new_state);</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;  <span class="keywordtype">void</span> restore_sub_statement_state(<a class="code" href="classSub__statement__state.html">Sub_statement_state</a> *backup);</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;<span class="comment">    Start a read-only attachable transaction.</span></div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;<span class="comment">    There must be no active attachable transactions (in other words, there can</span></div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;<span class="comment">    be only one active attachable transaction at a time).</span></div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;  <span class="keywordtype">void</span> begin_attachable_ro_transaction();</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="comment">    Start a read-write attachable transaction.</span></div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;<span class="comment">    All the read-only class&#39; requirements apply.</span></div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="comment">    Additional requirements are documented along the class</span></div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;<span class="comment">    declaration.</span></div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;  <span class="keywordtype">void</span> begin_attachable_rw_transaction();</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="comment">    End an active attachable transaction. Applies to both the read-only</span></div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="comment">    and the read-write versions.</span></div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="comment">    Note, that the read-write attachable transaction won&#39;t be terminated</span></div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="comment">    inside this method.</span></div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="comment">    To invoke the function there must be active attachable transaction.</span></div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;  <span class="keywordtype">void</span> end_attachable_transaction();</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;<span class="comment">    @return true if there is an active attachable transaction.</span></div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03059"></a><span class="lineno"><a class="line" href="classTHD.html#a68aa8081e199d358a3b372fc9824ffb4"> 3059</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a68aa8081e199d358a3b372fc9824ffb4">is_attachable_ro_transaction_active</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    <span class="keywordflow">return</span> m_attachable_trx != <span class="keyword">nullptr</span> &amp;&amp; m_attachable_trx-&gt;<a class="code" href="classTHD_1_1Attachable__trx.html#aa25f9429edea2c8b370c1bedb4d2534c">is_read_only</a>();</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;  }</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="comment">    @return true if there is an active attachable transaction.</span></div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03066"></a><span class="lineno"><a class="line" href="classTHD.html#a941fcac803fd6fc8f8e44d1584e0109c"> 3066</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a941fcac803fd6fc8f8e44d1584e0109c">is_attachable_transaction_active</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    <span class="keywordflow">return</span> m_attachable_trx != <span class="keyword">nullptr</span>;</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;  }</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;<span class="comment">    @return true if there is an active rw attachable transaction.</span></div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03073"></a><span class="lineno"><a class="line" href="classTHD.html#ac6653f0e6e583b004bd23879008a0d35"> 3073</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#ac6653f0e6e583b004bd23879008a0d35">is_attachable_rw_transaction_active</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    <span class="keywordflow">return</span> m_attachable_trx != <span class="keyword">nullptr</span> &amp;&amp; !m_attachable_trx-&gt;<a class="code" href="classTHD_1_1Attachable__trx.html#aa25f9429edea2c8b370c1bedb4d2534c">is_read_only</a>();</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;  }</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="comment">    @todo Make these methods private or remove them completely.  Only</span></div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;<span class="comment">    decide_logging_format should call them. /Sven</span></div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03082"></a><span class="lineno"><a class="line" href="classTHD.html#a63fd9e4a122c7ca66e4a142546838e9b"> 3082</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a63fd9e4a122c7ca66e4a142546838e9b">set_current_stmt_binlog_format_row_if_mixed</a>() {</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <a class="code" href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a>;</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;<span class="comment">      This should only be called from decide_logging_format.</span></div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="comment">      @todo Once we have ensured this, uncomment the following</span></div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;<span class="comment">      statement, remove the big comment below that, and remove the</span></div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;<span class="comment">      in_sub_stmt==0 condition from the following &#39;if&#39;.</span></div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    <span class="comment">/* DBUG_ASSERT(in_sub_stmt == 0); */</span></div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;<span class="comment">      If in a stored/function trigger, the caller should already have done the</span></div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;<span class="comment">      change. We test in_sub_stmt to prevent introducing bugs where people</span></div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;<span class="comment">      wouldn&#39;t ensure that, and would switch to row-based mode in the middle</span></div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;<span class="comment">      of executing a stored function/trigger (which is too late, see also</span></div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;<span class="comment">      reset_current_stmt_binlog_format_row()); this condition will make their</span></div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;<span class="comment">      tests fail and so force them to propagate the</span></div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;<span class="comment">      lex-&gt;binlog_row_based_if_mixed upwards to the caller.</span></div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="keywordflow">if</span> ((variables.binlog_format == <a class="code" href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bca30ac5a8bea24c56d28b29af8e3d721d8">BINLOG_FORMAT_MIXED</a>) &amp;&amp; (in_sub_stmt == 0))</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;      set_current_stmt_binlog_format_row();</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  }</div><div class="line"><a name="l03106"></a><span class="lineno"><a class="line" href="classTHD.html#a83effea31814e8e258a817be7e290677"> 3106</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a83effea31814e8e258a817be7e290677">set_current_stmt_binlog_format_row</a>() {</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <a class="code" href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a>;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    current_stmt_binlog_format = <a class="code" href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bca9fc57580019e63df209ad5271b483db8">BINLOG_FORMAT_ROW</a>;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;  }</div><div class="line"><a name="l03111"></a><span class="lineno"><a class="line" href="classTHD.html#a7953b16ef50f82579cf239d64d98c94d"> 3111</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a7953b16ef50f82579cf239d64d98c94d">clear_current_stmt_binlog_format_row</a>() {</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    <a class="code" href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a>;</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    current_stmt_binlog_format = <a class="code" href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bcacca4d39ed26658ad08e83887217a3e57">BINLOG_FORMAT_STMT</a>;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;  }</div><div class="line"><a name="l03116"></a><span class="lineno"><a class="line" href="classTHD.html#ace16912af2efc62730d276086223718d"> 3116</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ace16912af2efc62730d276086223718d">reset_current_stmt_binlog_format_row</a>() {</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    <a class="code" href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a>;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    <a class="code" href="my__dbug_8h.html#a3770d2ff545ed3e4b714d20014e663df">DBUG_PRINT</a>(<span class="stringliteral">&quot;debug&quot;</span>, (<span class="stringliteral">&quot;in_sub_stmt: %d, system_thread: %s&quot;</span>, in_sub_stmt != 0,</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;                         <a class="code" href="sql__class_8h.html#a76570ebd7443e3c05c9f2487f484dbc7">show_system_thread</a>(system_thread)));</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    <span class="keywordflow">if</span> (in_sub_stmt == 0) {</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;      <span class="keywordflow">if</span> (variables.binlog_format == <a class="code" href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bca9fc57580019e63df209ad5271b483db8">BINLOG_FORMAT_ROW</a>)</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        set_current_stmt_binlog_format_row();</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;        clear_current_stmt_binlog_format_row();</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;    }</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  }</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;<span class="comment">    Copies variables.original_commit_timestamp to</span></div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;<span class="comment">    ((Slave_worker *)rli_slave)-&gt;original_commit_timestamp,</span></div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="comment">    if this is a slave thread.</span></div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;  <span class="keywordtype">void</span> set_original_commit_timestamp_for_slave_thread();</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;<span class="comment">  /// Return the value of @@gtid_next_list: either a Gtid_set or NULL.</span></div><div class="line"><a name="l03137"></a><span class="lineno"><a class="line" href="classTHD.html#ac99d5a522ce55793a28d1a438ff8fb24"> 3137</a></span>&#160;<span class="comment"></span>  <a class="code" href="classGtid__set.html">Gtid_set</a> *<a class="code" href="classTHD.html#ac99d5a522ce55793a28d1a438ff8fb24">get_gtid_next_list</a>() {</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    <span class="keywordflow">return</span> variables.gtid_next_list.is_non_null</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;               ? variables.gtid_next_list.gtid_set</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;               : <span class="keyword">nullptr</span>;</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;  }</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;<span class="comment">  /// Return the value of @@gtid_next_list: either a Gtid_set or NULL.</span></div><div class="line"><a name="l03144"></a><span class="lineno"><a class="line" href="classTHD.html#a1b47cf643618ce7e5c4947d95cd556ca"> 3144</a></span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classGtid__set.html">Gtid_set</a> *<a class="code" href="classTHD.html#a1b47cf643618ce7e5c4947d95cd556ca">get_gtid_next_list_const</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code" href="classTHD.html">THD</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;get_gtid_next_list();</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;  }</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="comment">    Return true if the statement/transaction cache is currently empty,</span></div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;<span class="comment">    false otherwise.</span></div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;<span class="comment">    @param is_transactional if true, check the transaction cache.</span></div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="comment">    If false, check the statement cache.</span></div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;  <span class="keywordtype">bool</span> is_binlog_cache_empty(<span class="keywordtype">bool</span> is_transactional) <span class="keyword">const</span>;</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="comment">    The GTID of the currently owned transaction.</span></div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="comment">    ==== Modes of ownership ====</span></div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="comment">    The following modes of ownership are possible:</span></div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="comment">    - owned_gtid.sidno==0: the thread does not own any transaction.</span></div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="comment">    - owned_gtid.sidno==THD::OWNED_SIDNO_ANONYMOUS(==-2): the thread</span></div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;<span class="comment">      owns an anonymous transaction</span></div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;<span class="comment">    - owned_gtid.sidno&gt;0 and owned_gtid.gno&gt;0: the thread owns a GTID</span></div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;<span class="comment">      transaction.</span></div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="comment">    - (owned_gtid.sidno==THD::OWNED_SIDNO_GTID_SET(==-1): this is</span></div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="comment">      currently not used.  It was reserved for the case where multiple</span></div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment">      GTIDs are owned (using gtid_next_list).  This was one idea to</span></div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="comment">      make GTIDs work with NDB: due to the epoch concept, multiple</span></div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="comment">      transactions can be combined into one in NDB, and therefore a</span></div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="comment">      single transaction on a slave can have multiple GTIDs.)</span></div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment">    ==== Life cycle of ownership ====</span></div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment">    Generally, transaction ownership starts when the transaction is</span></div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;<span class="comment">    assigned its GTID and ends when the transaction commits or rolls</span></div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="comment">    back.  On a master (GTID_NEXT=AUTOMATIC), the GTID is assigned</span></div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;<span class="comment">    just before binlog flush; on a slave (GTID_NEXT=UUID:NUMBER or</span></div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="comment">    GTID_NEXT=ANONYMOUS) it is assigned before starting the</span></div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="comment">    transaction.</span></div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;<span class="comment">    A new client always starts with owned_gtid.sidno=0.</span></div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="comment">    Ownership can be acquired in the following ways:</span></div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment">    A1. If GTID_NEXT = &#39;AUTOMATIC&#39; and GTID_MODE = OFF/OFF_PERMISSIVE:</span></div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment">        The thread acquires anonymous ownership in</span></div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;<span class="comment">        gtid_state-&gt;generate_automatic_gtid called from</span></div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="comment">        MYSQL_BIN_LOG::write_transaction.</span></div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;<span class="comment">    A2. If GTID_NEXT = &#39;AUTOMATIC&#39; and GTID_MODE = ON/ON_PERMISSIVE:</span></div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;<span class="comment">        The thread generates the GTID and acquires ownership in</span></div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="comment">        gtid_state-&gt;generate_automatic_gtid called from</span></div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;<span class="comment">        MYSQL_BIN_LOG::write_transaction.</span></div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;<span class="comment">    A3. If GTID_NEXT = &#39;UUID:NUMBER&#39;: The thread acquires ownership in</span></div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;<span class="comment">        the following ways:</span></div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;<span class="comment">        - In a client, the SET GTID_NEXT statement acquires ownership.</span></div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;<span class="comment">        - The slave&#39;s analogy to a clients SET GTID_NEXT statement is</span></div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;<span class="comment">          Gtid_log_event::do_apply_event.  So the slave acquires</span></div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;<span class="comment">          ownership in this function.</span></div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;<span class="comment">        Note: if the GTID UUID:NUMBER is already included in</span></div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;<span class="comment">        GTID_EXECUTED, then the transaction must be skipped (the GTID</span></div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;<span class="comment">        auto-skip feature).  Thus, ownership is *not* acquired in this</span></div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;<span class="comment">        case and owned_gtid.sidno==0.</span></div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="comment">    A4. If GTID_NEXT = &#39;ANONYMOUS&#39;:</span></div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="comment">        - In a client, the SET GTID_NEXT statement acquires ownership.</span></div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;<span class="comment">        - In a slave thread, Gtid_log_event::do_apply_event acquires</span></div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;<span class="comment">          ownership.</span></div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;<span class="comment">        - Contrary to the case of GTID_NEXT=&#39;UUID:NUMBER&#39;, it is</span></div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;<span class="comment">          allowed to execute two transactions in sequence without</span></div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;<span class="comment">          changing GTID_NEXT (cf. R1 and R2 below).  Both transactions</span></div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;<span class="comment">          should be executed as anonymous transactions.  But ownership</span></div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;<span class="comment">          is released when the first transaction commits.  Therefore,</span></div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="comment">          when GTID_NEXT=&#39;ANONYMOUS&#39;, we also acquire anonymous</span></div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="comment">          ownership when starting to execute a statement, in</span></div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;<span class="comment">          gtid_reacquire_ownership_if_anonymous called from</span></div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;<span class="comment">          gtid_pre_statement_checks (usually called from</span></div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;<span class="comment">          mysql_execute_command).</span></div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;<span class="comment">    A5. Slave applier threads start in a special mode, having</span></div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;<span class="comment">        GTID_NEXT=&#39;NOT_YET_DETERMINED&#39;.  This mode cannot be set in a</span></div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;<span class="comment">        regular client.  When GTID_NEXT=NOT_YET_DETERMINED, the slave</span></div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;<span class="comment">        thread is postponing the decision of the value of GTID_NEXT</span></div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;<span class="comment">        until it has more information.  There are three cases:</span></div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;<span class="comment">        - If the first transaction of the relay log has a</span></div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;<span class="comment">          Gtid_log_event, then it will set GTID_NEXT=GTID:NUMBER and</span></div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;<span class="comment">          acquire GTID ownership in Gtid_log_event::do_apply_event.</span></div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;<span class="comment">        - If the first transaction of the relay log has a</span></div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;<span class="comment">          Anonymous_gtid_log_event, then it will set</span></div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;<span class="comment">          GTID_NEXT=ANONYMOUS and acquire anonymous ownership in</span></div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;<span class="comment">          Gtid_log_event::do_apply_event.</span></div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;<span class="comment">        - If the relay log was received from a pre-5.7.6 master with</span></div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;<span class="comment">          GTID_MODE=OFF (or a pre-5.6 master), then there are neither</span></div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;<span class="comment">          Gtid_log_events nor Anonymous_log_events in the relay log.</span></div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="comment">          In this case, the slave sets GTID_NEXT=ANONYMOUS and</span></div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;<span class="comment">          acquires anonymous ownership when executing a</span></div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;<span class="comment">          Query_log_event (Query_log_event::do_apply_event calls</span></div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="comment">          mysql_parse which calls gtid_pre_statement_checks which</span></div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;<span class="comment">          calls gtid_reacquire_ownership_if_anonymous).</span></div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;<span class="comment">    Ownership is released in the following ways:</span></div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;<span class="comment">    R1. A thread that holds GTID ownership releases ownership at</span></div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="comment">        transaction commit or rollback.  If GTID_NEXT=AUTOMATIC, all</span></div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;<span class="comment">        is fine. If GTID_NEXT=UUID:NUMBER, the UUID:NUMBER cannot be</span></div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="comment">        used for another transaction, since only one transaction can</span></div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;<span class="comment">        have any given GTID.  To avoid the user mistake of forgetting</span></div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="comment">        to set back GTID_NEXT, on commit we set</span></div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;<span class="comment">        thd-&gt;variables.gtid_next.type=UNDEFINED_GTID.  Then, any</span></div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;<span class="comment">        statement that user tries to execute other than SET GTID_NEXT</span></div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;<span class="comment">        will generate an error.</span></div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;<span class="comment">    R2. A thread that holds anonymous ownership releases ownership at</span></div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;<span class="comment">        transaction commit or rollback.  In this case there is no harm</span></div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;<span class="comment">        in leaving GTID_NEXT=&#39;ANONYMOUS&#39;, so</span></div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;<span class="comment">        thd-&gt;variables.gtid_next.type will remain ANONYMOUS_GTID and</span></div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;<span class="comment">        not UNDEFINED_GTID.</span></div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;<span class="comment">    There are statements that generate multiple transactions in the</span></div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;<span class="comment">    binary log. This includes the following:</span></div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;<span class="comment">    M1. DROP TABLE that is used with multiple tables, and the tables</span></div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;<span class="comment">        belong to more than one of the following groups: non-temporary</span></div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;<span class="comment">        table, temporary transactional table, temporary</span></div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;<span class="comment">        non-transactional table.  DROP TABLE is split into one</span></div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="comment">        transaction for each of these groups of tables.</span></div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;<span class="comment">    M2. DROP DATABASE that fails e.g. because rmdir fails. Then a</span></div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;<span class="comment">        single DROP TABLE is generated, which lists all tables that</span></div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;<span class="comment">        were dropped before the failure happened. But if the list of</span></div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;<span class="comment">        tables is big, and grows over a limit, the statement will be</span></div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;<span class="comment">        split into multiple statements.</span></div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;<span class="comment">    M3. CREATE TABLE ... SELECT that is logged in row format.  Then</span></div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;<span class="comment">        the server generates a single CREATE statement, followed by a</span></div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;<span class="comment">        BEGIN ... row events ... COMMIT transaction.</span></div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;<span class="comment">    M4. A statement that updates both transactional and</span></div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;<span class="comment">        non-transactional tables in the same statement, and is logged</span></div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="comment">        in row format.  Then it generates one transaction for the</span></div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;<span class="comment">        non-transactional row updates, followed by one transaction for</span></div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;<span class="comment">        the transactional row updates.</span></div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;<span class="comment">    M5. CALL is executed as multiple transactions and logged as</span></div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;<span class="comment">        multiple transactions.</span></div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;<span class="comment">    The general rules for multi-transaction statements are:</span></div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;<span class="comment">    - If GTID_NEXT=AUTOMATIC and GTID_MODE=ON or ON_PERMISSIVE, one</span></div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;<span class="comment">      GTID should be generated for each transaction within the</span></div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;<span class="comment">      statement. Therefore, ownership must be released after each</span></div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;<span class="comment">      commit so that a new GTID can be generated by the next</span></div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;<span class="comment">      transaction. Typically mysql_bin_log.commit() is called to</span></div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;<span class="comment">      achieve this. (Note that some of these statements are currently</span></div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;<span class="comment">      disallowed when GTID_MODE=ON.)</span></div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;<span class="comment">    - If GTID_NEXT=AUTOMATIC and GTID_MODE=OFF or OFF_PERMISSIVE, one</span></div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;<span class="comment">      Anonymous_gtid_log_event should be generated for each</span></div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;<span class="comment">      transaction within the statement. Similar to the case above, we</span></div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;<span class="comment">      call mysql_bin_log.commit() and release ownership between</span></div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;<span class="comment">      transactions within the statement.</span></div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;<span class="comment">      This works for all the special cases M1-M5 except M4.  When a</span></div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;<span class="comment">      statement writes both non-transactional and transactional</span></div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;<span class="comment">      updates to the binary log, both the transaction cache and the</span></div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;<span class="comment">      statement cache are flushed within the same call to</span></div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;<span class="comment">      flush_thread_caches(THD) from within the binary log group commit</span></div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;<span class="comment">      code.  At that point we cannot use mysql_bin_log.commit().</span></div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;<span class="comment">      Instead we release ownership using direct calls to</span></div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;<span class="comment">      gtid_state-&gt;release_anonymous_ownership() and</span></div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;<span class="comment">      thd-&gt;clear_owned_gtids() from binlog_cache_mngr::flush.</span></div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;<span class="comment">    - If GTID_NEXT=ANONYMOUS, anonymous ownership must be *preserved*</span></div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;<span class="comment">      between transactions within the statement, to prevent that a</span></div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;<span class="comment">      concurrent SET GTID_MODE=ON makes it impossible to log the</span></div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;<span class="comment">      statement. To avoid that ownership is released if</span></div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;<span class="comment">      mysql_bin_log.commit() is called, we set</span></div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;<span class="comment">      thd-&gt;is_commit_in_middle_of_statement before calling</span></div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;<span class="comment">      mysql_bin_log.commit.  Note that we must set this flag only if</span></div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;<span class="comment">      GTID_NEXT=ANONYMOUS, not if the transaction is anonymous when</span></div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;<span class="comment">      GTID_NEXT=AUTOMATIC and GTID_MODE=OFF.</span></div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;<span class="comment">      This works for all the special cases M1-M5 except M4.  When a</span></div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;<span class="comment">      statement writes non-transactional updates in the middle of a</span></div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;<span class="comment">      transaction, but keeps some transactional updates in the</span></div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;<span class="comment">      transaction cache, then it is not easy to know at the time of</span></div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="comment">      calling mysql_bin_log.commit() whether anonymous ownership needs</span></div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;<span class="comment">      to be preserved or not.  Instead, we directly check if the</span></div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;<span class="comment">      transaction cache is nonempty before releasing anonymous</span></div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;<span class="comment">      ownership inside Gtid_state::update_gtids_impl.</span></div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;<span class="comment">    - If GTID_NEXT=&#39;UUID:NUMBER&#39;, it is impossible to log a</span></div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;<span class="comment">      multi-transaction statement, since each GTID can only be used by</span></div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;<span class="comment">      one transaction. Therefore, an error must be generated in this</span></div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="comment">      case.  Errors are generated in different ways for the different</span></div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;<span class="comment">      statement types:</span></div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;<span class="comment">      - DROP TABLE: we can detect the situation before it happens,</span></div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;<span class="comment">        since the table type is known once the tables are opened. So</span></div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;<span class="comment">        we generate an error before even executing the statement.</span></div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;<span class="comment">      - DROP DATABASE: we can&#39;t detect the situation until it is too</span></div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;<span class="comment">        late; the tables have already been dropped and we cannot log</span></div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;<span class="comment">        anything meaningful.  So we don&#39;t log at all.</span></div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;<span class="comment">      - CREATE TABLE ... SELECT: this is not allowed when</span></div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="comment">        enforce_gtid_consistency is ON; the statement will be</span></div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;<span class="comment">        forbidden in is_ddl_gtid_compatible.</span></div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="comment">      - Statements that update both transactional and</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;<span class="comment">        non-transactional tables are disallowed when GTID_MODE=ON, so</span></div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;<span class="comment">        this normally does not happen. However, it can happen if the</span></div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;<span class="comment">        slave uses a different engine type than the master, so that a</span></div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;<span class="comment">        statement that updates InnoDB+InnoDB on master updates</span></div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="comment">        InnoDB+MyISAM on slave.  In this case the statement will be</span></div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;<span class="comment">        forbidden in is_dml_gtid_compatible and will not be allowed to</span></div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;<span class="comment">        execute.</span></div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;<span class="comment">      - CALL: the second statement will generate an error because</span></div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;<span class="comment">        GTID_NEXT is &#39;undefined&#39;.  Note that this situation can only</span></div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;<span class="comment">        happen if user does it on purpose: A CALL on master is logged</span></div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;<span class="comment">        as multiple statements, so a slave never executes CALL with</span></div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="comment">        GTID_NEXT=&#39;UUID:NUMBER&#39;.</span></div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;<span class="comment">    Finally, ownership release is suppressed in one more corner case:</span></div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;<span class="comment">    C1. Administration statements including OPTIMIZE TABLE, REPAIR</span></div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="comment">        TABLE, or ANALYZE TABLE are written to the binary log even if</span></div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;<span class="comment">        they fail.  This means that the thread first calls</span></div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;<span class="comment">        trans_rollack, and then writes the statement to the binlog.</span></div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;<span class="comment">        Rollback normally releases ownership.  But ownership must be</span></div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;<span class="comment">        kept until writing the binlog.  The solution is that these</span></div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;<span class="comment">        statements set thd-&gt;skip_gtid_rollback=true before calling</span></div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;<span class="comment">        trans_rollback, and Gtid_state::update_on_rollback does not</span></div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;<span class="comment">        release ownership if the flag is set.</span></div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;<span class="comment">    @todo It would probably be better to encapsulate this more, maybe</span></div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;<span class="comment">    use Gtid_specification instead of Gtid.</span></div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03397"></a><span class="lineno"><a class="line" href="classTHD.html#a0aeb3f9dc3bab17cf9a8fb14c04125ec"> 3397</a></span>&#160;  <a class="code" href="structGtid.html">Gtid</a> <a class="code" href="classTHD.html#a0aeb3f9dc3bab17cf9a8fb14c04125ec">owned_gtid</a>;</div><div class="line"><a name="l03398"></a><span class="lineno"><a class="line" href="classTHD.html#a18d5f472f13c600664363f3abd156949"> 3398</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> OWNED_SIDNO_GTID_SET = -1;</div><div class="line"><a name="l03399"></a><span class="lineno"><a class="line" href="classTHD.html#a44cb51d77130de8a44abaaa7c3497484"> 3399</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> OWNED_SIDNO_ANONYMOUS = -2;</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;<span class="comment">    For convenience, this contains the SID component of the GTID</span></div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;<span class="comment">    stored in owned_gtid.</span></div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03405"></a><span class="lineno"><a class="line" href="classTHD.html#a243f64d93ef80540453157679ec48abd"> 3405</a></span>&#160;  <a class="code" href="structbinary__log_1_1Uuid.html">rpl_sid</a> <a class="code" href="classTHD.html#a243f64d93ef80540453157679ec48abd">owned_sid</a>;</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;<span class="comment">  /** SE GTID persistence flag types. */</span></div><div class="line"><a name="l03408"></a><span class="lineno"><a class="line" href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78"> 3408</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78">Se_GTID_flag</a> : <span class="keywordtype">size_t</span> {<span class="comment"></span></div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;<span class="comment">    /** Pin owned GTID */</span></div><div class="line"><a name="l03410"></a><span class="lineno"><a class="line" href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78ae425027dd3a4507ea9d512ad7b2925b1"> 3410</a></span>&#160;    SE_GTID_PIN = 0,<span class="comment"></span></div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;<span class="comment">    /** Cleanup GTID during unpin. */</span></div><div class="line"><a name="l03412"></a><span class="lineno"><a class="line" href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78a5289929019913e5516e24b836306a61e"> 3412</a></span>&#160;    <a class="code" href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78a5289929019913e5516e24b836306a61e">SE_GTID_CLEANUP</a>,<span class="comment"></span></div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;<span class="comment">    /** SE would persist GTID for current transaction. */</span></div><div class="line"><a name="l03414"></a><span class="lineno"><a class="line" href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78a8695c6e72fc3ab7f000c1edbeb62f337"> 3414</a></span>&#160;    <a class="code" href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78a8695c6e72fc3ab7f000c1edbeb62f337">SE_GTID_PERSIST</a>,<span class="comment"></span></div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="comment">    /** If RESET log in progress. */</span></div><div class="line"><a name="l03416"></a><span class="lineno"><a class="line" href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78a3e0b5b7419f0ff0ae8925997a416cd03"> 3416</a></span>&#160;    <a class="code" href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78a3e0b5b7419f0ff0ae8925997a416cd03">SE_GTID_RESET_LOG</a>,<span class="comment"></span></div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<span class="comment">    /** Max element holding the biset size. */</span></div><div class="line"><a name="l03418"></a><span class="lineno"><a class="line" href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78ab2b50b3d9f9ecbb80a9782e80df9aa6d"> 3418</a></span>&#160;    SE_GTID_MAX</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;  };</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;</div><div class="line"><a name="l03421"></a><span class="lineno"><a class="line" href="classTHD.html#a20f10a73dcdd87a36f58d75a059fc564"> 3421</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classTHD.html#a20f10a73dcdd87a36f58d75a059fc564">Se_GTID_flagset</a> = std::bitset&lt;SE_GTID_MAX&gt;;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;<span class="comment">  /** Flags for SE GTID persistence. */</span></div><div class="line"><a name="l03424"></a><span class="lineno"><a class="line" href="classTHD.html#ac93312f3ed4c070c7e32af2d176ba947"> 3424</a></span>&#160;  <a class="code" href="classTHD.html#a20f10a73dcdd87a36f58d75a059fc564">Se_GTID_flagset</a> <a class="code" href="classTHD.html#ac93312f3ed4c070c7e32af2d176ba947">m_se_gtid_flags</a>;</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="comment">  /** Defer freeing owned GTID and SID till unpinned. */</span></div><div class="line"><a name="l03427"></a><span class="lineno"><a class="line" href="classTHD.html#aef8dbaa51c6bcceb123e63113433794f"> 3427</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#aef8dbaa51c6bcceb123e63113433794f">pin_gtid</a>() { m_se_gtid_flags.set(SE_GTID_PIN); }</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;<span class="comment">  /** Unpin and free GTID and SID. */</span></div><div class="line"><a name="l03430"></a><span class="lineno"><a class="line" href="classTHD.html#a2de87232795976fbc5f11214a2dde75a"> 3430</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a2de87232795976fbc5f11214a2dde75a">unpin_gtid</a>() {</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;    m_se_gtid_flags.reset(SE_GTID_PIN);</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;    <span class="comment">/* Do any deferred cleanup */</span></div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;    <span class="keywordflow">if</span> (m_se_gtid_flags[SE_GTID_CLEANUP]) {</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      clear_owned_gtids();</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;      m_se_gtid_flags.reset(SE_GTID_CLEANUP);</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;    }</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;  }</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;<span class="comment">  /** @return true, if single phase XA commit operation. */</span></div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;  <span class="keywordtype">bool</span> is_one_phase_commit();</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;<span class="comment">  /** Set when binlog reset operation is started. */</span></div><div class="line"><a name="l03443"></a><span class="lineno"><a class="line" href="classTHD.html#a946efa2cae945b26d8f3fa4588a49825"> 3443</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a946efa2cae945b26d8f3fa4588a49825">set_log_reset</a>() { m_se_gtid_flags.set(SE_GTID_RESET_LOG); }</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;<span class="comment">  /** Cleared after flushing SE logs during binlog reset. */</span></div><div class="line"><a name="l03446"></a><span class="lineno"><a class="line" href="classTHD.html#ac72854c006acf8b3f7bcd8836109bab6"> 3446</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ac72854c006acf8b3f7bcd8836109bab6">clear_log_reset</a>() { m_se_gtid_flags.reset(SE_GTID_RESET_LOG); }</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;<span class="comment">  /** @return true, if binlog reset operation. */</span></div><div class="line"><a name="l03449"></a><span class="lineno"><a class="line" href="classTHD.html#a234e4d45ceafcff8f49ace05c8c32ad5"> 3449</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a234e4d45ceafcff8f49ace05c8c32ad5">is_log_reset</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (m_se_gtid_flags[SE_GTID_RESET_LOG]); }</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;<span class="comment">  /** Set by SE when it guarantees GTID persistence. */</span></div><div class="line"><a name="l03452"></a><span class="lineno"><a class="line" href="classTHD.html#ae713d291ab580e907879e0eaeecc2a00"> 3452</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ae713d291ab580e907879e0eaeecc2a00">set_gtid_persisted_by_se</a>() { m_se_gtid_flags.set(SE_GTID_PERSIST); }</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;<span class="comment">  /** Reset by SE at transaction end after persisting GTID. */</span></div><div class="line"><a name="l03455"></a><span class="lineno"><a class="line" href="classTHD.html#a3baa9d83db0a55395cf59e4fa5ffdb47"> 3455</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a3baa9d83db0a55395cf59e4fa5ffdb47">reset_gtid_persisted_by_se</a>() { m_se_gtid_flags.reset(SE_GTID_PERSIST); }</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;<span class="comment">  /** @return true, if SE persists GTID for current transaction. */</span></div><div class="line"><a name="l03458"></a><span class="lineno"><a class="line" href="classTHD.html#aae19c409e4950cf0bfdcbebab48011e2"> 3458</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#aae19c409e4950cf0bfdcbebab48011e2">se_persists_gtid</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;    <a class="code" href="my__dbug_8h.html#a1f2d1168faa35ce15f1b058a5fe9c630">DBUG_EXECUTE_IF</a>(<span class="stringliteral">&quot;disable_se_persists_gtid&quot;</span>, <span class="keywordflow">return</span> (<span class="keyword">false</span>););</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <span class="keyword">auto</span> trx = get_transaction();</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    <span class="keyword">auto</span> xid_state = trx-&gt;xid_state();</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;    <span class="comment">/* XA transactions are always persisted by Innodb. */</span></div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    <span class="keywordflow">return</span> (!xid_state-&gt;has_state(<a class="code" href="classXID__STATE.html#a142676d46c9c5724d67ae56d8738f953a898a3b1cebc22df3e00a2f41304cee24">XID_STATE::XA_NOTR</a>) ||</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;            m_se_gtid_flags[SE_GTID_PERSIST]);</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;  }</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="preprocessor">#ifdef HAVE_GTID_NEXT_LIST</span></div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="comment">    If this thread owns a set of GTIDs (i.e., GTID_NEXT_LIST != NULL),</span></div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;<span class="comment">    then this member variable contains the subset of those GTIDs that</span></div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;<span class="comment">    are owned by this thread.</span></div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;  <a class="code" href="classGtid__set.html">Gtid_set</a> owned_gtid_set;</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;<span class="comment">   Replication related context.</span></div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;<span class="comment">   @todo: move more parts of replication related fields in THD to inside this</span></div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="comment">          class.</span></div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03482"></a><span class="lineno"><a class="line" href="classTHD.html#a05a7a0fa113b127dd7a20e849ded13ba"> 3482</a></span>&#160;  <a class="code" href="classRpl__thd__context.html">Rpl_thd_context</a> <a class="code" href="classTHD.html#a05a7a0fa113b127dd7a20e849ded13ba">rpl_thd_ctx</a>;</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;</div><div class="line"><a name="l03484"></a><span class="lineno"><a class="line" href="classTHD.html#ae88f48a487fbdb0c10b318728ce7251f"> 3484</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ae88f48a487fbdb0c10b318728ce7251f">clear_owned_gtids</a>() {</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;    <span class="comment">/* Defer GTID cleanup if pinned. Used for XA transactions where</span></div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;<span class="comment">    SE(Innodb) needs to read GTID. */</span></div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    <span class="keywordflow">if</span> (m_se_gtid_flags[SE_GTID_PIN]) {</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;      m_se_gtid_flags.set(SE_GTID_CLEANUP);</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    }</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    <span class="keywordflow">if</span> (owned_gtid.<a class="code" href="structGtid.html#aad81c0dd59ff02412e507d254c6843d2">sidno</a> == OWNED_SIDNO_GTID_SET) {</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="preprocessor">#ifdef HAVE_GTID_NEXT_LIST</span></div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;      owned_gtid_set.<a class="code" href="classGtid__set.html#a8d8130a7559cfd7b940f42e66c9b171a">clear</a>();</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;      <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(0);</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    }</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;    owned_gtid.<a class="code" href="structGtid.html#a459c77dd4b1918fa7760fa5b0588ce79">clear</a>();</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;    owned_sid.<a class="code" href="structbinary__log_1_1Uuid.html#abeb2fc1c0a321d5cc7275753170069ff">clear</a>();</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    owned_gtid.<a class="code" href="structGtid.html#a3ab329d122f4a333d20ee097156b5787">dbug_print</a>(<span class="keyword">nullptr</span>, <span class="stringliteral">&quot;set owned_gtid in clear_owned_gtids&quot;</span>);</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;  }</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="comment">  /** @return true, if owned GTID is empty or waiting for deferred cleanup. */</span></div><div class="line"><a name="l03504"></a><span class="lineno"><a class="line" href="classTHD.html#af9edac759d5b46b39cfeb95391b5dbe3"> 3504</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#af9edac759d5b46b39cfeb95391b5dbe3">owned_gtid_is_empty</a>() {</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;    <span class="keywordflow">if</span> (m_se_gtid_flags[SE_GTID_CLEANUP]) {</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;      <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    }</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;    <span class="keywordflow">return</span> (owned_gtid.<a class="code" href="structGtid.html#a36b73175b879388152c746453ee2b87a">is_empty</a>());</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;  }</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="comment">    There are some statements (like OPTIMIZE TABLE, ANALYZE TABLE and</span></div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="comment">    REPAIR TABLE) that might call trans_rollback_stmt() and also will be</span></div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;<span class="comment">    sucessfully executed and will have to go to the binary log.</span></div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="comment">    For these statements, the skip_gtid_rollback flag must be set to avoid</span></div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;<span class="comment">    problems when the statement is executed with a GTID_NEXT set to</span></div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;<span class="comment">    ASSIGNED_GTID (like the SQL thread do when applying events from other</span></div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;<span class="comment">    server). When this flag is set, a call to gtid_rollback() will do nothing.</span></div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03520"></a><span class="lineno"><a class="line" href="classTHD.html#a8cf26759b6f4cb27f4d583f220a974c2"> 3520</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a8cf26759b6f4cb27f4d583f220a974c2">skip_gtid_rollback</a>;</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;<span class="comment">    There are some statements (like DROP DATABASE that fails on rmdir</span></div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="comment">    and gets rewritten to multiple DROP TABLE statements) that may</span></div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;<span class="comment">    call trans_commit_stmt() before it has written all statements to</span></div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="comment">    the binlog.  When using GTID_NEXT = ANONYMOUS, such statements</span></div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="comment">    should not release ownership of the anonymous transaction until</span></div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;<span class="comment">    all statements have been written to the binlog.  To prevent that</span></div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="comment">    update_gtid_impl releases ownership, such statements must set this</span></div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment">    flag.</span></div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03531"></a><span class="lineno"><a class="line" href="classTHD.html#aeb4ab32a3c6fbacb94d4ef9372b445c6"> 3531</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#aeb4ab32a3c6fbacb94d4ef9372b445c6">is_commit_in_middle_of_statement</a>;</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;<span class="comment">    True while the transaction is executing, if one of</span></div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;<span class="comment">    is_ddl_gtid_consistent or is_dml_gtid_consistent returned false.</span></div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03537"></a><span class="lineno"><a class="line" href="classTHD.html#a03e2b2a18c968b3dee6e8f96b15ac781"> 3537</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a03e2b2a18c968b3dee6e8f96b15ac781">has_gtid_consistency_violation</a>;</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;</div><div class="line"><a name="l03539"></a><span class="lineno"><a class="line" href="classTHD.html#a42444c80d6289ae174d80b7c0d7b4436"> 3539</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> &amp;<a class="code" href="classTHD.html#a42444c80d6289ae174d80b7c0d7b4436">db</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_db; }</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="comment">    Set the current database; use deep copy of C-string.</span></div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;<span class="comment">    @param new_db     the new database name.</span></div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;<span class="comment">    Initialize the current database from a NULL-terminated string with</span></div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;<span class="comment">    length. If we run out of memory, we free the current database and</span></div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;<span class="comment">    return true.  This way the user will notice the error as there will be</span></div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;<span class="comment">    no current database selected (in addition to the error message set by</span></div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;<span class="comment">    malloc).</span></div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;<span class="comment">    @note This operation just sets {db, db_length}. Switching the current</span></div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;<span class="comment">    database usually involves other actions, like switching other database</span></div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;<span class="comment">    attributes including security context. In the future, this operation</span></div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;<span class="comment">    will be made private and more convenient interface will be provided.</span></div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;<span class="comment">    @return Operation status</span></div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;<span class="comment">      @retval false Success</span></div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;<span class="comment">      @retval true  Out-of-memory error</span></div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;  <span class="keywordtype">bool</span> set_db(<span class="keyword">const</span> <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> &amp;new_db);</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;<span class="comment">    Set the current database; use shallow copy of C-string.</span></div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;<span class="comment">    @param new_db     the new database name.</span></div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<span class="comment">    @note This operation just sets {db, db_length}. Switching the current</span></div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;<span class="comment">    database usually involves other actions, like switching other database</span></div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;<span class="comment">    attributes including security context. In the future, this operation</span></div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;<span class="comment">    will be made private and more convenient interface will be provided.</span></div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03573"></a><span class="lineno"><a class="line" href="classTHD.html#ac8a4198ecd3940d4888af6a6cc44479e"> 3573</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ac8a4198ecd3940d4888af6a6cc44479e">reset_db</a>(<span class="keyword">const</span> <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> &amp;new_db) {</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;    m_db.<a class="code" href="structMYSQL__LEX__CSTRING.html#a8ec5bb16b4275a6809163e00592b105d">str</a> = new_db.<a class="code" href="structMYSQL__LEX__CSTRING.html#a8ec5bb16b4275a6809163e00592b105d">str</a>;</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    m_db.<a class="code" href="structMYSQL__LEX__CSTRING.html#a8f240ebce8d7084b44bcffa514183dc8">length</a> = new_db.<a class="code" href="structMYSQL__LEX__CSTRING.html#a8f240ebce8d7084b44bcffa514183dc8">length</a>;</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;<span class="preprocessor">#ifdef HAVE_PSI_THREAD_INTERFACE</span></div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;    <a class="code" href="components_2services_2psi__thread_8h.html#a7625165f3bb767ea924946828d080dbb">PSI_THREAD_CALL</a>(set_thread_db)(new_db.<a class="code" href="structMYSQL__LEX__CSTRING.html#a8ec5bb16b4275a6809163e00592b105d">str</a>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(new_db.<a class="code" href="structMYSQL__LEX__CSTRING.html#a8f240ebce8d7084b44bcffa514183dc8">length</a>));</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;  }</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;<span class="comment">    Copy the current database to the argument. Use the current arena to</span></div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;<span class="comment">    allocate memory for a deep copy: current database may be freed after</span></div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;<span class="comment">    a statement is parsed but before it&#39;s executed.</span></div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03585"></a><span class="lineno"><a class="line" href="classTHD.html#aaf26e9c69d32816f07694237594e1162"> 3585</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#aaf26e9c69d32816f07694237594e1162">copy_db_to</a>(<span class="keywordtype">char</span> <span class="keyword">const</span> **p_db, <span class="keywordtype">size_t</span> *p_db_length)<span class="keyword"> const </span>{</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    <span class="keywordflow">if</span> (m_db.<a class="code" href="structMYSQL__LEX__CSTRING.html#a8ec5bb16b4275a6809163e00592b105d">str</a> == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;      <a class="code" href="group__MYSYS.html#ga19ebf963aef6b242322e15e01811972e">my_error</a>(ER_NO_DB_ERROR, <a class="code" href="test__mysql__runtime__error_8cc.html#ab3b3804e3bf2734c0f4f1c72f30df1bd">MYF</a>(0));</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    }</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    *p_db = <a class="code" href="m__string_8h.html#accb13dc1bbc754b77a9ecd9c3e832595">strmake</a>(m_db.<a class="code" href="structMYSQL__LEX__CSTRING.html#a8ec5bb16b4275a6809163e00592b105d">str</a>, m_db.<a class="code" href="structMYSQL__LEX__CSTRING.html#a8f240ebce8d7084b44bcffa514183dc8">length</a>);</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    *p_db_length = m_db.<a class="code" href="structMYSQL__LEX__CSTRING.html#a8f240ebce8d7084b44bcffa514183dc8">length</a>;</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;  }</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;</div><div class="line"><a name="l03595"></a><span class="lineno"><a class="line" href="classTHD.html#a3989c5c7c9961b4e950b5919a0823d2a"> 3595</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a3989c5c7c9961b4e950b5919a0823d2a">copy_db_to</a>(<span class="keywordtype">char</span> **p_db, <span class="keywordtype">size_t</span> *p_db_length)<span class="keyword"> const </span>{</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    <span class="keywordflow">return</span> copy_db_to(const_cast&lt;char const **&gt;(p_db), p_db_length);</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;  }</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;</div><div class="line"><a name="l03599"></a><span class="lineno"><a class="line" href="classTHD.html#a06d2be6c2ab3f3322da2f6890a6fdafc"> 3599</a></span>&#160;  <a class="code" href="classthd__scheduler.html">thd_scheduler</a> <a class="code" href="classTHD.html#a06d2be6c2ab3f3322da2f6890a6fdafc">scheduler</a>;</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;<span class="comment">    Get resource group context.</span></div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;<span class="comment">    @returns pointer to resource group context.</span></div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;</div><div class="line"><a name="l03607"></a><span class="lineno"><a class="line" href="classTHD.html#a5b9b6c54302faa029211ef0d14bd1c10"> 3607</a></span>&#160;  <a class="code" href="structresourcegroups_1_1Resource__group__ctx.html">resourcegroups::Resource_group_ctx</a> *<a class="code" href="classTHD.html#a5b9b6c54302faa029211ef0d14bd1c10">resource_group_ctx</a>() {</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    <span class="keywordflow">return</span> &amp;m_resource_group_ctx;</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  }</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;<span class="comment">    Save the performance schema thread instrumentation</span></div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;<span class="comment">    associated with this user session.</span></div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;<span class="comment">    @param psi Performance schema thread instrumentation</span></div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03617"></a><span class="lineno"><a class="line" href="classTHD.html#a1a7e86007b2717a2ebbbd3be630866d8"> 3617</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a1a7e86007b2717a2ebbbd3be630866d8">set_psi</a>(<a class="code" href="group__psi__abi__thread.html#ga2b98ed163438e5b60ff305f2bb143420">PSI_thread</a> *psi) { m_psi = psi; }</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;<span class="comment">    Read the performance schema thread instrumentation</span></div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;<span class="comment">    associated with this user session.</span></div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;<span class="comment">    This method is safe to use from a different thread.</span></div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03624"></a><span class="lineno"><a class="line" href="classTHD.html#a54d854b9856cf21470c1c8e758e7d33f"> 3624</a></span>&#160;  <a class="code" href="group__psi__abi__thread.html#ga2b98ed163438e5b60ff305f2bb143420">PSI_thread</a> *<a class="code" href="classTHD.html#a54d854b9856cf21470c1c8e758e7d33f">get_psi</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_psi; }</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;<span class="comment">    Performance schema thread instrumentation for this session.</span></div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;<span class="comment">    This member is maintained using atomic operations,</span></div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;<span class="comment">    do not access it directly.</span></div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;<span class="comment">    @sa set_psi</span></div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;<span class="comment">    @sa get_psi</span></div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03634"></a><span class="lineno"><a class="line" href="classTHD.html#a42f0c6d131002e0e52470aec17fc0339"> 3634</a></span>&#160;  std::atomic&lt;PSI_thread *&gt; <a class="code" href="classTHD.html#a42f0c6d131002e0e52470aec17fc0339">m_psi</a>;</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l03637"></a><span class="lineno"><a class="line" href="classTHD.html#a2780cf30cc4d26e35e135c4185f4cebd"> 3637</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classInternal__error__handler.html">Internal_error_handler</a> *<a class="code" href="classTHD.html#a2780cf30cc4d26e35e135c4185f4cebd">get_internal_handler</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;    <span class="keywordflow">return</span> m_internal_handler;</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;  }</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;<span class="comment">    Add an internal error handler to the thread execution context.</span></div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;<span class="comment">    @param handler the exception handler to add</span></div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;  <span class="keywordtype">void</span> push_internal_handler(<a class="code" href="classInternal__error__handler.html">Internal_error_handler</a> *<a class="code" href="classhandler.html">handler</a>);</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;<span class="comment">    Handle a sql condition.</span></div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;<span class="comment">    @param sql_errno the condition error number</span></div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;<span class="comment">    @param sqlstate the condition sqlstate</span></div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;<span class="comment">    @param level the condition level</span></div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;<span class="comment">    @param msg the condition message text</span></div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;<span class="comment">    @return true if the condition is handled</span></div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;  <span class="keywordtype">bool</span> handle_condition(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> sql_errno, <span class="keyword">const</span> <span class="keywordtype">char</span> *sqlstate,</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;                        <a class="code" href="classSql__condition.html#ab0602581e19cddb609bfe10c44be4e83">Sql_condition::enum_severity_level</a> *level,</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="test__sql__9__sessions_8cc.html#af6a786aadb2fc26d9c6d8dcb60c181f9">msg</a>);</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;<span class="comment">    Remove the error handler last pushed.</span></div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;  <a class="code" href="classInternal__error__handler.html">Internal_error_handler</a> *pop_internal_handler();</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;</div><div class="line"><a name="l03666"></a><span class="lineno"><a class="line" href="classTHD.html#a532f355531cd6c80a49920d7cedbb47e"> 3666</a></span>&#160;  <a class="code" href="classOpt__trace__context.html">Opt_trace_context</a> <a class="code" href="classTHD.html#a532f355531cd6c80a49920d7cedbb47e">opt_trace</a>;  <span class="comment">///&lt; optimizer trace of current statement</span></div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;<span class="comment"></span><span class="comment">  /**</span></div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;<span class="comment">    Raise an exception condition.</span></div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;<span class="comment">    @param code the MYSQL_ERRNO error code of the error</span></div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;  <span class="keywordtype">void</span> raise_error(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> code);</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;<span class="comment">    Raise an exception condition, with a formatted message.</span></div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;<span class="comment">    @param code the MYSQL_ERRNO error code of the error</span></div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;  <span class="keywordtype">void</span> raise_error_printf(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> code, ...);</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;<span class="comment">    Raise a completion condition (warning).</span></div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;<span class="comment">    @param code the MYSQL_ERRNO error code of the warning</span></div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;  <span class="keywordtype">void</span> raise_warning(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> code);</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;<span class="comment">    Raise a completion condition (warning), with a formatted message.</span></div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;<span class="comment">    @param code the MYSQL_ERRNO error code of the warning</span></div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;  <span class="keywordtype">void</span> raise_warning_printf(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> code, ...);</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;<span class="comment">    Raise a completion condition (note), with a fixed message.</span></div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;<span class="comment">    @param code the MYSQL_ERRNO error code of the note</span></div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;  <span class="keywordtype">void</span> raise_note(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> code);</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;<span class="comment">    Raise an completion condition (note), with a formatted message.</span></div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;<span class="comment">    @param code the MYSQL_ERRNO error code of the note</span></div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;  <span class="keywordtype">void</span> raise_note_printf(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> code, ...);</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;<span class="comment">    Only the implementation of the SIGNAL and RESIGNAL statements</span></div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;<span class="comment">    is permitted to raise SQL conditions in a generic way,</span></div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;<span class="comment">    or to raise them by bypassing handlers (RESIGNAL).</span></div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;<span class="comment">    To raise a SQL condition, the code should use the public</span></div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;<span class="comment">    raise_error() or raise_warning() methods provided by class THD.</span></div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03711"></a><span class="lineno"><a class="line" href="classTHD.html#a66b5162e2257930135f0a27713d5b39d"> 3711</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classSql__cmd__common__signal.html">Sql_cmd_common_signal</a>;</div><div class="line"><a name="l03712"></a><span class="lineno"><a class="line" href="classTHD.html#adc30903f21322b4b855010a1cbe8cff5"> 3712</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classSql__cmd__signal.html">Sql_cmd_signal</a>;</div><div class="line"><a name="l03713"></a><span class="lineno"><a class="line" href="classTHD.html#a8f16ac7fb80e5f7429f188c30d7cacc5"> 3713</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classSql__cmd__resignal.html">Sql_cmd_resignal</a>;</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;  <span class="keyword">friend</span> <span class="keywordtype">void</span> <a class="code" href="sql__error_8cc.html#a85b05343c7aaffd5cd9a2487feca6487">push_warning</a>(<a class="code" href="classTHD.html">THD</a> *thd,</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;                           <a class="code" href="classSql__condition.html#ab0602581e19cddb609bfe10c44be4e83">Sql_condition::enum_severity_level</a> severity,</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;                           <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> code, <span class="keyword">const</span> <span class="keywordtype">char</span> *message_text);</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;  <span class="keyword">friend</span> <span class="keywordtype">void</span> <a class="code" href="sql__class_8h.html#a18b65ea9518785d74749b5e323b41fb3">my_message_sql</a>(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <a class="code" href="my__inttypes_8h.html#a0db1f888c3bc329e7b0b340dbd41eb2b">myf</a>);</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;<span class="comment">    Raise a generic SQL condition. Also calls mysql_audit_notify() unless</span></div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;<span class="comment">    the condition is handled by a SQL condition handler.</span></div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;<span class="comment">    @param sql_errno the condition error number</span></div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;<span class="comment">    @param sqlstate the condition SQLSTATE</span></div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;<span class="comment">    @param level the condition level</span></div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;<span class="comment">    @param msg the condition message text</span></div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;<span class="comment">    @param fatal_error should the fatal_error flag be set?</span></div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;<span class="comment">    @return The condition raised, or NULL</span></div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;  <a class="code" href="classSql__condition.html">Sql_condition</a> *raise_condition(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> sql_errno, <span class="keyword">const</span> <span class="keywordtype">char</span> *sqlstate,</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;                                 <a class="code" href="classSql__condition.html#ab0602581e19cddb609bfe10c44be4e83">Sql_condition::enum_severity_level</a> level,</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *msg, <span class="keywordtype">bool</span> <a class="code" href="test-ssl_8cc.html#ad7ee63c4c1f8e982202cd22376853641">fatal_error</a> = <span class="keyword">false</span>);</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="mysql__config__editor_8cc.html#ab279a50ac7547100cf5ed7835314e534">set_command</a>(<span class="keyword">enum</span> <a class="code" href="my__command_8h.html#ae2ff1badf13d2b8099af8b47831281e1">enum_server_command</a> <a class="code" href="version__token_8cc.html#a9e0992eae3950adccaf4847fbff4231d">command</a>);</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;</div><div class="line"><a name="l03737"></a><span class="lineno"><a class="line" href="classTHD.html#a79acc868c5ed15c864f83a63f7a817b2"> 3737</a></span>&#160;  <span class="keyword">inline</span> <span class="keyword">enum</span> <a class="code" href="my__command_8h.html#ae2ff1badf13d2b8099af8b47831281e1">enum_server_command</a> get_command()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_command; }</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;<span class="comment">    For safe and protected access to the query string, the following</span></div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;<span class="comment">    rules should be followed:</span></div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;<span class="comment">    1: Only the owner (current_thd) can set the query string.</span></div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;<span class="comment">       This will be protected by LOCK_thd_query.</span></div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;<span class="comment">    2: The owner (current_thd) can read the query string without</span></div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;<span class="comment">       locking LOCK_thd_query.</span></div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;<span class="comment">    3: Other threads must lock LOCK_thd_query before reading</span></div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;<span class="comment">       the query string.</span></div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;<span class="comment">    This means that write-write conflicts are avoided by LOCK_thd_query.</span></div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;<span class="comment">    Read(by owner or other thread)-write(other thread) are disallowed.</span></div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;<span class="comment">    Read(other thread)-write(by owner) conflicts are avoided by LOCK_thd_query.</span></div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;<span class="comment">    Read(by owner)-write(by owner) won&#39;t happen as THD=thread.</span></div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;<span class="comment">    We want to keep current_thd out of header files, so the debug assert,</span></div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;<span class="comment">    is moved to the .cc file. In optimized mode, we want this getter to</span></div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;<span class="comment">    be fast, so we inline it.</span></div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;  <span class="keywordtype">void</span> debug_assert_query_locked() <span class="keyword">const</span>;</div><div class="line"><a name="l03759"></a><span class="lineno"><a class="line" href="classTHD.html#a6b4813e1dbb94c8c6094dd2780ddad4f"> 3759</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> &amp;<a class="code" href="classTHD.html#a6b4813e1dbb94c8c6094dd2780ddad4f">query</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;<span class="preprocessor">#ifndef DBUG_OFF</span></div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    debug_assert_query_locked();</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;    <span class="keywordflow">return</span> m_query_string;</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;  }</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;<span class="comment">    The current query in normalized form. The format is intended to be</span></div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;<span class="comment">    identical to the digest text of performance_schema, but not limited in</span></div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;<span class="comment">    size. In this case the parse tree is traversed as opposed to a (limited)</span></div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;<span class="comment">    token buffer. The string is allocated by this Statement and will be</span></div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;<span class="comment">    available until the next call to this function or this object is deleted.</span></div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;<span class="comment">    @note We have no protection against out-of-memory errors as this function</span></div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;<span class="comment">    relies on the Item::print() interface which does not propagate errors.</span></div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;<span class="comment">    @return The current query in normalized form.</span></div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;  <span class="keyword">const</span> <a class="code" href="classString.html">String</a> normalized_query();</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;<span class="comment">    Set query to be displayed in performance schema (threads table etc.).</span></div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03783"></a><span class="lineno"><a class="line" href="classTHD.html#a877cb79e120669859c6249c604740d71"> 3783</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a877cb79e120669859c6249c604740d71">set_query_for_display</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *query_arg MY_ATTRIBUTE((unused)),</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                             <span class="keywordtype">size_t</span> query_length_arg MY_ATTRIBUTE((unused))) {</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;    <span class="comment">// Set in pfs events statements table</span></div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;    <a class="code" href="group__psi__api__statement.html#ga18ef8810462384c22bd9224e290a7e7e">MYSQL_SET_STATEMENT_TEXT</a>(m_statement_psi, query_arg,</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;                             static_cast&lt;uint&gt;(query_length_arg));</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;<span class="preprocessor">#ifdef HAVE_PSI_THREAD_INTERFACE</span></div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;    <span class="comment">// Set in pfs threads table</span></div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;    <a class="code" href="components_2services_2psi__thread_8h.html#a7625165f3bb767ea924946828d080dbb">PSI_THREAD_CALL</a>(set_thread_info)</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;    (query_arg, <span class="keyword">static_cast&lt;</span><a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a><span class="keyword">&gt;</span>(query_length_arg));</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;  }</div><div class="line"><a name="l03794"></a><span class="lineno"><a class="line" href="classTHD.html#ada89e74e06af31a8b4e1f43d792c7083"> 3794</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ada89e74e06af31a8b4e1f43d792c7083">reset_query_for_display</a>(<span class="keywordtype">void</span>) { set_query_for_display(<span class="keyword">nullptr</span>, 0); }</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;<span class="comment">    Assign a new value to thd-&gt;m_query_string.</span></div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;<span class="comment">    Protected with the LOCK_thd_query mutex.</span></div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03800"></a><span class="lineno"><a class="line" href="classTHD.html#a1c09d48d6adc28360cc4d8ea16ae5e59"> 3800</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a1c09d48d6adc28360cc4d8ea16ae5e59">set_query</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *query_arg, <span class="keywordtype">size_t</span> query_length_arg) {</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;    <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> tmp = {query_arg, query_length_arg};</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;    set_query(tmp);</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;  }</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;  <span class="keywordtype">void</span> set_query(<a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> query_arg);</div><div class="line"><a name="l03805"></a><span class="lineno"><a class="line" href="classTHD.html#a41888d0827af3eec9d3dd736de490160"> 3805</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a41888d0827af3eec9d3dd736de490160">reset_query</a>() { set_query(<a class="code" href="lex__string_8h.html#a01c5da2ec635d24c374ba1a995dbe2aa">LEX_CSTRING</a>()); }</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<span class="comment">    Set the rewritten query (with passwords obfuscated etc.) on the THD.</span></div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;<span class="comment">    Wraps this in the LOCK_thd_query mutex to protect against race conditions</span></div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="comment">    with SHOW PROCESSLIST inspecting that string.</span></div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;<span class="comment">    This uses swap() and therefore &quot;steals&quot; the argument from the caller;</span></div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;<span class="comment">    the caller MUST take care not to try to use its own string after calling</span></div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;<span class="comment">    this function! This is an optimization for mysql_rewrite_query() so we</span></div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;<span class="comment">    don&#39;t copy its temporary string (which may get very long, up to</span></div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;<span class="comment">    @@max_allowed_packet).</span></div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;<span class="comment">    Using this outside of mysql_rewrite_query() is almost certainly wrong;</span></div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;<span class="comment">    please check with the runtime team!</span></div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="comment">    @param query_arg  The rewritten query to use for slow/bin/general logging.</span></div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;<span class="comment">                      The value will be released in the caller and MUST NOT</span></div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;<span class="comment">                      be used there after calling this function.</span></div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;  <span class="keywordtype">void</span> swap_rewritten_query(<a class="code" href="classString.html">String</a> &amp;query_arg);</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;<span class="comment">    Get the rewritten query (with passwords obfuscated etc.) from the THD.</span></div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;<span class="comment">    If done from a different thread (from the one that the rewritten_query</span></div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;<span class="comment">    is set on), the caller must hold LOCK_thd_query while calling this!</span></div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03832"></a><span class="lineno"><a class="line" href="classTHD.html#a47d4763fe18ce036fb8818b119f33172"> 3832</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classString.html">String</a> &amp;<a class="code" href="classTHD.html#a47d4763fe18ce036fb8818b119f33172">rewritten_query</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;<span class="preprocessor">#ifndef DBUG_OFF</span></div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="current__thd_8cc.html#a325e4fbea847aaf44935eb9784a607a4">current_thd</a> != <span class="keyword">this</span>) <a class="code" href="group__psi__api__mutex.html#gaccf61aa4a9e6108ac938a184d7b8efd7">mysql_mutex_assert_owner</a>(&amp;LOCK_thd_query);</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;    <span class="keywordflow">return</span> m_rewritten_query;</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;  }</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;<span class="comment">    Reset thd-&gt;m_rewritten_query. Protected with the LOCK_thd_query mutex.</span></div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l03842"></a><span class="lineno"><a class="line" href="classTHD.html#ae0ad60baeef524e7242c663c555aa732"> 3842</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ae0ad60baeef524e7242c663c555aa732">reset_rewritten_query</a>() {</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;    <span class="keywordflow">if</span> (rewritten_query().<a class="code" href="namespacegis.html#a1e3bf735dbe640151561b282f0f4dba5">length</a>()) {</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;      <a class="code" href="classString.html">String</a> empty;</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;      swap_rewritten_query(empty);</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;    }</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;  }</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;<span class="comment">    Assign a new value to thd-&gt;query_id.</span></div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;<span class="comment">    Protected with the LOCK_thd_data mutex.</span></div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03853"></a><span class="lineno"><a class="line" href="classTHD.html#a6a798662a9a4fac2fe127585da8f7ce3"> 3853</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a6a798662a9a4fac2fe127585da8f7ce3">set_query_id</a>(<a class="code" href="binlog_8h.html#a12a2cc906d37cadce17ce6455271a09a">query_id_t</a> new_query_id) {</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;    query_id = new_query_id;</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;    <a class="code" href="group__psi__api__statement.html#gaad7570a3e736bd188101f1be578a56ef">MYSQL_SET_STATEMENT_QUERY_ID</a>(m_statement_psi, new_query_id);</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;  }</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;<span class="comment">    Assign a new value to open_tables.</span></div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;<span class="comment">    Protected with the LOCK_thd_data mutex.</span></div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03864"></a><span class="lineno"><a class="line" href="classTHD.html#af984e3ca683e5a02c5ad0a21fa36a1ca"> 3864</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#af984e3ca683e5a02c5ad0a21fa36a1ca">set_open_tables</a>(<a class="code" href="structTABLE.html">TABLE</a> *open_tables_arg) {</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;    open_tables = open_tables_arg;</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;  }</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;<span class="comment">    Assign a new value to is_killable</span></div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;<span class="comment">    Protected with the LOCK_thd_data mutex.</span></div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03874"></a><span class="lineno"><a class="line" href="classTHD.html#a9fca8729a665c2aaee45127b3ae795d1"> 3874</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a9fca8729a665c2aaee45127b3ae795d1">set_is_killable</a>(<span class="keywordtype">bool</span> is_killable_arg) {</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;    is_killable = is_killable_arg;</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;    <a class="code" href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a>(&amp;LOCK_thd_data);</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;  }</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;</div><div class="line"><a name="l03880"></a><span class="lineno"><a class="line" href="classTHD.html#ae38008bbf02b7e5624a73ea2ec99493e"> 3880</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ae38008bbf02b7e5624a73ea2ec99493e">enter_locked_tables_mode</a>(<a class="code" href="locked__tables__list_8h.html#a77fee489173235058762d07e721b7476">enum_locked_tables_mode</a> mode_arg) {</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;    <a class="code" href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a>(locked_tables_mode == <a class="code" href="locked__tables__list_8h.html#a77fee489173235058762d07e721b7476ae592a6b4882bb655fe510aafbbcf0c48">LTM_NONE</a>);</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;    <span class="keywordflow">if</span> (mode_arg == <a class="code" href="locked__tables__list_8h.html#a77fee489173235058762d07e721b7476a39151d40394488df6591f568bc8f7ece">LTM_LOCK_TABLES</a>) {</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;<span class="comment">        When entering LOCK TABLES mode we should set explicit duration</span></div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;<span class="comment">        for all metadata locks acquired so far in order to avoid releasing</span></div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;<span class="comment">        them till UNLOCK TABLES statement.</span></div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;<span class="comment">        We don&#39;t do this when entering prelocked mode since sub-statements</span></div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;<span class="comment">        don&#39;t release metadata locks and restoring status-quo after leaving</span></div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;<span class="comment">        prelocking mode gets complicated.</span></div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;      mdl_context.<a class="code" href="classMDL__context.html#a357599f5af7c6ec7587ecb7b349f0313">set_explicit_duration_for_all_locks</a>();</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;    }</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;    locked_tables_mode = mode_arg;</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;  }</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;  <span class="keywordtype">void</span> leave_locked_tables_mode();</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;  <span class="keywordtype">int</span> decide_logging_format(<a class="code" href="structTABLE__LIST.html">TABLE_LIST</a> *tables);<span class="comment"></span></div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;<span class="comment">    is_dml_gtid_compatible() and is_ddl_gtid_compatible() check if the</span></div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;<span class="comment">    statement that is about to be processed will safely get a</span></div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;<span class="comment">    GTID. Currently, the following cases may lead to errors</span></div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;<span class="comment">    (e.g. duplicated GTIDs) and as such are forbidden:</span></div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;<span class="comment">     1. DML statements that mix non-transactional updates with</span></div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;<span class="comment">        transactional updates.</span></div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;<span class="comment">     2. Transactions that use non-transactional tables after</span></div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;<span class="comment">        having used transactional tables.</span></div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;<span class="comment">     3. CREATE...SELECT statement;</span></div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;<span class="comment">     4. CREATE TEMPORARY TABLE or DROP TEMPORARY TABLE within a</span></div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;<span class="comment">        transaction</span></div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;<span class="comment">    The first two conditions have to be checked in</span></div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;<span class="comment">    decide_logging_format, because that&#39;s where we know if the table</span></div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;<span class="comment">    is transactional or not.  These are implemented in</span></div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;<span class="comment">    is_dml_gtid_compatible().</span></div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;<span class="comment">    The third and fourth conditions have to be checked in</span></div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;<span class="comment">    mysql_execute_command because (1) that prevents implicit commit</span></div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;<span class="comment">    from being executed if the statement fails; (2) DROP TEMPORARY</span></div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;<span class="comment">    TABLE does not invoke decide_logging_format.  These are</span></div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;<span class="comment">    implemented in is_ddl_gtid_compatible().</span></div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;<span class="comment">    In the cases where GTID violations generate errors,</span></div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;<span class="comment">    is_ddl_gtid_compatible() needs to be called before the implicit</span></div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;<span class="comment">    pre-commit, so that there is no implicit commit if the statement</span></div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;<span class="comment">    fails.</span></div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;<span class="comment">    In the cases where GTID violations do not generate errors,</span></div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;<span class="comment">    is_ddl_gtid_compatible() needs to be called after the implicit</span></div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;<span class="comment">    pre-commit, because in these cases the function will increase the</span></div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;<span class="comment">    global counter automatic_gtid_violating_transaction_count or</span></div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;<span class="comment">    anonymous_gtid_violating_transaction_count.  If there is an</span></div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;<span class="comment">    ongoing transaction, the implicit commit will commit the</span></div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;<span class="comment">    transaction, which will call update_gtids_impl, which should</span></div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;<span class="comment">    decrease the counters depending on whether the *old* was violating</span></div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;<span class="comment">    GTID-consistency or not.  Thus, we should increase the counters</span></div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;<span class="comment">    only after the old transaction is committed.</span></div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;<span class="comment">    @param some_transactional_table true if the statement updates some</span></div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;<span class="comment">    transactional table; false otherwise.</span></div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;<span class="comment">    @param some_non_transactional_table true if the statement updates</span></div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;<span class="comment">    some non-transactional table; false otherwise.</span></div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;<span class="comment">    @param non_transactional_tables_are_tmp true if all updated</span></div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;<span class="comment">    non-transactional tables are temporary.</span></div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;<span class="comment">    @retval true if the statement is compatible;</span></div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;<span class="comment">    @retval false if the statement is not compatible.</span></div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;  <span class="keywordtype">bool</span> is_dml_gtid_compatible(<span class="keywordtype">bool</span> some_transactional_table,</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                              <span class="keywordtype">bool</span> some_non_transactional_table,</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;                              <span class="keywordtype">bool</span> non_transactional_tables_are_tmp);</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;  <span class="keywordtype">bool</span> is_ddl_gtid_compatible();</div><div class="line"><a name="l03959"></a><span class="lineno"><a class="line" href="classTHD.html#ae69035c8d6414f480a6a1da4361f955f"> 3959</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ae69035c8d6414f480a6a1da4361f955f">binlog_invoker</a>() { m_binlog_invoker = <span class="keyword">true</span>; }</div><div class="line"><a name="l03960"></a><span class="lineno"><a class="line" href="classTHD.html#a4de57314cf7ec1bb973b7fe82f62e1d4"> 3960</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a4de57314cf7ec1bb973b7fe82f62e1d4">need_binlog_invoker</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_binlog_invoker; }</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;  <span class="keywordtype">void</span> get_definer(<a class="code" href="structLEX__USER.html">LEX_USER</a> *definer);</div><div class="line"><a name="l03962"></a><span class="lineno"><a class="line" href="classTHD.html#a2967d1c32ec25ed3055eb941717196da"> 3962</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a2967d1c32ec25ed3055eb941717196da">set_invoker</a>(<span class="keyword">const</span> <a class="code" href="structMYSQL__LEX__STRING.html">LEX_STRING</a> *<a class="code" href="mysqladmin_8cc.html#a14871705f45ccdc5bb9f4549efd8e119">user</a>, <span class="keyword">const</span> <a class="code" href="structMYSQL__LEX__STRING.html">LEX_STRING</a> *<a class="code" href="mysqladmin_8cc.html#ae032e164f1daa754d6fbb79d59723931">host</a>) {</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;    m_invoker_user.str = user-&gt;<a class="code" href="structMYSQL__LEX__STRING.html#a87e83f941e25558be1e4b44a04a438be">str</a>;</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;    m_invoker_user.length = user-&gt;<a class="code" href="structMYSQL__LEX__STRING.html#adc0f5b45a80690636b88ca4866bfc557">length</a>;</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;    m_invoker_host.str = host-&gt;<a class="code" href="structMYSQL__LEX__STRING.html#a87e83f941e25558be1e4b44a04a438be">str</a>;</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;    m_invoker_host.length = host-&gt;<a class="code" href="structMYSQL__LEX__STRING.html#adc0f5b45a80690636b88ca4866bfc557">length</a>;</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;  }</div><div class="line"><a name="l03968"></a><span class="lineno"><a class="line" href="classTHD.html#a5f5f158243d5fb2d6bacdbc5372a1d21"> 3968</a></span>&#160;  <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> <a class="code" href="classTHD.html#a5f5f158243d5fb2d6bacdbc5372a1d21">get_invoker_user</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_invoker_user; }</div><div class="line"><a name="l03969"></a><span class="lineno"><a class="line" href="classTHD.html#aa5bd3959377c9e18f18cc4bf0614547b"> 3969</a></span>&#160;  <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> <a class="code" href="classTHD.html#aa5bd3959377c9e18f18cc4bf0614547b">get_invoker_host</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_invoker_host; }</div><div class="line"><a name="l03970"></a><span class="lineno"><a class="line" href="classTHD.html#a2fb33f56f032d09f529786907cb8c204"> 3970</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a2fb33f56f032d09f529786907cb8c204">has_invoker</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_invoker_user.str != <span class="keyword">nullptr</span>; }</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;  <span class="keywordtype">void</span> mark_transaction_to_rollback(<span class="keywordtype">bool</span> <a class="code" href="xcom__transport_8cc.html#a2ca19ac59047f1b932b7737dac46b7b8">all</a>);</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;<span class="comment">  /** The current internal error handler for this thread, or NULL. */</span></div><div class="line"><a name="l03976"></a><span class="lineno"><a class="line" href="classTHD.html#aa998d677a348f716a6c4ff24a8b06da0"> 3976</a></span>&#160;  <a class="code" href="classInternal__error__handler.html">Internal_error_handler</a> *<a class="code" href="classTHD.html#aa998d677a348f716a6c4ff24a8b06da0">m_internal_handler</a>;</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;<span class="comment">    This memory root is used for two purposes:</span></div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;<span class="comment">    - for conventional queries, to allocate structures stored in main_lex</span></div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;<span class="comment">    during parsing, and allocate runtime data (execution plan, etc.)</span></div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;<span class="comment">    during execution.</span></div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;<span class="comment">    - for prepared queries, only to allocate runtime data. The parsed</span></div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;<span class="comment">    tree itself is reused between executions and thus is stored elsewhere.</span></div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l03986"></a><span class="lineno"><a class="line" href="classTHD.html#ae7a84550105a38cec599aa5c07621b7b"> 3986</a></span>&#160;  <a class="code" href="structMEM__ROOT.html">MEM_ROOT</a> <a class="code" href="classTHD.html#ae7a84550105a38cec599aa5c07621b7b">main_mem_root</a>;</div><div class="line"><a name="l03987"></a><span class="lineno"><a class="line" href="classTHD.html#a26f0a6e5db9eb66cfddc6b416f62e171"> 3987</a></span>&#160;  <a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> <a class="code" href="classTHD.html#a26f0a6e5db9eb66cfddc6b416f62e171">main_da</a>;</div><div class="line"><a name="l03988"></a><span class="lineno"><a class="line" href="classTHD.html#aee1e2078ec88057e4363bdbcac847243"> 3988</a></span>&#160;  <a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> <a class="code" href="classTHD.html#aee1e2078ec88057e4363bdbcac847243">m_parser_da</a>; <span class="comment">/**&lt; cf. get_parser_da() */</span></div><div class="line"><a name="l03989"></a><span class="lineno"><a class="line" href="classTHD.html#a0b7b9bcbe2362eb25727541e66cf22dd"> 3989</a></span>&#160;  <a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> <a class="code" href="classTHD.html#a0b7b9bcbe2362eb25727541e66cf22dd">m_query_rewrite_plugin_da</a>;</div><div class="line"><a name="l03990"></a><span class="lineno"><a class="line" href="classTHD.html#a7316fb38d263971ebbf17f493a698d87"> 3990</a></span>&#160;  <a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> *<a class="code" href="classTHD.html#a7316fb38d263971ebbf17f493a698d87">m_query_rewrite_plugin_da_ptr</a>;</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;</div><div class="line"><a name="l03992"></a><span class="lineno"><a class="line" href="classTHD.html#a9d1ed780b584f0c95f714ad6d1dde9a5"> 3992</a></span>&#160;  <a class="code" href="classDiagnostics__area.html">Diagnostics_area</a> *<a class="code" href="classTHD.html#a9d1ed780b584f0c95f714ad6d1dde9a5">m_stmt_da</a>;</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;<span class="comment">    It will be set TURE if CURRENT_USER() is called in account management</span></div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;<span class="comment">    statements or default definer is set in CREATE/ALTER SP, SF, Event,</span></div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;<span class="comment">    TRIGGER or VIEW statements.</span></div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;<span class="comment">    Current user will be binlogged into Query_log_event if current_user_used</span></div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;<span class="comment">    is true; It will be stored into m_invoker_host and m_invoker_user by SQL</span></div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;<span class="comment">    thread.</span></div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l04003"></a><span class="lineno"><a class="line" href="classTHD.html#a2d34ad426d05c99fb8dd404caccc1f3c"> 4003</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a2d34ad426d05c99fb8dd404caccc1f3c">m_binlog_invoker</a>;</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;<span class="comment">    It points to the invoker in the Query_log_event.</span></div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;<span class="comment">    SQL thread use it as the default definer in CREATE/ALTER SP, SF, Event,</span></div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;<span class="comment">    TRIGGER or VIEW statements or current user in account management</span></div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;<span class="comment">    statements if it is not NULL.</span></div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l04011"></a><span class="lineno"><a class="line" href="classTHD.html#a4af42194393272f3f676225e519e7ade"> 4011</a></span>&#160;  <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> <a class="code" href="classTHD.html#a4af42194393272f3f676225e519e7ade">m_invoker_user</a>;</div><div class="line"><a name="l04012"></a><span class="lineno"><a class="line" href="classTHD.html#a28d9ac07105667219fee7134affb0e89"> 4012</a></span>&#160;  <a class="code" href="structMYSQL__LEX__CSTRING.html">LEX_CSTRING</a> <a class="code" href="classTHD.html#a28d9ac07105667219fee7134affb0e89">m_invoker_host</a>;</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;</div><div class="line"><a name="l04014"></a><span class="lineno"><a class="line" href="classTHD.html#a6b36c51a3ab7fcb6f3a629cf61ebbb94"> 4014</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classProtocol__classic.html">Protocol_classic</a>;</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;<span class="comment">    Optimizer cost model for server operations.</span></div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04020"></a><span class="lineno"><a class="line" href="classTHD.html#a3ddf49eb172ad90d10abf305922b673c"> 4020</a></span>&#160;  <a class="code" href="classCost__model__server.html">Cost_model_server</a> <a class="code" href="classTHD.html#a3ddf49eb172ad90d10abf305922b673c">m_cost_model</a>;</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;<span class="comment">    Initialize the optimizer cost model.</span></div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;<span class="comment">    This function should be called each time a new query is started.</span></div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04028"></a><span class="lineno"><a class="line" href="classTHD.html#a1f9021d85e0ba76b4c30e0fb58f00b17"> 4028</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a1f9021d85e0ba76b4c30e0fb58f00b17">init_cost_model</a>() { m_cost_model.<a class="code" href="classCost__model__server.html#a267c97e430cec8665c0c62ad722d80c1">init</a>(); }</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;<span class="comment">    Retrieve the optimizer cost model for this connection.</span></div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04033"></a><span class="lineno"><a class="line" href="classTHD.html#a76abf5318f8258b540891ddaf80fb86a"> 4033</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classCost__model__server.html">Cost_model_server</a> *<a class="code" href="classTHD.html#a76abf5318f8258b540891ddaf80fb86a">cost_model</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> &amp;m_cost_model; }</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;</div><div class="line"><a name="l04035"></a><span class="lineno"><a class="line" href="classTHD.html#a6acd53435ad4bb82b8cfdcef9ab34667"> 4035</a></span>&#160;  <a class="code" href="classSession__tracker.html">Session_tracker</a> <a class="code" href="classTHD.html#a6acd53435ad4bb82b8cfdcef9ab34667">session_tracker</a>;</div><div class="line"><a name="l04036"></a><span class="lineno"><a class="line" href="classTHD.html#a5d80b04327477810a2248a8cf2c70649"> 4036</a></span>&#160;  <a class="code" href="classSession__sysvar__resource__manager.html">Session_sysvar_resource_manager</a> <a class="code" href="classTHD.html#a5d80b04327477810a2248a8cf2c70649">session_sysvar_res_mgr</a>;</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;</div><div class="line"><a name="l04038"></a><span class="lineno"><a class="line" href="classTHD.html#a82bcaeca2e4a33c70382b4af2c81c091"> 4038</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a82bcaeca2e4a33c70382b4af2c81c091">syntax_error</a>() { <a class="code" href="classTHD.html#a82bcaeca2e4a33c70382b4af2c81c091">syntax_error</a>(ER_SYNTAX_ERROR); }</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;  <span class="keywordtype">void</span> syntax_error(<span class="keyword">const</span> <span class="keywordtype">char</span> *format, ...)</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;      MY_ATTRIBUTE((format(printf, 2, 3)));</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;  <span class="keywordtype">void</span> syntax_error(<span class="keywordtype">int</span> <a class="code" href="mysql_8h.html#a11a4321c550a74672fe26f02996efa3f">mysql_errno</a>, ...);</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;</div><div class="line"><a name="l04043"></a><span class="lineno"><a class="line" href="classTHD.html#a2152377ce84a056334207e43a93b1be8"> 4043</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a2152377ce84a056334207e43a93b1be8">syntax_error_at</a>(<span class="keyword">const</span> <a class="code" href="structYYLTYPE.html">YYLTYPE</a> &amp;location) {</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;    syntax_error_at(location, ER_SYNTAX_ERROR);</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;  }</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;  <span class="keywordtype">void</span> syntax_error_at(<span class="keyword">const</span> <a class="code" href="structYYLTYPE.html">YYLTYPE</a> &amp;location, <span class="keyword">const</span> <span class="keywordtype">char</span> *format, ...)</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;      MY_ATTRIBUTE((format(printf, 3, 4)));</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;  <span class="keywordtype">void</span> syntax_error_at(<span class="keyword">const</span> <a class="code" href="structYYLTYPE.html">YYLTYPE</a> &amp;location, <span class="keywordtype">int</span> mysql_errno, ...);</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;  <span class="keywordtype">void</span> vsyntax_error_at(<span class="keyword">const</span> <a class="code" href="structYYLTYPE.html">YYLTYPE</a> &amp;location, <span class="keyword">const</span> <span class="keywordtype">char</span> *format,</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;                        va_list args) MY_ATTRIBUTE((format(printf, 3, 0)));</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;  <span class="keywordtype">void</span> vsyntax_error_at(<span class="keyword">const</span> <span class="keywordtype">char</span> *pos_in_lexer_raw_buffer, <span class="keyword">const</span> <span class="keywordtype">char</span> *format,</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;                        va_list args) MY_ATTRIBUTE((format(printf, 3, 0)));</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;<span class="comment">    Send name and type of result to client.</span></div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;<span class="comment">    Sum fields has table name empty and field_name.</span></div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;<span class="comment">    @param list         List of items to send to client</span></div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;<span class="comment">    @param flags        Bit mask with the following functions:</span></div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;<span class="comment">                          - 1 send number of rows</span></div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;<span class="comment">                          - 2 send default values</span></div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;<span class="comment">                          - 4 don&#39;t write eof packet</span></div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;<span class="comment">    @retval</span></div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;<span class="comment">      false ok</span></div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;<span class="comment">    @retval</span></div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;<span class="comment">      true Error  (Note that in this case the error is not sent to the client)</span></div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;  <span class="keywordtype">bool</span> send_result_metadata(<span class="keyword">const</span> <a class="code" href="classmem__root__deque.html">mem_root_deque&lt;Item *&gt;</a> &amp;<a class="code" href="test__udf__registration_8cc.html#a96e3cff2f3e1d8eda47115215d03ff32">list</a>, <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="hp__test1_8cc.html#a6eec09a91807e20d7b3d6ef3da594067">flags</a>);</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;<span class="comment">    Send one result set row.</span></div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;<span class="comment">    @param row_items a collection of column values for that row</span></div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;<span class="comment">    @return Error status.</span></div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;<span class="comment">    @retval true  Error.</span></div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;<span class="comment">    @retval false Success.</span></div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;  <span class="keywordtype">bool</span> send_result_set_row(<span class="keyword">const</span> <a class="code" href="classmem__root__deque.html">mem_root_deque&lt;Item *&gt;</a> &amp;row_items);</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;<span class="comment">    Send the status of the current statement execution over network.</span></div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;<span class="comment">    In MySQL, there are two types of SQL statements: those that return</span></div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="comment">    a result set and those that return status information only.</span></div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;<span class="comment">    If a statement returns a result set, it consists of 3 parts:</span></div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;<span class="comment">    - result set meta-data</span></div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;<span class="comment">    - variable number of result set rows (can be 0)</span></div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;<span class="comment">    - followed and terminated by EOF or ERROR packet</span></div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;<span class="comment">    Once the  client has seen the meta-data information, it always</span></div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;<span class="comment">    expects an EOF or ERROR to terminate the result set. If ERROR is</span></div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;<span class="comment">    received, the result set rows are normally discarded (this is up</span></div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="comment">    to the client implementation, libmysql at least does discard them).</span></div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="comment">    EOF, on the contrary, means &quot;successfully evaluated the entire</span></div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;<span class="comment">    result set&quot;. Since we don&#39;t know how many rows belong to a result</span></div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;<span class="comment">    set until it&#39;s evaluated, EOF/ERROR is the indicator of the end</span></div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;<span class="comment">    of the row stream. Note, that we can not buffer result set rows</span></div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;<span class="comment">    on the server -- there may be an arbitrary number of rows. But</span></div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;<span class="comment">    we do buffer the last packet (EOF/ERROR) in the Diagnostics_area and</span></div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;<span class="comment">    delay sending it till the very end of execution (here), to be able to</span></div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;<span class="comment">    change EOF to an ERROR if commit failed or some other error occurred</span></div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;<span class="comment">    during the last cleanup steps taken after execution.</span></div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;<span class="comment">    A statement that does not return a result set doesn&#39;t send result</span></div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;<span class="comment">    set meta-data either. Instead it returns one of:</span></div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;<span class="comment">    - OK packet</span></div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;<span class="comment">    - ERROR packet.</span></div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;<span class="comment">    Similarly to the EOF/ERROR of the previous statement type, OK/ERROR</span></div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<span class="comment">    packet is &quot;buffered&quot; in the Diagnostics Area and sent to the client</span></div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="comment">    in the end of statement.</span></div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;<span class="comment">    @note This method defines a template, but delegates actual</span></div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="comment">    sending of data to virtual Protocol::send_{ok,eof,error}. This</span></div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="comment">    allows for implementation of protocols that &quot;intercept&quot; ok/eof/error</span></div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="comment">    messages, and store them in memory, etc, instead of sending to</span></div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="comment">    the client.</span></div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;<span class="comment">    @pre  The Diagnostics Area is assigned or disabled. It can not be empty</span></div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;<span class="comment">          -- we assume that every SQL statement or COM_* command</span></div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;<span class="comment">          generates OK, ERROR, or EOF status.</span></div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;<span class="comment">    @post The status information is encoded to protocol format and sent to the</span></div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;<span class="comment">          client.</span></div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;<span class="comment">    @return We conventionally return void, since the only type of error</span></div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;<span class="comment">            that can happen here is a NET (transport) error, and that one</span></div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;<span class="comment">            will become visible when we attempt to read from the NET the</span></div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;<span class="comment">            next command.</span></div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;<span class="comment">            Diagnostics_area::is_sent is set for debugging purposes only.</span></div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;  <span class="keywordtype">void</span> send_statement_status();</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;<span class="comment">    This is only used by master dump threads.</span></div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;<span class="comment">    When the master receives a new connection from a slave with a</span></div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;<span class="comment">    UUID (for slave versions &gt;= 5.6)/server_id(for slave versions &lt; 5.6)</span></div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;<span class="comment">    that is already connected, it will set this flag true</span></div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;<span class="comment">    before killing the old slave connection.</span></div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04148"></a><span class="lineno"><a class="line" href="classTHD.html#adfed2fbb66bc9b415c128595352116bc"> 4148</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#adfed2fbb66bc9b415c128595352116bc">duplicate_slave_id</a>;</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;<span class="comment">    Claim all the memory used by the THD object.</span></div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="comment">    This method is to keep memory instrumentation statistics</span></div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;<span class="comment">    updated, when an object is transfered across threads.</span></div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classProtocol__classic.html#a10fdce232a6ecc82034400107b443712">claim_memory_ownership</a>(<span class="keywordtype">bool</span> claim);</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;</div><div class="line"><a name="l04157"></a><span class="lineno"><a class="line" href="classTHD.html#a112d8a7987b227066823714538d74a3e"> 4157</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a112d8a7987b227066823714538d74a3e">is_a_srv_session</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> is_a_srv_session_thd; }</div><div class="line"><a name="l04158"></a><span class="lineno"><a class="line" href="classTHD.html#ae773b651f12e538da8ebd724c5b91245"> 4158</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#ae773b651f12e538da8ebd724c5b91245">mark_as_srv_session</a>() { is_a_srv_session_thd = <span class="keyword">true</span>; }</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;<span class="comment">    Returns the plugin, the thd belongs to.</span></div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;<span class="comment">    @return pointer to the plugin id</span></div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l04164"></a><span class="lineno"><a class="line" href="classTHD.html#a67c3161454007ae2761d80ab368b0bb0"> 4164</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structst__plugin__int.html">st_plugin_int</a> *<a class="code" href="classTHD.html#a67c3161454007ae2761d80ab368b0bb0">get_plugin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_plugin; }<span class="comment"></span></div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;<span class="comment">    Sets the plugin id to the value provided as parameter</span></div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;<span class="comment">    @param plugin the id of the plugin the thd belongs to</span></div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l04169"></a><span class="lineno"><a class="line" href="classTHD.html#a7fc76fb03b82258ff8f8ac377e72071d"> 4169</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a7fc76fb03b82258ff8f8ac377e72071d">set_plugin</a>(<span class="keyword">const</span> <a class="code" href="structst__plugin__int.html">st_plugin_int</a> *<a class="code" href="test__services__host__application__signal_8cc.html#a49308eac63cac1d140bf78a2ee88dbd0">plugin</a>) { m_plugin = <a class="code" href="test__services__host__application__signal_8cc.html#a49308eac63cac1d140bf78a2ee88dbd0">plugin</a>; }</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;<span class="preprocessor">#ifndef DBUG_OFF</span></div><div class="line"><a name="l04171"></a><span class="lineno"><a class="line" href="classTHD.html#aafdc0d63105f0e703d0b73872acdab10"> 4171</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#aafdc0d63105f0e703d0b73872acdab10">get_tmp_table_seq_id</a>() { <span class="keywordflow">return</span> tmp_table_seq_id++; }</div><div class="line"><a name="l04172"></a><span class="lineno"><a class="line" href="classTHD.html#a80f35f27e3aa29d3599ed02ee87f3dc0"> 4172</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a80f35f27e3aa29d3599ed02ee87f3dc0">set_tmp_table_seq_id</a>(<a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> arg) { tmp_table_seq_id = arg; }</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;</div><div class="line"><a name="l04175"></a><span class="lineno"><a class="line" href="classTHD.html#af079816a2418d2ec626e059f4c615346"> 4175</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#af079816a2418d2ec626e059f4c615346">is_plugin_fake_ddl</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_is_plugin_fake_ddl; }</div><div class="line"><a name="l04176"></a><span class="lineno"><a class="line" href="classTHD.html#abfd91c1bcac40e4db5e4679b7240e737"> 4176</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#abfd91c1bcac40e4db5e4679b7240e737">mark_plugin_fake_ddl</a>(<span class="keywordtype">bool</span> <a class="code" href="hp__test1_8cc.html#adf916204820072417ed73a32de1cefcf">flag</a>) { m_is_plugin_fake_ddl = <a class="code" href="hp__test1_8cc.html#adf916204820072417ed73a32de1cefcf">flag</a>; }</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;<span class="comment">    Variable to mark if the object is part of a Srv_session object, which</span></div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;<span class="comment">    aggregates THD.</span></div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04183"></a><span class="lineno"><a class="line" href="classTHD.html#a58905b9435ffe4cfc198026068014b59"> 4183</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a58905b9435ffe4cfc198026068014b59">is_a_srv_session_thd</a>;</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;<span class="comment">  /// Stores the plugin id it is attached to (if any).</span></div><div class="line"><a name="l04186"></a><span class="lineno"><a class="line" href="classTHD.html#a2aef15dd169e2a721893f116b28e0fd6"> 4186</a></span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="structst__plugin__int.html">st_plugin_int</a> *m_plugin{<span class="keyword">nullptr</span>};</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;<span class="comment">    Creating or dropping plugin native table through a plugin service.</span></div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;<span class="comment">    This variable enables the DDL command execution from</span></div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;<span class="comment">    dd::create_native_table() to be executed without committing the</span></div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;<span class="comment">    transaction.</span></div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04194"></a><span class="lineno"><a class="line" href="classTHD.html#ad79b2ca158056d58bd48d2bc583fccf2"> 4194</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#ad79b2ca158056d58bd48d2bc583fccf2">m_is_plugin_fake_ddl</a>;</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;<span class="preprocessor">#ifndef DBUG_OFF</span></div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;<span class="comment">    Sequential number of internal tmp table created in the statement. Useful for</span></div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;<span class="comment">    tracking tmp tables when number of them is involved in a query.</span></div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04201"></a><span class="lineno"><a class="line" href="classTHD.html#ac2ef222abca3ee61f63b2240a56c5c2d"> 4201</a></span>&#160;  <a class="code" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code" href="classTHD.html#ac2ef222abca3ee61f63b2240a56c5c2d">tmp_table_seq_id</a>;</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;<span class="comment">    The member serves to guard against duplicate use of the same xid</span></div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;<span class="comment">    at binary logging.</span></div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04208"></a><span class="lineno"><a class="line" href="classTHD.html#a297a1b6b0e8bcf34f5b96f1485c522eb"> 4208</a></span>&#160;  <a class="code" href="structxid__t.html">XID</a> <a class="code" href="classTHD.html#a297a1b6b0e8bcf34f5b96f1485c522eb">debug_binlog_xid_last</a>;</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;<span class="comment">    Flag set by my_write before waiting for disk space.</span></div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;<span class="comment">    This is used by replication to decide if the I/O thread should be</span></div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;<span class="comment">    killed or not when stopping the replication threads.</span></div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;<span class="comment">    In ordinary STOP SLAVE case, the I/O thread will wait for disk space</span></div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;<span class="comment">    or to be killed regardless of this flag value.</span></div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;<span class="comment">    In server shutdown case, if this flag is true, the I/O thread will be</span></div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;<span class="comment">    signaled with KILL_CONNECTION to abort the waiting, letting the server</span></div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;<span class="comment">    to shutdown promptly.</span></div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04224"></a><span class="lineno"><a class="line" href="classTHD.html#a77a50d0be4824e52ac50b3b861a585d1"> 4224</a></span>&#160;  <span class="keywordtype">bool</span> waiting_for_disk_space = <span class="keyword">false</span>;</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;<span class="comment">    Set the waiting_for_disk_space flag.</span></div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;<span class="comment">    @param waiting The value to set in the flag.</span></div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04232"></a><span class="lineno"><a class="line" href="classTHD.html#a60b0ad63f84dcdef1f343fa2a2a490c4"> 4232</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a60b0ad63f84dcdef1f343fa2a2a490c4">set_waiting_for_disk_space</a>(<span class="keywordtype">bool</span> waiting) {</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;    waiting_for_disk_space = waiting;</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;  }<span class="comment"></span></div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;<span class="comment">    Returns the current waiting_for_disk_space flag value.</span></div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04238"></a><span class="lineno"><a class="line" href="classTHD.html#a26860f9fc54dc0ead94c402b81e42f91"> 4238</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a26860f9fc54dc0ead94c402b81e42f91">is_waiting_for_disk_space</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> waiting_for_disk_space; }</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;  <span class="keywordtype">bool</span> sql_parser();</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;<span class="comment">  /// Enables or disables use of secondary storage engines in this session.</span></div><div class="line"><a name="l04243"></a><span class="lineno"><a class="line" href="classTHD.html#acaa9e7e4d2d89e2428a3df881486fec4"> 4243</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classTHD.html#acaa9e7e4d2d89e2428a3df881486fec4">set_secondary_engine_optimization</a>(<a class="code" href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56e">Secondary_engine_optimization</a> state) {</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;    m_secondary_engine_optimization = state;</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;  }</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;<span class="comment">    Can secondary storage engines be used for query execution in</span></div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;<span class="comment">    this session?</span></div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04251"></a><span class="lineno"><a class="line" href="classTHD.html#aab99a7bbf58663e13dbee4b225939f09"> 4251</a></span>&#160;  <a class="code" href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56e">Secondary_engine_optimization</a> <a class="code" href="classTHD.html#aab99a7bbf58663e13dbee4b225939f09">secondary_engine_optimization</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;    <span class="keywordflow">return</span> m_secondary_engine_optimization;</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;  }</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;<span class="comment">    Checks if queries in this session can use a secondary storage engine for</span></div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;<span class="comment">    execution. A secondary engine cannot be used if any of the following</span></div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;<span class="comment">    conditions is true:</span></div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;<span class="comment">    - Secondary engines are disabled in the session</span></div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;<span class="comment">    - The user has disabled secondary engines</span></div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;<span class="comment">    - LOCK TABLES mode is active</span></div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;<span class="comment">    - Multi-statement transaction mode is active</span></div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;<span class="comment">    - It is a sub-statement of a stored procedure</span></div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;<span class="comment">    @return true if secondary storage engines can be used in this</span></div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;<span class="comment">    session, or false otherwise</span></div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;  <span class="keywordtype">bool</span> secondary_storage_engine_eligible() <span class="keyword">const</span>;</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;<span class="comment">    This flag tells if a secondary storage engine can be used to</span></div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;<span class="comment">    execute a query in this session.</span></div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04276"></a><span class="lineno"><a class="line" href="classTHD.html#a0e21b51262fc367e961b108e9b64d901"> 4276</a></span>&#160;  <a class="code" href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56e">Secondary_engine_optimization</a> m_secondary_engine_optimization =</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;      <a class="code" href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56eaa11a38b780db1a59973d7f3a270ce2aa">Secondary_engine_optimization::PRIMARY_ONLY</a>;</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;  <span class="keywordtype">void</span> cleanup_after_parse_error();<span class="comment"></span></div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;<span class="comment">    Flag that indicates if the user of current session has SYSTEM_USER privilege</span></div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l04283"></a><span class="lineno"><a class="line" href="classTHD.html#a09fd20ad9db99e403694e30723b3bf1f"> 4283</a></span>&#160;  std::atomic&lt;bool&gt; <a class="code" href="classTHD.html#a09fd20ad9db99e403694e30723b3bf1f">m_is_system_user</a>;</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;  <span class="keywordtype">bool</span> is_system_user();</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;  <span class="keywordtype">void</span> set_system_user(<span class="keywordtype">bool</span> system_user_flag);</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;</div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l04290"></a><span class="lineno"><a class="line" href="classTHD.html#adf0c2d55e25bc9370c36d1078417655e"> 4290</a></span>&#160;  <a class="code" href="classTransactional__ddl__context.html">Transactional_ddl_context</a> m_transactional_ddl{<span class="keyword">this</span>};</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;};</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;<span class="comment">   Return lock_tables_mode for secondary engine.</span></div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;<span class="comment">   @param cthd thread context</span></div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;<span class="comment">   @retval true if lock_tables_mode is on</span></div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;<span class="comment">   @retval false, otherwise</span></div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04299"></a><span class="lineno"><a class="line" href="sql__class_8h.html#af22efe9532622d3aaf1f4627274faad4"> 4299</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="sql__class_8h.html#af22efe9532622d3aaf1f4627274faad4">secondary_engine_lock_tables_mode</a>(<span class="keyword">const</span> <a class="code" href="classTHD.html">THD</a> &amp;cthd) {</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;  <span class="keywordflow">return</span> (cthd.<a class="code" href="classOpen__tables__state.html#acccde8a1d2a6789f8a7240921fcafd6c">locked_tables_mode</a> == <a class="code" href="locked__tables__list_8h.html#a77fee489173235058762d07e721b7476a39151d40394488df6591f568bc8f7ece">LTM_LOCK_TABLES</a> ||</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;          cthd.<a class="code" href="classOpen__tables__state.html#acccde8a1d2a6789f8a7240921fcafd6c">locked_tables_mode</a> == <a class="code" href="locked__tables__list_8h.html#a77fee489173235058762d07e721b7476ad2caca3ff1da0a1f34ec5ff0d1b213d7">LTM_PRELOCKED_UNDER_LOCK_TABLES</a>);</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;}</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;<span class="comment">/** A short cut for thd-&gt;get_stmt_da()-&gt;set_ok_status(). */</span></div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;<span class="keywordtype">void</span> <a class="code" href="sql__class_8h.html#a9232eb995dd70b888477a3ac014adb29">my_ok</a>(<a class="code" href="classTHD.html">THD</a> *thd, <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> affected_rows = 0, <a class="code" href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a> <span class="keywordtype">id</span> = 0,</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;           <span class="keyword">const</span> <span class="keywordtype">char</span> *message = <span class="keyword">nullptr</span>);</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;<span class="comment">/** A short cut for thd-&gt;get_stmt_da()-&gt;set_eof_status(). */</span></div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;<span class="keywordtype">void</span> <a class="code" href="sql__class_8h.html#a1b02d78838864ccf5d568330c2aea5d2">my_eof</a>(<a class="code" href="classTHD.html">THD</a> *thd);</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="sql__class_8h.html#a54bb1ac8c34d138b5dd4e51aa92c688d">add_item_to_list</a>(<a class="code" href="classTHD.html">THD</a> *thd, <a class="code" href="classItem.html">Item</a> *item);</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;<span class="comment">/*************************************************************************/</span></div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;<span class="comment">  The function re-attaches the engine ha_data (which was previously detached by</span></div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;<span class="comment">  detach_ha_data_from_thd) to THD.</span></div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;<span class="comment">  This is typically done to replication applier executing</span></div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;<span class="comment">  one of XA-PREPARE, XA-COMMIT ONE PHASE or rollback.</span></div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;<span class="comment">  @param thd         thread context</span></div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;<span class="comment">  @param hton        pointer to handlerton</span></div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;<span class="keywordtype">void</span> <a class="code" href="sql__class_8h.html#ae11fef08ce7b1572e20d634d0e3325b5">reattach_engine_ha_data_to_thd</a>(<a class="code" href="classTHD.html">THD</a> *thd, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structhandlerton.html">handlerton</a> *hton);</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;<span class="comment">  Check if engine substitution is allowed in the current thread context.</span></div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;<span class="comment">  @param thd         thread context</span></div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;<span class="comment">  @retval            true if engine substitution is allowed</span></div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;<span class="comment">  @retval            false otherwise</span></div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;</div><div class="line"><a name="l04335"></a><span class="lineno"><a class="line" href="sql__class_8h.html#a80f2c09692315ed4bb6273501e6d29f5"> 4335</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="sql__class_8h.html#a80f2c09692315ed4bb6273501e6d29f5">is_engine_substitution_allowed</a>(<span class="keyword">const</span> <a class="code" href="classTHD.html">THD</a> *thd) {</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;  <span class="keywordflow">return</span> !(thd-&gt;<a class="code" href="classTHD.html#ace66d6d175889b62f3260264cfac216a">variables</a>.<a class="code" href="structSystem__variables.html#a9529275c4402abcfa8f27d0b98d2063f">sql_mode</a> &amp; <a class="code" href="system__variables_8h.html#ac89cf8001a738e813ab027f75adc9f2b">MODE_NO_ENGINE_SUBSTITUTION</a>);</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;}</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;<span class="comment">  Returns if the user of the session has the SYSTEM_USER privilege or not.</span></div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;<span class="comment">  @retval true  User has SYSTEM_USER privilege</span></div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;<span class="comment">  @retval false Otherwise</span></div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l04345"></a><span class="lineno"><a class="line" href="classTHD.html#a87bd76207e6a1e87c2821b51b34030ef"> 4345</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classTHD.html#a87bd76207e6a1e87c2821b51b34030ef">THD::is_system_user</a>() {</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;  <span class="keywordflow">return</span> m_is_system_user.load(std::memory_order_seq_cst);</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;}</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;<span class="comment">  Sets the system_user flag atomically for the current session.</span></div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;<span class="comment">  @param [in] system_user_flag  boolean flag that indicates value to set.</span></div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l04354"></a><span class="lineno"><a class="line" href="classTHD.html#a5bfef16ee415d9f45a2f28a0c63e5516"> 4354</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classTHD.html#a5bfef16ee415d9f45a2f28a0c63e5516">THD::set_system_user</a>(<span class="keywordtype">bool</span> system_user_flag) {</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;  m_is_system_user.store(system_user_flag, std::memory_order_seq_cst);</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;}</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SQL_CLASS_INCLUDED */</span><span class="preprocessor"></span></div><div class="ttc" id="classTHD_html_a3fde14709d1dd755050cde00400e1ea0"><div class="ttname"><a href="classTHD.html#a3fde14709d1dd755050cde00400e1ea0">THD::double_value</a></div><div class="ttdeci">double double_value</div><div class="ttdef"><b>Definition:</b> sql_class.h:2498</div></div>
<div class="ttc" id="classTHD_html_a2829d63cff897bc79c91d372ad5e29f4"><div class="ttname"><a href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4">THD::enum_binlog_query_type</a></div><div class="ttdeci">enum_binlog_query_type</div><div class="ttdef"><b>Definition:</b> sql_class.h:2660</div></div>
<div class="ttc" id="group__group__cs__shutdown__kill__constants_html_gga06133bb686f1030c73086378cab8d27bae76eb4d20fb50e864e6b84a956c2f843"><div class="ttname"><a href="group__group__cs__shutdown__kill__constants.html#gga06133bb686f1030c73086378cab8d27bae76eb4d20fb50e864e6b84a956c2f843">KILL_CONNECTION</a></div><div class="ttdoc">Connection level of the KILL command. </div><div class="ttdef"><b>Definition:</b> mysql_com.h:973</div></div>
<div class="ttc" id="classTHD_html_a812eba45c251221a8a3e0cf9450c7cf2"><div class="ttname"><a href="classTHD.html#a812eba45c251221a8a3e0cf9450c7cf2">THD::stmt_depends_on_first_successful_insert_id_in_prev_stmt</a></div><div class="ttdeci">bool stmt_depends_on_first_successful_insert_id_in_prev_stmt</div><div class="ttdef"><b>Definition:</b> sql_class.h:1916</div></div>
<div class="ttc" id="sql__class_8h_html_af22efe9532622d3aaf1f4627274faad4"><div class="ttname"><a href="sql__class_8h.html#af22efe9532622d3aaf1f4627274faad4">secondary_engine_lock_tables_mode</a></div><div class="ttdeci">bool secondary_engine_lock_tables_mode(const THD &amp;cthd)</div><div class="ttdoc">Return lock_tables_mode for secondary engine. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4299</div></div>
<div class="ttc" id="group__psi__abi_html_ga0a3b1290ecc0e31cb8a6e4e5402b6f18"><div class="ttname"><a href="group__psi__abi.html#ga0a3b1290ecc0e31cb8a6e4e5402b6f18">PSI_INSTRUMENT_ME</a></div><div class="ttdeci">static constexpr unsigned PSI_INSTRUMENT_ME</div><div class="ttdef"><b>Definition:</b> psi_base.h:44</div></div>
<div class="ttc" id="structst__plugin__int_html"><div class="ttname"><a href="structst__plugin__int.html">st_plugin_int</a></div><div class="ttdef"><b>Definition:</b> sql_plugin_ref.h:44</div></div>
<div class="ttc" id="classTHD_html_a9fca8729a665c2aaee45127b3ae795d1"><div class="ttname"><a href="classTHD.html#a9fca8729a665c2aaee45127b3ae795d1">THD::set_is_killable</a></div><div class="ttdeci">void set_is_killable(bool is_killable_arg)</div><div class="ttdoc">Assign a new value to is_killable Protected with the LOCK_thd_data mutex. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3874</div></div>
<div class="ttc" id="structresult_html"><div class="ttname"><a href="structresult.html">result</a></div><div class="ttdef"><b>Definition:</b> result.h:29</div></div>
<div class="ttc" id="violite_8h_html_aea8851f79253c53aede5ec790c65d572"><div class="ttname"><a href="violite_8h.html#aea8851f79253c53aede5ec790c65d572">SSL_handle</a></div><div class="ttdeci">#define SSL_handle</div><div class="ttdef"><b>Definition:</b> violite.h:445</div></div>
<div class="ttc" id="classTHD_html_a4de57314cf7ec1bb973b7fe82f62e1d4"><div class="ttname"><a href="classTHD.html#a4de57314cf7ec1bb973b7fe82f62e1d4">THD::need_binlog_invoker</a></div><div class="ttdeci">bool need_binlog_invoker() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3960</div></div>
<div class="ttc" id="query__options_8h_html_af3ef29bb91e9565fd2e313f2816b4355"><div class="ttname"><a href="query__options_8h.html#af3ef29bb91e9565fd2e313f2816b4355">OPTION_BEGIN</a></div><div class="ttdeci">#define OPTION_BEGIN</div><div class="ttdef"><b>Definition:</b> query_options.h:74</div></div>
<div class="ttc" id="my__inttypes_8h_html_a22152088aba12c47e916b7f0ffee0f51"><div class="ttname"><a href="my__inttypes_8h.html#a22152088aba12c47e916b7f0ffee0f51">ulonglong</a></div><div class="ttdeci">unsigned long long int ulonglong</div><div class="ttdef"><b>Definition:</b> my_inttypes.h:55</div></div>
<div class="ttc" id="classTHD_html_a376ffc6c7396ce30002addf504ddd331"><div class="ttname"><a href="classTHD.html#a376ffc6c7396ce30002addf504ddd331">THD::real_id</a></div><div class="ttdeci">my_thread_t real_id</div><div class="ttdef"><b>Definition:</b> sql_class.h:2191</div></div>
<div class="ttc" id="my__thread__local_8h_html"><div class="ttname"><a href="my__thread__local_8h.html">my_thread_local.h</a></div></div>
<div class="ttc" id="structSystem__variables_html"><div class="ttname"><a href="structSystem__variables.html">System_variables</a></div><div class="ttdef"><b>Definition:</b> system_variables.h:174</div></div>
<div class="ttc" id="group__MYSYS_html_ga3c52003b570b762bc82527771487a305"><div class="ttname"><a href="group__MYSYS.html#ga3c52003b570b762bc82527771487a305">memdup_root</a></div><div class="ttdeci">void * memdup_root(MEM_ROOT *root, const void *str, size_t len)</div><div class="ttdef"><b>Definition:</b> my_alloc.cc:268</div></div>
<div class="ttc" id="classpartition__info_html"><div class="ttname"><a href="classpartition__info.html">partition_info</a></div><div class="ttdef"><b>Definition:</b> partition_info.h:208</div></div>
<div class="ttc" id="classMDL__ticket_html"><div class="ttname"><a href="classMDL__ticket.html">MDL_ticket</a></div><div class="ttdoc">A granted metadata lock. </div><div class="ttdef"><b>Definition:</b> mdl.h:965</div></div>
<div class="ttc" id="classQuery__arena_html_ad3d9dcdae4be8fe97434af23ec52cecc"><div class="ttname"><a href="classQuery__arena.html#ad3d9dcdae4be8fe97434af23ec52cecc">Query_arena::is_stmt_prepare_or_first_sp_execute</a></div><div class="ttdeci">bool is_stmt_prepare_or_first_sp_execute() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:291</div></div>
<div class="ttc" id="psi_2mysql__mutex_8h_html"><div class="ttname"><a href="psi_2mysql__mutex_8h.html">mysql_mutex.h</a></div><div class="ttdoc">Instrumentation helpers for mutexes. </div></div>
<div class="ttc" id="my__table__map_8h_html"><div class="ttname"><a href="my__table__map_8h.html">my_table_map.h</a></div></div>
<div class="ttc" id="group__Locking_html_ga94fe72a2ec087e3457aafd2a1911dc60"><div class="ttname"><a href="group__Locking.html#ga94fe72a2ec087e3457aafd2a1911dc60">Global_read_lock::m_atomic_active_requests</a></div><div class="ttdeci">static std::atomic&lt; int32 &gt; m_atomic_active_requests</div><div class="ttdef"><b>Definition:</b> sql_class.h:743</div></div>
<div class="ttc" id="classTHD_html_ac3b669eb637e00446c2248701ce6e927"><div class="ttname"><a href="classTHD.html#ac3b669eb637e00446c2248701ce6e927">THD::user_var_events_alloc</a></div><div class="ttdeci">MEM_ROOT * user_var_events_alloc</div><div class="ttdef"><b>Definition:</b> sql_class.h:2296</div></div>
<div class="ttc" id="classTHD_html_a6c976f8f022417df827670e90d919da7"><div class="ttname"><a href="classTHD.html#a6c976f8f022417df827670e90d919da7">THD::enable_slow_log</a></div><div class="ttdeci">bool enable_slow_log</div><div class="ttdef"><b>Definition:</b> sql_class.h:2472</div></div>
<div class="ttc" id="my__inttypes_8h_html_a65f85814a8290f9797005d3b28e7e5fc"><div class="ttname"><a href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a></div><div class="ttdeci">unsigned char uchar</div><div class="ttdef"><b>Definition:</b> my_inttypes.h:51</div></div>
<div class="ttc" id="structMYSQL__LEX__STRING_html_a87e83f941e25558be1e4b44a04a438be"><div class="ttname"><a href="structMYSQL__LEX__STRING.html#a87e83f941e25558be1e4b44a04a438be">MYSQL_LEX_STRING::str</a></div><div class="ttdeci">char * str</div><div class="ttdef"><b>Definition:</b> mysql_lex_string.h:35</div></div>
<div class="ttc" id="sql__string_8h_html"><div class="ttname"><a href="sql__string_8h.html">sql_string.h</a></div><div class="ttdoc">Our own string classes, used pervasively throughout the executor. </div></div>
<div class="ttc" id="classTHD_html_ace4dd3359d802d88be920471d65b2ec1"><div class="ttname"><a href="classTHD.html#ace4dd3359d802d88be920471d65b2ec1">THD::in_multi_stmt_transaction_mode</a></div><div class="ttdeci">bool in_multi_stmt_transaction_mode() const</div><div class="ttdoc">Returns true if session is in a multi-statement transaction mode. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2818</div></div>
<div class="ttc" id="classTHD_html_a121f1ddee2f3c663bd68f3d859c0b98b"><div class="ttname"><a href="classTHD.html#a121f1ddee2f3c663bd68f3d859c0b98b">THD::clear_binlog_table_maps</a></div><div class="ttdeci">void clear_binlog_table_maps()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1647</div></div>
<div class="ttc" id="classTHD_html_a95686cf0c1182e013d9423db326b7892"><div class="ttname"><a href="classTHD.html#a95686cf0c1182e013d9423db326b7892">THD::is_slave_error</a></div><div class="ttdeci">bool is_slave_error</div><div class="ttdoc">True if a slave error. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2462</div></div>
<div class="ttc" id="classTHD_html_a4bb5d57ac2b0ff5fd4041cb4ac38a5d4"><div class="ttname"><a href="classTHD.html#a4bb5d57ac2b0ff5fd4041cb4ac38a5d4">THD::reset_binlog_local_stmt_filter</a></div><div class="ttdeci">void reset_binlog_local_stmt_filter()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1542</div></div>
<div class="ttc" id="classTHD_html_af4cbdda1c4ce71d589429534b8297fe3"><div class="ttname"><a href="classTHD.html#af4cbdda1c4ce71d589429534b8297fe3">THD::tmp_table</a></div><div class="ttdeci">uint tmp_table</div><div class="ttdef"><b>Definition:</b> sql_class.h:2212</div></div>
<div class="ttc" id="classTHD_html_a9c3c62ef19781a3beb4e38541a7ca32d"><div class="ttname"><a href="classTHD.html#a9c3c62ef19781a3beb4e38541a7ca32d">THD::LOCK_thd_protocol</a></div><div class="ttdeci">mysql_mutex_t LOCK_thd_protocol</div><div class="ttdoc">Protects THD::m_protocol when it gets removed in x plugin. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1060</div></div>
<div class="ttc" id="classTHD_html_ae38008bbf02b7e5624a73ea2ec99493e"><div class="ttname"><a href="classTHD.html#ae38008bbf02b7e5624a73ea2ec99493e">THD::enter_locked_tables_mode</a></div><div class="ttdeci">void enter_locked_tables_mode(enum_locked_tables_mode mode_arg)</div><div class="ttdef"><b>Definition:</b> sql_class.h:3880</div></div>
<div class="ttc" id="node__connection_8h_html_ac81c8c488b37932224b37520e063ea83"><div class="ttname"><a href="node__connection_8h.html#ac81c8c488b37932224b37520e063ea83">is_connected</a></div><div class="ttdeci">static int is_connected(connection_descriptor *con)</div><div class="ttdef"><b>Definition:</b> node_connection.h:74</div></div>
<div class="ttc" id="classSub__statement__state_html_a66e7075e6515d6711d3d4f57a5621f1d"><div class="ttname"><a href="classSub__statement__state.html#a66e7075e6515d6711d3d4f57a5621f1d">Sub_statement_state::sent_row_count</a></div><div class="ttdeci">ha_rows sent_row_count</div><div class="ttdef"><b>Definition:</b> sql_class.h:623</div></div>
<div class="ttc" id="classTHD_1_1Attachable__trx_html_a475be4429ac336c26e6d397073bb9b95"><div class="ttname"><a href="classTHD_1_1Attachable__trx.html#a475be4429ac336c26e6d397073bb9b95">THD::Attachable_trx::m_trx_state</a></div><div class="ttdeci">Transaction_state m_trx_state</div><div class="ttdoc">Transaction state data. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1759</div></div>
<div class="ttc" id="test-ssl_8cc_html_ad7ee63c4c1f8e982202cd22376853641"><div class="ttname"><a href="test-ssl_8cc.html#ad7ee63c4c1f8e982202cd22376853641">fatal_error</a></div><div class="ttdeci">void fatal_error(const char *r)</div><div class="ttdef"><b>Definition:</b> test-ssl.cc:40</div></div>
<div class="ttc" id="classTHD_html_af51413ab3ce883addff226fa9603ab12a7e76c1f9b8f6b4a65ddf8039d02eef49"><div class="ttname"><a href="classTHD.html#af51413ab3ce883addff226fa9603ab12a7e76c1f9b8f6b4a65ddf8039d02eef49">THD::CE_SYNC_ERROR</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:2373</div></div>
<div class="ttc" id="system__variables_8h_html_acd03be4982af89757ca0317f3d73d0bc"><div class="ttname"><a href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bc">enum_binlog_format</a></div><div class="ttdeci">enum_binlog_format</div><div class="ttdef"><b>Definition:</b> system_variables.h:44</div></div>
<div class="ttc" id="classTHD_html_ad52e81c7674fe28c61cf204a03bafb2e"><div class="ttname"><a href="classTHD.html#ad52e81c7674fe28c61cf204a03bafb2e">THD::m_security_ctx</a></div><div class="ttdeci">Security_context * m_security_ctx</div><div class="ttdef"><b>Definition:</b> sql_class.h:1115</div></div>
<div class="ttc" id="sql__class_8h_html_a80f2c09692315ed4bb6273501e6d29f5"><div class="ttname"><a href="sql__class_8h.html#a80f2c09692315ed4bb6273501e6d29f5">is_engine_substitution_allowed</a></div><div class="ttdeci">bool is_engine_substitution_allowed(const THD *thd)</div><div class="ttdoc">Check if engine substitution is allowed in the current thread context. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4335</div></div>
<div class="ttc" id="classTHD_html_a30a1cef179fd744cca1fca66e4c35a67"><div class="ttname"><a href="classTHD.html#a30a1cef179fd744cca1fca66e4c35a67">THD::is_error</a></div><div class="ttdeci">bool is_error() const</div><div class="ttdoc">true if there is an error in the error stack. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2908</div></div>
<div class="ttc" id="classTHD_html_a52d5774258fd38d6a434953ee94915e0"><div class="ttname"><a href="classTHD.html#a52d5774258fd38d6a434953ee94915e0">THD::long_value</a></div><div class="ttdeci">long long_value</div><div class="ttdef"><b>Definition:</b> sql_class.h:2495</div></div>
<div class="ttc" id="mysqladmin_8cc_html_a14871705f45ccdc5bb9f4549efd8e119"><div class="ttname"><a href="mysqladmin_8cc.html#a14871705f45ccdc5bb9f4549efd8e119">user</a></div><div class="ttdeci">char * user</div><div class="ttdef"><b>Definition:</b> mysqladmin.cc:59</div></div>
<div class="ttc" id="components_2services_2psi__thread_8h_html_a7625165f3bb767ea924946828d080dbb"><div class="ttname"><a href="components_2services_2psi__thread_8h.html#a7625165f3bb767ea924946828d080dbb">PSI_THREAD_CALL</a></div><div class="ttdeci">#define PSI_THREAD_CALL(M)</div><div class="ttdef"><b>Definition:</b> psi_thread.h:35</div></div>
<div class="ttc" id="classTHD_html_a5f5f158243d5fb2d6bacdbc5372a1d21"><div class="ttname"><a href="classTHD.html#a5f5f158243d5fb2d6bacdbc5372a1d21">THD::get_invoker_user</a></div><div class="ttdeci">LEX_CSTRING get_invoker_user() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3968</div></div>
<div class="ttc" id="classPrepared__statement_html"><div class="ttname"><a href="classPrepared__statement.html">Prepared_statement</a></div><div class="ttdoc">Prepared_statement: a statement that can contain placeholders. </div><div class="ttdef"><b>Definition:</b> sql_prepare.h:320</div></div>
<div class="ttc" id="structMYSQL__LEX__STRING_html"><div class="ttname"><a href="structMYSQL__LEX__STRING.html">MYSQL_LEX_STRING</a></div><div class="ttdef"><b>Definition:</b> mysql_lex_string.h:34</div></div>
<div class="ttc" id="template__utils_8h_html_abaa3204566f2da1d5876a24eb4f0e5cd"><div class="ttname"><a href="template__utils_8h.html#abaa3204566f2da1d5876a24eb4f0e5cd">pointer_cast</a></div><div class="ttdeci">T pointer_cast(void *p)</div><div class="ttdoc">Casts from one pointer type, to another, without using reinterpret_cast or C-style cast: foo f; bar *...</div><div class="ttdef"><b>Definition:</b> template_utils.h:73</div></div>
<div class="ttc" id="classOpen__tables__state_html"><div class="ttname"><a href="classOpen__tables__state.html">Open_tables_state</a></div><div class="ttdoc">Class that holds information about tables which were opened and locked by the thread. </div><div class="ttdef"><b>Definition:</b> sql_class.h:429</div></div>
<div class="ttc" id="classcollation__unordered__map_html"><div class="ttname"><a href="classcollation__unordered__map.html">collation_unordered_map</a></div><div class="ttdoc">std::unordered_map, but with my_malloc and collation-aware comparison. </div><div class="ttdef"><b>Definition:</b> map_helpers.h:236</div></div>
<div class="ttc" id="classTHD_html_a3caf0d8f3abc4f1fcf34d330263d9b75"><div class="ttname"><a href="classTHD.html#a3caf0d8f3abc4f1fcf34d330263d9b75">THD::m_user_connect</a></div><div class="ttdeci">USER_CONN * m_user_connect</div><div class="ttdef"><b>Definition:</b> sql_class.h:2099</div></div>
<div class="ttc" id="classTHD_html_a897accff2c6929a400f95a1156d7d106"><div class="ttname"><a href="classTHD.html#a897accff2c6929a400f95a1156d7d106">THD::force_one_auto_inc_interval</a></div><div class="ttdeci">void force_one_auto_inc_interval(ulonglong next_id)</div><div class="ttdef"><b>Definition:</b> sql_class.h:1996</div></div>
<div class="ttc" id="classTHD_html_aa509977e70035eb587af42bb49f9ba2c"><div class="ttname"><a href="classTHD.html#aa509977e70035eb587af42bb49f9ba2c">THD::where</a></div><div class="ttdeci">const char * where</div><div class="ttdef"><b>Definition:</b> sql_class.h:1286</div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html_a28a4e3b14be2ea2e7916a05a2fe60f9f"><div class="ttname"><a href="classTHD_1_1Query__plan.html#a28a4e3b14be2ea2e7916a05a2fe60f9f">THD::Query_plan::thd</a></div><div class="ttdeci">THD *const thd</div><div class="ttdef"><b>Definition:</b> sql_class.h:1205</div></div>
<div class="ttc" id="classTHD_html_a8a57c506360e6f165b28c2ccb76bc4d9"><div class="ttname"><a href="classTHD.html#a8a57c506360e6f165b28c2ccb76bc4d9">THD::sp_runtime_ctx</a></div><div class="ttdeci">sp_rcontext * sp_runtime_ctx</div><div class="ttdoc">Current SP-runtime context. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2479</div></div>
<div class="ttc" id="classTHD_html_a2829d63cff897bc79c91d372ad5e29f4a483bc88a82baec686bcb2b98bb6c4ff8"><div class="ttname"><a href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4a483bc88a82baec686bcb2b98bb6c4ff8">THD::ROW_QUERY_TYPE</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:2662</div></div>
<div class="ttc" id="classTHD_html_a51e54aaf9ff69cdf5991f30ffc56d814"><div class="ttname"><a href="classTHD.html#a51e54aaf9ff69cdf5991f30ffc56d814">THD::record_first_successful_insert_id_in_cur_stmt</a></div><div class="ttdeci">void record_first_successful_insert_id_in_cur_stmt(ulonglong id_arg)</div><div class="ttdef"><b>Definition:</b> sql_class.h:1970</div></div>
<div class="ttc" id="classTHD_html_ace16912af2efc62730d276086223718d"><div class="ttname"><a href="classTHD.html#ace16912af2efc62730d276086223718d">THD::reset_current_stmt_binlog_format_row</a></div><div class="ttdeci">void reset_current_stmt_binlog_format_row()</div><div class="ttdef"><b>Definition:</b> sql_class.h:3116</div></div>
<div class="ttc" id="classTHD_html_a070a0ce589c0116c5aa8fcf5e5014727"><div class="ttname"><a href="classTHD.html#a070a0ce589c0116c5aa8fcf5e5014727">THD::first_successful_insert_id_in_prev_stmt_for_binlog</a></div><div class="ttdeci">ulonglong first_successful_insert_id_in_prev_stmt_for_binlog</div><div class="ttdef"><b>Definition:</b> sql_class.h:1881</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_a7f25a09d4e97f679b6e3ee6319939da3"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#a7f25a09d4e97f679b6e3ee6319939da3">THD::Transaction_state::m_trx</a></div><div class="ttdeci">Transaction_ctx * m_trx</div><div class="ttdoc">Transaction_ctx instance. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1687</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240baedcfb5129894e0b118d44d0283ae669d"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baedcfb5129894e0b118d44d0283ae669d">SYSTEM_THREAD_INFO_REPOSITORY</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:40</div></div>
<div class="ttc" id="classOpen__tables__state_html_aeae43d7bcaa5f4a62d21e0c978c667bb"><div class="ttname"><a href="classOpen__tables__state.html#aeae43d7bcaa5f4a62d21e0c978c667bb">Open_tables_state::reset_reprepare_observers</a></div><div class="ttdeci">void reset_reprepare_observers()</div><div class="ttdef"><b>Definition:</b> sql_class.h:469</div></div>
<div class="ttc" id="classMDL__context_html_a357599f5af7c6ec7587ecb7b349f0313"><div class="ttname"><a href="classMDL__context.html#a357599f5af7c6ec7587ecb7b349f0313">MDL_context::set_explicit_duration_for_all_locks</a></div><div class="ttdeci">void set_explicit_duration_for_all_locks()</div><div class="ttdoc">Set explicit duration for all locks in the context. </div><div class="ttdef"><b>Definition:</b> mdl.cc:4557</div></div>
<div class="ttc" id="structLEX_html"><div class="ttname"><a href="structLEX.html">LEX</a></div><div class="ttdoc">The LEX object currently serves three different purposes: </div><div class="ttdef"><b>Definition:</b> sql_lex.h:3613</div></div>
<div class="ttc" id="classTHD_html_ad2b97fa1c383b8e79ad17d51c015729e"><div class="ttname"><a href="classTHD.html#ad2b97fa1c383b8e79ad17d51c015729e">THD::binlog_unsafe_warning_flags</a></div><div class="ttdeci">uint32 binlog_unsafe_warning_flags</div><div class="ttdoc">Bit field for the state of binlog warnings. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1601</div></div>
<div class="ttc" id="sql__class_8h_html_a54bb1ac8c34d138b5dd4e51aa92c688d"><div class="ttname"><a href="sql__class_8h.html#a54bb1ac8c34d138b5dd4e51aa92c688d">add_item_to_list</a></div><div class="ttdeci">bool add_item_to_list(THD *thd, Item *item)</div><div class="ttdef"><b>Definition:</b> sql_class.cc:2663</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_a77fa377fa88e669a548677a28a5b601f"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#a77fa377fa88e669a548677a28a5b601f">THD::Transaction_state::m_time_zone_used</a></div><div class="ttdeci">bool m_time_zone_used</div><div class="ttdoc">Current time zone (i.e. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1713</div></div>
<div class="ttc" id="classTHD_html_a981c4dd14384944b09235ee7d00855f4"><div class="ttname"><a href="classTHD.html#a981c4dd14384944b09235ee7d00855f4">THD::is_stmt_prepare</a></div><div class="ttdeci">bool is_stmt_prepare() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:807</div></div>
<div class="ttc" id="memcached_8c_html_a9e8f65e2f04446eb0a2f098411dacf9b"><div class="ttname"><a href="memcached_8c.html#a9e8f65e2f04446eb0a2f098411dacf9b">count</a></div><div class="ttdeci">ssize_t count</div><div class="ttdef"><b>Definition:</b> memcached.c:386</div></div>
<div class="ttc" id="classTHD_html_a7d8d7dc34cf8a15e129843a9d6419262"><div class="ttname"><a href="classTHD.html#a7d8d7dc34cf8a15e129843a9d6419262">THD::is_current_stmt_binlog_format_row</a></div><div class="ttdeci">int is_current_stmt_binlog_format_row() const</div><div class="ttdoc">Determine the binlog format of the current statement. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1473</div></div>
<div class="ttc" id="myisam__ftdump_8cc_html_af26982218484ec3fdcb8f7d92e864a9b"><div class="ttname"><a href="myisam__ftdump_8cc.html#af26982218484ec3fdcb8f7d92e864a9b">query</a></div><div class="ttdeci">static char * query</div><div class="ttdef"><b>Definition:</b> myisam_ftdump.cc:44</div></div>
<div class="ttc" id="classTHD_html_addf196e6878180910d06b7a51f727651"><div class="ttname"><a href="classTHD.html#addf196e6878180910d06b7a51f727651">THD::is_fatal_error</a></div><div class="ttdeci">bool is_fatal_error() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2894</div></div>
<div class="ttc" id="structrand__struct_html"><div class="ttname"><a href="structrand__struct.html">rand_struct</a></div><div class="ttdef"><b>Definition:</b> mysql_com.h:1044</div></div>
<div class="ttc" id="sql__class_8h_html_af8d5b2c7cc3fbc0f7dddcb915021bed5"><div class="ttname"><a href="sql__class_8h.html#af8d5b2c7cc3fbc0f7dddcb915021bed5">Item_change_list</a></div><div class="ttdeci">I_List&lt; Item_change_record &gt; Item_change_list</div><div class="ttdef"><b>Definition:</b> sql_class.h:421</div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html_ad2ef3e6cea7dc62c489c785ea4b99435"><div class="ttname"><a href="classTHD_1_1Query__plan.html#ad2ef3e6cea7dc62c489c785ea4b99435">THD::Query_plan::sql_command</a></div><div class="ttdeci">enum_sql_command sql_command</div><div class="ttdoc">Original sql_command;. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1207</div></div>
<div class="ttc" id="classTHD_html_a1c09d48d6adc28360cc4d8ea16ae5e59"><div class="ttname"><a href="classTHD.html#a1c09d48d6adc28360cc4d8ea16ae5e59">THD::set_query</a></div><div class="ttdeci">void set_query(const char *query_arg, size_t query_length_arg)</div><div class="ttdoc">Assign a new value to thd-&gt;m_query_string. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3800</div></div>
<div class="ttc" id="classCost__model__server_html_a267c97e430cec8665c0c62ad722d80c1"><div class="ttname"><a href="classCost__model__server.html#a267c97e430cec8665c0c62ad722d80c1">Cost_model_server::init</a></div><div class="ttdeci">void init()</div><div class="ttdoc">Initialize the cost model object for a query. </div><div class="ttdef"><b>Definition:</b> opt_costmodel.cc:43</div></div>
<div class="ttc" id="classTHD_html_a47f166c02353a5893c2c1607e02af6b4"><div class="ttname"><a href="classTHD.html#a47f166c02353a5893c2c1607e02af6b4">THD::is_server_upgrade_thread</a></div><div class="ttdeci">bool is_server_upgrade_thread() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2246</div></div>
<div class="ttc" id="classTHD_html_a4af42194393272f3f676225e519e7ade"><div class="ttname"><a href="classTHD.html#a4af42194393272f3f676225e519e7ade">THD::m_invoker_user</a></div><div class="ttdeci">LEX_CSTRING m_invoker_user</div><div class="ttdoc">It points to the invoker in the Query_log_event. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4011</div></div>
<div class="ttc" id="classTHD_html_a92a32a2541d0592a3afe5321ff586235"><div class="ttname"><a href="classTHD.html#a92a32a2541d0592a3afe5321ff586235">THD::num_truncated_fields</a></div><div class="ttdeci">ha_rows num_truncated_fields</div><div class="ttdef"><b>Definition:</b> sql_class.h:2077</div></div>
<div class="ttc" id="string_8h_html"><div class="ttname"><a href="string_8h.html">string.h</a></div></div>
<div class="ttc" id="classDiscrete__intervals__list_html_ade0cbb03dcd687e4dc5ce572834a077a"><div class="ttname"><a href="classDiscrete__intervals__list.html#ade0cbb03dcd687e4dc5ce572834a077a">Discrete_intervals_list::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> discrete_interval.h:143</div></div>
<div class="ttc" id="classTHD_html_abe268aadf4ed6516048624af38a0a3aa"><div class="ttname"><a href="classTHD.html#abe268aadf4ed6516048624af38a0a3aa">THD::LOCK_thd_sysvar</a></div><div class="ttdeci">mysql_mutex_t LOCK_thd_sysvar</div><div class="ttdoc">Protects THD::variables while being updated. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1055</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240baa79beba3ce7bf907b74714487ef9d18f"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baa79beba3ce7bf907b74714487ef9d18f">SYSTEM_THREAD_SERVER_INITIALIZE</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:46</div></div>
<div class="ttc" id="classItem__change__record_html"><div class="ttname"><a href="classItem__change__record.html">Item_change_record</a></div><div class="ttdoc">A registry for item tree transformations performed during query optimization. </div><div class="ttdef"><b>Definition:</b> sql_class.h:407</div></div>
<div class="ttc" id="classQuery__tables__list_html"><div class="ttname"><a href="classQuery__tables__list.html">Query_tables_list</a></div><div class="ttdef"><b>Definition:</b> sql_lex.h:2413</div></div>
<div class="ttc" id="classTHD_html_aa6abe91dfbd5b85812c0b888255f9540"><div class="ttname"><a href="classTHD.html#aa6abe91dfbd5b85812c0b888255f9540">THD::charset_is_character_set_filesystem</a></div><div class="ttdeci">bool charset_is_character_set_filesystem</div><div class="ttdef"><b>Definition:</b> sql_class.h:2471</div></div>
<div class="ttc" id="classOpen__tables__state_html_a5e82eec8650504f34423f5889e9a1e3d"><div class="ttname"><a href="classOpen__tables__state.html#a5e82eec8650504f34423f5889e9a1e3d">Open_tables_state::Open_tables_state</a></div><div class="ttdeci">Open_tables_state()</div><div class="ttdoc">This constructor initializes Open_tables_state instance which can only be used as backup storage...</div><div class="ttdef"><b>Definition:</b> sql_class.h:551</div></div>
<div class="ttc" id="classTHD_html_a40cb4e81f0ca5ef0ac6042752f84f5be"><div class="ttname"><a href="classTHD.html#a40cb4e81f0ca5ef0ac6042752f84f5be">THD::stmt_arena</a></div><div class="ttdeci">Query_arena * stmt_arena</div><div class="ttdef"><b>Definition:</b> sql_class.h:1852</div></div>
<div class="ttc" id="structHa__data_html_a3d0c3a6cda3a19f09f21b17193e0feab"><div class="ttname"><a href="structHa__data.html#a3d0c3a6cda3a19f09f21b17193e0feab">Ha_data::ha_ptr</a></div><div class="ttdeci">void * ha_ptr</div><div class="ttdoc">Storage engine specific thread local data. </div><div class="ttdef"><b>Definition:</b> sql_class.h:667</div></div>
<div class="ttc" id="classTHD_html_abd0f16981c46e67c8680050ed49c6c4c"><div class="ttname"><a href="classTHD.html#abd0f16981c46e67c8680050ed49c6c4c">THD::m_transaction</a></div><div class="ttdeci">std::unique_ptr&lt; Transaction_ctx &gt; m_transaction</div><div class="ttdef"><b>Definition:</b> sql_class.h:1660</div></div>
<div class="ttc" id="classPrepared__statement__map_html_acc204498db24519d9db042d9973829fd"><div class="ttname"><a href="classPrepared__statement__map.html#acc204498db24519d9db042d9973829fd">Prepared_statement_map::names_hash</a></div><div class="ttdeci">collation_unordered_map&lt; std::string, Prepared_statement * &gt; names_hash</div><div class="ttdef"><b>Definition:</b> sql_class.h:396</div></div>
<div class="ttc" id="structmysql__cond__t_html"><div class="ttname"><a href="structmysql__cond__t.html">mysql_cond_t</a></div><div class="ttdoc">An instrumented cond structure. </div><div class="ttdef"><b>Definition:</b> mysql_cond_bits.h:49</div></div>
<div class="ttc" id="classPlugin__array_html"><div class="ttname"><a href="classPlugin__array.html">Plugin_array</a></div><div class="ttdoc">Plugin array helper class. </div><div class="ttdef"><b>Definition:</b> sql_plugin_ref.h:109</div></div>
<div class="ttc" id="classTHD_html_a37e72044a3dfadd3fa34de75532a0b4a"><div class="ttname"><a href="classTHD.html#a37e72044a3dfadd3fa34de75532a0b4a">THD::lock_query_plan</a></div><div class="ttdeci">void lock_query_plan()</div><div class="ttdoc">Locks the query plan of this THD. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1090</div></div>
<div class="ttc" id="classthd__scheduler_html_a4f6594bdef996f0d8b68ae7f442d6a99"><div class="ttname"><a href="classthd__scheduler.html#a4f6594bdef996f0d8b68ae7f442d6a99">thd_scheduler::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> sql_class.h:197</div></div>
<div class="ttc" id="classTHD_html_aaa7a6c6f69c0f88b6af26f5296865494"><div class="ttname"><a href="classTHD.html#aaa7a6c6f69c0f88b6af26f5296865494">THD::transaction_rollback_request</a></div><div class="ttdeci">bool transaction_rollback_request</div><div class="ttdoc">Set by a storage engine to request the entire transaction (that possibly spans multiple engines) to r...</div><div class="ttdef"><b>Definition:</b> sql_class.h:2440</div></div>
<div class="ttc" id="sql__const_8h_html"><div class="ttname"><a href="sql__const_8h.html">sql_const.h</a></div><div class="ttdoc">File containing constants that can be used throughout the server. </div></div>
<div class="ttc" id="classTransaction__ctx_html"><div class="ttname"><a href="classTransaction__ctx.html">Transaction_ctx</a></div><div class="ttdef"><b>Definition:</b> transaction_info.h:51</div></div>
<div class="ttc" id="classTHD_html_afa3c413607ea1ff67a8c17500a9de27bae71b344111f6a0f7a3427e989682d308"><div class="ttname"><a href="classTHD.html#afa3c413607ea1ff67a8c17500a9de27bae71b344111f6a0f7a3427e989682d308">THD::RESET_LEX</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:1727</div></div>
<div class="ttc" id="classTHD_html_a6f59ec56969f12878961fa605966d3c3"><div class="ttname"><a href="classTHD.html#a6f59ec56969f12878961fa605966d3c3">THD::is_killed</a></div><div class="ttdeci">int is_killed() const final</div><div class="ttdoc">Has the owner thread been killed? </div><div class="ttdef"><b>Definition:</b> sql_class.h:2710</div></div>
<div class="ttc" id="app__data_8cc_html_a4104c7043ba0f61a452a016adfd1869d"><div class="ttname"><a href="app__data_8cc.html#a4104c7043ba0f61a452a016adfd1869d">new_data</a></div><div class="ttdeci">app_data_ptr new_data(u_int n, char *val, cons_type consensus)</div><div class="ttdef"><b>Definition:</b> app_data.cc:360</div></div>
<div class="ttc" id="classItem__change__record_html_aa05441ac007b42a66d1c7307a9ba4642"><div class="ttname"><a href="classItem__change__record.html#aa05441ac007b42a66d1c7307a9ba4642">Item_change_record::Item_change_record</a></div><div class="ttdeci">Item_change_record()</div><div class="ttdef"><b>Definition:</b> sql_class.h:410</div></div>
<div class="ttc" id="structPSI__idle__locker__state__v1_html"><div class="ttname"><a href="structPSI__idle__locker__state__v1.html">PSI_idle_locker_state_v1</a></div><div class="ttdoc">State data storage for start_idle_wait_v1_t. </div><div class="ttdef"><b>Definition:</b> psi_idle_bits.h:51</div></div>
<div class="ttc" id="system__variables_8h_html_acd03be4982af89757ca0317f3d73d0bca9fc57580019e63df209ad5271b483db8"><div class="ttname"><a href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bca9fc57580019e63df209ad5271b483db8">BINLOG_FORMAT_ROW</a></div><div class="ttdoc">row-based </div><div class="ttdef"><b>Definition:</b> system_variables.h:47</div></div>
<div class="ttc" id="classItem__change__record_html_acac78e3f5ed6a66679acd178f941a7c5"><div class="ttname"><a href="classItem__change__record.html#acac78e3f5ed6a66679acd178f941a7c5">Item_change_record::new_value</a></div><div class="ttdeci">Item * new_value</div><div class="ttdef"><b>Definition:</b> sql_class.h:417</div></div>
<div class="ttc" id="classQuery__arena_html_a38d6042ee2ec4fd9e5b45d46571bf6e1"><div class="ttname"><a href="classQuery__arena.html#a38d6042ee2ec4fd9e5b45d46571bf6e1">Query_arena::enum_state</a></div><div class="ttdeci">enum_state</div><div class="ttdef"><b>Definition:</b> sql_class.h:245</div></div>
<div class="ttc" id="time_8h_html"><div class="ttname"><a href="time_8h.html">time.h</a></div><div class="ttdoc">Include file for Sun RPC to compile out of the box. </div></div>
<div class="ttc" id="my__inttypes_8h_html"><div class="ttname"><a href="my__inttypes_8h.html">my_inttypes.h</a></div><div class="ttdoc">Some integer typedefs for easier portability. </div></div>
<div class="ttc" id="classTHD_html_a36cdfb0312655df3749f0726274f4893"><div class="ttname"><a href="classTHD.html#a36cdfb0312655df3749f0726274f4893">THD::set_trans_pos</a></div><div class="ttdeci">void set_trans_pos(const char *file, my_off_t pos)</div><div class="ttdoc">Functions to set and get transaction position. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2320</div></div>
<div class="ttc" id="group__MYSYS_html_ga19ebf963aef6b242322e15e01811972e"><div class="ttname"><a href="group__MYSYS.html#ga19ebf963aef6b242322e15e01811972e">my_error</a></div><div class="ttdeci">void my_error(int nr, myf MyFlags,...)</div><div class="ttdoc">Fill in and print a previously registered error message. </div><div class="ttdef"><b>Definition:</b> my_error.cc:215</div></div>
<div class="ttc" id="structUser__level__lock_html"><div class="ttname"><a href="structUser__level__lock.html">User_level_lock</a></div><div class="ttdoc">For locks with EXPLICIT duration, MDL returns a new ticket every time a lock is granted. </div><div class="ttdef"><b>Definition:</b> item_func.cc:5091</div></div>
<div class="ttc" id="group__psi__api__statement_html_gaad7570a3e736bd188101f1be578a56ef"><div class="ttname"><a href="group__psi__api__statement.html#gaad7570a3e736bd188101f1be578a56ef">MYSQL_SET_STATEMENT_QUERY_ID</a></div><div class="ttdeci">#define MYSQL_SET_STATEMENT_QUERY_ID(LOCKER, P1)</div><div class="ttdef"><b>Definition:</b> mysql_statement.h:105</div></div>
<div class="ttc" id="classTHD_html_a76589a8167a8f4c9c816194f25bb0ee5"><div class="ttname"><a href="classTHD.html#a76589a8167a8f4c9c816194f25bb0ee5">THD::rand_saved_seed2</a></div><div class="ttdeci">ulong rand_saved_seed2</div><div class="ttdef"><b>Definition:</b> sql_class.h:2190</div></div>
<div class="ttc" id="classOpen__tables__state_html_afedfe3c414cc165f61ff46cc9d2dd6ac"><div class="ttname"><a href="classOpen__tables__state.html#afedfe3c414cc165f61ff46cc9d2dd6ac">Open_tables_state::m_reprepare_observers</a></div><div class="ttdeci">Prealloced_array&lt; Reprepare_observer *, 4 &gt; m_reprepare_observers</div><div class="ttdoc">A stack of Reprepare_observer-instances. </div><div class="ttdef"><b>Definition:</b> sql_class.h:451</div></div>
<div class="ttc" id="classTHD_html_ac72854c006acf8b3f7bcd8836109bab6"><div class="ttname"><a href="classTHD.html#ac72854c006acf8b3f7bcd8836109bab6">THD::clear_log_reset</a></div><div class="ttdeci">void clear_log_reset()</div><div class="ttdoc">Cleared after flushing SE logs during binlog reset. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3446</div></div>
<div class="ttc" id="classTHD_html_a2829d63cff897bc79c91d372ad5e29f4abdd8ab0f7264a80fc11ceb4fb9a17e2c"><div class="ttname"><a href="classTHD.html#a2829d63cff897bc79c91d372ad5e29f4abdd8ab0f7264a80fc11ceb4fb9a17e2c">THD::STMT_QUERY_TYPE</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:2665</div></div>
<div class="ttc" id="classTHD_html_a4f79a3c90670c42ec40412c2955b3f4d"><div class="ttname"><a href="classTHD.html#a4f79a3c90670c42ec40412c2955b3f4d">THD::thd_tx_priority</a></div><div class="ttdeci">int thd_tx_priority</div><div class="ttdef"><b>Definition:</b> sql_class.h:2290</div></div>
<div class="ttc" id="classOpen__tables__state_html_a60a4ab3e19e0797f87560a21de81e5f1"><div class="ttname"><a href="classOpen__tables__state.html#a60a4ab3e19e0797f87560a21de81e5f1">Open_tables_state::state_flags</a></div><div class="ttdeci">uint state_flags</div><div class="ttdef"><b>Definition:</b> sql_class.h:544</div></div>
<div class="ttc" id="sys__vars__resource__mgr_8h_html"><div class="ttname"><a href="sys__vars__resource__mgr_8h.html">sys_vars_resource_mgr.h</a></div></div>
<div class="ttc" id="memcached_8c_html_a4acff8232e4aec9cd5c6dc200ac55ef3"><div class="ttname"><a href="memcached_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a></div><div class="ttdeci">pthread_mutex_t mutex</div><div class="ttdef"><b>Definition:</b> memcached.c:384</div></div>
<div class="ttc" id="query__options_8h_html"><div class="ttname"><a href="query__options_8h.html">query_options.h</a></div></div>
<div class="ttc" id="namespacemysql__protocol_1_1Capabilities_html_a87a15ae15ae06d1484d11f8480e0e645"><div class="ttname"><a href="namespacemysql__protocol_1_1Capabilities.html#a87a15ae15ae06d1484d11f8480e0e645">mysql_protocol::Capabilities::SSL</a></div><div class="ttdeci">static constexpr Flags SSL(1&lt;&lt; 11)</div></div>
<div class="ttc" id="psi__memory__key_8cc_html_a26ad70c4235eb554a4b8088ebac2a020"><div class="ttname"><a href="psi__memory__key_8cc.html#a26ad70c4235eb554a4b8088ebac2a020">key_memory_THD_handler_tables_hash</a></div><div class="ttdeci">PSI_memory_key key_memory_THD_handler_tables_hash</div><div class="ttdef"><b>Definition:</b> psi_memory_key.cc:87</div></div>
<div class="ttc" id="classTHD_html_aa5c0af5c320332468ef8b620ba83c2c7"><div class="ttname"><a href="classTHD.html#aa5c0af5c320332468ef8b620ba83c2c7">THD::get_sent_row_count</a></div><div class="ttdeci">ha_rows get_sent_row_count() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2117</div></div>
<div class="ttc" id="classmem__root__deque_html"><div class="ttname"><a href="classmem__root__deque.html">mem_root_deque</a></div><div class="ttdoc">A (partial) implementation of std::deque allocating its blocks on a MEM_ROOT. </div><div class="ttdef"><b>Definition:</b> mem_root_deque.h:109</div></div>
<div class="ttc" id="classQuery__arena_html_aa669d228545b9648c156efeed3ba02d6"><div class="ttname"><a href="classQuery__arena.html#aa669d228545b9648c156efeed3ba02d6">Query_arena::memdup_typed</a></div><div class="ttdeci">T * memdup_typed(const T *mem)</div><div class="ttdef"><b>Definition:</b> sql_class.h:312</div></div>
<div class="ttc" id="classTHD_html_af65e652f6d1e80fb99d771a0498c3638"><div class="ttname"><a href="classTHD.html#af65e652f6d1e80fb99d771a0498c3638">THD::reset_skip_readonly_check</a></div><div class="ttdeci">void reset_skip_readonly_check()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1640</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240ba507007b21210c8e36cfdfdf95eb33560"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba507007b21210c8e36cfdfdf95eb33560">SYSTEM_THREAD_EVENT_SCHEDULER</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:38</div></div>
<div class="ttc" id="classTHD_html_ab2e036d6f69a8c3354caf79985deee73"><div class="ttname"><a href="classTHD.html#ab2e036d6f69a8c3354caf79985deee73">THD::m_idle_psi</a></div><div class="ttdeci">PSI_idle_locker * m_idle_psi</div><div class="ttdoc">Idle instrumentation. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2169</div></div>
<div class="ttc" id="classTHD_html_a42444c80d6289ae174d80b7c0d7b4436"><div class="ttname"><a href="classTHD.html#a42444c80d6289ae174d80b7c0d7b4436">THD::db</a></div><div class="ttdeci">const LEX_CSTRING &amp; db() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3539</div></div>
<div class="ttc" id="classProtocol__classic_html"><div class="ttname"><a href="classProtocol__classic.html">Protocol_classic</a></div><div class="ttdef"><b>Definition:</b> protocol_classic.h:51</div></div>
<div class="ttc" id="classTHD_html_aa998d677a348f716a6c4ff24a8b06da0"><div class="ttname"><a href="classTHD.html#aa998d677a348f716a6c4ff24a8b06da0">THD::m_internal_handler</a></div><div class="ttdeci">Internal_error_handler * m_internal_handler</div><div class="ttdoc">The current internal error handler for this thread, or NULL. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3976</div></div>
<div class="ttc" id="classTHD_html_aaf26e9c69d32816f07694237594e1162"><div class="ttname"><a href="classTHD.html#aaf26e9c69d32816f07694237594e1162">THD::copy_db_to</a></div><div class="ttdeci">bool copy_db_to(char const **p_db, size_t *p_db_length) const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3585</div></div>
<div class="ttc" id="classTHD_html_ad79b2ca158056d58bd48d2bc583fccf2"><div class="ttname"><a href="classTHD.html#ad79b2ca158056d58bd48d2bc583fccf2">THD::m_is_plugin_fake_ddl</a></div><div class="ttdeci">bool m_is_plugin_fake_ddl</div><div class="ttdoc">Creating or dropping plugin native table through a plugin service. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4194</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240ba646d234189bccb1b51baf6d3fe9c9e4d"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba646d234189bccb1b51baf6d3fe9c9e4d">SYSTEM_THREAD_COMPRESS_GTID_TABLE</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:42</div></div>
<div class="ttc" id="group__psi__api__mutex_html_ga5d4432144c24f6cf89f761417dd1c1c6"><div class="ttname"><a href="group__psi__api__mutex.html#ga5d4432144c24f6cf89f761417dd1c1c6">mysql_mutex_assert_not_owner</a></div><div class="ttdeci">#define mysql_mutex_assert_not_owner(M)</div><div class="ttdoc">Wrapper, to use safe_mutex_assert_not_owner with instrumented mutexes. </div><div class="ttdef"><b>Definition:</b> mysql_mutex.h:123</div></div>
<div class="ttc" id="classTransactional__ddl__context_html_ac515746762e97a70c2c8d157578f2019"><div class="ttname"><a href="classTransactional__ddl__context.html#ac515746762e97a70c2c8d157578f2019">Transactional_ddl_context::inited</a></div><div class="ttdeci">bool inited()</div><div class="ttdef"><b>Definition:</b> sql_class.h:779</div></div>
<div class="ttc" id="classsp__cache_html"><div class="ttname"><a href="classsp__cache.html">sp_cache</a></div><div class="ttdef"><b>Definition:</b> sp_cache.cc:41</div></div>
<div class="ttc" id="classTHD_html_aef8dbaa51c6bcceb123e63113433794f"><div class="ttname"><a href="classTHD.html#aef8dbaa51c6bcceb123e63113433794f">THD::pin_gtid</a></div><div class="ttdeci">void pin_gtid()</div><div class="ttdoc">Defer freeing owned GTID and SID till unpinned. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3427</div></div>
<div class="ttc" id="classTHD_html_a60d919e5c76951f61a779289aac88d90"><div class="ttname"><a href="classTHD.html#a60d919e5c76951f61a779289aac88d90">THD::current_mutex</a></div><div class="ttdeci">std::atomic&lt; mysql_mutex_t * &gt; current_mutex</div><div class="ttdoc">The mutex used with current_cond. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1312</div></div>
<div class="ttc" id="structMYSQL__LEX__CSTRING_html_a8ec5bb16b4275a6809163e00592b105d"><div class="ttname"><a href="structMYSQL__LEX__CSTRING.html#a8ec5bb16b4275a6809163e00592b105d">MYSQL_LEX_CSTRING::str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> mysql_lex_string.h:40</div></div>
<div class="ttc" id="classTHD_html_aa7c77b86e7141e1d080ae0fab1c2372d"><div class="ttname"><a href="classTHD.html#aa7c77b86e7141e1d080ae0fab1c2372d">THD::reset_first_successful_insert_id</a></div><div class="ttdeci">void reset_first_successful_insert_id()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1983</div></div>
<div class="ttc" id="classMDL__context__owner_html"><div class="ttname"><a href="classMDL__context__owner.html">MDL_context_owner</a></div><div class="ttdoc">An interface to separate the MDL module from the THD, and the rest of the server code. </div><div class="ttdef"><b>Definition:</b> mdl.h:83</div></div>
<div class="ttc" id="classTHD_html_a3c77e3ccae824537f33d184d445cae84"><div class="ttname"><a href="classTHD.html#a3c77e3ccae824537f33d184d445cae84">THD::tx_commit_pending</a></div><div class="ttdeci">bool tx_commit_pending</div><div class="ttdef"><b>Definition:</b> sql_class.h:935</div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html"><div class="ttname"><a href="classTHD_1_1Query__plan.html">THD::Query_plan</a></div><div class="ttdoc">Query plan for EXPLAINable commands, should be locked with LOCK_query_plan before using...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1203</div></div>
<div class="ttc" id="classTHD_html_a2488437f2c5fe89407cdbfbb9df6bc36"><div class="ttname"><a href="classTHD.html#a2488437f2c5fe89407cdbfbb9df6bc36">THD::protocol_binary</a></div><div class="ttdeci">std::unique_ptr&lt; Protocol_binary &gt; protocol_binary</div><div class="ttdef"><b>Definition:</b> sql_class.h:1149</div></div>
<div class="ttc" id="sql__cmd__srs_8cc_html_ae1f3a7aed6d381dcd98b265913716fd4"><div class="ttname"><a href="sql__cmd__srs_8cc.html#ae1f3a7aed6d381dcd98b265913716fd4">rollback</a></div><div class="ttdeci">static bool rollback(THD *thd)</div><div class="ttdoc">Abort the current statement and transaction. </div><div class="ttdef"><b>Definition:</b> sql_cmd_srs.cc:139</div></div>
<div class="ttc" id="structHa__data_html_a4263cded81cce8451aea9d97e6cc8fd4"><div class="ttname"><a href="structHa__data.html#a4263cded81cce8451aea9d97e6cc8fd4">Ha_data::Ha_data</a></div><div class="ttdeci">Ha_data()</div><div class="ttdef"><b>Definition:</b> sql_class.h:697</div></div>
<div class="ttc" id="namespacedd_html_ac738a3a18c0b1423ab2dca5f1d227296"><div class="ttname"><a href="namespacedd.html#ac738a3a18c0b1423ab2dca5f1d227296">dd::String_type</a></div><div class="ttdeci">Char_string_template&lt; String_type_allocator &gt; String_type</div><div class="ttdef"><b>Definition:</b> string_type.h:50</div></div>
<div class="ttc" id="classTHD_1_1Attachable__trx__rw_html"><div class="ttname"><a href="classTHD_1_1Attachable__trx__rw.html">THD::Attachable_trx_rw</a></div><div class="ttdoc">A derived from THD::Attachable_trx class allows updates in the attachable transaction. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1780</div></div>
<div class="ttc" id="classTHD_html_af1141e7ffe7be501c9924f1b1f34ec78a3e0b5b7419f0ff0ae8925997a416cd03"><div class="ttname"><a href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78a3e0b5b7419f0ff0ae8925997a416cd03">THD::SE_GTID_RESET_LOG</a></div><div class="ttdoc">If RESET log in progress. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3416</div></div>
<div class="ttc" id="classTHD_html_acc2dfaeff7fe8328447716eb221e5e53"><div class="ttname"><a href="classTHD.html#acc2dfaeff7fe8328447716eb221e5e53">THD::sp_proc_cache</a></div><div class="ttdeci">sp_cache * sp_proc_cache</div><div class="ttdef"><b>Definition:</b> sql_class.h:2480</div></div>
<div class="ttc" id="structVio_html_abb1ac2cee2fe25bc3964866f27c3c051"><div class="ttname"><a href="structVio.html#abb1ac2cee2fe25bc3964866f27c3c051">Vio::ssl_arg</a></div><div class="ttdeci">void * ssl_arg</div><div class="ttdef"><b>Definition:</b> violite.h:407</div></div>
<div class="ttc" id="classDiscrete__intervals__list_html_a58a5310a1fb8451c1b1db37142456b0d"><div class="ttname"><a href="classDiscrete__intervals__list.html#a58a5310a1fb8451c1b1db37142456b0d">Discrete_intervals_list::append</a></div><div class="ttdeci">bool append(Discrete_interval *new_interval)</div><div class="ttdef"><b>Definition:</b> discrete_interval.h:116</div></div>
<div class="ttc" id="group__MYSYS_html_gaf9a1809cc617261f4e10df31ad4039b9"><div class="ttname"><a href="group__MYSYS.html#gaf9a1809cc617261f4e10df31ad4039b9">strdup_root</a></div><div class="ttdeci">char * strdup_root(MEM_ROOT *root, const char *str)</div><div class="ttdef"><b>Definition:</b> my_alloc.cc:242</div></div>
<div class="ttc" id="classGlobal__read__lock_html_a04314b8c54f52b54e75650cbc832b7de"><div class="ttname"><a href="classGlobal__read__lock.html#a04314b8c54f52b54e75650cbc832b7de">Global_read_lock::can_acquire_protection</a></div><div class="ttdeci">bool can_acquire_protection() const</div><div class="ttdoc">Check if this connection can acquire protection against GRL and emit error if otherwise. </div><div class="ttdef"><b>Definition:</b> sql_class.h:731</div></div>
<div class="ttc" id="mysqladmin_8cc_html_ae032e164f1daa754d6fbb79d59723931"><div class="ttname"><a href="mysqladmin_8cc.html#ae032e164f1daa754d6fbb79d59723931">host</a></div><div class="ttdeci">const char * host</div><div class="ttdef"><b>Definition:</b> mysqladmin.cc:58</div></div>
<div class="ttc" id="classTHD_html_abc08035d1164b66c0d5c5ac232523dba"><div class="ttname"><a href="classTHD.html#abc08035d1164b66c0d5c5ac232523dba">THD::tx_priority</a></div><div class="ttdeci">int tx_priority</div><div class="ttdef"><b>Definition:</b> sql_class.h:2285</div></div>
<div class="ttc" id="classTHD_html_ace66d6d175889b62f3260264cfac216a"><div class="ttname"><a href="classTHD.html#ace66d6d175889b62f3260264cfac216a">THD::variables</a></div><div class="ttdeci">struct System_variables variables</div><div class="ttdef"><b>Definition:</b> sql_class.h:989</div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html_a74b6dd2bac1275e0e8fae5ee4175e9f3"><div class="ttname"><a href="classTHD_1_1Query__plan.html#a74b6dd2bac1275e0e8fae5ee4175e9f3">THD::Query_plan::is_ps_query</a></div><div class="ttdeci">bool is_ps_query() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1258</div></div>
<div class="ttc" id="classTHD_html_aee1e2078ec88057e4363bdbcac847243"><div class="ttname"><a href="classTHD.html#aee1e2078ec88057e4363bdbcac847243">THD::m_parser_da</a></div><div class="ttdeci">Diagnostics_area m_parser_da</div><div class="ttdoc">cf. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3988</div></div>
<div class="ttc" id="structPSI__statement__locker__state__v1_html"><div class="ttname"><a href="structPSI__statement__locker__state__v1.html">PSI_statement_locker_state_v1</a></div><div class="ttdoc">State data storage for get_thread_statement_locker_v1_t, get_thread_statement_locker_v1_t. </div><div class="ttdef"><b>Definition:</b> psi_statement_bits.h:136</div></div>
<div class="ttc" id="classRpl__thd__context_html"><div class="ttname"><a href="classRpl__thd__context.html">Rpl_thd_context</a></div><div class="ttdef"><b>Definition:</b> rpl_context.h:280</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240b"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240b">enum_thread_type</a></div><div class="ttdeci">enum_thread_type</div><div class="ttdef"><b>Definition:</b> thread_type.h:33</div></div>
<div class="ttc" id="classTHD_html_adfed2fbb66bc9b415c128595352116bc"><div class="ttname"><a href="classTHD.html#adfed2fbb66bc9b415c128595352116bc">THD::duplicate_slave_id</a></div><div class="ttdeci">bool duplicate_slave_id</div><div class="ttdoc">This is only used by master dump threads. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4148</div></div>
<div class="ttc" id="my__sqlcommand_8h_html_a46bba265a20f1784df6b9802aec4122a"><div class="ttname"><a href="my__sqlcommand_8h.html#a46bba265a20f1784df6b9802aec4122a">enum_sql_command</a></div><div class="ttdeci">enum_sql_command</div><div class="ttdef"><b>Definition:</b> my_sqlcommand.h:45</div></div>
<div class="ttc" id="classTHD_html_a427aaab42cc8a799234d0a97e4621a8c"><div class="ttname"><a href="classTHD.html#a427aaab42cc8a799234d0a97e4621a8c">THD::clear_clone_vio</a></div><div class="ttdeci">void clear_clone_vio()</div><div class="ttdoc">Clear clone network Vio for remote clone. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2635</div></div>
<div class="ttc" id="psi__idle__bits_8h_html"><div class="ttname"><a href="psi__idle__bits_8h.html">psi_idle_bits.h</a></div><div class="ttdoc">Performance schema instrumentation interface. </div></div>
<div class="ttc" id="classTHD_html_a0b7b9bcbe2362eb25727541e66cf22dd"><div class="ttname"><a href="classTHD.html#a0b7b9bcbe2362eb25727541e66cf22dd">THD::m_query_rewrite_plugin_da</a></div><div class="ttdeci">Diagnostics_area m_query_rewrite_plugin_da</div><div class="ttdef"><b>Definition:</b> sql_class.h:3989</div></div>
<div class="ttc" id="classTHD_html_a39b62a8daf61f31dafd623484fa95156"><div class="ttname"><a href="classTHD.html#a39b62a8daf61f31dafd623484fa95156">THD::set_security_context</a></div><div class="ttdeci">void set_security_context(Security_context *sctx)</div><div class="ttdef"><b>Definition:</b> sql_class.h:1118</div></div>
<div class="ttc" id="classTHD_html_a98462dbdca947ea962a2e1fac10bb865"><div class="ttname"><a href="classTHD.html#a98462dbdca947ea962a2e1fac10bb865">THD::query_start_in_secs</a></div><div class="ttdeci">time_t query_start_in_secs() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2765</div></div>
<div class="ttc" id="classSql__cmd__signal_html"><div class="ttname"><a href="classSql__cmd__signal.html">Sql_cmd_signal</a></div><div class="ttdoc">Sql_cmd_signal represents a SIGNAL statement. </div><div class="ttdef"><b>Definition:</b> sql_signal.h:147</div></div>
<div class="ttc" id="classTHD_html_a703cd04c9100ea7bc6df0445ee8bac5f"><div class="ttname"><a href="classTHD.html#a703cd04c9100ea7bc6df0445ee8bac5f">THD::is_fatal_sub_stmt_error</a></div><div class="ttdeci">bool is_fatal_sub_stmt_error</div><div class="ttdoc">true if we are in a sub-statement and the current error can not be safely recovered until we left the...</div><div class="ttdef"><b>Definition:</b> sql_class.h:2452</div></div>
<div class="ttc" id="classTHD_html_abb273b15863db167e5591be73a6413ca"><div class="ttname"><a href="classTHD.html#abb273b15863db167e5591be73a6413ca">THD::sp_func_cache</a></div><div class="ttdeci">sp_cache * sp_func_cache</div><div class="ttdef"><b>Definition:</b> sql_class.h:2481</div></div>
<div class="ttc" id="sql__error_8cc_html_a85b05343c7aaffd5cd9a2487feca6487"><div class="ttname"><a href="sql__error_8cc.html#a85b05343c7aaffd5cd9a2487feca6487">push_warning</a></div><div class="ttdeci">void push_warning(THD *thd, Sql_condition::enum_severity_level severity, uint code, const char *message_text)</div><div class="ttdoc">Push the warning to error list if there is still room in the list. </div><div class="ttdef"><b>Definition:</b> sql_error.cc:649</div></div>
<div class="ttc" id="structrpl__event__coordinates_html"><div class="ttname"><a href="structrpl__event__coordinates.html">rpl_event_coordinates</a></div><div class="ttdoc">the struct aggregates two paramenters that identify an event uniquely in scope of communication of a ...</div><div class="ttdef"><b>Definition:</b> sql_class.h:216</div></div>
<div class="ttc" id="classOpen__tables__state_html_acccde8a1d2a6789f8a7240921fcafd6c"><div class="ttname"><a href="classOpen__tables__state.html#acccde8a1d2a6789f8a7240921fcafd6c">Open_tables_state::locked_tables_mode</a></div><div class="ttdeci">enum enum_locked_tables_mode locked_tables_mode</div><div class="ttdef"><b>Definition:</b> sql_class.h:534</div></div>
<div class="ttc" id="structMYSQL__LEX__CSTRING_html"><div class="ttname"><a href="structMYSQL__LEX__CSTRING.html">MYSQL_LEX_CSTRING</a></div><div class="ttdef"><b>Definition:</b> mysql_lex_string.h:39</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_a852fc16165720425d815f8fa340004bb"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#a852fc16165720425d815f8fa340004bb">THD::Transaction_state::m_open_tables_state</a></div><div class="ttdeci">Open_tables_backup m_open_tables_state</div><div class="ttdoc">Open-tables state. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1675</div></div>
<div class="ttc" id="classQuery__arena_html_a79593347c4c7cabb2b94ae6370c18bab"><div class="ttname"><a href="classQuery__arena.html#a79593347c4c7cabb2b94ae6370c18bab">Query_arena::Query_arena</a></div><div class="ttdeci">Query_arena(MEM_ROOT *mem_root_arg, enum enum_state state_arg)</div><div class="ttdef"><b>Definition:</b> sql_class.h:271</div></div>
<div class="ttc" id="classTHD_html_a42aa99eda44ef4933b022773bf396a3d"><div class="ttname"><a href="classTHD.html#a42aa99eda44ef4933b022773bf396a3d">THD::get_rand_seed</a></div><div class="ttdeci">uint get_rand_seed() const override</div><div class="ttdoc">Provide thread specific random seed for MDL_context&amp;#39;s PRNG. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2749</div></div>
<div class="ttc" id="classQuery__result_html"><div class="ttname"><a href="classQuery__result.html">Query_result</a></div><div class="ttdef"><b>Definition:</b> query_result.h:54</div></div>
<div class="ttc" id="classTHD_html_aa3d11bd2de65c90fe1933cfd311263f9"><div class="ttname"><a href="classTHD.html#aa3d11bd2de65c90fe1933cfd311263f9">THD::get_transaction</a></div><div class="ttdeci">Transaction_ctx * get_transaction()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1793</div></div>
<div class="ttc" id="classTHD_html_adb00a587a780046fe38f27be18f79d76"><div class="ttname"><a href="classTHD.html#adb00a587a780046fe38f27be18f79d76">THD::m_server_idle</a></div><div class="ttdeci">bool m_server_idle</div><div class="ttdoc">True if the server code is IDLE for this connection. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2175</div></div>
<div class="ttc" id="classTHD_html_a1696473d387286f44b9fbcde5b2b8ed9"><div class="ttname"><a href="classTHD.html#a1696473d387286f44b9fbcde5b2b8ed9">THD::m_row_count_func</a></div><div class="ttdeci">longlong m_row_count_func</div><div class="ttdoc">Stores the result of ROW_COUNT() function. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2068</div></div>
<div class="ttc" id="classTHD_html_a63f8bccb7359184a45a29a7b20853cd0"><div class="ttname"><a href="classTHD.html#a63f8bccb7359184a45a29a7b20853cd0">THD::m_protocol</a></div><div class="ttdeci">Protocol * m_protocol</div><div class="ttdef"><b>Definition:</b> sql_class.h:1185</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_ac960c86a277dab53f956387cfc71076b"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#ac960c86a277dab53f956387cfc71076b">THD::Transaction_state::m_sql_command</a></div><div class="ttdeci">enum_sql_command m_sql_command</div><div class="ttdoc">SQL-command. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1670</div></div>
<div class="ttc" id="classGlobal__read__lock_html_af95c661261a4863e6b80969b63c1db30"><div class="ttname"><a href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30">Global_read_lock::enum_grl_state</a></div><div class="ttdeci">enum_grl_state</div><div class="ttdef"><b>Definition:</b> sql_class.h:707</div></div>
<div class="ttc" id="classTHD_html_a6498a61496362873bf74c31f7bf87141"><div class="ttname"><a href="classTHD.html#a6498a61496362873bf74c31f7bf87141">THD::m_normalized_query</a></div><div class="ttdeci">String m_normalized_query</div><div class="ttdef"><b>Definition:</b> sql_class.h:876</div></div>
<div class="ttc" id="classItem__change__record_html_a5eae8545914da07cc08d2304f825f3f6"><div class="ttname"><a href="classItem__change__record.html#a5eae8545914da07cc08d2304f825f3f6">Item_change_record::old_value</a></div><div class="ttdeci">Item * old_value</div><div class="ttdef"><b>Definition:</b> sql_class.h:416</div></div>
<div class="ttc" id="classTHD_html_a9671e550bcaae88b814b8fddf100faa4a66eced0095aeef3ff100a9140d5fcb26"><div class="ttname"><a href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4a66eced0095aeef3ff100a9140d5fcb26">THD::BINLOG_FILTER_CLEAR</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:1538</div></div>
<div class="ttc" id="classLocked__tables__list_html"><div class="ttname"><a href="classLocked__tables__list.html">Locked_tables_list</a></div><div class="ttdoc">Tables that were locked with LOCK TABLES statement. </div><div class="ttdef"><b>Definition:</b> locked_tables_list.h:86</div></div>
<div class="ttc" id="classSecurity__context_html"><div class="ttname"><a href="classSecurity__context.html">Security_context</a></div><div class="ttdoc">A set of THD members describing the current authenticated user. </div><div class="ttdef"><b>Definition:</b> sql_security_ctx.h:53</div></div>
<div class="ttc" id="classQuery__arena_html_a469f3d1f39bd9a5dba08de062112852e"><div class="ttname"><a href="classQuery__arena.html#a469f3d1f39bd9a5dba08de062112852e">Query_arena::item_list</a></div><div class="ttdeci">Item * item_list() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:283</div></div>
<div class="ttc" id="classTHD_html_af0ac9641bfb593a6fc22cba1042083c8"><div class="ttname"><a href="classTHD.html#af0ac9641bfb593a6fc22cba1042083c8">THD::arg_of_last_insert_id_function</a></div><div class="ttdeci">bool arg_of_last_insert_id_function</div><div class="ttdef"><b>Definition:</b> sql_class.h:1861</div></div>
<div class="ttc" id="namespacedd_html_abb73bd0d1f34e0e4727e0f0e453f1f5b"><div class="ttname"><a href="namespacedd.html#abb73bd0d1f34e0e4727e0f0e453f1f5b">dd::init</a></div><div class="ttdeci">bool init(enum_dd_init_type dd_init)</div><div class="ttdoc">Initialize data dictionary upon server startup, server startup on old data directory or install data ...</div><div class="ttdef"><b>Definition:</b> dd.cc:57</div></div>
<div class="ttc" id="classOpen__tables__state_html_a932fda84cbe964ed4d60986df6b52939"><div class="ttname"><a href="classOpen__tables__state.html#a932fda84cbe964ed4d60986df6b52939">Open_tables_state::push_reprepare_observer</a></div><div class="ttdeci">void push_reprepare_observer(Reprepare_observer *o)</div><div class="ttdef"><b>Definition:</b> sql_class.h:459</div></div>
<div class="ttc" id="classTHD_html_a10f09c5b2fac2e86a201789257d28cd7"><div class="ttname"><a href="classTHD.html#a10f09c5b2fac2e86a201789257d28cd7">THD::set_row_count_func</a></div><div class="ttdeci">void set_row_count_func(longlong row_count_func)</div><div class="ttdef"><b>Definition:</b> sql_class.h:2073</div></div>
<div class="ttc" id="my__thread__bits_8h_html"><div class="ttname"><a href="my__thread__bits_8h.html">my_thread_bits.h</a></div><div class="ttdoc">Types to make different thread packages compatible. </div></div>
<div class="ttc" id="classSql__cmd__resignal_html"><div class="ttname"><a href="classSql__cmd__resignal.html">Sql_cmd_resignal</a></div><div class="ttdoc">Sql_cmd_resignal represents a RESIGNAL statement. </div><div class="ttdef"><b>Definition:</b> sql_signal.h:167</div></div>
<div class="ttc" id="classTHD_html_af51413ab3ce883addff226fa9603ab12ae14add6a3fc0dacf3245451c39a03cf7"><div class="ttname"><a href="classTHD.html#af51413ab3ce883addff226fa9603ab12ae14add6a3fc0dacf3245451c39a03cf7">THD::CE_FLUSH_ERROR</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:2372</div></div>
<div class="ttc" id="classTHD_html_a7d0d5b2c8084adc97c39a9106bdd036c"><div class="ttname"><a href="classTHD.html#a7d0d5b2c8084adc97c39a9106bdd036c">THD::db_charset</a></div><div class="ttdeci">const CHARSET_INFO * db_charset</div><div class="ttdef"><b>Definition:</b> sql_class.h:2140</div></div>
<div class="ttc" id="classTHD_html_a8fadccd09476d7b1041f55a28d3071d5"><div class="ttname"><a href="classTHD.html#a8fadccd09476d7b1041f55a28d3071d5">THD::is_cmd_skip_readonly</a></div><div class="ttdeci">bool is_cmd_skip_readonly() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1638</div></div>
<div class="ttc" id="classTHD_html_a5d80b04327477810a2248a8cf2c70649"><div class="ttname"><a href="classTHD.html#a5d80b04327477810a2248a8cf2c70649">THD::session_sysvar_res_mgr</a></div><div class="ttdeci">Session_sysvar_resource_manager session_sysvar_res_mgr</div><div class="ttdef"><b>Definition:</b> sql_class.h:4036</div></div>
<div class="ttc" id="classTHD_html_a9d034145d1ab360d7c639df5d06c88c6"><div class="ttname"><a href="classTHD.html#a9d034145d1ab360d7c639df5d06c88c6">THD::parsing_system_view</a></div><div class="ttdeci">bool parsing_system_view</div><div class="ttdef"><b>Definition:</b> sql_class.h:2476</div></div>
<div class="ttc" id="locked__tables__list_8h_html"><div class="ttname"><a href="locked__tables__list_8h.html">locked_tables_list.h</a></div></div>
<div class="ttc" id="classTHD_html_a4f37982d59c36a6e1d69407175ee78c3"><div class="ttname"><a href="classTHD.html#a4f37982d59c36a6e1d69407175ee78c3">THD::max_client_packet_length</a></div><div class="ttdeci">ulong max_client_packet_length</div><div class="ttdef"><b>Definition:</b> sql_class.h:1288</div></div>
<div class="ttc" id="classGtid__set_html_a8d8130a7559cfd7b940f42e66c9b171a"><div class="ttname"><a href="classGtid__set.html#a8d8130a7559cfd7b940f42e66c9b171a">Gtid_set::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Removes all gtids from this Gtid_set. </div><div class="ttdef"><b>Definition:</b> rpl_gtid_set.cc:263</div></div>
<div class="ttc" id="classTHD_html_af1141e7ffe7be501c9924f1b1f34ec78a5289929019913e5516e24b836306a61e"><div class="ttname"><a href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78a5289929019913e5516e24b836306a61e">THD::SE_GTID_CLEANUP</a></div><div class="ttdoc">Cleanup GTID during unpin. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3412</div></div>
<div class="ttc" id="sql__const_8h_html_ad827c9bf54cb2308ac2bbe77108e11d3"><div class="ttname"><a href="sql__const_8h.html#ad827c9bf54cb2308ac2bbe77108e11d3">enum_mark_columns</a></div><div class="ttdeci">enum_mark_columns</div><div class="ttdef"><b>Definition:</b> sql_const.h:381</div></div>
<div class="ttc" id="sql__class_8h_html_a1e56ac35f2f3cb474eabccda7c5bc1b1"><div class="ttname"><a href="sql__class_8h.html#a1e56ac35f2f3cb474eabccda7c5bc1b1">thd_enter_stage</a></div><div class="ttdeci">void thd_enter_stage(void *opaque_thd, const PSI_stage_info *new_stage, PSI_stage_info *old_stage, const char *src_function, const char *src_file, int src_line)</div><div class="ttdef"><b>Definition:</b> sql_thd_internal_api.cc:153</div></div>
<div class="ttc" id="classTHD_html_ae3ad672c82efb1dfb7873d385bc658a8"><div class="ttname"><a href="classTHD.html#ae3ad672c82efb1dfb7873d385bc658a8">THD::time_zone_used</a></div><div class="ttdeci">bool time_zone_used</div><div class="ttdef"><b>Definition:</b> sql_class.h:2454</div></div>
<div class="ttc" id="classTHD_html_a7fc76fb03b82258ff8f8ac377e72071d"><div class="ttname"><a href="classTHD.html#a7fc76fb03b82258ff8f8ac377e72071d">THD::set_plugin</a></div><div class="ttdeci">void set_plugin(const st_plugin_int *plugin)</div><div class="ttdoc">Sets the plugin id to the value provided as parameter. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4169</div></div>
<div class="ttc" id="test__udf__registration_8cc_html_a96e3cff2f3e1d8eda47115215d03ff32"><div class="ttname"><a href="test__udf__registration_8cc.html#a96e3cff2f3e1d8eda47115215d03ff32">list</a></div><div class="ttdeci">class udf_list * list</div></div>
<div class="ttc" id="classTHD_html_a088b42aed329e44798a9a7f8a937a0ba"><div class="ttname"><a href="classTHD.html#a088b42aed329e44798a9a7f8a937a0ba">THD::get_protocol_classic</a></div><div class="ttdeci">const Protocol_classic * get_protocol_classic() const</div><div class="ttdoc">Asserts that the protocol is of type text or binary and then returns the m_protocol casted to Protoco...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1174</div></div>
<div class="ttc" id="sql__class_8h_html_a18b65ea9518785d74749b5e323b41fb3"><div class="ttname"><a href="sql__class_8h.html#a18b65ea9518785d74749b5e323b41fb3">my_message_sql</a></div><div class="ttdeci">void my_message_sql(uint error, const char *str, myf MyFlags)</div><div class="ttdoc">All global error messages are sent here where the first one is stored for the client. </div><div class="ttdef"><b>Definition:</b> mysqld.cc:3552</div></div>
<div class="ttc" id="test__services__host__application__signal_8cc_html_a49308eac63cac1d140bf78a2ee88dbd0"><div class="ttname"><a href="test__services__host__application__signal_8cc.html#a49308eac63cac1d140bf78a2ee88dbd0">plugin</a></div><div class="ttdeci">static struct st_mysql_daemon plugin</div><div class="ttdef"><b>Definition:</b> test_services_host_application_signal.cc:130</div></div>
<div class="ttc" id="classTHD_html_a3ddf49eb172ad90d10abf305922b673c"><div class="ttname"><a href="classTHD.html#a3ddf49eb172ad90d10abf305922b673c">THD::m_cost_model</a></div><div class="ttdeci">Cost_model_server m_cost_model</div><div class="ttdoc">Optimizer cost model for server operations. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4020</div></div>
<div class="ttc" id="classTHD_html_af5301183e91d96e8e0cca048ff7083fd"><div class="ttname"><a href="classTHD.html#af5301183e91d96e8e0cca048ff7083fd">THD::m_main_security_ctx</a></div><div class="ttdeci">Security_context m_main_security_ctx</div><div class="ttdef"><b>Definition:</b> sql_class.h:1114</div></div>
<div class="ttc" id="classOpen__tables__backup_html"><div class="ttname"><a href="classOpen__tables__backup.html">Open_tables_backup</a></div><div class="ttdoc">Storage for backup of Open_tables_state. </div><div class="ttdef"><b>Definition:</b> sql_class.h:565</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_ae56fe056be6e8bdf69992129d16460bb"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#ae56fe056be6e8bdf69992129d16460bb">THD::Transaction_state::m_tx_isolation</a></div><div class="ttdeci">enum_tx_isolation m_tx_isolation</div><div class="ttdoc">Transaction isolation level. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1681</div></div>
<div class="ttc" id="classSub__statement__state_html_ac1c3ff29c863989156ff247bcee41181"><div class="ttname"><a href="classSub__statement__state.html#ac1c3ff29c863989156ff247bcee41181">Sub_statement_state::in_sub_stmt</a></div><div class="ttdeci">uint in_sub_stmt</div><div class="ttdef"><b>Definition:</b> sql_class.h:625</div></div>
<div class="ttc" id="structGtid_html"><div class="ttname"><a href="structGtid.html">Gtid</a></div><div class="ttdoc">TODO: Move this structure to libbinlogevents/include/control_events.h when we start using C++11...</div><div class="ttdef"><b>Definition:</b> rpl_gtid.h:1027</div></div>
<div class="ttc" id="classTHD_html_a877cb79e120669859c6249c604740d71"><div class="ttname"><a href="classTHD.html#a877cb79e120669859c6249c604740d71">THD::set_query_for_display</a></div><div class="ttdeci">void set_query_for_display(const char *query_arg, size_t query_length_arg)</div><div class="ttdoc">Set query to be displayed in performance schema (threads table etc.). </div><div class="ttdef"><b>Definition:</b> sql_class.h:3783</div></div>
<div class="ttc" id="psi__transaction__bits_8h_html"><div class="ttname"><a href="psi__transaction__bits_8h.html">psi_transaction_bits.h</a></div><div class="ttdoc">Performance schema instrumentation interface. </div></div>
<div class="ttc" id="classTHD_html_acad2df81d059520f15ef12114b9b3a09"><div class="ttname"><a href="classTHD.html#acad2df81d059520f15ef12114b9b3a09">THD::is_initialize_system_thread</a></div><div class="ttdeci">bool is_initialize_system_thread() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2228</div></div>
<div class="ttc" id="classQuery__arena_html_a06a57f3132f744a6e85b6408e12f9d32"><div class="ttname"><a href="classQuery__arena.html#a06a57f3132f744a6e85b6408e12f9d32">Query_arena::get_state</a></div><div class="ttdeci">enum_state get_state() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:289</div></div>
<div class="ttc" id="classTHD_html_ad6eba27979fa58eaf6af0b55777e440e"><div class="ttname"><a href="classTHD.html#ad6eba27979fa58eaf6af0b55777e440e">THD::restore_ha_data</a></div><div class="ttdeci">void restore_ha_data(const Prealloced_array&lt; Ha_data, PREALLOC_NUM_HA &gt; &amp;backup)</div><div class="ttdoc">Restore ha_data from the provided backup copy. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1406</div></div>
<div class="ttc" id="my__command_8h_html"><div class="ttname"><a href="my__command_8h.html">my_command.h</a></div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240ba38ad19872f53d6ef2e7815f4efd4c348"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba38ad19872f53d6ef2e7815f4efd4c348">SYSTEM_THREAD_BACKGROUND</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:43</div></div>
<div class="ttc" id="classQuery__arena_html_a7395e69c19fc73f34f92e3707c0a86db"><div class="ttname"><a href="classQuery__arena.html#a7395e69c19fc73f34f92e3707c0a86db">Query_arena::m_item_list</a></div><div class="ttdeci">Item * m_item_list</div><div class="ttdef"><b>Definition:</b> sql_class.h:232</div></div>
<div class="ttc" id="classProtocol__binary_html"><div class="ttname"><a href="classProtocol__binary.html">Protocol_binary</a></div><div class="ttdef"><b>Definition:</b> protocol_classic.h:238</div></div>
<div class="ttc" id="classTHD_html_a064818560c0ef3bc537f52b63499f3be"><div class="ttname"><a href="classTHD.html#a064818560c0ef3bc537f52b63499f3be">THD::fill_variables_recursion_level</a></div><div class="ttdeci">uint fill_variables_recursion_level</div><div class="ttdef"><b>Definition:</b> sql_class.h:1377</div></div>
<div class="ttc" id="classTHD_html_a6633fff886be7782ae52532dbf827344"><div class="ttname"><a href="classTHD.html#a6633fff886be7782ae52532dbf827344">THD::set_server_id</a></div><div class="ttdeci">void set_server_id(uint32 sid)</div><div class="ttdef"><b>Definition:</b> sql_class.h:1449</div></div>
<div class="ttc" id="namespaceundo_html_af16fb6085ef2e93316f4b550861c179c"><div class="ttname"><a href="namespaceundo.html#af16fb6085ef2e93316f4b550861c179c">undo::is_active</a></div><div class="ttdeci">bool is_active(space_id_t space_id, bool get_latch=true)</div><div class="ttdef"><b>Definition:</b> trx0purge.cc:1137</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240baf0fd6f2211b556e963a48a1f3a421ade"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baf0fd6f2211b556e963a48a1f3a421ade">SYSTEM_THREAD_EVENT_WORKER</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:39</div></div>
<div class="ttc" id="classTHD_html_aca83b78be787a3204ea98dadcc5e563d"><div class="ttname"><a href="classTHD.html#aca83b78be787a3204ea98dadcc5e563d">THD::LOCK_current_cond</a></div><div class="ttdeci">mysql_mutex_t LOCK_current_cond</div><div class="ttdoc">Mutex protecting access to current_mutex and current_cond. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1307</div></div>
<div class="ttc" id="classTHD_html_ad428f042d033a86b6618d8c2ca9aaf9e"><div class="ttname"><a href="classTHD.html#ad428f042d033a86b6618d8c2ca9aaf9e">THD::killed</a></div><div class="ttdeci">std::atomic&lt; killed_state &gt; killed</div><div class="ttdef"><b>Definition:</b> sql_class.h:2397</div></div>
<div class="ttc" id="classTHD_html_ad9803661804b24613cc97d5cb42fb8e8"><div class="ttname"><a href="classTHD.html#ad9803661804b24613cc97d5cb42fb8e8">THD::query_name_consts</a></div><div class="ttdeci">uint query_name_consts</div><div class="ttdoc">number of name_const() substitutions, see sp_head.cc:subst_spvars() </div><div class="ttdef"><b>Definition:</b> sql_class.h:2484</div></div>
<div class="ttc" id="sql_2handler_8h_html_af40f16fb4f6b573dcc6763e7a847c7ae"><div class="ttname"><a href="sql_2handler_8h.html#af40f16fb4f6b573dcc6763e7a847c7ae">ha_notification_type</a></div><div class="ttdeci">ha_notification_type</div><div class="ttdef"><b>Definition:</b> handler.h:914</div></div>
<div class="ttc" id="query__options_8h_html_a8d83dd7bcb6b71b786015c699693043f"><div class="ttname"><a href="query__options_8h.html#a8d83dd7bcb6b71b786015c699693043f">OPTION_NOT_AUTOCOMMIT</a></div><div class="ttdeci">#define OPTION_NOT_AUTOCOMMIT</div><div class="ttdef"><b>Definition:</b> query_options.h:73</div></div>
<div class="ttc" id="classhandler_html"><div class="ttname"><a href="classhandler.html">handler</a></div><div class="ttdoc">The handler class is the interface for dynamically loadable storage engines. </div><div class="ttdef"><b>Definition:</b> handler.h:4032</div></div>
<div class="ttc" id="namespacebuf_html"><div class="ttname"><a href="namespacebuf.html">buf</a></div><div class="ttdef"><b>Definition:</b> buf0block_hint.cc:29</div></div>
<div class="ttc" id="structGtid_html_a459c77dd4b1918fa7760fa5b0588ce79"><div class="ttname"><a href="structGtid.html#a459c77dd4b1918fa7760fa5b0588ce79">Gtid::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Set both components to 0. </div><div class="ttdef"><b>Definition:</b> rpl_gtid.h:1034</div></div>
<div class="ttc" id="classTHD_html_abfc621ef5e64ce7878efa9d32ca2d04d"><div class="ttname"><a href="classTHD.html#abfc621ef5e64ce7878efa9d32ca2d04d">THD::change_item_tree</a></div><div class="ttdeci">void change_item_tree(Item **place, Item *new_value)</div><div class="ttdoc">Record a transient change to a pointer to an Item within another Item. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2993</div></div>
<div class="ttc" id="classTHD_html_a5bfef16ee415d9f45a2f28a0c63e5516"><div class="ttname"><a href="classTHD.html#a5bfef16ee415d9f45a2f28a0c63e5516">THD::set_system_user</a></div><div class="ttdeci">void set_system_user(bool system_user_flag)</div><div class="ttdoc">Sets the system_user flag atomically for the current session. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4354</div></div>
<div class="ttc" id="classTHD_html_acaa9e7e4d2d89e2428a3df881486fec4"><div class="ttname"><a href="classTHD.html#acaa9e7e4d2d89e2428a3df881486fec4">THD::set_secondary_engine_optimization</a></div><div class="ttdeci">void set_secondary_engine_optimization(Secondary_engine_optimization state)</div><div class="ttdoc">Enables or disables use of secondary storage engines in this session. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4243</div></div>
<div class="ttc" id="classTime__zone_html"><div class="ttname"><a href="classTime__zone.html">Time_zone</a></div><div class="ttdoc">This class represents abstract time zone and provides basic interface for MYSQL_TIME &lt;-&gt; my_time_t co...</div><div class="ttdef"><b>Definition:</b> tztime.h:51</div></div>
<div class="ttc" id="classTHD_html_a493e0d425484963d8d6d85d24db56677"><div class="ttname"><a href="classTHD.html#a493e0d425484963d8d6d85d24db56677">THD::m_query_string</a></div><div class="ttdeci">LEX_CSTRING m_query_string</div><div class="ttdoc">The query associated with this statement. </div><div class="ttdef"><b>Definition:</b> sql_class.h:875</div></div>
<div class="ttc" id="memcached_8h_html_add2ec924c0f221790d7235ffb2e615cd"><div class="ttname"><a href="memcached_8h.html#add2ec924c0f221790d7235ffb2e615cd">protocol</a></div><div class="ttdeci">protocol</div><div class="ttdef"><b>Definition:</b> memcached.h:112</div></div>
<div class="ttc" id="classTHD_html_a391cecc5b7f91691c6a69a1155a1d541"><div class="ttname"><a href="classTHD.html#a391cecc5b7f91691c6a69a1155a1d541">THD::get_examined_row_count</a></div><div class="ttdeci">ha_rows get_examined_row_count() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2119</div></div>
<div class="ttc" id="error__handler_8cc_html_a82ac7afffb412aab613d35b74421ba40"><div class="ttname"><a href="error__handler_8cc.html#a82ac7afffb412aab613d35b74421ba40">report_error</a></div><div class="ttdeci">static bool report_error(THD *thd, int error_code, Sql_condition::enum_severity_level level, Args... args)</div><div class="ttdef"><b>Definition:</b> error_handler.cc:290</div></div>
<div class="ttc" id="classSub__statement__state_html_a5adfbca8da11219bed70f1ff632a2bfa"><div class="ttname"><a href="classSub__statement__state.html#a5adfbca8da11219bed70f1ff632a2bfa">Sub_statement_state::current_found_rows</a></div><div class="ttdeci">ulonglong current_found_rows</div><div class="ttdef"><b>Definition:</b> sql_class.h:621</div></div>
<div class="ttc" id="classTHD_html_a5cd1849ef51bdf3c5a853d47f9a0c741"><div class="ttname"><a href="classTHD.html#a5cd1849ef51bdf3c5a853d47f9a0c741">THD::query_id</a></div><div class="ttdeci">query_id_t query_id</div><div class="ttdef"><b>Definition:</b> sql_class.h:2185</div></div>
<div class="ttc" id="rpl__context_8h_html"><div class="ttname"><a href="rpl__context_8h.html">rpl_context.h</a></div></div>
<div class="ttc" id="classGlobal__read__lock_html_a61224701430e9c30777782128db67367"><div class="ttname"><a href="classGlobal__read__lock.html#a61224701430e9c30777782128db67367">Global_read_lock::m_state</a></div><div class="ttdeci">enum_grl_state m_state</div><div class="ttdef"><b>Definition:</b> sql_class.h:744</div></div>
<div class="ttc" id="rpl__gtid_8h_html"><div class="ttname"><a href="rpl__gtid_8h.html">rpl_gtid.h</a></div></div>
<div class="ttc" id="classTHD_html_ab9d706bbac951a79e8cd6c5cead314f8"><div class="ttname"><a href="classTHD.html#ab9d706bbac951a79e8cd6c5cead314f8">THD::m_current_query_partial_plans</a></div><div class="ttdeci">ulonglong m_current_query_partial_plans</div><div class="ttdoc">Current query partial plans. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1009</div></div>
<div class="ttc" id="classTHD_html_a2d86c71c6d2786d5a084c104aa99b3e3"><div class="ttname"><a href="classTHD.html#a2d86c71c6d2786d5a084c104aa99b3e3">THD::mdl_context</a></div><div class="ttdeci">MDL_context mdl_context</div><div class="ttdef"><b>Definition:</b> sql_class.h:828</div></div>
<div class="ttc" id="classTHD_html_a09fd20ad9db99e403694e30723b3bf1f"><div class="ttname"><a href="classTHD.html#a09fd20ad9db99e403694e30723b3bf1f">THD::m_is_system_user</a></div><div class="ttdeci">std::atomic&lt; bool &gt; m_is_system_user</div><div class="ttdoc">Flag that indicates if the user of current session has SYSTEM_USER privilege. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4283</div></div>
<div class="ttc" id="classTHD_html_a5f3e30c9303f0878c5e7ab4296d9e952"><div class="ttname"><a href="classTHD.html#a5f3e30c9303f0878c5e7ab4296d9e952">THD::thread_stack</a></div><div class="ttdeci">const char * thread_stack</div><div class="ttdef"><b>Definition:</b> sql_class.h:1099</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240baadaddfd06f0dc6795a60005e7041f187"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baadaddfd06f0dc6795a60005e7041f187">SYSTEM_THREAD_SLAVE_SQL</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:36</div></div>
<div class="ttc" id="mysql__cond__bits_8h_html"><div class="ttname"><a href="mysql__cond__bits_8h.html">mysql_cond_bits.h</a></div><div class="ttdoc">Instrumentation helpers for conditions. </div></div>
<div class="ttc" id="classTHD_html_af51413ab3ce883addff226fa9603ab12"><div class="ttname"><a href="classTHD.html#af51413ab3ce883addff226fa9603ab12">THD::Commit_error</a></div><div class="ttdeci">Commit_error</div><div class="ttdef"><b>Definition:</b> sql_class.h:2370</div></div>
<div class="ttc" id="structNET__SERVER_html"><div class="ttname"><a href="structNET__SERVER.html">NET_SERVER</a></div><div class="ttdef"><b>Definition:</b> mysql_com_server.h:58</div></div>
<div class="ttc" id="classString_html"><div class="ttname"><a href="classString.html">String</a></div><div class="ttdoc">Using this class is fraught with peril, and you need to be very careful when doing so...</div><div class="ttdef"><b>Definition:</b> sql_string.h:164</div></div>
<div class="ttc" id="dur__prop_8h_html"><div class="ttname"><a href="dur__prop_8h.html">dur_prop.h</a></div></div>
<div class="ttc" id="classTHD_html_ae7a84550105a38cec599aa5c07621b7b"><div class="ttname"><a href="classTHD.html#ae7a84550105a38cec599aa5c07621b7b">THD::main_mem_root</a></div><div class="ttdeci">MEM_ROOT main_mem_root</div><div class="ttdoc">This memory root is used for two purposes: </div><div class="ttdef"><b>Definition:</b> sql_class.h:3986</div></div>
<div class="ttc" id="classQuery__arena_html_abdf099c0fd4c83bcf7edcc8520c34a12"><div class="ttname"><a href="classQuery__arena.html#abdf099c0fd4c83bcf7edcc8520c34a12">Query_arena::set_state</a></div><div class="ttdeci">void set_state(enum_state state_arg)</div><div class="ttdef"><b>Definition:</b> sql_class.h:288</div></div>
<div class="ttc" id="sql__servers_8cc_html_a664bdac526e13ad70b21edf13c1a0e64"><div class="ttname"><a href="sql__servers_8cc.html#a664bdac526e13ad70b21edf13c1a0e64">mem</a></div><div class="ttdeci">static MEM_ROOT mem</div><div class="ttdef"><b>Definition:</b> sql_servers.cc:98</div></div>
<div class="ttc" id="mysql__com_8h_html_a1d854e841086925be1883e4d7b4e8cada1f53c7403e030b7699ed3b4ad237012b"><div class="ttname"><a href="mysql__com_8h.html#a1d854e841086925be1883e4d7b4e8cada1f53c7403e030b7699ed3b4ad237012b">SERVER_STATUS_IN_TRANS</a></div><div class="ttdoc">Is raised when a multi-statement transaction has been started, either explicitly, by means of BEGIN o...</div><div class="ttdef"><b>Definition:</b> mysql_com.h:775</div></div>
<div class="ttc" id="myisampack_8cc_html_ac9a4b7317723254f2c79bffcd3265666"><div class="ttname"><a href="myisampack_8cc.html#ac9a4b7317723254f2c79bffcd3265666">backup</a></div><div class="ttdeci">static bool backup</div><div class="ttdef"><b>Definition:</b> myisampack.cc:194</div></div>
<div class="ttc" id="classTHD_html_a6963970384186fdc5af8ec638ccb259a"><div class="ttname"><a href="classTHD.html#a6963970384186fdc5af8ec638ccb259a">THD::m_transaction_psi</a></div><div class="ttdeci">PSI_transaction_locker * m_transaction_psi</div><div class="ttdoc">Current transaction instrumentation. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2162</div></div>
<div class="ttc" id="classTHD_html_a4e6591d86a3b396427a04e17f583a0bd"><div class="ttname"><a href="classTHD.html#a4e6591d86a3b396427a04e17f583a0bd">THD::is_dd_system_thread</a></div><div class="ttdeci">bool is_dd_system_thread() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2220</div></div>
<div class="ttc" id="classSql__cmd__common__signal_html"><div class="ttname"><a href="classSql__cmd__common__signal.html">Sql_cmd_common_signal</a></div><div class="ttdoc">Sql_cmd_common_signal represents the common properties of the SIGNAL and RESIGNAL statements...</div><div class="ttdef"><b>Definition:</b> sql_signal.h:87</div></div>
<div class="ttc" id="classTHD_html_a15d25a98d6d23440c0bf3aa037d9f3dd"><div class="ttname"><a href="classTHD.html#a15d25a98d6d23440c0bf3aa037d9f3dd">THD::fill_status_recursion_level</a></div><div class="ttdeci">uint fill_status_recursion_level</div><div class="ttdoc">Used by fill_status() to avoid acquiring LOCK_status mutex twice when this function is called recursi...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1376</div></div>
<div class="ttc" id="lex__string_8h_html"><div class="ttname"><a href="lex__string_8h.html">lex_string.h</a></div></div>
<div class="ttc" id="classTHD_html_af39e05df2c6ac87fa5d540b0387c951d"><div class="ttname"><a href="classTHD.html#af39e05df2c6ac87fa5d540b0387c951d">THD::release_resources_done</a></div><div class="ttdeci">bool release_resources_done() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2582</div></div>
<div class="ttc" id="my__dbug_8h_html_a1f2d1168faa35ce15f1b058a5fe9c630"><div class="ttname"><a href="my__dbug_8h.html#a1f2d1168faa35ce15f1b058a5fe9c630">DBUG_EXECUTE_IF</a></div><div class="ttdeci">#define DBUG_EXECUTE_IF(keyword, a1)</div><div class="ttdef"><b>Definition:</b> my_dbug.h:171</div></div>
<div class="ttc" id="structTABLE_html"><div class="ttname"><a href="structTABLE.html">TABLE</a></div><div class="ttdef"><b>Definition:</b> table.h:1363</div></div>
<div class="ttc" id="classQuery__arena_html_ab1c88786a7adf53e61fa30f32a1ed409"><div class="ttname"><a href="classQuery__arena.html#ab1c88786a7adf53e61fa30f32a1ed409">Query_arena::mem_strdup</a></div><div class="ttdeci">char * mem_strdup(const char *str)</div><div class="ttdef"><b>Definition:</b> sql_class.h:315</div></div>
<div class="ttc" id="classTHD_html_a7316fb38d263971ebbf17f493a698d87"><div class="ttname"><a href="classTHD.html#a7316fb38d263971ebbf17f493a698d87">THD::m_query_rewrite_plugin_da_ptr</a></div><div class="ttdeci">Diagnostics_area * m_query_rewrite_plugin_da_ptr</div><div class="ttdef"><b>Definition:</b> sql_class.h:3990</div></div>
<div class="ttc" id="classTHD_html_a33269b783c4ed83ae7df446486b8bc30"><div class="ttname"><a href="classTHD.html#a33269b783c4ed83ae7df446486b8bc30">THD::col_access</a></div><div class="ttdeci">ulong col_access</div><div class="ttdef"><b>Definition:</b> sql_class.h:2186</div></div>
<div class="ttc" id="mysql__com_8h_html"><div class="ttname"><a href="mysql__com_8h.html">mysql_com.h</a></div><div class="ttdoc">Common definition between mysql server &amp; client. </div></div>
<div class="ttc" id="classTHD_html_aa5bd3959377c9e18f18cc4bf0614547b"><div class="ttname"><a href="classTHD.html#aa5bd3959377c9e18f18cc4bf0614547b">THD::get_invoker_host</a></div><div class="ttdeci">LEX_CSTRING get_invoker_host() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3969</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240ba8973dd3c3c6eefc671cd7d1f1d4bfaa3"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba8973dd3c3c6eefc671cd7d1f1d4bfaa3">SYSTEM_THREAD_DD_RESTART</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:45</div></div>
<div class="ttc" id="opt__costmodel_8h_html"><div class="ttname"><a href="opt__costmodel_8h.html">opt_costmodel.h</a></div></div>
<div class="ttc" id="classTHD_html_a305a07e95c586b3280fe993a80c74542"><div class="ttname"><a href="classTHD.html#a305a07e95c586b3280fe993a80c74542">THD::get_stmt_da</a></div><div class="ttdeci">Diagnostics_area * get_stmt_da()</div><div class="ttdoc">Returns first Diagnostics Area for the current statement. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2911</div></div>
<div class="ttc" id="sql__connect_8h_html"><div class="ttname"><a href="sql__connect_8h.html">sql_connect.h</a></div></div>
<div class="ttc" id="psi__base_8h_html"><div class="ttname"><a href="psi__base_8h.html">psi_base.h</a></div><div class="ttdoc">Performance schema instrumentation interface. </div></div>
<div class="ttc" id="classTHD_html_a23d4ed19f8e834ad0e09db758e74debc"><div class="ttname"><a href="classTHD.html#a23d4ed19f8e834ad0e09db758e74debc">THD::slave_thread</a></div><div class="ttdeci">bool slave_thread</div><div class="ttdef"><b>Definition:</b> sql_class.h:2420</div></div>
<div class="ttc" id="classTHD_html_ad144721886ad0ea1a5a7d879bbfd6a3a"><div class="ttname"><a href="classTHD.html#ad144721886ad0ea1a5a7d879bbfd6a3a">THD::read_first_successful_insert_id_in_prev_stmt</a></div><div class="ttdeci">ulonglong read_first_successful_insert_id_in_prev_stmt(void)</div><div class="ttdef"><b>Definition:</b> sql_class.h:1974</div></div>
<div class="ttc" id="classTHD_html_a41888d0827af3eec9d3dd736de490160"><div class="ttname"><a href="classTHD.html#a41888d0827af3eec9d3dd736de490160">THD::reset_query</a></div><div class="ttdeci">void reset_query()</div><div class="ttdef"><b>Definition:</b> sql_class.h:3805</div></div>
<div class="ttc" id="classSub__statement__state_html_a2a79b5f1892b00dbde5fda6cb4067157"><div class="ttname"><a href="classSub__statement__state.html#a2a79b5f1892b00dbde5fda6cb4067157">Sub_statement_state::enable_slow_log</a></div><div class="ttdeci">bool enable_slow_log</div><div class="ttdef"><b>Definition:</b> sql_class.h:626</div></div>
<div class="ttc" id="classTHD_html_af51413ab3ce883addff226fa9603ab12a4ac4de4fe90c120618f88b3b0f32af7c"><div class="ttname"><a href="classTHD.html#af51413ab3ce883addff226fa9603ab12a4ac4de4fe90c120618f88b3b0f32af7c">THD::CE_COMMIT_ERROR</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:2374</div></div>
<div class="ttc" id="classTHD_html_a2a3514bd66bfed7e8be6d8d138ca364f"><div class="ttname"><a href="classTHD.html#a2a3514bd66bfed7e8be6d8d138ca364f">THD::m_statement_state</a></div><div class="ttdeci">PSI_statement_locker_state m_statement_state</div><div class="ttdoc">Current statement instrumentation state. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2158</div></div>
<div class="ttc" id="classTHD_html_ae0ad60baeef524e7242c663c555aa732"><div class="ttname"><a href="classTHD.html#ae0ad60baeef524e7242c663c555aa732">THD::reset_rewritten_query</a></div><div class="ttdeci">void reset_rewritten_query()</div><div class="ttdoc">Reset thd-&gt;m_rewritten_query. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3842</div></div>
<div class="ttc" id="classTHD_html_a7a1ba495765a2c8dafac08d048bed709"><div class="ttname"><a href="classTHD.html#a7a1ba495765a2c8dafac08d048bed709">THD::collation</a></div><div class="ttdeci">const CHARSET_INFO * collation()</div><div class="ttdef"><b>Definition:</b> sql_class.h:2757</div></div>
<div class="ttc" id="psi__memory__key_8cc_html_abf35066bd8735e191b6f89455113e2c5"><div class="ttname"><a href="psi__memory__key_8cc.html#abf35066bd8735e191b6f89455113e2c5">key_memory_User_level_lock</a></div><div class="ttdeci">PSI_memory_key key_memory_User_level_lock</div><div class="ttdef"><b>Definition:</b> psi_memory_key.cc:91</div></div>
<div class="ttc" id="classTHD_html_a28d9ac07105667219fee7134affb0e89"><div class="ttname"><a href="classTHD.html#a28d9ac07105667219fee7134affb0e89">THD::m_invoker_host</a></div><div class="ttdeci">LEX_CSTRING m_invoker_host</div><div class="ttdef"><b>Definition:</b> sql_class.h:4012</div></div>
<div class="ttc" id="classGlobal__read__lock_html_a9ca6e13d1fea6ecfc78312f0ef957429"><div class="ttname"><a href="classGlobal__read__lock.html#a9ca6e13d1fea6ecfc78312f0ef957429">Global_read_lock::Global_read_lock</a></div><div class="ttdeci">Global_read_lock()</div><div class="ttdef"><b>Definition:</b> sql_class.h:713</div></div>
<div class="ttc" id="classPrepared__statement__map_html_ad157f743044ec2dc7b41cd2bcd23d6eb"><div class="ttname"><a href="classPrepared__statement__map.html#ad157f743044ec2dc7b41cd2bcd23d6eb">Prepared_statement_map::st_hash</a></div><div class="ttdeci">malloc_unordered_map&lt; ulong, std::unique_ptr&lt; Prepared_statement &gt; &gt; st_hash</div><div class="ttdef"><b>Definition:</b> sql_class.h:395</div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html_a908901cfb52de0265f0dc8070e181be1"><div class="ttname"><a href="classTHD_1_1Query__plan.html#a908901cfb52de0265f0dc8070e181be1">THD::Query_plan::modification_plan</a></div><div class="ttdeci">const Modification_plan * modification_plan</div><div class="ttdoc">Query plan for UPDATE/DELETE/INSERT/REPLACE. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1211</div></div>
<div class="ttc" id="my__dbug_8h_html_a3770d2ff545ed3e4b714d20014e663df"><div class="ttname"><a href="my__dbug_8h.html#a3770d2ff545ed3e4b714d20014e663df">DBUG_PRINT</a></div><div class="ttdeci">#define DBUG_PRINT(keyword, arglist)</div><div class="ttdef"><b>Definition:</b> my_dbug.h:181</div></div>
<div class="ttc" id="classTHD_html_ab26acc1bf65cde84b61d0e6d5981d238"><div class="ttname"><a href="classTHD.html#ab26acc1bf65cde84b61d0e6d5981d238">THD::get_binlog_table_maps</a></div><div class="ttdeci">uint get_binlog_table_maps() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1646</div></div>
<div class="ttc" id="classParser__state_html"><div class="ttname"><a href="classParser__state.html">Parser_state</a></div><div class="ttdoc">Internal state of the parser. </div><div class="ttdef"><b>Definition:</b> sql_lex.h:4378</div></div>
<div class="ttc" id="classTHD_html_a234e4d45ceafcff8f49ace05c8c32ad5"><div class="ttname"><a href="classTHD.html#a234e4d45ceafcff8f49ace05c8c32ad5">THD::is_log_reset</a></div><div class="ttdeci">bool is_log_reset() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3449</div></div>
<div class="ttc" id="my__base_8h_html"><div class="ttname"><a href="my__base_8h.html">my_base.h</a></div><div class="ttdoc">This file includes constants used by all storage engines. </div></div>
<div class="ttc" id="classSub__statement__state_html_a47a31bd174b892769cc4c118e62478e3"><div class="ttname"><a href="classSub__statement__state.html#a47a31bd174b892769cc4c118e62478e3">Sub_statement_state::first_successful_insert_id_in_cur_stmt</a></div><div class="ttdeci">ulonglong first_successful_insert_id_in_cur_stmt</div><div class="ttdef"><b>Definition:</b> sql_class.h:619</div></div>
<div class="ttc" id="group__psi__abi__transaction_html_ga88504a3aa3d24a2e5011a80ded544639"><div class="ttname"><a href="group__psi__abi__transaction.html#ga88504a3aa3d24a2e5011a80ded544639">PSI_transaction_locker</a></div><div class="ttdeci">struct PSI_transaction_locker PSI_transaction_locker</div><div class="ttdef"><b>Definition:</b> psi_transaction_bits.h:40</div></div>
<div class="ttc" id="classTHD_html_ada89e74e06af31a8b4e1f43d792c7083"><div class="ttname"><a href="classTHD.html#ada89e74e06af31a8b4e1f43d792c7083">THD::reset_query_for_display</a></div><div class="ttdeci">void reset_query_for_display(void)</div><div class="ttdef"><b>Definition:</b> sql_class.h:3794</div></div>
<div class="ttc" id="m__ctype_8h_html_a3d5e399bacf45a3a3263a2dad25dfd1a"><div class="ttname"><a href="m__ctype_8h.html#a3d5e399bacf45a3a3263a2dad25dfd1a">system_charset_info</a></div><div class="ttdeci">MYSQL_PLUGIN_IMPORT CHARSET_INFO * system_charset_info</div><div class="ttdef"><b>Definition:</b> mysqld.cc:1448</div></div>
<div class="ttc" id="structLEX__USER_html"><div class="ttname"><a href="structLEX__USER.html">LEX_USER</a></div><div class="ttdef"><b>Definition:</b> table.h:2432</div></div>
<div class="ttc" id="classQuery__arena_html_a6c35aaf846a0de86b5f8e0960f5648d2"><div class="ttname"><a href="classQuery__arena.html#a6c35aaf846a0de86b5f8e0960f5648d2">Query_arena::strmake</a></div><div class="ttdeci">char * strmake(const char *str, size_t size) const</div><div class="ttdef"><b>Definition:</b> sql_class.h:316</div></div>
<div class="ttc" id="structGtid_html_a36b73175b879388152c746453ee2b87a"><div class="ttname"><a href="structGtid.html#a36b73175b879388152c746453ee2b87a">Gtid::is_empty</a></div><div class="ttdeci">bool is_empty() const</div><div class="ttdoc">Return true if sidno is zero (and assert that gno is zero too in this case). </div><div class="ttdef"><b>Definition:</b> rpl_gtid.h:1049</div></div>
<div class="ttc" id="classTHD_html_a20f10a73dcdd87a36f58d75a059fc564"><div class="ttname"><a href="classTHD.html#a20f10a73dcdd87a36f58d75a059fc564">THD::Se_GTID_flagset</a></div><div class="ttdeci">std::bitset&lt; SE_GTID_MAX &gt; Se_GTID_flagset</div><div class="ttdef"><b>Definition:</b> sql_class.h:3421</div></div>
<div class="ttc" id="classTHD_html_ae713d291ab580e907879e0eaeecc2a00"><div class="ttname"><a href="classTHD.html#ae713d291ab580e907879e0eaeecc2a00">THD::set_gtid_persisted_by_se</a></div><div class="ttdeci">void set_gtid_persisted_by_se()</div><div class="ttdoc">Set by SE when it guarantees GTID persistence. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3452</div></div>
<div class="ttc" id="structTHD__timer__info_html"><div class="ttname"><a href="structTHD__timer__info.html">THD_timer_info</a></div><div class="ttdef"><b>Definition:</b> sql_timer.cc:53</div></div>
<div class="ttc" id="classPrealloced__array_html"><div class="ttname"><a href="classPrealloced__array.html">Prealloced_array&lt; Reprepare_observer *, 4 &gt;</a></div></div>
<div class="ttc" id="my__dbug_8h_html_af5d75f213550ec27715b65d9bdfa45ec"><div class="ttname"><a href="my__dbug_8h.html#af5d75f213550ec27715b65d9bdfa45ec">DBUG_ASSERT</a></div><div class="ttdeci">#define DBUG_ASSERT(A)</div><div class="ttdef"><b>Definition:</b> my_dbug.h:199</div></div>
<div class="ttc" id="classTHD_html_a51b1256db4ab889d94e04e91e2278deb"><div class="ttname"><a href="classTHD.html#a51b1256db4ab889d94e04e91e2278deb">THD::derived_tables_processing</a></div><div class="ttdeci">bool derived_tables_processing</div><div class="ttdef"><b>Definition:</b> sql_class.h:2474</div></div>
<div class="ttc" id="sql__class_8h_html_aa932766edc1bc08140164f5360f25bb4"><div class="ttname"><a href="sql__class_8h.html#aa932766edc1bc08140164f5360f25bb4">thd_set_waiting_for_disk_space</a></div><div class="ttdeci">void thd_set_waiting_for_disk_space(void *opaque_thd, const bool waiting)</div><div class="ttdef"><b>Definition:</b> sql_thd_internal_api.cc:164</div></div>
<div class="ttc" id="classPrealloced__array_html_abe9bdf6bb8bca24028cbf148f2cd2bb2"><div class="ttname"><a href="classPrealloced__array.html#abe9bdf6bb8bca24028cbf148f2cd2bb2">Prealloced_array::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> prealloced_array.h:217</div></div>
<div class="ttc" id="classGlobal__read__lock_html_af95c661261a4863e6b80969b63c1db30a6480c459ce00b17959b844ffb141327e"><div class="ttname"><a href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30a6480c459ce00b17959b844ffb141327e">Global_read_lock::GRL_ACQUIRED</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:709</div></div>
<div class="ttc" id="classTHD_html_a269884bb8e788099217d1193c94afac6"><div class="ttname"><a href="classTHD.html#a269884bb8e788099217d1193c94afac6">THD::dbug_sentry</a></div><div class="ttdeci">uint dbug_sentry</div><div class="ttdef"><b>Definition:</b> sql_class.h:1301</div></div>
<div class="ttc" id="m__string_8h_html_accb13dc1bbc754b77a9ecd9c3e832595"><div class="ttname"><a href="m__string_8h.html#accb13dc1bbc754b77a9ecd9c3e832595">strmake</a></div><div class="ttdeci">char * strmake(char *dst, const char *src, size_t length)</div><div class="ttdef"><b>Definition:</b> strmake.cc:42</div></div>
<div class="ttc" id="classTHD_html_adccdd5e05e006547b17e17206f364469"><div class="ttname"><a href="classTHD.html#adccdd5e05e006547b17e17206f364469">THD::backup_ha_data</a></div><div class="ttdeci">void backup_ha_data(Prealloced_array&lt; Ha_data, PREALLOC_NUM_HA &gt; *backup)</div><div class="ttdoc">Copy ha_data into the provided argument. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1392</div></div>
<div class="ttc" id="sql__class_8h_html_a72c83217b7613b5afda5d424fe70d56eae6e50391869cd06da36e384421075226"><div class="ttname"><a href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56eae6e50391869cd06da36e384421075226">Secondary_engine_optimization::PRIMARY_TENTATIVELY</a></div><div class="ttdoc">The current statement should only use tables from the primary storage engine. </div></div>
<div class="ttc" id="classTHD_html_aa94228d38f66fefe787d037ee54cd69b"><div class="ttname"><a href="classTHD.html#aa94228d38f66fefe787d037ee54cd69b">THD::file_id</a></div><div class="ttdeci">uint32 file_id</div><div class="ttdef"><b>Definition:</b> sql_class.h:1344</div></div>
<div class="ttc" id="classTHD_html_a51a6b836dd5eb7125b21d0093002052f"><div class="ttname"><a href="classTHD.html#a51a6b836dd5eb7125b21d0093002052f">THD::lock_info</a></div><div class="ttdeci">THR_LOCK_INFO lock_info</div><div class="ttdef"><b>Definition:</b> sql_class.h:1035</div></div>
<div class="ttc" id="current__thd_8h_html"><div class="ttname"><a href="current__thd_8h.html">current_thd.h</a></div></div>
<div class="ttc" id="classGlobal__read__lock_html_a184e5ade656ab4c0a269875930239847"><div class="ttname"><a href="classGlobal__read__lock.html#a184e5ade656ab4c0a269875930239847">Global_read_lock::m_mdl_global_shared_lock</a></div><div class="ttdeci">MDL_ticket * m_mdl_global_shared_lock</div><div class="ttdoc">In order to acquire the global read lock, the connection must acquire shared metadata lock in GLOBAL ...</div><div class="ttdef"><b>Definition:</b> sql_class.h:750</div></div>
<div class="ttc" id="classTHD_html_a413bc5f40af312f9423dab928f87b533"><div class="ttname"><a href="classTHD.html#a413bc5f40af312f9423dab928f87b533">THD::current_stmt_binlog_format</a></div><div class="ttdeci">enum_binlog_format current_stmt_binlog_format</div><div class="ttdoc">Indicates the format in which the current statement will be logged. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1587</div></div>
<div class="ttc" id="classTHD_html_a2300257d01cd62fda2c76054c7494f82"><div class="ttname"><a href="classTHD.html#a2300257d01cd62fda2c76054c7494f82">THD::enter_cond</a></div><div class="ttdeci">void enter_cond(mysql_cond_t *cond, mysql_mutex_t *mutex, const PSI_stage_info *stage, PSI_stage_info *old_stage, const char *src_function, const char *src_file, int src_line) override</div><div class="ttdoc">Enter a condition wait. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2676</div></div>
<div class="ttc" id="discrete__interval_8h_html"><div class="ttname"><a href="discrete__interval_8h.html">discrete_interval.h</a></div></div>
<div class="ttc" id="classTHD_html_a73557dd67cd09b87e5ccce960a9e526d"><div class="ttname"><a href="classTHD.html#a73557dd67cd09b87e5ccce960a9e526d">THD::get_row_count_func</a></div><div class="ttdeci">longlong get_row_count_func() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2071</div></div>
<div class="ttc" id="system__variables_8h_html_a2279a47c49e41b76069e24d5061aa905"><div class="ttname"><a href="system__variables_8h.html#a2279a47c49e41b76069e24d5061aa905">MODE_STRICT_TRANS_TABLES</a></div><div class="ttdeci">#define MODE_STRICT_TRANS_TABLES</div><div class="ttdef"><b>Definition:</b> system_variables.h:111</div></div>
<div class="ttc" id="classTHD_html_a3591aefeafcb7af9d70f295029a26b2e"><div class="ttname"><a href="classTHD.html#a3591aefeafcb7af9d70f295029a26b2e">THD::thread_id</a></div><div class="ttdeci">my_thread_id thread_id() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2211</div></div>
<div class="ttc" id="mysql__config__editor_8cc_html_ab279a50ac7547100cf5ed7835314e534"><div class="ttname"><a href="mysql__config__editor_8cc.html#ab279a50ac7547100cf5ed7835314e534">set_command</a></div><div class="ttdeci">static int set_command(void)</div><div class="ttdoc">Execute &amp;#39;set&amp;#39; command. </div><div class="ttdef"><b>Definition:</b> mysql_config_editor.cc:494</div></div>
<div class="ttc" id="classRelay__log__info_html"><div class="ttname"><a href="classRelay__log__info.html">Relay_log_info</a></div><div class="ttdef"><b>Definition:</b> rpl_rli.h:165</div></div>
<div class="ttc" id="classTHD_html_ac2ef222abca3ee61f63b2240a56c5c2d"><div class="ttname"><a href="classTHD.html#ac2ef222abca3ee61f63b2240a56c5c2d">THD::tmp_table_seq_id</a></div><div class="ttdeci">uint tmp_table_seq_id</div><div class="ttdoc">Sequential number of internal tmp table created in the statement. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4201</div></div>
<div class="ttc" id="classTHD_html_a7bb3d82e62fc0c437b4c5dba80135a0c"><div class="ttname"><a href="classTHD.html#a7bb3d82e62fc0c437b4c5dba80135a0c">THD::auto_inc_intervals_in_cur_stmt_for_binlog</a></div><div class="ttdeci">Discrete_intervals_list auto_inc_intervals_in_cur_stmt_for_binlog</div><div class="ttdef"><b>Definition:</b> sql_class.h:1931</div></div>
<div class="ttc" id="classTHD_html_ae773b651f12e538da8ebd724c5b91245"><div class="ttname"><a href="classTHD.html#ae773b651f12e538da8ebd724c5b91245">THD::mark_as_srv_session</a></div><div class="ttdeci">void mark_as_srv_session()</div><div class="ttdef"><b>Definition:</b> sql_class.h:4158</div></div>
<div class="ttc" id="classTHD_html_a6f87c01afcdc38d1d35febe203c8fbed"><div class="ttname"><a href="classTHD.html#a6f87c01afcdc38d1d35febe203c8fbed">THD::timer_cache</a></div><div class="ttdeci">struct THD_timer_info * timer_cache</div><div class="ttdoc">After resetting(cancelling) timer, current timer object is cached with timer_cache timer to reuse...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1566</div></div>
<div class="ttc" id="classTHD_html_afcc9975b25b793a4670694a4d5fd447d"><div class="ttname"><a href="classTHD.html#afcc9975b25b793a4670694a4d5fd447d">THD::is_stmt_prepare_or_first_sp_execute</a></div><div class="ttdeci">bool is_stmt_prepare_or_first_sp_execute() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:812</div></div>
<div class="ttc" id="do__ctype_8cc_html_ab5ad9aa3d3e725ca44ebfa85e0b1020d"><div class="ttname"><a href="do__ctype_8cc.html#ab5ad9aa3d3e725ca44ebfa85e0b1020d">pos</a></div><div class="ttdeci">char * pos</div><div class="ttdef"><b>Definition:</b> do_ctype.cc:76</div></div>
<div class="ttc" id="classTHD_html_ae8446418aabab529bcf8e8781e7d36f3"><div class="ttname"><a href="classTHD.html#ae8446418aabab529bcf8e8781e7d36f3">THD::m_enable_plugins</a></div><div class="ttdeci">bool m_enable_plugins</div><div class="ttdef"><b>Definition:</b> sql_class.h:2556</div></div>
<div class="ttc" id="classOpen__tables__state_html_ad083bb3ef57825565efbe36b2e2b4679"><div class="ttname"><a href="classOpen__tables__state.html#ad083bb3ef57825565efbe36b2e2b4679">Open_tables_state::pop_reprepare_observer</a></div><div class="ttdeci">Reprepare_observer * pop_reprepare_observer()</div><div class="ttdef"><b>Definition:</b> sql_class.h:463</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_a7846e38cc12d856d71f807d26f032a2d"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#a7846e38cc12d856d71f807d26f032a2d">THD::Transaction_state::m_transaction_rollback_request</a></div><div class="ttdeci">bool m_transaction_rollback_request</div><div class="ttdoc">Transaction rollback request flag. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1723</div></div>
<div class="ttc" id="thr__lock_8h_html_a43801b0a0281484bf8f90c80d701ccb3"><div class="ttname"><a href="thr__lock_8h.html#a43801b0a0281484bf8f90c80d701ccb3">thr_lock_type</a></div><div class="ttdeci">thr_lock_type</div><div class="ttdef"><b>Definition:</b> thr_lock.h:50</div></div>
<div class="ttc" id="classTHD_html_af984e3ca683e5a02c5ad0a21fa36a1ca"><div class="ttname"><a href="classTHD.html#af984e3ca683e5a02c5ad0a21fa36a1ca">THD::set_open_tables</a></div><div class="ttdeci">void set_open_tables(TABLE *open_tables_arg)</div><div class="ttdoc">Assign a new value to open_tables. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3864</div></div>
<div class="ttc" id="classTHD_html_a9ed6f3917f069b1e274706b563277efa"><div class="ttname"><a href="classTHD.html#a9ed6f3917f069b1e274706b563277efa">THD::skip_readonly_check</a></div><div class="ttdeci">bool skip_readonly_check</div><div class="ttdef"><b>Definition:</b> sql_class.h:1573</div></div>
<div class="ttc" id="classTHD_1_1Attachable__trx_html_ac27a855c8b5dd7217a1bf75a0f53bf87"><div class="ttname"><a href="classTHD_1_1Attachable__trx.html#ac27a855c8b5dd7217a1bf75a0f53bf87">THD::Attachable_trx::m_reset_lex</a></div><div class="ttdeci">enum_reset_lex m_reset_lex</div><div class="ttdef"><b>Definition:</b> sql_class.h:1750</div></div>
<div class="ttc" id="classTHD_html_ae66b7e9449e141780dd88efcaba98c16"><div class="ttname"><a href="classTHD.html#ae66b7e9449e141780dd88efcaba98c16">THD::clear_error</a></div><div class="ttdeci">void clear_error()</div><div class="ttdoc">Clear the current error, if any. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2876</div></div>
<div class="ttc" id="prealloced__array_8h_html"><div class="ttname"><a href="prealloced__array_8h.html">prealloced_array.h</a></div></div>
<div class="ttc" id="classTHD_html_a8cf26759b6f4cb27f4d583f220a974c2"><div class="ttname"><a href="classTHD.html#a8cf26759b6f4cb27f4d583f220a974c2">THD::skip_gtid_rollback</a></div><div class="ttdeci">bool skip_gtid_rollback</div><div class="ttdef"><b>Definition:</b> sql_class.h:3520</div></div>
<div class="ttc" id="test__mysql__runtime__error_8cc_html_ab3b3804e3bf2734c0f4f1c72f30df1bd"><div class="ttname"><a href="test__mysql__runtime__error_8cc.html#ab3b3804e3bf2734c0f4f1c72f30df1bd">MYF</a></div><div class="ttdeci">#define MYF(v)</div></div>
<div class="ttc" id="classQuery__arena_html_a7a5e86f5a1af6e9b6c59069a1bedb037"><div class="ttname"><a href="classQuery__arena.html#a7a5e86f5a1af6e9b6c59069a1bedb037">Query_arena::is_regular</a></div><div class="ttdeci">bool is_regular() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:298</div></div>
<div class="ttc" id="classTHD_html_af1141e7ffe7be501c9924f1b1f34ec78a8695c6e72fc3ab7f000c1edbeb62f337"><div class="ttname"><a href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78a8695c6e72fc3ab7f000c1edbeb62f337">THD::SE_GTID_PERSIST</a></div><div class="ttdoc">SE would persist GTID for current transaction. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3414</div></div>
<div class="ttc" id="classQuery__arena_html"><div class="ttname"><a href="classQuery__arena.html">Query_arena</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:226</div></div>
<div class="ttc" id="classPrepared__statement__map_html_a67d532a9be8ddd03a53acae3b0493dac"><div class="ttname"><a href="classPrepared__statement__map.html#a67d532a9be8ddd03a53acae3b0493dac">Prepared_statement_map::m_last_found_statement</a></div><div class="ttdeci">Prepared_statement * m_last_found_statement</div><div class="ttdef"><b>Definition:</b> sql_class.h:397</div></div>
<div class="ttc" id="classTHD_html_ac2448f4024806acc55a714a168855983"><div class="ttname"><a href="classTHD.html#ac2448f4024806acc55a714a168855983">THD::first_query_id</a></div><div class="ttdeci">query_id_t first_query_id</div><div class="ttdef"><b>Definition:</b> sql_class.h:2524</div></div>
<div class="ttc" id="structPSI__stage__info__v1_html"><div class="ttname"><a href="structPSI__stage__info__v1.html">PSI_stage_info_v1</a></div><div class="ttdoc">Stage instrument information. </div><div class="ttdef"><b>Definition:</b> psi_stage_bits.h:71</div></div>
<div class="ttc" id="classTHD_html_a09b38235fdaa6cba46555ba5b8af0fac"><div class="ttname"><a href="classTHD.html#a09b38235fdaa6cba46555ba5b8af0fac">THD::m_stage_progress_psi</a></div><div class="ttdeci">PSI_stage_progress * m_stage_progress_psi</div><div class="ttdoc">Current stage progress instrumentation. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2146</div></div>
<div class="ttc" id="classTHD_html_aa8f160f74031563e5a49704c4a2ca6d2"><div class="ttname"><a href="classTHD.html#aa8f160f74031563e5a49704c4a2ca6d2">THD::is_fsp_truncate_mode</a></div><div class="ttdeci">bool is_fsp_truncate_mode() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2773</div></div>
<div class="ttc" id="structYYLTYPE_html"><div class="ttname"><a href="structYYLTYPE.html">YYLTYPE</a></div><div class="ttdoc">Bison &quot;location&quot; class. </div><div class="ttdef"><b>Definition:</b> parse_location.h:42</div></div>
<div class="ttc" id="sql__class_8h_html_a9232eb995dd70b888477a3ac014adb29"><div class="ttname"><a href="sql__class_8h.html#a9232eb995dd70b888477a3ac014adb29">my_ok</a></div><div class="ttdeci">void my_ok(THD *thd, ulonglong affected_rows=0, ulonglong id=0, const char *message=nullptr)</div><div class="ttdoc">A short cut for thd-&gt;get_stmt_da()-&gt;set_ok_status(). </div><div class="ttdef"><b>Definition:</b> sql_class.cc:2906</div></div>
<div class="ttc" id="classTHD_html_ae88f48a487fbdb0c10b318728ce7251f"><div class="ttname"><a href="classTHD.html#ae88f48a487fbdb0c10b318728ce7251f">THD::clear_owned_gtids</a></div><div class="ttdeci">void clear_owned_gtids()</div><div class="ttdef"><b>Definition:</b> sql_class.h:3484</div></div>
<div class="ttc" id="classTHD_html_afda156ec9ec7f901b4d3f2bcd20cf46f"><div class="ttname"><a href="classTHD.html#afda156ec9ec7f901b4d3f2bcd20cf46f">THD::in_lock_tables</a></div><div class="ttdeci">bool in_lock_tables</div><div class="ttdef"><b>Definition:</b> sql_class.h:2455</div></div>
<div class="ttc" id="thread__type_8h_html"><div class="ttname"><a href="thread__type_8h.html">thread_type.h</a></div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240ba4a3f2f45c5962e9908dac1097fc396e1"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba4a3f2f45c5962e9908dac1097fc396e1">SYSTEM_THREAD_INIT_FILE</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:47</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_a2efe31a690d4bc6004f11a498cff3e0e"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#a2efe31a690d4bc6004f11a498cff3e0e">THD::Transaction_state::m_thd_option_bits</a></div><div class="ttdeci">ulonglong m_thd_option_bits</div><div class="ttdoc">THD options. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1693</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_acec40d0653caba7a96345b1d0edf810b"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#acec40d0653caba7a96345b1d0edf810b">THD::Transaction_state::m_query_tables_list</a></div><div class="ttdeci">Query_tables_list * m_query_tables_list</div><div class="ttdef"><b>Definition:</b> sql_class.h:1672</div></div>
<div class="ttc" id="group__psi__api__statement_html_ga18ef8810462384c22bd9224e290a7e7e"><div class="ttname"><a href="group__psi__api__statement.html#ga18ef8810462384c22bd9224e290a7e7e">MYSQL_SET_STATEMENT_TEXT</a></div><div class="ttdeci">#define MYSQL_SET_STATEMENT_TEXT(LOCKER, P1, P2)</div><div class="ttdef"><b>Definition:</b> mysql_statement.h:96</div></div>
<div class="ttc" id="classTHD_html_a31946409c286050e84c4c9db94249e6b"><div class="ttname"><a href="classTHD.html#a31946409c286050e84c4c9db94249e6b">THD::save_current_query_costs</a></div><div class="ttdeci">void save_current_query_costs()</div><div class="ttdoc">Save the current query costs attributes in the thread session status. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1029</div></div>
<div class="ttc" id="psi__thread__bits_8h_html"><div class="ttname"><a href="psi__thread__bits_8h.html">psi_thread_bits.h</a></div><div class="ttdoc">Performance schema instrumentation interface. </div></div>
<div class="ttc" id="classPrealloced__array_html_ae5d02fc5111d71dc962d4da25b598446"><div class="ttname"><a href="classPrealloced__array.html#ae5d02fc5111d71dc962d4da25b598446">Prealloced_array::back</a></div><div class="ttdeci">Element_type &amp; back()</div><div class="ttdef"><b>Definition:</b> prealloced_array.h:232</div></div>
<div class="ttc" id="classTHD_html_a1df1b6f4a7a8446001c9691f8e5153bc"><div class="ttname"><a href="classTHD.html#a1df1b6f4a7a8446001c9691f8e5153bc">THD::get_parser_da</a></div><div class="ttdeci">Diagnostics_area * get_parser_da()</div><div class="ttdoc">Returns thread-local Diagnostics Area for parsing. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2930</div></div>
<div class="ttc" id="resource__group__basic__types_8h_html"><div class="ttname"><a href="resource__group__basic__types_8h.html">resource_group_basic_types.h</a></div></div>
<div class="ttc" id="classTHD_html_a8757a413abb6e86235bab3d2a1654877"><div class="ttname"><a href="classTHD.html#a8757a413abb6e86235bab3d2a1654877">THD::is_killable</a></div><div class="ttdeci">bool is_killable</div><div class="ttdef"><b>Definition:</b> sql_class.h:1303</div></div>
<div class="ttc" id="classTHD_html_ad5d9b3752ab439d42e6b67f276f52405"><div class="ttname"><a href="classTHD.html#ad5d9b3752ab439d42e6b67f276f52405">THD::get_protocol_classic</a></div><div class="ttdeci">Protocol_classic * get_protocol_classic()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1179</div></div>
<div class="ttc" id="classTHD_html_ac99d5a522ce55793a28d1a438ff8fb24"><div class="ttname"><a href="classTHD.html#ac99d5a522ce55793a28d1a438ff8fb24">THD::get_gtid_next_list</a></div><div class="ttdeci">Gtid_set * get_gtid_next_list()</div><div class="ttdoc">Return the value of @gtid_next_list: either a Gtid_set or NULL. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3137</div></div>
<div class="ttc" id="system__variables_8h_html_a9a3d5e8862316e95457e7859e792ffe5"><div class="ttname"><a href="system__variables_8h.html#a9a3d5e8862316e95457e7859e792ffe5">MODE_TIME_TRUNCATE_FRACTIONAL</a></div><div class="ttdeci">#define MODE_TIME_TRUNCATE_FRACTIONAL</div><div class="ttdef"><b>Definition:</b> system_variables.h:132</div></div>
<div class="ttc" id="classMDL__savepoint_html"><div class="ttname"><a href="classMDL__savepoint.html">MDL_savepoint</a></div><div class="ttdoc">Savepoint for MDL context. </div><div class="ttdef"><b>Definition:</b> mdl.h:1297</div></div>
<div class="ttc" id="classmalloc__unordered__map_html"><div class="ttname"><a href="classmalloc__unordered__map.html">malloc_unordered_map</a></div><div class="ttdoc">std::unordered_map, but with my_malloc, so that you can track the memory used using PSI memory keys...</div><div class="ttdef"><b>Definition:</b> map_helpers.h:175</div></div>
<div class="ttc" id="classTHD_html_a79ff94d7479786a5458794323702b415"><div class="ttname"><a href="classTHD.html#a79ff94d7479786a5458794323702b415">THD::m_current_query_cost</a></div><div class="ttdeci">double m_current_query_cost</div><div class="ttdoc">Current query cost. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1004</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_a53a636d02fde2a2c515d28d5b1e012c5"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#a53a636d02fde2a2c515d28d5b1e012c5">THD::Transaction_state::m_transaction_psi</a></div><div class="ttdeci">PSI_transaction_locker * m_transaction_psi</div><div class="ttdoc">Current transaction instrumentation. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1696</div></div>
<div class="ttc" id="mdl_8h_html"><div class="ttname"><a href="mdl_8h.html">mdl.h</a></div></div>
<div class="ttc" id="system__variables_8h_html"><div class="ttname"><a href="system__variables_8h.html">system_variables.h</a></div></div>
<div class="ttc" id="classTHD_html_a83ab8f537e924f564e8a7f2b11a34c2a"><div class="ttname"><a href="classTHD.html#a83ab8f537e924f564e8a7f2b11a34c2a">THD::m_release_resources_done</a></div><div class="ttdeci">bool m_release_resources_done</div><div class="ttdef"><b>Definition:</b> sql_class.h:2585</div></div>
<div class="ttc" id="sql__error_8h_html"><div class="ttname"><a href="sql__error_8h.html">sql_error.h</a></div></div>
<div class="ttc" id="structHa__data_html"><div class="ttname"><a href="structHa__data.html">Ha_data</a></div><div class="ttdoc">Storage engine specific thread local data. </div><div class="ttdef"><b>Definition:</b> sql_class.h:662</div></div>
<div class="ttc" id="structSystem__variables_html_a9529275c4402abcfa8f27d0b98d2063f"><div class="ttname"><a href="structSystem__variables.html#a9529275c4402abcfa8f27d0b98d2063f">System_variables::sql_mode</a></div><div class="ttdeci">sql_mode_t sql_mode</div><div class="ttdoc">which non-standard SQL behaviour should be enabled </div><div class="ttdef"><b>Definition:</b> system_variables.h:202</div></div>
<div class="ttc" id="classTHD_html_a842ff08d35ef75b18b37c208786149a8"><div class="ttname"><a href="classTHD.html#a842ff08d35ef75b18b37c208786149a8">THD::stmt_map</a></div><div class="ttdeci">Prepared_statement_map stmt_map</div><div class="ttdoc">All prepared statements of this connection. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1094</div></div>
<div class="ttc" id="classTHD_html_adaed45bcb64200391d6d368d609a7c3e"><div class="ttname"><a href="classTHD.html#adaed45bcb64200391d6d368d609a7c3e">THD::m_rewritten_query</a></div><div class="ttdeci">String m_rewritten_query</div><div class="ttdoc">In some cases, we may want to modify the query (i.e. </div><div class="ttdef"><b>Definition:</b> sql_class.h:926</div></div>
<div class="ttc" id="sql__class_8h_html_aa281dfb23b842c055bdf2b770d7dc45f"><div class="ttname"><a href="sql__class_8h.html#aa281dfb23b842c055bdf2b770d7dc45f">RETURN_NAME_AS_STRING</a></div><div class="ttdeci">#define RETURN_NAME_AS_STRING(NAME)</div></div>
<div class="ttc" id="classTHD_html_a2df5aa03cfed8d6a6a9bb4111f6c54c8"><div class="ttname"><a href="classTHD.html#a2df5aa03cfed8d6a6a9bb4111f6c54c8">THD::COND_thr_lock</a></div><div class="ttdeci">mysql_cond_t COND_thr_lock</div><div class="ttdoc">Condition variable used for waiting by the THR_LOCK.c subsystem. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1326</div></div>
<div class="ttc" id="classTHD_html_ab090db60e886ed772da28766076263c1"><div class="ttname"><a href="classTHD.html#ab090db60e886ed772da28766076263c1">THD::m_attachable_trx</a></div><div class="ttdeci">Attachable_trx * m_attachable_trx</div><div class="ttdef"><b>Definition:</b> sql_class.h:1790</div></div>
<div class="ttc" id="classList_html"><div class="ttname"><a href="classList.html">List&lt; Security_context &gt;</a></div></div>
<div class="ttc" id="classTHD_html_a3a40d1058616e2c316f051523eea992b"><div class="ttname"><a href="classTHD.html#a3a40d1058616e2c316f051523eea992b">THD::proc_info</a></div><div class="ttdeci">const char * proc_info</div><div class="ttdef"><b>Definition:</b> sql_class.h:1146</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_aa75d025169affd7b5f534d0f957f310e"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#aa75d025169affd7b5f534d0f957f310e">THD::Transaction_state::m_sql_mode</a></div><div class="ttdeci">sql_mode_t m_sql_mode</div><div class="ttdoc">SQL_MODE. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1678</div></div>
<div class="ttc" id="system__variables_8h_html_acd03be4982af89757ca0317f3d73d0bca30ac5a8bea24c56d28b29af8e3d721d8"><div class="ttname"><a href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bca30ac5a8bea24c56d28b29af8e3d721d8">BINLOG_FORMAT_MIXED</a></div><div class="ttdoc">statement if safe, otherwise row - autodetected </div><div class="ttdef"><b>Definition:</b> system_variables.h:45</div></div>
<div class="ttc" id="classPrepared__statement__map_html"><div class="ttname"><a href="classPrepared__statement__map.html">Prepared_statement_map</a></div><div class="ttdoc">Container for all prepared statements created/used in a connection. </div><div class="ttdef"><b>Definition:</b> sql_class.h:355</div></div>
<div class="ttc" id="classilink_html"><div class="ttname"><a href="classilink.html">ilink</a></div><div class="ttdef"><b>Definition:</b> sql_list.h:672</div></div>
<div class="ttc" id="my__compiler_8h_html_a939e6ad65d8ab9567f0718ca5810b3f0"><div class="ttname"><a href="my__compiler_8h.html#a939e6ad65d8ab9567f0718ca5810b3f0">SUPPRESS_TSAN</a></div><div class="ttdeci">#define SUPPRESS_TSAN</div><div class="ttdef"><b>Definition:</b> my_compiler.h:148</div></div>
<div class="ttc" id="classTHD_html_acc88998f9c885e791268e290ff505b86"><div class="ttname"><a href="classTHD.html#acc88998f9c885e791268e290ff505b86">THD::change_list</a></div><div class="ttdeci">Item_change_list change_list</div><div class="ttdoc">This is used to track transient changes to items during optimization of a prepared statement/stored p...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1838</div></div>
<div class="ttc" id="classTHD_html_a2d34ad426d05c99fb8dd404caccc1f3c"><div class="ttname"><a href="classTHD.html#a2d34ad426d05c99fb8dd404caccc1f3c">THD::m_binlog_invoker</a></div><div class="ttdeci">bool m_binlog_invoker</div><div class="ttdoc">It will be set TURE if CURRENT_USER() is called in account management statements or default definer i...</div><div class="ttdef"><b>Definition:</b> sql_class.h:4003</div></div>
<div class="ttc" id="structMYSQL__LEX__CSTRING_html_a8f240ebce8d7084b44bcffa514183dc8"><div class="ttname"><a href="structMYSQL__LEX__CSTRING.html#a8f240ebce8d7084b44bcffa514183dc8">MYSQL_LEX_CSTRING::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> mysql_lex_string.h:41</div></div>
<div class="ttc" id="sql__class_8h_html_a0edbc223d7288eb5d53f953fdef5e685"><div class="ttname"><a href="sql__class_8h.html#a0edbc223d7288eb5d53f953fdef5e685">empty_c_string</a></div><div class="ttdeci">char empty_c_string[1]</div><div class="ttdef"><b>Definition:</b> sql_class.cc:121</div></div>
<div class="ttc" id="classTHD_html_abfd91c1bcac40e4db5e4679b7240e737"><div class="ttname"><a href="classTHD.html#abfd91c1bcac40e4db5e4679b7240e737">THD::mark_plugin_fake_ddl</a></div><div class="ttdeci">void mark_plugin_fake_ddl(bool flag)</div><div class="ttdef"><b>Definition:</b> sql_class.h:4176</div></div>
<div class="ttc" id="classTHD_html_aae563ffb7ad386c1152eaf2067009425"><div class="ttname"><a href="classTHD.html#aae563ffb7ad386c1152eaf2067009425">THD::m_trans_fixed_log_file</a></div><div class="ttdeci">char * m_trans_fixed_log_file</div><div class="ttdef"><b>Definition:</b> sql_class.h:1628</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240bafbfeb61465ecf9701c5607578a34e334"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240bafbfeb61465ecf9701c5607578a34e334">SYSTEM_THREAD_NDBCLUSTER_BINLOG</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:37</div></div>
<div class="ttc" id="classTHD_html_adc377898f02fc86ef0205abef975d941"><div class="ttname"><a href="classTHD.html#adc377898f02fc86ef0205abef975d941">THD::get_protocol</a></div><div class="ttdeci">Protocol * get_protocol()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1153</div></div>
<div class="ttc" id="classdd_1_1cache_1_1Dictionary__client_html"><div class="ttname"><a href="classdd_1_1cache_1_1Dictionary__client.html">dd::cache::Dictionary_client</a></div><div class="ttdef"><b>Definition:</b> dictionary_client.h:146</div></div>
<div class="ttc" id="classTHD_html_a9e7283725175fd8a9c6d6cae4401f85a"><div class="ttname"><a href="classTHD.html#a9e7283725175fd8a9c6d6cae4401f85a">THD::is_binlog_applier</a></div><div class="ttdeci">bool is_binlog_applier() const</div><div class="ttdoc">The function checks whether the thread is processing queries from binlog, as automatically generated ...</div><div class="ttdef"><b>Definition:</b> sql_class.h:943</div></div>
<div class="ttc" id="classSub__statement__state_html_a56e72213cc63778f23a19c92569652c6"><div class="ttname"><a href="classSub__statement__state.html#a56e72213cc63778f23a19c92569652c6">Sub_statement_state::savepoints</a></div><div class="ttdeci">SAVEPOINT * savepoints</div><div class="ttdef"><b>Definition:</b> sql_class.h:627</div></div>
<div class="ttc" id="classTHD_html_a60b0ad63f84dcdef1f343fa2a2a490c4"><div class="ttname"><a href="classTHD.html#a60b0ad63f84dcdef1f343fa2a2a490c4">THD::set_waiting_for_disk_space</a></div><div class="ttdeci">void set_waiting_for_disk_space(bool waiting)</div><div class="ttdoc">Set the waiting_for_disk_space flag. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4232</div></div>
<div class="ttc" id="classTHD_html_a631142d04eb8c4c54b27f17b7055e108"><div class="ttname"><a href="classTHD.html#a631142d04eb8c4c54b27f17b7055e108">THD::is_admin_connection</a></div><div class="ttdeci">bool is_admin_connection() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1340</div></div>
<div class="ttc" id="classTHD_html_a28d503de7aaffbb8677d4e3eb6bf81b8"><div class="ttname"><a href="classTHD.html#a28d503de7aaffbb8677d4e3eb6bf81b8">THD::kill_immunizer</a></div><div class="ttdeci">dd::DD_kill_immunizer * kill_immunizer</div><div class="ttdoc">When operation on DD tables is in progress then THD is set to kill immune mode. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2413</div></div>
<div class="ttc" id="classTHD_html_a677f0f9fffc3a94edeb1e82d4760f699"><div class="ttname"><a href="classTHD.html#a677f0f9fffc3a94edeb1e82d4760f699">THD::exit_cond</a></div><div class="ttdeci">void exit_cond(const PSI_stage_info *stage, const char *src_function, const char *src_file, int src_line) override</div><div class="ttdoc">End a wait on a condition. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2693</div></div>
<div class="ttc" id="classTHD_html_a82bcaeca2e4a33c70382b4af2c81c091"><div class="ttname"><a href="classTHD.html#a82bcaeca2e4a33c70382b4af2c81c091">THD::syntax_error</a></div><div class="ttdeci">void syntax_error()</div><div class="ttdef"><b>Definition:</b> sql_class.h:4038</div></div>
<div class="ttc" id="classTHD_html_a500ab088f76574561fcfc910968b88fd"><div class="ttname"><a href="classTHD.html#a500ab088f76574561fcfc910968b88fd">THD::m_db</a></div><div class="ttdeci">LEX_CSTRING m_db</div><div class="ttdoc">Name of the current (default) database. </div><div class="ttdef"><b>Definition:</b> sql_class.h:895</div></div>
<div class="ttc" id="classTHD_html_ae917ceb9a297bbe6abdde1897af5c9d2"><div class="ttname"><a href="classTHD.html#ae917ceb9a297bbe6abdde1897af5c9d2">THD::killed_state</a></div><div class="ttdeci">killed_state</div><div class="ttdef"><b>Definition:</b> sql_class.h:2390</div></div>
<div class="ttc" id="classTHD_html_a6b4813e1dbb94c8c6094dd2780ddad4f"><div class="ttname"><a href="classTHD.html#a6b4813e1dbb94c8c6094dd2780ddad4f">THD::query</a></div><div class="ttdeci">const LEX_CSTRING &amp; query() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3759</div></div>
<div class="ttc" id="classSub__statement__state_html_ada987c1cb09b53610f447020706c9c5c"><div class="ttname"><a href="classSub__statement__state.html#ada987c1cb09b53610f447020706c9c5c">Sub_statement_state::first_successful_insert_id_in_prev_stmt</a></div><div class="ttdeci">ulonglong first_successful_insert_id_in_prev_stmt</div><div class="ttdef"><b>Definition:</b> sql_class.h:618</div></div>
<div class="ttc" id="classTHD_1_1Attachable__trx__rw_html_a5fb435203bcde9ecf360e5d8b47a1011"><div class="ttname"><a href="classTHD_1_1Attachable__trx__rw.html#a5fb435203bcde9ecf360e5d8b47a1011">THD::Attachable_trx_rw::is_read_only</a></div><div class="ttdeci">bool is_read_only() const override</div><div class="ttdef"><b>Definition:</b> sql_class.h:1782</div></div>
<div class="ttc" id="classTHD_html_a3feb1df736e43c287b46c7d422b71842"><div class="ttname"><a href="classTHD.html#a3feb1df736e43c287b46c7d422b71842">THD::m_view_ctx_list</a></div><div class="ttdeci">List&lt; Security_context &gt; m_view_ctx_list</div><div class="ttdef"><b>Definition:</b> sql_class.h:1119</div></div>
<div class="ttc" id="classQuery__arena_html_a65dc9833a47539c56429de4835a958f7"><div class="ttname"><a href="classQuery__arena.html#a65dc9833a47539c56429de4835a958f7">Query_arena::reset_item_list</a></div><div class="ttdeci">void reset_item_list()</div><div class="ttdef"><b>Definition:</b> sql_class.h:284</div></div>
<div class="ttc" id="classDiagnostics__area_html"><div class="ttname"><a href="classDiagnostics__area.html">Diagnostics_area</a></div><div class="ttdoc">Stores status of the currently executed statement. </div><div class="ttdef"><b>Definition:</b> sql_error.h:268</div></div>
<div class="ttc" id="sql__class_8h_html_ae11fef08ce7b1572e20d634d0e3325b5"><div class="ttname"><a href="sql__class_8h.html#ae11fef08ce7b1572e20d634d0e3325b5">reattach_engine_ha_data_to_thd</a></div><div class="ttdeci">void reattach_engine_ha_data_to_thd(THD *thd, const struct handlerton *hton)</div><div class="ttdoc">The function re-attaches the engine ha_data (which was previously detached by detach_ha_data_from_thd...</div><div class="ttdef"><b>Definition:</b> sql_class.cc:2684</div></div>
<div class="ttc" id="my__compiler_8h_html"><div class="ttname"><a href="my__compiler_8h.html">my_compiler.h</a></div><div class="ttdoc">Header for compiler-dependent features. </div></div>
<div class="ttc" id="xa_8h_html"><div class="ttname"><a href="xa_8h.html">xa.h</a></div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html_a98588f3282ffeeef08f24554d2318f9f"><div class="ttname"><a href="classTHD_1_1Query__plan.html#a98588f3282ffeeef08f24554d2318f9f">THD::Query_plan::get_modification_plan</a></div><div class="ttdeci">Modification_plan const  * get_modification_plan() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1254</div></div>
<div class="ttc" id="classMDL__context_html"><div class="ttname"><a href="classMDL__context.html">MDL_context</a></div><div class="ttdoc">Context of the owner of metadata locks. </div><div class="ttdef"><b>Definition:</b> mdl.h:1392</div></div>
<div class="ttc" id="classTHD_html_a6acd53435ad4bb82b8cfdcef9ab34667"><div class="ttname"><a href="classTHD.html#a6acd53435ad4bb82b8cfdcef9ab34667">THD::session_tracker</a></div><div class="ttdeci">Session_tracker session_tracker</div><div class="ttdef"><b>Definition:</b> sql_class.h:4035</div></div>
<div class="ttc" id="classQuery__arena_html_a11e9af1383e888193664168276bcef5c"><div class="ttname"><a href="classQuery__arena.html#a11e9af1383e888193664168276bcef5c">Query_arena::mem_calloc</a></div><div class="ttdeci">void * mem_calloc(size_t size)</div><div class="ttdef"><b>Definition:</b> sql_class.h:301</div></div>
<div class="ttc" id="classTHD_html_a6a798662a9a4fac2fe127585da8f7ce3"><div class="ttname"><a href="classTHD.html#a6a798662a9a4fac2fe127585da8f7ce3">THD::set_query_id</a></div><div class="ttdeci">void set_query_id(query_id_t new_query_id)</div><div class="ttdoc">Assign a new value to thd-&gt;query_id. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3853</div></div>
<div class="ttc" id="classTHD_html_aafdc0d63105f0e703d0b73872acdab10"><div class="ttname"><a href="classTHD.html#aafdc0d63105f0e703d0b73872acdab10">THD::get_tmp_table_seq_id</a></div><div class="ttdeci">uint get_tmp_table_seq_id()</div><div class="ttdef"><b>Definition:</b> sql_class.h:4171</div></div>
<div class="ttc" id="classRows__log__event_html"><div class="ttname"><a href="classRows__log__event.html">Rows_log_event</a></div><div class="ttdoc">Common base class for all row-containing log events. </div><div class="ttdef"><b>Definition:</b> log_event.h:2697</div></div>
<div class="ttc" id="classTHD_html_a1a7e86007b2717a2ebbbd3be630866d8"><div class="ttname"><a href="classTHD.html#a1a7e86007b2717a2ebbbd3be630866d8">THD::set_psi</a></div><div class="ttdeci">void set_psi(PSI_thread *psi)</div><div class="ttdoc">Save the performance schema thread instrumentation associated with this user session. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3617</div></div>
<div class="ttc" id="classGlobal__read__lock_html_af95c661261a4863e6b80969b63c1db30ae5cdc8d264fb06c6eb605e8e5540d01a"><div class="ttname"><a href="classGlobal__read__lock.html#af95c661261a4863e6b80969b63c1db30ae5cdc8d264fb06c6eb605e8e5540d01a">Global_read_lock::GRL_NONE</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:708</div></div>
<div class="ttc" id="sql__class_8h_html_a1b02d78838864ccf5d568330c2aea5d2"><div class="ttname"><a href="sql__class_8h.html#a1b02d78838864ccf5d568330c2aea5d2">my_eof</a></div><div class="ttdeci">void my_eof(THD *thd)</div><div class="ttdoc">A short cut for thd-&gt;get_stmt_da()-&gt;set_eof_status(). </div><div class="ttdef"><b>Definition:</b> sql_class.cc:2912</div></div>
<div class="ttc" id="mysql__com_8h_html_a45f11cf97b6dec62756b92cbb96f7418"><div class="ttname"><a href="mysql__com_8h.html#a45f11cf97b6dec62756b92cbb96f7418">SCRAMBLE_LENGTH</a></div><div class="ttdeci">#define SCRAMBLE_LENGTH</div><div class="ttdoc">Length of random string sent by server on handshake; this is also length of obfuscated password...</div><div class="ttdef"><b>Definition:</b> mysql_com.h:117</div></div>
<div class="ttc" id="classOpen__tables__state_html_aac1eaac32c0fbbea08c46f2cb1eadc71"><div class="ttname"><a href="classOpen__tables__state.html#aac1eaac32c0fbbea08c46f2cb1eadc71">Open_tables_state::enum_flags</a></div><div class="ttdeci">enum_flags</div><div class="ttdef"><b>Definition:</b> sql_class.h:536</div></div>
<div class="ttc" id="structLOG__INFO_html"><div class="ttname"><a href="structLOG__INFO.html">LOG_INFO</a></div><div class="ttdef"><b>Definition:</b> binlog.h:116</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_a1661eeb9498f218a59eb495bdb0bb0a5"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#a1661eeb9498f218a59eb495bdb0bb0a5">THD::Transaction_state::m_in_lock_tables</a></div><div class="ttdeci">bool m_in_lock_tables</div><div class="ttdoc">THD::in_lock_tables value. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1702</div></div>
<div class="ttc" id="structresourcegroups_1_1Resource__group__ctx_html"><div class="ttname"><a href="structresourcegroups_1_1Resource__group__ctx.html">resourcegroups::Resource_group_ctx</a></div><div class="ttdef"><b>Definition:</b> resource_group_basic_types.h:53</div></div>
<div class="ttc" id="sql__list_8h_html"><div class="ttname"><a href="sql__list_8h.html">sql_list.h</a></div></div>
<div class="ttc" id="my__psi__config_8h_html"><div class="ttname"><a href="my__psi__config_8h.html">my_psi_config.h</a></div><div class="ttdoc">Defines various enable/disable and HAVE_ macros related to the performance schema instrumentation sys...</div></div>
<div class="ttc" id="classTHD_html_acd098dcfcff6ec6b1501a283e21e817b"><div class="ttname"><a href="classTHD.html#acd098dcfcff6ec6b1501a283e21e817b">THD::in_active_multi_stmt_transaction</a></div><div class="ttdeci">bool in_active_multi_stmt_transaction() const</div><div class="ttdoc">true if the session is in a multi-statement transaction mode ( </div><div class="ttdef"><b>Definition:</b> sql_class.h:2856</div></div>
<div class="ttc" id="classTHD_html_a1f9021d85e0ba76b4c30e0fb58f00b17"><div class="ttname"><a href="classTHD.html#a1f9021d85e0ba76b4c30e0fb58f00b17">THD::init_cost_model</a></div><div class="ttdeci">void init_cost_model()</div><div class="ttdoc">Initialize the optimizer cost model. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4028</div></div>
<div class="ttc" id="mysql_8h_html_a11a4321c550a74672fe26f02996efa3f"><div class="ttname"><a href="mysql_8h.html#a11a4321c550a74672fe26f02996efa3f">mysql_errno</a></div><div class="ttdeci">unsigned int STDCALL mysql_errno(MYSQL *mysql)</div><div class="ttdef"><b>Definition:</b> client.cc:8217</div></div>
<div class="ttc" id="my__inttypes_8h_html_ac2a9e79eb120216f855626495b7bd18a"><div class="ttname"><a href="my__inttypes_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a></div><div class="ttdeci">uint16_t uint16</div><div class="ttdef"><b>Definition:</b> my_inttypes.h:64</div></div>
<div class="ttc" id="classItem_html"><div class="ttname"><a href="classItem.html">Item</a></div><div class="ttdef"><b>Definition:</b> item.h:775</div></div>
<div class="ttc" id="sql__class_8h_html_afc2c9357b900b1cb53799a03c186f9ea"><div class="ttname"><a href="sql__class_8h.html#afc2c9357b900b1cb53799a03c186f9ea">LOG_POS_COORD</a></div><div class="ttdeci">struct rpl_event_coordinates LOG_POS_COORD</div><div class="ttdoc">the struct aggregates two paramenters that identify an event uniquely in scope of communication of a ...</div></div>
<div class="ttc" id="classTHD_html_a7bc1ddd59b3944ce978b8664b631a1fa"><div class="ttname"><a href="classTHD.html#a7bc1ddd59b3944ce978b8664b631a1fa">THD::tx_read_only</a></div><div class="ttdeci">bool tx_read_only</div><div class="ttdef"><b>Definition:</b> sql_class.h:2279</div></div>
<div class="ttc" id="uca-dump_8cc_html_a91ad9478d81a7aaf2593e8d9c3d06a14"><div class="ttname"><a href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition:</b> uca-dump.cc:29</div></div>
<div class="ttc" id="structrpl__event__coordinates_html_a819645c3714eaa0680bb1518e09be0d9"><div class="ttname"><a href="structrpl__event__coordinates.html#a819645c3714eaa0680bb1518e09be0d9">rpl_event_coordinates::pos</a></div><div class="ttdeci">my_off_t pos</div><div class="ttdef"><b>Definition:</b> sql_class.h:218</div></div>
<div class="ttc" id="hash_8c_html_ab4646d77540701d2eb2c877effbe5739"><div class="ttname"><a href="hash_8c.html#ab4646d77540701d2eb2c877effbe5739">final</a></div><div class="ttdeci">#define final(a, b, c)</div><div class="ttdef"><b>Definition:</b> hash.c:109</div></div>
<div class="ttc" id="classTHD_html_a97e400a6c324a58b6cfd0baac7780751"><div class="ttname"><a href="classTHD.html#a97e400a6c324a58b6cfd0baac7780751">THD::m_examined_row_count</a></div><div class="ttdeci">ha_rows m_examined_row_count</div><div class="ttdoc">Number of rows read and/or evaluated for a statement. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2096</div></div>
<div class="ttc" id="classTHD_1_1Attachable__trx_html_aa25f9429edea2c8b370c1bedb4d2534c"><div class="ttname"><a href="classTHD_1_1Attachable__trx.html#aa25f9429edea2c8b370c1bedb4d2534c">THD::Attachable_trx::is_read_only</a></div><div class="ttdeci">virtual bool is_read_only() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1744</div></div>
<div class="ttc" id="classTransactional__ddl__context_html_a3444b5909669bd002b8e9b73f166b589"><div class="ttname"><a href="classTransactional__ddl__context.html#a3444b5909669bd002b8e9b73f166b589">Transactional_ddl_context::~Transactional_ddl_context</a></div><div class="ttdeci">~Transactional_ddl_context()</div><div class="ttdef"><b>Definition:</b> sql_class.h:771</div></div>
<div class="ttc" id="classTHD_html_a51890b2f30585a8d6c96a9bed162ead0"><div class="ttname"><a href="classTHD.html#a51890b2f30585a8d6c96a9bed162ead0">THD::binlog_row_event_extra_data</a></div><div class="ttdeci">uchar * binlog_row_event_extra_data</div><div class="ttdef"><b>Definition:</b> sql_class.h:1431</div></div>
<div class="ttc" id="sslopt-case_8h_html_ae00b773898ac853cec38cdf7a08b8e89"><div class="ttname"><a href="sslopt-case_8h.html#ae00b773898ac853cec38cdf7a08b8e89">name</a></div><div class="ttdeci">case opt name</div><div class="ttdef"><b>Definition:</b> sslopt-case.h:32</div></div>
<div class="ttc" id="my__io_8h_html_a0fd6678904889e4aeff1402c35e890da"><div class="ttname"><a href="my__io_8h.html#a0fd6678904889e4aeff1402c35e890da">FN_REFLEN</a></div><div class="ttdeci">#define FN_REFLEN</div><div class="ttdef"><b>Definition:</b> my_io.h:82</div></div>
<div class="ttc" id="classQuery__arena_html_a8ae60662f431cb7ad3beef1716458e2f"><div class="ttname"><a href="classQuery__arena.html#a8ae60662f431cb7ad3beef1716458e2f">Query_arena::set_item_list</a></div><div class="ttdeci">void set_item_list(Item *item)</div><div class="ttdef"><b>Definition:</b> sql_class.h:285</div></div>
<div class="ttc" id="server_8cc_html_aa815e54d471702b29f65174ee1f47280"><div class="ttname"><a href="server_8cc.html#aa815e54d471702b29f65174ee1f47280">old_value</a></div><div class="ttdeci">T old_value</div><div class="ttdef"><b>Definition:</b> server.cc:203</div></div>
<div class="ttc" id="locked__tables__list_8h_html_a77fee489173235058762d07e721b7476ad2caca3ff1da0a1f34ec5ff0d1b213d7"><div class="ttname"><a href="locked__tables__list_8h.html#a77fee489173235058762d07e721b7476ad2caca3ff1da0a1f34ec5ff0d1b213d7">LTM_PRELOCKED_UNDER_LOCK_TABLES</a></div><div class="ttdef"><b>Definition:</b> locked_tables_list.h:48</div></div>
<div class="ttc" id="classTHD_html_add6ff58faa84ff475d19466ff6bde705"><div class="ttname"><a href="classTHD.html#add6ff58faa84ff475d19466ff6bde705">THD::server_id</a></div><div class="ttdeci">uint32 server_id</div><div class="ttdef"><b>Definition:</b> sql_class.h:1343</div></div>
<div class="ttc" id="dur__prop_8h_html_acb10b3b16320b8c588102ef06a5dd87f"><div class="ttname"><a href="dur__prop_8h.html#acb10b3b16320b8c588102ef06a5dd87f">durability_properties</a></div><div class="ttdeci">durability_properties</div><div class="ttdef"><b>Definition:</b> dur_prop.h:30</div></div>
<div class="ttc" id="my__inttypes_8h_html_a9c0acdcb1b083d30069a62cee1ece644"><div class="ttname"><a href="my__inttypes_8h.html#a9c0acdcb1b083d30069a62cee1ece644">longlong</a></div><div class="ttdeci">long long int longlong</div><div class="ttdef"><b>Definition:</b> my_inttypes.h:54</div></div>
<div class="ttc" id="violite_8h_html_add2537fe635a53ad239256865059b033"><div class="ttname"><a href="violite_8h.html#add2537fe635a53ad239256865059b033">enum_vio_type</a></div><div class="ttdeci">enum_vio_type</div><div class="ttdef"><b>Definition:</b> violite.h:77</div></div>
<div class="ttc" id="classTHD_html_a8bc04f94c98c0c02830391aae8cac05b"><div class="ttname"><a href="classTHD.html#a8bc04f94c98c0c02830391aae8cac05b">THD::is_strict_mode</a></div><div class="ttdeci">bool is_strict_mode() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2753</div></div>
<div class="ttc" id="classTHD_html_a2fb33f56f032d09f529786907cb8c204"><div class="ttname"><a href="classTHD.html#a2fb33f56f032d09f529786907cb8c204">THD::has_invoker</a></div><div class="ttdeci">bool has_invoker() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3970</div></div>
<div class="ttc" id="classXID__STATE_html_a142676d46c9c5724d67ae56d8738f953a898a3b1cebc22df3e00a2f41304cee24"><div class="ttname"><a href="classXID__STATE.html#a142676d46c9c5724d67ae56d8738f953a898a3b1cebc22df3e00a2f41304cee24">XID_STATE::XA_NOTR</a></div><div class="ttdef"><b>Definition:</b> xa.h:365</div></div>
<div class="ttc" id="structxid__t_html"><div class="ttname"><a href="structxid__t.html">xid_t</a></div><div class="ttdoc">struct xid_t is binary compatible with the XID structure as in the X/Open CAE Specification, Distributed Transaction Processing: The XA Specification, X/Open Company Ltd., 1991. </div><div class="ttdef"><b>Definition:</b> xa.h:215</div></div>
<div class="ttc" id="classTHD_html_a1bbd5e45d9e0771810084e4299bc1631"><div class="ttname"><a href="classTHD.html#a1bbd5e45d9e0771810084e4299bc1631">THD::get_stmt_da</a></div><div class="ttdeci">const Diagnostics_area * get_stmt_da() const</div><div class="ttdoc">Returns first Diagnostics Area for the current statement. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2914</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240ba2c90ddde90548084c5f8293a874e7290"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba2c90ddde90548084c5f8293a874e7290">NON_SYSTEM_THREAD</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:34</div></div>
<div class="ttc" id="my__inttypes_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="my__inttypes_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> my_inttypes.h:66</div></div>
<div class="ttc" id="psi__statement__bits_8h_html"><div class="ttname"><a href="psi__statement__bits_8h.html">psi_statement_bits.h</a></div><div class="ttdoc">Performance schema instrumentation interface. </div></div>
<div class="ttc" id="classTHD_html_a0aeb3f9dc3bab17cf9a8fb14c04125ec"><div class="ttname"><a href="classTHD.html#a0aeb3f9dc3bab17cf9a8fb14c04125ec">THD::owned_gtid</a></div><div class="ttdeci">Gtid owned_gtid</div><div class="ttdoc">The GTID of the currently owned transaction. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3397</div></div>
<div class="ttc" id="mysql__thread_8h_html"><div class="ttname"><a href="mysql__thread_8h.html">mysql_thread.h</a></div><div class="ttdoc">Instrumentation helpers for mysys threads. </div></div>
<div class="ttc" id="classTHD_html_af079816a2418d2ec626e059f4c615346"><div class="ttname"><a href="classTHD.html#af079816a2418d2ec626e059f4c615346">THD::is_plugin_fake_ddl</a></div><div class="ttdeci">bool is_plugin_fake_ddl() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:4175</div></div>
<div class="ttc" id="classTHD_html_aaac435d3e63d575c72bcecde44c44b31"><div class="ttname"><a href="classTHD.html#aaac435d3e63d575c72bcecde44c44b31">THD::set_active_vio</a></div><div class="ttdeci">void set_active_vio(Vio *vio)</div><div class="ttdef"><b>Definition:</b> sql_class.h:2607</div></div>
<div class="ttc" id="classSql__condition_html"><div class="ttname"><a href="classSql__condition.html">Sql_condition</a></div><div class="ttdoc">Representation of a SQL condition. </div><div class="ttdef"><b>Definition:</b> sql_error.h:53</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240ba8adaca290bf553cb8483a337167704b4"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba8adaca290bf553cb8483a337167704b4">SYSTEM_THREAD_SERVER_UPGRADE</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:48</div></div>
<div class="ttc" id="classPrealloced__array_html_a92d3037ced30fd2ab494d0c102406b5c"><div class="ttname"><a href="classPrealloced__array.html#a92d3037ced30fd2ab494d0c102406b5c">Prealloced_array::pop_back</a></div><div class="ttdeci">void pop_back()</div><div class="ttdoc">Removes the last element in the array, effectively reducing the container size by one...</div><div class="ttdef"><b>Definition:</b> prealloced_array.h:333</div></div>
<div class="ttc" id="classTHD_html_a01e09067c0d8094567f5c9f2828c57ee"><div class="ttname"><a href="classTHD.html#a01e09067c0d8094567f5c9f2828c57ee">THD::current_cond</a></div><div class="ttdeci">std::atomic&lt; mysql_cond_t * &gt; current_cond</div><div class="ttdoc">Pointer to the condition variable the thread owning this THD is currently waiting for...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1322</div></div>
<div class="ttc" id="classOpen__tables__state_html_a56d538ef4412d61201d0c3fe686b859b"><div class="ttname"><a href="classOpen__tables__state.html#a56d538ef4412d61201d0c3fe686b859b">Open_tables_state::extra_lock</a></div><div class="ttdeci">MYSQL_LOCK * extra_lock</div><div class="ttdef"><b>Definition:</b> sql_class.h:504</div></div>
<div class="ttc" id="test__sql__9__sessions_8cc_html_af6a786aadb2fc26d9c6d8dcb60c181f9"><div class="ttname"><a href="test__sql__9__sessions_8cc.html#af6a786aadb2fc26d9c6d8dcb60c181f9">msg</a></div><div class="ttdeci">char msg[1024]</div><div class="ttdef"><b>Definition:</b> test_sql_9_sessions.cc:281</div></div>
<div class="ttc" id="classTHD_html_a4bb6eed9b07c387d15945293a4794f9d"><div class="ttname"><a href="classTHD.html#a4bb6eed9b07c387d15945293a4794f9d">THD::LOCK_query_plan</a></div><div class="ttdeci">mysql_mutex_t LOCK_query_plan</div><div class="ttdoc">Protects query plan (SELECT/UPDATE/DELETE&amp;#39;s) from being freed/changed while another thread explains i...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1086</div></div>
<div class="ttc" id="structVio_html"><div class="ttname"><a href="structVio.html">Vio</a></div><div class="ttdef"><b>Definition:</b> violite.h:321</div></div>
<div class="ttc" id="classTHD_html_aae909fabc9ab6a6e16b5b6de2361b38f"><div class="ttname"><a href="classTHD.html#aae909fabc9ab6a6e16b5b6de2361b38f">THD::unioned_events_trans</a></div><div class="ttdeci">bool unioned_events_trans</div><div class="ttdef"><b>Definition:</b> sql_class.h:2518</div></div>
<div class="ttc" id="structhandlerton_html"><div class="ttname"><a href="structhandlerton.html">handlerton</a></div><div class="ttdoc">handlerton is a singleton structure - one instance per storage engine - to provide access to storage ...</div><div class="ttdef"><b>Definition:</b> handler.h:2301</div></div>
<div class="ttc" id="psi__memory__key_8cc_html_a4b3137a40e6a83872737a2343d378464"><div class="ttname"><a href="psi__memory__key_8cc.html#a4b3137a40e6a83872737a2343d378464">key_memory_user_var_entry</a></div><div class="ttdeci">PSI_memory_key key_memory_user_var_entry</div><div class="ttdef"><b>Definition:</b> psi_memory_key.cc:144</div></div>
<div class="ttc" id="classTHD_html_a0afd485c2df4248421caa96fc2d69b22"><div class="ttname"><a href="classTHD.html#a0afd485c2df4248421caa96fc2d69b22">THD::m_digest</a></div><div class="ttdeci">sql_digest_state * m_digest</div><div class="ttdoc">Current statement digest. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2148</div></div>
<div class="ttc" id="classTHD_html_a7cbc0c059d0a5d108698e4e387505837"><div class="ttname"><a href="classTHD.html#a7cbc0c059d0a5d108698e4e387505837">THD::ha_data</a></div><div class="ttdeci">Prealloced_array&lt; Ha_data, PREALLOC_NUM_HA &gt; ha_data</div><div class="ttdef"><b>Definition:</b> sql_class.h:1381</div></div>
<div class="ttc" id="m__ctype_8h_html_aa4bc5bb4f339afec426049fee727d701"><div class="ttname"><a href="m__ctype_8h.html#aa4bc5bb4f339afec426049fee727d701">my_charset_latin1</a></div><div class="ttdeci">MYSQL_PLUGIN_IMPORT CHARSET_INFO my_charset_latin1</div><div class="ttdef"><b>Definition:</b> ctype-latin1.cc:367</div></div>
<div class="ttc" id="classTHD_html_ac2911fedb9ff1914d809c258e4655fb2"><div class="ttname"><a href="classTHD.html#ac2911fedb9ff1914d809c258e4655fb2">THD::security_context</a></div><div class="ttdeci">Security_context * security_context() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1117</div></div>
<div class="ttc" id="classTHD_html_a3139a05451a8fb331fc5fda3b9000deb"><div class="ttname"><a href="classTHD.html#a3139a05451a8fb331fc5fda3b9000deb">THD::m_token_array</a></div><div class="ttdeci">unsigned char * m_token_array</div><div class="ttdoc">Current statement digest token array. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2150</div></div>
<div class="ttc" id="structCHARSET__INFO_html"><div class="ttname"><a href="structCHARSET__INFO.html">CHARSET_INFO</a></div><div class="ttdef"><b>Definition:</b> m_ctype.h:359</div></div>
<div class="ttc" id="classTHD_html_a26860f9fc54dc0ead94c402b81e42f91"><div class="ttname"><a href="classTHD.html#a26860f9fc54dc0ead94c402b81e42f91">THD::is_waiting_for_disk_space</a></div><div class="ttdeci">bool is_waiting_for_disk_space() const</div><div class="ttdoc">Returns the current waiting_for_disk_space flag value. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4238</div></div>
<div class="ttc" id="classTHD_html_a80f35f27e3aa29d3599ed02ee87f3dc0"><div class="ttname"><a href="classTHD.html#a80f35f27e3aa29d3599ed02ee87f3dc0">THD::set_tmp_table_seq_id</a></div><div class="ttdeci">void set_tmp_table_seq_id(uint arg)</div><div class="ttdef"><b>Definition:</b> sql_class.h:4172</div></div>
<div class="ttc" id="classTransactional__ddl__context_html"><div class="ttname"><a href="classTransactional__ddl__context.html">Transactional_ddl_context</a></div><div class="ttdoc">This class keeps the context of transactional DDL statements. </div><div class="ttdef"><b>Definition:</b> sql_class.h:765</div></div>
<div class="ttc" id="my__thread__bits_8h_html_a86fa057db30de4141b1c0723e005cb88"><div class="ttname"><a href="my__thread__bits_8h.html#a86fa057db30de4141b1c0723e005cb88">my_thread_t</a></div><div class="ttdeci">pthread_t my_thread_t</div><div class="ttdef"><b>Definition:</b> my_thread_bits.h:47</div></div>
<div class="ttc" id="sql_2field_8h_html_a46645b5c37cb3b92ce921432738cfa1d"><div class="ttname"><a href="sql_2field_8h.html#a46645b5c37cb3b92ce921432738cfa1d">enum_check_fields</a></div><div class="ttdeci">enum_check_fields</div><div class="ttdef"><b>Definition:</b> field.h:171</div></div>
<div class="ttc" id="sql__class_8h_html_a72c83217b7613b5afda5d424fe70d56e"><div class="ttname"><a href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56e">Secondary_engine_optimization</a></div><div class="ttdeci">Secondary_engine_optimization</div><div class="ttdoc">Enum that represents which phase of secondary engine optimization the current statement is in...</div><div class="ttdef"><b>Definition:</b> sql_class.h:581</div></div>
<div class="ttc" id="types_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> types.h:54</div></div>
<div class="ttc" id="classTHD_html_a78e5a9c411bd4733de72d41fd58aed1a"><div class="ttname"><a href="classTHD.html#a78e5a9c411bd4733de72d41fd58aed1a">THD::m_audited</a></div><div class="ttdeci">bool m_audited</div><div class="ttdef"><b>Definition:</b> sql_class.h:2564</div></div>
<div class="ttc" id="classSub__statement__state_html_a676f7969061279fc814bf6bc4b57c2da"><div class="ttname"><a href="classSub__statement__state.html#a676f7969061279fc814bf6bc4b57c2da">Sub_statement_state::previous_found_rows</a></div><div class="ttdeci">ulonglong previous_found_rows</div><div class="ttdef"><b>Definition:</b> sql_class.h:622</div></div>
<div class="ttc" id="xcom__transport_8cc_html_a2ca19ac59047f1b932b7737dac46b7b8"><div class="ttname"><a href="xcom__transport_8cc.html#a2ca19ac59047f1b932b7737dac46b7b8">all</a></div><div class="ttdeci">static int all(site_def const *s, node_no node)</div><div class="ttdef"><b>Definition:</b> xcom_transport.cc:879</div></div>
<div class="ttc" id="classTHD_html_a2780cf30cc4d26e35e135c4185f4cebd"><div class="ttname"><a href="classTHD.html#a2780cf30cc4d26e35e135c4185f4cebd">THD::get_internal_handler</a></div><div class="ttdeci">const Internal_error_handler * get_internal_handler() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3637</div></div>
<div class="ttc" id="classTHD_html_a3021f8a2de3bbc8cec238e22e508dfd3"><div class="ttname"><a href="classTHD.html#a3021f8a2de3bbc8cec238e22e508dfd3">THD::protocol_text</a></div><div class="ttdeci">std::unique_ptr&lt; Protocol_text &gt; protocol_text</div><div class="ttdef"><b>Definition:</b> sql_class.h:1148</div></div>
<div class="ttc" id="classTHD_html_a77cfc7cf32448166f4a510a4e7c8361d"><div class="ttname"><a href="classTHD.html#a77cfc7cf32448166f4a510a4e7c8361d">THD::get_ssl</a></div><div class="ttdeci">SSL_handle get_ssl() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1155</div></div>
<div class="ttc" id="classTHD_html_a05a7a0fa113b127dd7a20e849ded13ba"><div class="ttname"><a href="classTHD.html#a05a7a0fa113b127dd7a20e849ded13ba">THD::rpl_thd_ctx</a></div><div class="ttdeci">Rpl_thd_context rpl_thd_ctx</div><div class="ttdef"><b>Definition:</b> sql_class.h:3482</div></div>
<div class="ttc" id="mysql__statement_8h_html"><div class="ttname"><a href="mysql__statement_8h.html">mysql_statement.h</a></div><div class="ttdoc">Instrumentation helpers for statements. </div></div>
<div class="ttc" id="classTHD_html_a06d2be6c2ab3f3322da2f6890a6fdafc"><div class="ttname"><a href="classTHD.html#a06d2be6c2ab3f3322da2f6890a6fdafc">THD::scheduler</a></div><div class="ttdeci">thd_scheduler scheduler</div><div class="ttdef"><b>Definition:</b> sql_class.h:3599</div></div>
<div class="ttc" id="my__sys_8h_html"><div class="ttname"><a href="my__sys_8h.html">my_sys.h</a></div><div class="ttdoc">Common header for many mysys elements. </div></div>
<div class="ttc" id="structGtid_html_a3ab329d122f4a333d20ee097156b5787"><div class="ttname"><a href="structGtid.html#a3ab329d122f4a333d20ee097156b5787">Gtid::dbug_print</a></div><div class="ttdeci">void dbug_print(const Sid_map *sid_map, const char *text=&quot;&quot;, bool need_lock=false) const</div><div class="ttdoc">Print this Gtid to the trace file if debug is enabled; no-op otherwise. </div><div class="ttdef"><b>Definition:</b> rpl_gtid.h:1109</div></div>
<div class="ttc" id="classSub__statement__state_html_a14a0148e85ad293a49b8e8e1a2d80aa4"><div class="ttname"><a href="classSub__statement__state.html#a14a0148e85ad293a49b8e8e1a2d80aa4">Sub_statement_state::option_bits</a></div><div class="ttdeci">ulonglong option_bits</div><div class="ttdef"><b>Definition:</b> sql_class.h:617</div></div>
<div class="ttc" id="group__psi__abi__statement_html_gadc11814f47e2d3907a2459116a8ba7ab"><div class="ttname"><a href="group__psi__abi__statement.html#gadc11814f47e2d3907a2459116a8ba7ab">PSI_statement_locker</a></div><div class="ttdeci">struct PSI_statement_locker PSI_statement_locker</div><div class="ttdef"><b>Definition:</b> psi_statement_bits.h:73</div></div>
<div class="ttc" id="my__command_8h_html_ae2ff1badf13d2b8099af8b47831281e1"><div class="ttname"><a href="my__command_8h.html#ae2ff1badf13d2b8099af8b47831281e1">enum_server_command</a></div><div class="ttdeci">enum_server_command</div><div class="ttdoc">A list of all MySQL protocol commands. </div><div class="ttdef"><b>Definition:</b> my_command.h:47</div></div>
<div class="ttc" id="classTHD_html_ad98e6a9f1b843728ea53ed9723edc21e"><div class="ttname"><a href="classTHD.html#ad98e6a9f1b843728ea53ed9723edc21e">THD::m_net_server_extension</a></div><div class="ttdeci">NET_SERVER m_net_server_extension</div><div class="ttdoc">Aditional network instrumentation for the server only. </div><div class="ttdef"><b>Definition:</b> sql_class.h:978</div></div>
<div class="ttc" id="classTHD_html_a5a7c9c815ab5f4227d6904a0b47b1c3f"><div class="ttname"><a href="classTHD.html#a5a7c9c815ab5f4227d6904a0b47b1c3f">THD::current_found_rows</a></div><div class="ttdeci">ulonglong current_found_rows</div><div class="ttdoc">Dynamic, collected and set also in subqueries. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2011</div></div>
<div class="ttc" id="classTHD_html_a58905b9435ffe4cfc198026068014b59"><div class="ttname"><a href="classTHD.html#a58905b9435ffe4cfc198026068014b59">THD::is_a_srv_session_thd</a></div><div class="ttdeci">bool is_a_srv_session_thd</div><div class="ttdoc">Variable to mark if the object is part of a Srv_session object, which aggregates THD. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4183</div></div>
<div class="ttc" id="classTHD_html_ae6769e533bc4c0e9e994ebeba81ed4fc"><div class="ttname"><a href="classTHD.html#ae6769e533bc4c0e9e994ebeba81ed4fc">THD::is_bootstrap_system_thread</a></div><div class="ttdeci">bool is_bootstrap_system_thread() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2239</div></div>
<div class="ttc" id="structMYSQL__LEX__STRING_html_adc0f5b45a80690636b88ca4866bfc557"><div class="ttname"><a href="structMYSQL__LEX__STRING.html#adc0f5b45a80690636b88ca4866bfc557">MYSQL_LEX_STRING::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> mysql_lex_string.h:36</div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html_ac6115abd499ade3e0fd2967259869b84"><div class="ttname"><a href="classTHD_1_1Query__plan.html#ac6115abd499ade3e0fd2967259869b84">THD::Query_plan::Query_plan</a></div><div class="ttdeci">Query_plan(THD *thd_arg)</div><div class="ttdef"><b>Definition:</b> sql_class.h:1228</div></div>
<div class="ttc" id="classTHD_html_aab3f62b3bd2dcc75b35c73a18f0e7bd6"><div class="ttname"><a href="classTHD.html#aab3f62b3bd2dcc75b35c73a18f0e7bd6">THD::peer_port</a></div><div class="ttdeci">uint16 peer_port</div><div class="ttdef"><b>Definition:</b> sql_class.h:1346</div></div>
<div class="ttc" id="namespaceVt100_html_a4aa812918902b1f6f03db9eff1f0acca"><div class="ttname"><a href="namespaceVt100.html#a4aa812918902b1f6f03db9eff1f0acca">Vt100::reset</a></div><div class="ttdeci">std::string HARNESS_EXPORT reset()</div><div class="ttdoc">get &amp;#39;reset attributes&amp;#39; ESC sequence. </div><div class="ttdef"><b>Definition:</b> vt100.cc:36</div></div>
<div class="ttc" id="do__ctype_8cc_html_a37ac231c3e0b7db0a8807b99e174c729"><div class="ttname"><a href="do__ctype_8cc.html#a37ac231c3e0b7db0a8807b99e174c729">DBUG_TRACE</a></div><div class="ttdeci">DBUG_TRACE</div><div class="ttdef"><b>Definition:</b> do_ctype.cc:46</div></div>
<div class="ttc" id="mysql__com_8h_html_a2bc4c09a6ed0698c89d441028d76a648"><div class="ttname"><a href="mysql__com_8h.html#a2bc4c09a6ed0698c89d441028d76a648">scramble</a></div><div class="ttdeci">void scramble(char *to, const char *message, const char *password)</div><div class="ttdoc">Produce an obscure octet sequence from password and random string, received from the server...</div><div class="ttdef"><b>Definition:</b> password.cc:270</div></div>
<div class="ttc" id="sql__class_8h_html_a4e026d8e1d2fc237283f978b1b931ccb"><div class="ttname"><a href="sql__class_8h.html#a4e026d8e1d2fc237283f978b1b931ccb">thd_exit_cond</a></div><div class="ttdeci">void thd_exit_cond(void *opaque_thd, const PSI_stage_info *stage, const char *src_function, const char *src_file, int src_line)</div><div class="ttdoc">Set thread leaving a condition. </div><div class="ttdef"><b>Definition:</b> sql_thd_internal_api.cc:144</div></div>
<div class="ttc" id="classTHD_html_a2de87232795976fbc5f11214a2dde75a"><div class="ttname"><a href="classTHD.html#a2de87232795976fbc5f11214a2dde75a">THD::unpin_gtid</a></div><div class="ttdeci">void unpin_gtid()</div><div class="ttdoc">Unpin and free GTID and SID. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3430</div></div>
<div class="ttc" id="my__inttypes_8h_html_a378b5b2448c7170f4b6bd225583e8a19"><div class="ttname"><a href="my__inttypes_8h.html#a378b5b2448c7170f4b6bd225583e8a19">my_off_t</a></div><div class="ttdeci">ulonglong my_off_t</div><div class="ttdef"><b>Definition:</b> my_inttypes.h:71</div></div>
<div class="ttc" id="classGtid__set_html"><div class="ttname"><a href="classGtid__set.html">Gtid_set</a></div><div class="ttdoc">Represents a set of GTIDs. </div><div class="ttdef"><b>Definition:</b> rpl_gtid.h:1414</div></div>
<div class="ttc" id="classTHD_html_a03e2b2a18c968b3dee6e8f96b15ac781"><div class="ttname"><a href="classTHD.html#a03e2b2a18c968b3dee6e8f96b15ac781">THD::has_gtid_consistency_violation</a></div><div class="ttdeci">bool has_gtid_consistency_violation</div><div class="ttdef"><b>Definition:</b> sql_class.h:3537</div></div>
<div class="ttc" id="classTHD_html_a9d1ed780b584f0c95f714ad6d1dde9a5"><div class="ttname"><a href="classTHD.html#a9d1ed780b584f0c95f714ad6d1dde9a5">THD::m_stmt_da</a></div><div class="ttdeci">Diagnostics_area * m_stmt_da</div><div class="ttdef"><b>Definition:</b> sql_class.h:3992</div></div>
<div class="ttc" id="classTHD_html_a67c3161454007ae2761d80ab368b0bb0"><div class="ttname"><a href="classTHD.html#a67c3161454007ae2761d80ab368b0bb0">THD::get_plugin</a></div><div class="ttdeci">const st_plugin_int * get_plugin() const</div><div class="ttdoc">Returns the plugin, the thd belongs to. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4164</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_aa0989674f66b8c84e64352912641aa34"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#aa0989674f66b8c84e64352912641aa34">THD::Transaction_state::m_tx_read_only</a></div><div class="ttdeci">bool m_tx_read_only</div><div class="ttdoc">Transaction read-only state. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1690</div></div>
<div class="ttc" id="classTHD_html_aeb1fbff27dc70e02622ab59965ad31dc"><div class="ttname"><a href="classTHD.html#aeb1fbff27dc70e02622ab59965ad31dc">THD::m_trans_log_file</a></div><div class="ttdeci">const char * m_trans_log_file</div><div class="ttdoc">The binary log position of the transaction. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1627</div></div>
<div class="ttc" id="classTHD_html_aa31637e09b425d1f831eb14c7766ec40"><div class="ttname"><a href="classTHD.html#aa31637e09b425d1f831eb14c7766ec40">THD::m_binlog_filter_state</a></div><div class="ttdeci">binlog_filter_state m_binlog_filter_state</div><div class="ttdoc">Indicate if the current statement should be discarded instead of written to the binlog. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1581</div></div>
<div class="ttc" id="classTHD_html_a58f36f97d354993f4adf64f22133a7a4"><div class="ttname"><a href="classTHD.html#a58f36f97d354993f4adf64f22133a7a4">THD::lex</a></div><div class="ttdeci">LEX * lex</div><div class="ttdef"><b>Definition:</b> sql_class.h:863</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240baca5f11f9495bcd708e19d0d41e863d56"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240baca5f11f9495bcd708e19d0d41e863d56">SYSTEM_THREAD_DD_INITIALIZE</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:44</div></div>
<div class="ttc" id="classTHD_html_a32210906fc43174f9affe0cc13ce86a7"><div class="ttname"><a href="classTHD.html#a32210906fc43174f9affe0cc13ce86a7">THD::m_trans_end_pos</a></div><div class="ttdeci">my_off_t m_trans_end_pos</div><div class="ttdef"><b>Definition:</b> sql_class.h:1629</div></div>
<div class="ttc" id="classTHD_1_1Attachable__trx_html_a92624bc0abefbce5c1bbab69c1f71de4"><div class="ttname"><a href="classTHD_1_1Attachable__trx.html#a92624bc0abefbce5c1bbab69c1f71de4">THD::Attachable_trx::m_prev_attachable_trx</a></div><div class="ttdeci">Attachable_trx * m_prev_attachable_trx</div><div class="ttdoc">Attachable_trx which was active for the THD before when this transaction was started (NULL in most ca...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1756</div></div>
<div class="ttc" id="classQuery__arena_html_aedfc1e8a96654eb8bccb81c0e311f7bd"><div class="ttname"><a href="classQuery__arena.html#aedfc1e8a96654eb8bccb81c0e311f7bd">Query_arena::mem_root</a></div><div class="ttdeci">MEM_ROOT * mem_root</div><div class="ttdef"><b>Definition:</b> sql_class.h:235</div></div>
<div class="ttc" id="structPSI__transaction__locker__state__v1_html"><div class="ttname"><a href="structPSI__transaction__locker__state__v1.html">PSI_transaction_locker_state_v1</a></div><div class="ttdoc">State data storage for get_thread_transaction_locker_v1_t, get_thread_transaction_locker_v1_t. </div><div class="ttdef"><b>Definition:</b> psi_transaction_bits.h:52</div></div>
<div class="ttc" id="classTHD_html_ae06f4d9c6079af9667b0c5fffe999ae2"><div class="ttname"><a href="classTHD.html#ae06f4d9c6079af9667b0c5fffe999ae2">THD::charset_is_system_charset</a></div><div class="ttdeci">bool charset_is_system_charset</div><div class="ttdoc">is set if a statement accesses a temporary table created through CREATE TEMPORARY TABLE...</div><div class="ttdef"><b>Definition:</b> sql_class.h:2470</div></div>
<div class="ttc" id="thr__lock_8h_html"><div class="ttname"><a href="thr__lock_8h.html">thr_lock.h</a></div></div>
<div class="ttc" id="classTHD_html_af97d8d03f26deab5d14993ce8ad498cf"><div class="ttname"><a href="classTHD.html#af97d8d03f26deab5d14993ce8ad498cf">THD::thread_specific_used</a></div><div class="ttdeci">bool thread_specific_used</div><div class="ttdoc">is set if some thread specific value(s) used in a statement. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2465</div></div>
<div class="ttc" id="classTHD_html_ab3b03b54670b3f7c7225d9fc7a496652"><div class="ttname"><a href="classTHD.html#ab3b03b54670b3f7c7225d9fc7a496652">THD::set_time</a></div><div class="ttdeci">void set_time(const struct timeval *t)</div><div class="ttdef"><b>Definition:</b> sql_class.h:2768</div></div>
<div class="ttc" id="classTHD_html_a582a85b74619b34867ee0cfe1b5c54ce"><div class="ttname"><a href="classTHD.html#a582a85b74619b34867ee0cfe1b5c54ce">THD::dd_client</a></div><div class="ttdeci">dd::cache::Dictionary_client * dd_client() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:864</div></div>
<div class="ttc" id="structbinary__log_1_1Uuid_html_abeb2fc1c0a321d5cc7275753170069ff"><div class="ttname"><a href="structbinary__log_1_1Uuid.html#abeb2fc1c0a321d5cc7275753170069ff">binary_log::Uuid::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Set to all zeros. </div><div class="ttdef"><b>Definition:</b> uuid.h:62</div></div>
<div class="ttc" id="classQuery__arena_html_a8572a9bd5bdb18d54ffba079d0fdea2d"><div class="ttname"><a href="classQuery__arena.html#a8572a9bd5bdb18d54ffba079d0fdea2d">Query_arena::state</a></div><div class="ttdeci">enum_state state</div><div class="ttdef"><b>Definition:</b> sql_class.h:268</div></div>
<div class="ttc" id="classInternal__error__handler_html"><div class="ttname"><a href="classInternal__error__handler.html">Internal_error_handler</a></div><div class="ttdoc">This class represents the interface for internal error handlers. </div><div class="ttdef"><b>Definition:</b> error_handler.h:46</div></div>
<div class="ttc" id="classTHD_html_a532f355531cd6c80a49920d7cedbb47e"><div class="ttname"><a href="classTHD.html#a532f355531cd6c80a49920d7cedbb47e">THD::opt_trace</a></div><div class="ttdeci">Opt_trace_context opt_trace</div><div class="ttdoc">optimizer trace of current statement </div><div class="ttdef"><b>Definition:</b> sql_class.h:3666</div></div>
<div class="ttc" id="classOpt__trace__context_html"><div class="ttname"><a href="classOpt__trace__context.html">Opt_trace_context</a></div><div class="ttdoc">A per-session context which is always available at any point of execution, because in practice it&amp;#39;s a...</div><div class="ttdef"><b>Definition:</b> opt_trace_context.h:88</div></div>
<div class="ttc" id="template__utils_8h_html"><div class="ttname"><a href="template__utils_8h.html">template_utils.h</a></div></div>
<div class="ttc" id="classTHD_html_ac8b2cdba46110af2a0378d44eba00de4"><div class="ttname"><a href="classTHD.html#ac8b2cdba46110af2a0378d44eba00de4">THD::is_stmt_prepare_or_first_stmt_execute</a></div><div class="ttdeci">bool is_stmt_prepare_or_first_stmt_execute() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:817</div></div>
<div class="ttc" id="classTHD_html_a2152377ce84a056334207e43a93b1be8"><div class="ttname"><a href="classTHD.html#a2152377ce84a056334207e43a93b1be8">THD::syntax_error_at</a></div><div class="ttdeci">void syntax_error_at(const YYLTYPE &amp;location)</div><div class="ttdef"><b>Definition:</b> sql_class.h:4043</div></div>
<div class="ttc" id="classTHD_html_a90953a8bea3f7b428cb451397f276304"><div class="ttname"><a href="classTHD.html#a90953a8bea3f7b428cb451397f276304">THD::update_lock_default</a></div><div class="ttdeci">thr_lock_type update_lock_default</div><div class="ttdoc">Type of lock to be used for all DML statements, except INSERT, in cases when lock is not specified ex...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1357</div></div>
<div class="ttc" id="structHa__data_html_a8df0e23f95ddefe6e2639d7e8b07a4cc"><div class="ttname"><a href="structHa__data.html#a8df0e23f95ddefe6e2639d7e8b07a4cc">Ha_data::lock</a></div><div class="ttdeci">plugin_ref lock</div><div class="ttdoc">NULL: engine is not bound to this thread non-NULL: engine is bound to this thread, engine shutdown forbidden. </div><div class="ttdef"><b>Definition:</b> sql_class.h:695</div></div>
<div class="ttc" id="dbug_8cc_html_a8c097a59d344c89887c5f4cbdbcf493e"><div class="ttname"><a href="dbug_8cc.html#a8c097a59d344c89887c5f4cbdbcf493e">PROFILING</a></div><div class="ttdeci">#define PROFILING</div><div class="ttdef"><b>Definition:</b> dbug.cc:154</div></div>
<div class="ttc" id="my__thread__local_8h_html_a507db6035f89ca9c3d96c1ed3b987fcc"><div class="ttname"><a href="my__thread__local_8h.html#a507db6035f89ca9c3d96c1ed3b987fcc">my_thread_id</a></div><div class="ttdeci">uint32 my_thread_id</div><div class="ttdef"><b>Definition:</b> my_thread_local.h:33</div></div>
<div class="ttc" id="version__token_8cc_html_a9e0992eae3950adccaf4847fbff4231d"><div class="ttname"><a href="version__token_8cc.html#a9e0992eae3950adccaf4847fbff4231d">command</a></div><div class="ttdeci">command</div><div class="ttdef"><b>Definition:</b> version_token.cc:278</div></div>
<div class="ttc" id="classQuery__arena_html_a132c87657a795ccc9d2e9db8abaa8ac3"><div class="ttname"><a href="classQuery__arena.html#a132c87657a795ccc9d2e9db8abaa8ac3">Query_arena::is_stmt_prepare_or_first_stmt_execute</a></div><div class="ttdeci">bool is_stmt_prepare_or_first_stmt_execute() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:294</div></div>
<div class="ttc" id="classTHD_html_afa3c413607ea1ff67a8c17500a9de27b"><div class="ttname"><a href="classTHD.html#afa3c413607ea1ff67a8c17500a9de27b">THD::enum_reset_lex</a></div><div class="ttdeci">enum_reset_lex</div><div class="ttdef"><b>Definition:</b> sql_class.h:1727</div></div>
<div class="ttc" id="classTHD_html_a0851c50664c485cd1292a135f76e0307"><div class="ttname"><a href="classTHD.html#a0851c50664c485cd1292a135f76e0307">THD::m_is_admin_conn</a></div><div class="ttdeci">bool m_is_admin_conn</div><div class="ttdef"><b>Definition:</b> sql_class.h:1336</div></div>
<div class="ttc" id="classTHD_html_afa33b073b2f66a05dcc43bfe1357484e"><div class="ttname"><a href="classTHD.html#afa33b073b2f66a05dcc43bfe1357484e">THD::m_resource_group_ctx</a></div><div class="ttdeci">resourcegroups::Resource_group_ctx m_resource_group_ctx</div><div class="ttdoc">Resource group context indicating the current resource group and the name of the resource group to sw...</div><div class="ttdef"><b>Definition:</b> sql_class.h:902</div></div>
<div class="ttc" id="structuser__conn_html"><div class="ttname"><a href="structuser__conn.html">user_conn</a></div><div class="ttdef"><b>Definition:</b> sql_connect.h:69</div></div>
<div class="ttc" id="classTHD_html_a98047940059e31cedbb2a68a2bca28df"><div class="ttname"><a href="classTHD.html#a98047940059e31cedbb2a68a2bca28df">THD::query_start_usec_used</a></div><div class="ttdeci">bool query_start_usec_used</div><div class="ttdef"><b>Definition:</b> sql_class.h:2453</div></div>
<div class="ttc" id="classTHD_html_aae19c409e4950cf0bfdcbebab48011e2"><div class="ttname"><a href="classTHD.html#aae19c409e4950cf0bfdcbebab48011e2">THD::se_persists_gtid</a></div><div class="ttdeci">bool se_persists_gtid() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3458</div></div>
<div class="ttc" id="classthd__scheduler_html_aa99c727a71a45dc2126c973ce796d137"><div class="ttname"><a href="classthd__scheduler.html#aa99c727a71a45dc2126c973ce796d137">thd_scheduler::~thd_scheduler</a></div><div class="ttdeci">~thd_scheduler()</div><div class="ttdef"><b>Definition:</b> sql_class.h:201</div></div>
<div class="ttc" id="structSAVEPOINT_html"><div class="ttname"><a href="structSAVEPOINT.html">SAVEPOINT</a></div><div class="ttdef"><b>Definition:</b> transaction_info.h:42</div></div>
<div class="ttc" id="classTHD_html_a545a10790e3f8bca0f18c6a5e46dead4"><div class="ttname"><a href="classTHD.html#a545a10790e3f8bca0f18c6a5e46dead4">THD::is_system_thread</a></div><div class="ttdeci">bool is_system_thread() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2217</div></div>
<div class="ttc" id="structrpl__event__coordinates_html_aa9adb347385c31e998f55f447eda8c4e"><div class="ttname"><a href="structrpl__event__coordinates.html#aa9adb347385c31e998f55f447eda8c4e">rpl_event_coordinates::file_name</a></div><div class="ttdeci">char * file_name</div><div class="ttdef"><b>Definition:</b> sql_class.h:217</div></div>
<div class="ttc" id="classTHD_html_ac7322cad4b0ee57fbfd13c42a5ed76c2"><div class="ttname"><a href="classTHD.html#ac7322cad4b0ee57fbfd13c42a5ed76c2">THD::get_query_rewrite_plugin_da</a></div><div class="ttdeci">Diagnostics_area * get_query_rewrite_plugin_da()</div><div class="ttdoc">Returns thread-local Diagnostics Area to be used by query rewrite plugins. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2941</div></div>
<div class="ttc" id="classTHD_html_a88c407aadf9c279bc94eaf21f77e9175"><div class="ttname"><a href="classTHD.html#a88c407aadf9c279bc94eaf21f77e9175">THD::catalog</a></div><div class="ttdeci">const LEX_CSTRING &amp; catalog() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1267</div></div>
<div class="ttc" id="classTHD_html_aff87818ded40571a9ea74ee93ac81d94"><div class="ttname"><a href="classTHD.html#aff87818ded40571a9ea74ee93ac81d94">THD::found_rows</a></div><div class="ttdeci">ulonglong found_rows() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2783</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240ba4eeba491e7a1a8e7e960c531b179f394"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba4eeba491e7a1a8e7e960c531b179f394">SYSTEM_THREAD_SLAVE_IO</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:35</div></div>
<div class="ttc" id="classProtocol_html"><div class="ttname"><a href="classProtocol.html">Protocol</a></div><div class="ttdef"><b>Definition:</b> protocol.h:34</div></div>
<div class="ttc" id="psi__stage__bits_8h_html"><div class="ttname"><a href="psi__stage__bits_8h.html">psi_stage_bits.h</a></div><div class="ttdoc">Performance schema instrumentation interface. </div></div>
<div class="ttc" id="classQuery__arena_html_a1b32bd738ceabcfecbac6d4aa8433a0d"><div class="ttname"><a href="classQuery__arena.html#a1b32bd738ceabcfecbac6d4aa8433a0d">Query_arena::alloc_typed</a></div><div class="ttdeci">T * alloc_typed()</div><div class="ttdef"><b>Definition:</b> sql_class.h:307</div></div>
<div class="ttc" id="classSession__sysvar__resource__manager_html"><div class="ttname"><a href="classSession__sysvar__resource__manager.html">Session_sysvar_resource_manager</a></div><div class="ttdoc">Session_sysvar_resource_manager When a session (THD) gets initialized, it receives a shallow copy of ...</div><div class="ttdef"><b>Definition:</b> sys_vars_resource_mgr.h:67</div></div>
<div class="ttc" id="classTHD_html_a68aa8081e199d358a3b372fc9824ffb4"><div class="ttname"><a href="classTHD.html#a68aa8081e199d358a3b372fc9824ffb4">THD::is_attachable_ro_transaction_active</a></div><div class="ttdeci">bool is_attachable_ro_transaction_active() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3059</div></div>
<div class="ttc" id="hp__test1_8cc_html_adf916204820072417ed73a32de1cefcf"><div class="ttname"><a href="hp__test1_8cc.html#adf916204820072417ed73a32de1cefcf">flag</a></div><div class="ttdeci">static int flag</div><div class="ttdef"><b>Definition:</b> hp_test1.cc:39</div></div>
<div class="ttc" id="sql__class_8h_html_a4a184b0ed2cd02bf976cbc962ab73de9"><div class="ttname"><a href="sql__class_8h.html#a4a184b0ed2cd02bf976cbc962ab73de9">PREALLOC_NUM_HA</a></div><div class="ttdeci">constexpr size_t PREALLOC_NUM_HA</div><div class="ttdef"><b>Definition:</b> sql_class.h:190</div></div>
<div class="ttc" id="classQuery__arena_html_a54aac863df5e185baa158e9e72c52b5b"><div class="ttname"><a href="classQuery__arena.html#a54aac863df5e185baa158e9e72c52b5b">Query_arena::is_stmt_prepare</a></div><div class="ttdeci">bool is_stmt_prepare() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:290</div></div>
<div class="ttc" id="classTransactional__ddl__context_html_a849ea5f3991362649bec50c68d1dc171"><div class="ttname"><a href="classTransactional__ddl__context.html#a849ea5f3991362649bec50c68d1dc171">Transactional_ddl_context::Transactional_ddl_context</a></div><div class="ttdeci">Transactional_ddl_context(THD *thd)</div><div class="ttdef"><b>Definition:</b> sql_class.h:767</div></div>
<div class="ttc" id="classTHD_html_a2272ebb8c9b59a2d51e137b5dbcfe107"><div class="ttname"><a href="classTHD.html#a2272ebb8c9b59a2d51e137b5dbcfe107">THD::statement_id_counter</a></div><div class="ttdeci">ulong statement_id_counter</div><div class="ttdef"><b>Definition:</b> sql_class.h:2189</div></div>
<div class="ttc" id="classTHD_html_aa99d434000b1e2572b741a69e34b8980"><div class="ttname"><a href="classTHD.html#aa99d434000b1e2572b741a69e34b8980">THD::push_diagnostics_area</a></div><div class="ttdeci">void push_diagnostics_area(Diagnostics_area *da, bool copy_conditions=true)</div><div class="ttdoc">Push the given Diagnostics Area on top of the stack, making it the new first Diagnostics Area...</div><div class="ttdef"><b>Definition:</b> sql_class.h:2956</div></div>
<div class="ttc" id="classTHD_html_af3feadcfbb9a7835b7941945c6cd0828"><div class="ttname"><a href="classTHD.html#af3feadcfbb9a7835b7941945c6cd0828">THD::is_operating_substatement_implicitly</a></div><div class="ttdeci">bool is_operating_substatement_implicitly</div><div class="ttdef"><b>Definition:</b> sql_class.h:2036</div></div>
<div class="ttc" id="classTHD_html_a54d854b9856cf21470c1c8e758e7d33f"><div class="ttname"><a href="classTHD.html#a54d854b9856cf21470c1c8e758e7d33f">THD::get_psi</a></div><div class="ttdeci">PSI_thread * get_psi() const</div><div class="ttdoc">Read the performance schema thread instrumentation associated with this user session. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3624</div></div>
<div class="ttc" id="classTHD_html_ab77dc649d04a41008e69003736eb24d9"><div class="ttname"><a href="classTHD.html#ab77dc649d04a41008e69003736eb24d9">THD::net</a></div><div class="ttdeci">NET net</div><div class="ttdef"><b>Definition:</b> sql_class.h:1633</div></div>
<div class="ttc" id="classTHD_html_a6277c56db1fa8a31ca2413e9e1b896de"><div class="ttname"><a href="classTHD.html#a6277c56db1fa8a31ca2413e9e1b896de">THD::m_thread_id</a></div><div class="ttdeci">my_thread_id m_thread_id</div><div class="ttdoc">This counter is 32 bit because of the client protocol. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2203</div></div>
<div class="ttc" id="system__variables_8h_html_acd03be4982af89757ca0317f3d73d0bcacca4d39ed26658ad08e83887217a3e57"><div class="ttname"><a href="system__variables_8h.html#acd03be4982af89757ca0317f3d73d0bcacca4d39ed26658ad08e83887217a3e57">BINLOG_FORMAT_STMT</a></div><div class="ttdoc">statement-based </div><div class="ttdef"><b>Definition:</b> system_variables.h:46</div></div>
<div class="ttc" id="classTHD_html_a61ae989e5c3c2e0dfa3c8701ddb8067d"><div class="ttname"><a href="classTHD.html#a61ae989e5c3c2e0dfa3c8701ddb8067d">THD::get_transaction</a></div><div class="ttdeci">const Transaction_ctx * get_transaction() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1795</div></div>
<div class="ttc" id="structPSI__stage__progress__v1_html"><div class="ttname"><a href="structPSI__stage__progress__v1.html">PSI_stage_progress_v1</a></div><div class="ttdoc">Interface for an instrumented stage progress. </div><div class="ttdef"><b>Definition:</b> psi_stage_bits.h:60</div></div>
<div class="ttc" id="my__dbug_8h_html"><div class="ttname"><a href="my__dbug_8h.html">my_dbug.h</a></div></div>
<div class="ttc" id="sql__class_8h_html_a76570ebd7443e3c05c9f2487f484dbc7"><div class="ttname"><a href="sql__class_8h.html#a76570ebd7443e3c05c9f2487f484dbc7">show_system_thread</a></div><div class="ttdeci">char const  * show_system_thread(enum_thread_type thread)</div><div class="ttdef"><b>Definition:</b> sql_class.h:631</div></div>
<div class="ttc" id="classTHD_html_a65a43f30f696f95840ae621146a44405"><div class="ttname"><a href="classTHD.html#a65a43f30f696f95840ae621146a44405">THD::fatal_error</a></div><div class="ttdeci">void fatal_error()</div><div class="ttdoc">Mark the current error as fatal. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2893</div></div>
<div class="ttc" id="classTHD_html_ab3cae918b100630fb0c073dbd4c42013"><div class="ttname"><a href="classTHD.html#ab3cae918b100630fb0c073dbd4c42013">THD::get_stacked_da</a></div><div class="ttdeci">const Diagnostics_area * get_stacked_da() const</div><div class="ttdoc">Returns the second Diagnostics Area for the current statement. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2917</div></div>
<div class="ttc" id="classTHD_html_a510136f4a756403fb083308df2fb003d"><div class="ttname"><a href="classTHD.html#a510136f4a756403fb083308df2fb003d">THD::get_binlog_local_stmt_filter</a></div><div class="ttdeci">binlog_filter_state get_binlog_local_stmt_filter() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1556</div></div>
<div class="ttc" id="classTHD_1_1Attachable__trx_html_a396ad49c62693f5571c366ee07fd5342"><div class="ttname"><a href="classTHD_1_1Attachable__trx.html#a396ad49c62693f5571c366ee07fd5342">THD::Attachable_trx::m_thd</a></div><div class="ttdeci">THD * m_thd</div><div class="ttdoc">THD instance. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1748</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html"><div class="ttname"><a href="structTHD_1_1Transaction__state.html">THD::Transaction_state</a></div><div class="ttdoc">An utility struct for Attachable_trx. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1663</div></div>
<div class="ttc" id="psi__memory__key_8h_html"><div class="ttname"><a href="psi__memory__key_8h.html">psi_memory_key.h</a></div></div>
<div class="ttc" id="classTHD_html_a2f49b86d2427fa0f37c93e13f9ac080f"><div class="ttname"><a href="classTHD.html#a2f49b86d2427fa0f37c93e13f9ac080f">THD::clear_current_query_costs</a></div><div class="ttdeci">void clear_current_query_costs()</div><div class="ttdoc">Clear the query costs attributes for the current query. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1014</div></div>
<div class="ttc" id="structmysql__mutex__t_html"><div class="ttname"><a href="structmysql__mutex__t.html">mysql_mutex_t</a></div><div class="ttdoc">An instrumented mutex structure. </div><div class="ttdef"><b>Definition:</b> mysql_mutex_bits.h:49</div></div>
<div class="ttc" id="classTHD_html_ace47d2f0ac593685063f1252e9a144e6"><div class="ttname"><a href="classTHD.html#ace47d2f0ac593685063f1252e9a144e6">THD::m_disable_password_validation</a></div><div class="ttdeci">bool m_disable_password_validation</div><div class="ttdef"><b>Definition:</b> sql_class.h:1132</div></div>
<div class="ttc" id="classTHD_html_aa9d10434713933cd9e9a5c9ae1450b88"><div class="ttname"><a href="classTHD.html#aa9d10434713933cd9e9a5c9ae1450b88">THD::audit_class_plugins</a></div><div class="ttdeci">Plugin_array audit_class_plugins</div><div class="ttdoc">Array of active audit plugins which have been used by this THD. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2543</div></div>
<div class="ttc" id="classSub__statement__state_html"><div class="ttname"><a href="classSub__statement__state.html">Sub_statement_state</a></div><div class="ttdoc">Used to save context when executing a function or trigger. </div><div class="ttdef"><b>Definition:</b> sql_class.h:615</div></div>
<div class="ttc" id="classTHD_html_af1141e7ffe7be501c9924f1b1f34ec78"><div class="ttname"><a href="classTHD.html#af1141e7ffe7be501c9924f1b1f34ec78">THD::Se_GTID_flag</a></div><div class="ttdeci">Se_GTID_flag</div><div class="ttdoc">SE GTID persistence flag types. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3408</div></div>
<div class="ttc" id="my__inttypes_8h_html_a0db1f888c3bc329e7b0b340dbd41eb2b"><div class="ttname"><a href="my__inttypes_8h.html#a0db1f888c3bc329e7b0b340dbd41eb2b">myf</a></div><div class="ttdeci">int myf</div><div class="ttdef"><b>Definition:</b> my_inttypes.h:93</div></div>
<div class="ttc" id="classTHD_html_a80e02419914f3da098e1a8794551bf09"><div class="ttname"><a href="classTHD.html#a80e02419914f3da098e1a8794551bf09">THD::packet</a></div><div class="ttdeci">String packet</div><div class="ttdef"><b>Definition:</b> sql_class.h:1634</div></div>
<div class="ttc" id="classTHD_html_a37a1810b18a4a60ef7a89f2f8cf01ab1"><div class="ttname"><a href="classTHD.html#a37a1810b18a4a60ef7a89f2f8cf01ab1">THD::push_protocol</a></div><div class="ttdeci">void push_protocol(const std::unique_ptr&lt; ProtocolClass &gt; &amp;protocol)</div><div class="ttdef"><b>Definition:</b> sql_class.h:2976</div></div>
<div class="ttc" id="classGlobal__read__lock_html_a0f511b352f4515d70c6bb317b053f7de"><div class="ttname"><a href="classGlobal__read__lock.html#a0f511b352f4515d70c6bb317b053f7de">Global_read_lock::m_mdl_blocks_commits_lock</a></div><div class="ttdeci">MDL_ticket * m_mdl_blocks_commits_lock</div><div class="ttdoc">Also in order to acquire the global read lock, the connection must acquire a shared metadata lock in ...</div><div class="ttdef"><b>Definition:</b> sql_class.h:756</div></div>
<div class="ttc" id="classTHD_html_a87bd76207e6a1e87c2821b51b34030ef"><div class="ttname"><a href="classTHD.html#a87bd76207e6a1e87c2821b51b34030ef">THD::is_system_user</a></div><div class="ttdeci">bool is_system_user()</div><div class="ttdoc">Returns if the user of the session has the SYSTEM_USER privilege or not. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4345</div></div>
<div class="ttc" id="classTHD_html_a72aa3496415e426b5563b78f191f2098"><div class="ttname"><a href="classTHD.html#a72aa3496415e426b5563b78f191f2098">THD::get_protocol</a></div><div class="ttdeci">const Protocol * get_protocol() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1151</div></div>
<div class="ttc" id="classTHD_html_a297a1b6b0e8bcf34f5b96f1485c522eb"><div class="ttname"><a href="classTHD.html#a297a1b6b0e8bcf34f5b96f1485c522eb">THD::debug_binlog_xid_last</a></div><div class="ttdeci">XID debug_binlog_xid_last</div><div class="ttdef"><b>Definition:</b> sql_class.h:4208</div></div>
<div class="ttc" id="binlog_8h_html_a12a2cc906d37cadce17ce6455271a09a"><div class="ttname"><a href="binlog_8h.html#a12a2cc906d37cadce17ce6455271a09a">query_id_t</a></div><div class="ttdeci">int64 query_id_t</div><div class="ttdef"><b>Definition:</b> binlog.h:70</div></div>
<div class="ttc" id="classTHD_html_a72249f9440b501f408eb710518ff5870"><div class="ttname"><a href="classTHD.html#a72249f9440b501f408eb710518ff5870">THD::optimizer_switch_flag</a></div><div class="ttdeci">bool optimizer_switch_flag(ulonglong flag) const</div><div class="ttdoc">Tells whether the given optimizer_switch flag is on. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1532</div></div>
<div class="ttc" id="classTHD_html_acd9e4c9442ecb192a501cb6f3555b195"><div class="ttname"><a href="classTHD.html#acd9e4c9442ecb192a501cb6f3555b195">THD::check_clone_vio</a></div><div class="ttdeci">bool check_clone_vio()</div><div class="ttdoc">Check if clone network Vio is active. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2642</div></div>
<div class="ttc" id="classPrealloced__array_html_a624d17ca3684b1e7220f0343eb2360fd"><div class="ttname"><a href="classPrealloced__array.html#a624d17ca3684b1e7220f0343eb2360fd">Prealloced_array::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Removes (and destroys) all elements. </div><div class="ttdef"><b>Definition:</b> prealloced_array.h:586</div></div>
<div class="ttc" id="sql__class_8h_html_a72c83217b7613b5afda5d424fe70d56ea371b09d93ca01e09a42fbd5a2a423f8e"><div class="ttname"><a href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56ea371b09d93ca01e09a42fbd5a2a423f8e">Secondary_engine_optimization::SECONDARY</a></div><div class="ttdoc">The current statement should use tables from a secondary storage engine if possible. </div></div>
<div class="ttc" id="classDiagnostics__area_html_a37dd3ff9b2f6177d72b9345768d34eca"><div class="ttname"><a href="classDiagnostics__area.html#a37dd3ff9b2f6177d72b9345768d34eca">Diagnostics_area::stacked_da</a></div><div class="ttdeci">const Diagnostics_area * stacked_da() const</div><div class="ttdoc">Returns the Diagnostics Area below the current diagnostics area on the stack. </div><div class="ttdef"><b>Definition:</b> sql_error.h:586</div></div>
<div class="ttc" id="structHa__data_html_a1ab76d76afcd5a91c33e6466ece6b6cc"><div class="ttname"><a href="structHa__data.html#a1ab76d76afcd5a91c33e6466ece6b6cc">Ha_data::ha_ptr_backup</a></div><div class="ttdeci">void * ha_ptr_backup</div><div class="ttdoc">A memorizer to engine specific &quot;native&quot; transaction object to provide storage engine detach-re-attach...</div><div class="ttdef"><b>Definition:</b> sql_class.h:678</div></div>
<div class="ttc" id="classTHD_html_a7b69b5cbd027a1e48a58fc2fe76476e7"><div class="ttname"><a href="classTHD.html#a7b69b5cbd027a1e48a58fc2fe76476e7">THD::get_ha_data</a></div><div class="ttdeci">Ha_data * get_ha_data(int slot)</div><div class="ttdoc">Retrieve Ha_data for a given slot. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1387</div></div>
<div class="ttc" id="lex__string_8h_html_a01c5da2ec635d24c374ba1a995dbe2aa"><div class="ttname"><a href="lex__string_8h.html#a01c5da2ec635d24c374ba1a995dbe2aa">LEX_CSTRING</a></div><div class="ttdeci">struct MYSQL_LEX_CSTRING LEX_CSTRING</div><div class="ttdef"><b>Definition:</b> lex_string.h:40</div></div>
<div class="ttc" id="classTHD_html_a314e110052f1994be7d732d484f6d84c"><div class="ttname"><a href="classTHD.html#a314e110052f1994be7d732d484f6d84c">THD::set_ssl</a></div><div class="ttdeci">void set_ssl(Vio *vio)</div><div class="ttdef"><b>Definition:</b> sql_class.h:2613</div></div>
<div class="ttc" id="classGlobal__read__lock_html_abff09417a0643d98f92e2cd9f8e21a0d"><div class="ttname"><a href="classGlobal__read__lock.html#abff09417a0643d98f92e2cd9f8e21a0d">Global_read_lock::global_read_lock_active</a></div><div class="ttdeci">static bool global_read_lock_active()</div><div class="ttdoc">Used by innodb memcached server to check if any connections have global read lock. </div><div class="ttdef"><b>Definition:</b> sql_class.h:725</div></div>
<div class="ttc" id="classuser__var__entry_html"><div class="ttname"><a href="classuser__var__entry.html">user_var_entry</a></div><div class="ttdef"><b>Definition:</b> item_func.h:2994</div></div>
<div class="ttc" id="classTHD_html_acfd365279829b128edbb75e113d68db0"><div class="ttname"><a href="classTHD.html#acfd365279829b128edbb75e113d68db0">THD::do_union</a></div><div class="ttdeci">bool do_union</div><div class="ttdef"><b>Definition:</b> sql_class.h:2507</div></div>
<div class="ttc" id="classTHD_html_afa937eb13c356a986e428cf1b6663ba6"><div class="ttname"><a href="classTHD.html#afa937eb13c356a986e428cf1b6663ba6">THD::password</a></div><div class="ttdeci">uchar password</div><div class="ttdef"><b>Definition:</b> sql_class.h:2422</div></div>
<div class="ttc" id="classthd__scheduler_html"><div class="ttname"><a href="classthd__scheduler.html">thd_scheduler</a></div><div class="ttdoc">To be used for pool-of-threads (implemented differently on various OSs) </div><div class="ttdef"><b>Definition:</b> sql_class.h:195</div></div>
<div class="ttc" id="pfs__thread__provider_8h_html"><div class="ttname"><a href="pfs__thread__provider_8h.html">pfs_thread_provider.h</a></div><div class="ttdoc">Performance schema instrumentation (declarations). </div></div>
<div class="ttc" id="locked__tables__list_8h_html_a77fee489173235058762d07e721b7476"><div class="ttname"><a href="locked__tables__list_8h.html#a77fee489173235058762d07e721b7476">enum_locked_tables_mode</a></div><div class="ttdeci">enum_locked_tables_mode</div><div class="ttdoc">Type of locked tables mode. </div><div class="ttdef"><b>Definition:</b> locked_tables_list.h:44</div></div>
<div class="ttc" id="classModification__plan_html"><div class="ttname"><a href="classModification__plan.html">Modification_plan</a></div><div class="ttdoc">Table modification plan for JOIN-less statements (update/delete) </div><div class="ttdef"><b>Definition:</b> opt_explain.h:80</div></div>
<div class="ttc" id="mysql__mutex__bits_8h_html"><div class="ttname"><a href="mysql__mutex__bits_8h.html">mysql_mutex_bits.h</a></div><div class="ttdoc">ABI for instrumented mutexes. </div></div>
<div class="ttc" id="group__MYSYS_html_ga6fe5765f3b92d4dadad6f28e56957899"><div class="ttname"><a href="group__MYSYS.html#ga6fe5765f3b92d4dadad6f28e56957899">default_charset_info</a></div><div class="ttdeci">MYSQL_PLUGIN_IMPORT CHARSET_INFO * default_charset_info</div><div class="ttdef"><b>Definition:</b> charset.cc:423</div></div>
<div class="ttc" id="classTHD_html_ac6653f0e6e583b004bd23879008a0d35"><div class="ttname"><a href="classTHD.html#ac6653f0e6e583b004bd23879008a0d35">THD::is_attachable_rw_transaction_active</a></div><div class="ttdeci">bool is_attachable_rw_transaction_active() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3073</div></div>
<div class="ttc" id="classItem__change__record_html_a65dc90734e440a2d4da93c546f9e851c"><div class="ttname"><a href="classItem__change__record.html#a65dc90734e440a2d4da93c546f9e851c">Item_change_record::Item_change_record</a></div><div class="ttdeci">Item_change_record(Item **place, Item *new_value)</div><div class="ttdef"><b>Definition:</b> sql_class.h:413</div></div>
<div class="ttc" id="map__helpers_8h_html"><div class="ttname"><a href="map__helpers_8h.html">map_helpers.h</a></div></div>
<div class="ttc" id="classTHD_html_a7953b16ef50f82579cf239d64d98c94d"><div class="ttname"><a href="classTHD.html#a7953b16ef50f82579cf239d64d98c94d">THD::clear_current_stmt_binlog_format_row</a></div><div class="ttdeci">void clear_current_stmt_binlog_format_row()</div><div class="ttdef"><b>Definition:</b> sql_class.h:3111</div></div>
<div class="ttc" id="classOpen__tables__backup_html_a790db3d7c6d12288c1b72b7fa571916c"><div class="ttname"><a href="classOpen__tables__backup.html#a790db3d7c6d12288c1b72b7fa571916c">Open_tables_backup::mdl_system_tables_svp</a></div><div class="ttdeci">MDL_savepoint mdl_system_tables_svp</div><div class="ttdoc">When we backup the open tables state to open a system table or tables, we want to save state of metad...</div><div class="ttdef"><b>Definition:</b> sql_class.h:574</div></div>
<div class="ttc" id="structsql__digest__state_html"><div class="ttname"><a href="structsql__digest__state.html">sql_digest_state</a></div><div class="ttdoc">State data storage for digest_start, digest_add_token. </div><div class="ttdef"><b>Definition:</b> sql_digest_stream.h:35</div></div>
<div class="ttc" id="classTHD_1_1Attachable__trx_html_a767726c2f48805d924ae0914df7e388c"><div class="ttname"><a href="classTHD_1_1Attachable__trx.html#a767726c2f48805d924ae0914df7e388c">THD::Attachable_trx::get_prev_attachable_trx</a></div><div class="ttdeci">Attachable_trx * get_prev_attachable_trx() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1741</div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html_a0727e4959844b99f616f89426ce1339d"><div class="ttname"><a href="classTHD_1_1Query__plan.html#a0727e4959844b99f616f89426ce1339d">THD::Query_plan::get_lex</a></div><div class="ttdeci">LEX * get_lex() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1250</div></div>
<div class="ttc" id="my__io_8h_html"><div class="ttname"><a href="my__io_8h.html">my_io.h</a></div><div class="ttdoc">Common #defines and includes for file and socket I/O. </div></div>
<div class="ttc" id="classI__List_html"><div class="ttname"><a href="classI__List.html">I_List&lt; Item_change_record &gt;</a></div></div>
<div class="ttc" id="classTHD_html_a59efd33ea1ebf92b45c2f9232f564bef"><div class="ttname"><a href="classTHD.html#a59efd33ea1ebf92b45c2f9232f564bef">THD::status_var_aggregated</a></div><div class="ttdeci">bool status_var_aggregated</div><div class="ttdef"><b>Definition:</b> sql_class.h:993</div></div>
<div class="ttc" id="classQuery__arena_html_aef63eda408fe634c472acb7a268a0869"><div class="ttname"><a href="classQuery__arena.html#aef63eda408fe634c472acb7a268a0869">Query_arena::memdup</a></div><div class="ttdeci">void * memdup(const void *str, size_t size)</div><div class="ttdef"><b>Definition:</b> sql_class.h:319</div></div>
<div class="ttc" id="group__psi__api__mutex_html_gaccf61aa4a9e6108ac938a184d7b8efd7"><div class="ttname"><a href="group__psi__api__mutex.html#gaccf61aa4a9e6108ac938a184d7b8efd7">mysql_mutex_assert_owner</a></div><div class="ttdeci">#define mysql_mutex_assert_owner(M)</div><div class="ttdoc">Wrapper, to use safe_mutex_assert_owner with instrumented mutexes. </div><div class="ttdef"><b>Definition:</b> mysql_mutex.h:109</div></div>
<div class="ttc" id="classTHD_html_a397100c599ecc8901529e2d7355bd993"><div class="ttname"><a href="classTHD.html#a397100c599ecc8901529e2d7355bd993">THD::get_trans_fixed_pos</a></div><div class="ttdeci">void get_trans_fixed_pos(const char **file_var, my_off_t *pos_var) const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2355</div></div>
<div class="ttc" id="classTHD_html_ac407896beb3240309f98167990b58d50"><div class="ttname"><a href="classTHD.html#ac407896beb3240309f98167990b58d50">THD::unmasked_server_id</a></div><div class="ttdeci">uint32 unmasked_server_id</div><div class="ttdef"><b>Definition:</b> sql_class.h:1342</div></div>
<div class="ttc" id="violite_8h_html"><div class="ttname"><a href="violite_8h.html">violite.h</a></div><div class="ttdoc">Vio Lite. </div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html_a848e5cee2fa1d0bb5be1697dc7bd78ae"><div class="ttname"><a href="classTHD_1_1Query__plan.html#a848e5cee2fa1d0bb5be1697dc7bd78ae">THD::Query_plan::lex</a></div><div class="ttdeci">LEX * lex</div><div class="ttdoc">LEX of topmost statement. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1209</div></div>
<div class="ttc" id="classTHD_html_a2c8dc7fd2104d419ed6d70d99deda127"><div class="ttname"><a href="classTHD.html#a2c8dc7fd2104d419ed6d70d99deda127">THD::pop_diagnostics_area</a></div><div class="ttdeci">void pop_diagnostics_area()</div><div class="ttdoc">Pop the top DA off the Diagnostics Area stack. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2963</div></div>
<div class="ttc" id="sql__plugin__ref_8h_html"><div class="ttname"><a href="sql__plugin__ref_8h.html">sql_plugin_ref.h</a></div></div>
<div class="ttc" id="classTHD_html_a081a29897480566f439d7e2c53799328"><div class="ttname"><a href="classTHD.html#a081a29897480566f439d7e2c53799328">THD::m_dd_client</a></div><div class="ttdeci">std::unique_ptr&lt; dd::cache::Dictionary_client &gt; m_dd_client</div><div class="ttdef"><b>Definition:</b> sql_class.h:870</div></div>
<div class="ttc" id="classTHD_html_ae96ffa9182f5eba1bffaca8e02d61bca"><div class="ttname"><a href="classTHD.html#ae96ffa9182f5eba1bffaca8e02d61bca">THD::m_connection_attributes</a></div><div class="ttdeci">std::vector&lt; char &gt; m_connection_attributes</div><div class="ttdoc">Session&amp;#39;s connection attributes for the connected client. </div><div class="ttdef"><b>Definition:</b> sql_class.h:998</div></div>
<div class="ttc" id="classItem__change__record_html_aa65017793bdf6f41344109d7cb00a51b"><div class="ttname"><a href="classItem__change__record.html#aa65017793bdf6f41344109d7cb00a51b">Item_change_record::place</a></div><div class="ttdeci">Item ** place</div><div class="ttdef"><b>Definition:</b> sql_class.h:415</div></div>
<div class="ttc" id="classHa__trx__info_html"><div class="ttname"><a href="classHa__trx__info.html">Ha_trx_info</a></div><div class="ttdoc">Either statement transaction or normal transaction - related thread-specific storage engine data...</div><div class="ttdef"><b>Definition:</b> transaction_info.h:408</div></div>
<div class="ttc" id="classTHD_html_a5b4ce043dec5c4eaea92708335db8ae6"><div class="ttname"><a href="classTHD.html#a5b4ce043dec5c4eaea92708335db8ae6">THD::set_clone_vio</a></div><div class="ttdeci">void set_clone_vio(Vio *vio)</div><div class="ttdoc">Set active clone network Vio for remote clone. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2628</div></div>
<div class="ttc" id="structGtid_html_aad81c0dd59ff02412e507d254c6843d2"><div class="ttname"><a href="structGtid.html#aad81c0dd59ff02412e507d254c6843d2">Gtid::sidno</a></div><div class="ttdeci">rpl_sidno sidno</div><div class="ttdoc">SIDNO of this Gtid. </div><div class="ttdef"><b>Definition:</b> rpl_gtid.h:1029</div></div>
<div class="ttc" id="classTHD_html_a0624d627df806876ea2739e8fc1c7191"><div class="ttname"><a href="classTHD.html#a0624d627df806876ea2739e8fc1c7191">THD::timer</a></div><div class="ttdeci">struct THD_timer_info * timer</div><div class="ttdoc">Holds active timer object. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1561</div></div>
<div class="ttc" id="classTHD_html_aab99a7bbf58663e13dbee4b225939f09"><div class="ttname"><a href="classTHD.html#aab99a7bbf58663e13dbee4b225939f09">THD::secondary_engine_optimization</a></div><div class="ttdeci">Secondary_engine_optimization secondary_engine_optimization() const</div><div class="ttdoc">Can secondary storage engines be used for query execution in this session? </div><div class="ttdef"><b>Definition:</b> sql_class.h:4251</div></div>
<div class="ttc" id="classTHD_html_aff118031188614eca7a3954a0b8505b4"><div class="ttname"><a href="classTHD.html#aff118031188614eca7a3954a0b8505b4">THD::m_digest_state</a></div><div class="ttdeci">sql_digest_state m_digest_state</div><div class="ttdoc">Top level statement digest. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2152</div></div>
<div class="ttc" id="classTHD_html_af9edac759d5b46b39cfeb95391b5dbe3"><div class="ttname"><a href="classTHD.html#af9edac759d5b46b39cfeb95391b5dbe3">THD::owned_gtid_is_empty</a></div><div class="ttdeci">bool owned_gtid_is_empty()</div><div class="ttdef"><b>Definition:</b> sql_class.h:3504</div></div>
<div class="ttc" id="classOpen__tables__state_html_afed6746977711436977cafbf738456da"><div class="ttname"><a href="classOpen__tables__state.html#afed6746977711436977cafbf738456da">Open_tables_state::get_reprepare_observer</a></div><div class="ttdeci">Reprepare_observer * get_reprepare_observer() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:454</div></div>
<div class="ttc" id="dd__event_8h_html_a20f7f65896651c6fcc973f518670c5a8"><div class="ttname"><a href="dd__event_8h.html#a20f7f65896651c6fcc973f518670c5a8">sql_mode_t</a></div><div class="ttdeci">ulonglong sql_mode_t</div><div class="ttdef"><b>Definition:</b> dd_event.h:36</div></div>
<div class="ttc" id="classTHD_1_1Attachable__trx_html"><div class="ttname"><a href="classTHD_1_1Attachable__trx.html">THD::Attachable_trx</a></div><div class="ttdoc">Class representing read-only attachable transaction, encapsulates knowledge how to backup state of cu...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1737</div></div>
<div class="ttc" id="classTHD_html_a9337218e2983f33f407ef76046f31bfa"><div class="ttname"><a href="classTHD.html#a9337218e2983f33f407ef76046f31bfa">THD::work_part_info</a></div><div class="ttdeci">partition_info * work_part_info</div><div class="ttdef"><b>Definition:</b> sql_class.h:2536</div></div>
<div class="ttc" id="classTHD_html_a0d59225e08125bb900e41cb91c532f95"><div class="ttname"><a href="classTHD.html#a0d59225e08125bb900e41cb91c532f95">THD::first_successful_insert_id_in_cur_stmt</a></div><div class="ttdeci">ulonglong first_successful_insert_id_in_cur_stmt</div><div class="ttdef"><b>Definition:</b> sql_class.h:1887</div></div>
<div class="ttc" id="classTHD_html_a5b9b6c54302faa029211ef0d14bd1c10"><div class="ttname"><a href="classTHD.html#a5b9b6c54302faa029211ef0d14bd1c10">THD::resource_group_ctx</a></div><div class="ttdeci">resourcegroups::Resource_group_ctx * resource_group_ctx()</div><div class="ttdoc">Get resource group context. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3607</div></div>
<div class="ttc" id="classTHD_html_a18fe76ce7eafdfc3072f349f8e0993c1"><div class="ttname"><a href="classTHD.html#a18fe76ce7eafdfc3072f349f8e0993c1">THD::auto_inc_intervals_forced</a></div><div class="ttdeci">Discrete_intervals_list auto_inc_intervals_forced</div><div class="ttdef"><b>Definition:</b> sql_class.h:1933</div></div>
<div class="ttc" id="components_2services_2mysql__mutex_8h_html_a5c748d3c7862702885acb90576754a2c"><div class="ttname"><a href="components_2services_2mysql__mutex_8h.html#a5c748d3c7862702885acb90576754a2c">mysql_mutex_unlock</a></div><div class="ttdeci">#define mysql_mutex_unlock(M)</div><div class="ttdef"><b>Definition:</b> mysql_mutex.h:56</div></div>
<div class="ttc" id="classTHD_html_a07baac420f0da8360412ae766d318d69"><div class="ttname"><a href="classTHD.html#a07baac420f0da8360412ae766d318d69">THD::LOCK_thd_query</a></div><div class="ttdeci">mysql_mutex_t LOCK_thd_query</div><div class="ttdoc">Protects THD::m_query_string. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1049</div></div>
<div class="ttc" id="group__psi__abi__idle_html_ga625c939a19042bc1890a893123430e61"><div class="ttname"><a href="group__psi__abi__idle.html#ga625c939a19042bc1890a893123430e61">PSI_idle_locker</a></div><div class="ttdeci">struct PSI_idle_locker PSI_idle_locker</div><div class="ttdef"><b>Definition:</b> psi_idle_bits.h:40</div></div>
<div class="ttc" id="classTHD_html_abd20d43f3f290fbdcfe5628ca014b30a"><div class="ttname"><a href="classTHD.html#abd20d43f3f290fbdcfe5628ca014b30a">THD::table_map_for_update</a></div><div class="ttdeci">table_map table_map_for_update</div><div class="ttdef"><b>Definition:</b> sql_class.h:1858</div></div>
<div class="ttc" id="system__variables_8h_html_ac89cf8001a738e813ab027f75adc9f2b"><div class="ttname"><a href="system__variables_8h.html#ac89cf8001a738e813ab027f75adc9f2b">MODE_NO_ENGINE_SUBSTITUTION</a></div><div class="ttdeci">#define MODE_NO_ENGINE_SUBSTITUTION</div><div class="ttdef"><b>Definition:</b> system_variables.h:126</div></div>
<div class="ttc" id="classTHD_html_a6733b5ac8a0aceab948c6b4f4322c9af"><div class="ttname"><a href="classTHD.html#a6733b5ac8a0aceab948c6b4f4322c9af">THD::get_user_connect</a></div><div class="ttdeci">const USER_CONN * get_user_connect() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2103</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_a64d33e1562b53a7d6833330576dd2616"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#a64d33e1562b53a7d6833330576dd2616">THD::Transaction_state::m_server_status</a></div><div class="ttdeci">uint m_server_status</div><div class="ttdoc">Server status flags. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1699</div></div>
<div class="ttc" id="locked__tables__list_8h_html_a77fee489173235058762d07e721b7476a39151d40394488df6591f568bc8f7ece"><div class="ttname"><a href="locked__tables__list_8h.html#a77fee489173235058762d07e721b7476a39151d40394488df6591f568bc8f7ece">LTM_LOCK_TABLES</a></div><div class="ttdef"><b>Definition:</b> locked_tables_list.h:46</div></div>
<div class="ttc" id="structMEM__ROOT_html_a1762b39f7ab09bb12891f445d6bbcda2"><div class="ttname"><a href="structMEM__ROOT.html#a1762b39f7ab09bb12891f445d6bbcda2">MEM_ROOT::Alloc</a></div><div class="ttdeci">void * Alloc(size_t length)</div><div class="ttdoc">Allocate memory. </div><div class="ttdef"><b>Definition:</b> my_alloc.h:134</div></div>
<div class="ttc" id="classTHD_html_a76abf5318f8258b540891ddaf80fb86a"><div class="ttname"><a href="classTHD.html#a76abf5318f8258b540891ddaf80fb86a">THD::cost_model</a></div><div class="ttdeci">const Cost_model_server * cost_model() const</div><div class="ttdoc">Retrieve the optimizer cost model for this connection. </div><div class="ttdef"><b>Definition:</b> sql_class.h:4033</div></div>
<div class="ttc" id="classTHD_html_ae97e7460f8e8aa02c0ab93d1de3b1247"><div class="ttname"><a href="classTHD.html#ae97e7460f8e8aa02c0ab93d1de3b1247">THD::locked_tables_list</a></div><div class="ttdeci">Locked_tables_list locked_tables_list</div><div class="ttdef"><b>Definition:</b> sql_class.h:2534</div></div>
<div class="ttc" id="classProtocol__text_html"><div class="ttname"><a href="classProtocol__text.html">Protocol_text</a></div><div class="ttdoc">Class used for the old (MySQL 4.0 protocol). </div><div class="ttdef"><b>Definition:</b> protocol_classic.h:216</div></div>
<div class="ttc" id="classTHD_html_a417a79b17f99e2341ac8f3a8775d6992"><div class="ttname"><a href="classTHD.html#a417a79b17f99e2341ac8f3a8775d6992">THD::cleanup_done</a></div><div class="ttdeci">bool cleanup_done</div><div class="ttdef"><b>Definition:</b> sql_class.h:2586</div></div>
<div class="ttc" id="sql__class_8h_html_ac8425312a45cdb33ee7b064490f21b54"><div class="ttname"><a href="sql__class_8h.html#ac8425312a45cdb33ee7b064490f21b54">thd_set_psi</a></div><div class="ttdeci">void thd_set_psi(THD *thd, PSI_thread *psi)</div><div class="ttdoc">Set reference to Performance Schema object for THD object. </div><div class="ttdef"><b>Definition:</b> sql_thd_api.cc:127</div></div>
<div class="ttc" id="classTHD_html_aeb4ab32a3c6fbacb94d4ef9372b445c6"><div class="ttname"><a href="classTHD.html#aeb4ab32a3c6fbacb94d4ef9372b445c6">THD::is_commit_in_middle_of_statement</a></div><div class="ttdeci">bool is_commit_in_middle_of_statement</div><div class="ttdef"><b>Definition:</b> sql_class.h:3531</div></div>
<div class="ttc" id="components_2services_2mysql__mutex_8h_html_a340bf8f49d0cbaa994eaf5fb1fc7a22f"><div class="ttname"><a href="components_2services_2mysql__mutex_8h.html#a340bf8f49d0cbaa994eaf5fb1fc7a22f">mysql_mutex_lock</a></div><div class="ttdeci">#define mysql_mutex_lock(M)</div><div class="ttdef"><b>Definition:</b> mysql_mutex.h:49</div></div>
<div class="ttc" id="m__ctype_8h_html"><div class="ttname"><a href="m__ctype_8h.html">m_ctype.h</a></div><div class="ttdoc">A better implementation of the UNIX ctype(3) library. </div></div>
<div class="ttc" id="classTHD_html_a2e75626e242da066a9c4bcbfacf7263d"><div class="ttname"><a href="classTHD.html#a2e75626e242da066a9c4bcbfacf7263d">THD::insert_lock_default</a></div><div class="ttdeci">thr_lock_type insert_lock_default</div><div class="ttdoc">Type of lock to be used for INSERT statement if lock is not specified explicitly. ...</div><div class="ttdef"><b>Definition:</b> sql_class.h:1363</div></div>
<div class="ttc" id="classQuery__arena_html_ac346ad1bfff92bfacb74f312f57d744a"><div class="ttname"><a href="classQuery__arena.html#ac346ad1bfff92bfacb74f312f57d744a">Query_arena::alloc</a></div><div class="ttdeci">void * alloc(size_t size)</div><div class="ttdef"><b>Definition:</b> sql_class.h:300</div></div>
<div class="ttc" id="my__table__map_8h_html_a82b78abeba8cfb8e3df3e082f42b6cff"><div class="ttname"><a href="my__table__map_8h.html#a82b78abeba8cfb8e3df3e082f42b6cff">table_map</a></div><div class="ttdeci">uint64_t table_map</div><div class="ttdef"><b>Definition:</b> my_table_map.h:29</div></div>
<div class="ttc" id="classTHD_html_a98af9dcb3ae920e8365d49953baed28e"><div class="ttname"><a href="classTHD.html#a98af9dcb3ae920e8365d49953baed28e">THD::next_to_commit</a></div><div class="ttdeci">THD * next_to_commit</div><div class="ttdoc">Used by MYSQL_BIN_LOG to maintain the commit queue for binary log group commit. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2302</div></div>
<div class="ttc" id="classTHD_html_aac65dac79ad504434faf434fac2e638c"><div class="ttname"><a href="classTHD.html#aac65dac79ad504434faf434fac2e638c">THD::in_sub_stmt</a></div><div class="ttdeci">uint in_sub_stmt</div><div class="ttdef"><b>Definition:</b> sql_class.h:1366</div></div>
<div class="ttc" id="structbinary__log_1_1Uuid_html"><div class="ttname"><a href="structbinary__log_1_1Uuid.html">binary_log::Uuid</a></div><div class="ttdoc">This is a POD. </div><div class="ttdef"><b>Definition:</b> uuid.h:60</div></div>
<div class="ttc" id="namespacefile_html"><div class="ttname"><a href="namespacefile.html">file</a></div><div class="ttdef"><b>Definition:</b> os0file.h:85</div></div>
<div class="ttc" id="classTHD_html_aed48431daf356f5e62044248c424b76f"><div class="ttname"><a href="classTHD.html#aed48431daf356f5e62044248c424b76f">THD::current_linfo</a></div><div class="ttdeci">LOG_INFO * current_linfo</div><div class="ttdef"><b>Definition:</b> sql_class.h:2491</div></div>
<div class="ttc" id="classTHD_html_ae5a349f788655802500578e93c0b218d"><div class="ttname"><a href="classTHD.html#ae5a349f788655802500578e93c0b218d">THD::binlog_table_maps</a></div><div class="ttdeci">uint binlog_table_maps</div><div class="ttdef"><b>Definition:</b> sql_class.h:1607</div></div>
<div class="ttc" id="classTHD_html_a09acfa83c5541b5351122e0e79c468d2"><div class="ttname"><a href="classTHD.html#a09acfa83c5541b5351122e0e79c468d2">THD::m_transaction_state</a></div><div class="ttdeci">PSI_transaction_locker_state m_transaction_state</div><div class="ttdoc">Current transaction instrumentation state. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2165</div></div>
<div class="ttc" id="classTHD_html_a42c2486e95914d7934387bc0317076ea"><div class="ttname"><a href="classTHD.html#a42c2486e95914d7934387bc0317076ea">THD::m_sent_row_count</a></div><div class="ttdeci">ha_rows m_sent_row_count</div><div class="ttdoc">Number of rows we actually sent to the client, including &quot;synthetic&quot; rows in ROLLUP etc...</div><div class="ttdef"><b>Definition:</b> sql_class.h:2084</div></div>
<div class="ttc" id="classTHD_html_a42f0c6d131002e0e52470aec17fc0339"><div class="ttname"><a href="classTHD.html#a42f0c6d131002e0e52470aec17fc0339">THD::m_psi</a></div><div class="ttdeci">std::atomic&lt; PSI_thread * &gt; m_psi</div><div class="ttdoc">Performance schema thread instrumentation for this session. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3634</div></div>
<div class="ttc" id="classTHD_html_a307269c284bbbbbb0d319ed39c91782f"><div class="ttname"><a href="classTHD.html#a307269c284bbbbbb0d319ed39c91782f">THD::tx_isolation</a></div><div class="ttdeci">enum_tx_isolation tx_isolation</div><div class="ttdef"><b>Definition:</b> sql_class.h:2274</div></div>
<div class="ttc" id="transaction__info_8h_html"><div class="ttname"><a href="transaction__info_8h.html">transaction_info.h</a></div></div>
<div class="ttc" id="system__variables_8h_html_ad004a34722cec86fb70352d7386e8013"><div class="ttname"><a href="system__variables_8h.html#ad004a34722cec86fb70352d7386e8013">MODE_STRICT_ALL_TABLES</a></div><div class="ttdeci">#define MODE_STRICT_ALL_TABLES</div><div class="ttdef"><b>Definition:</b> system_variables.h:112</div></div>
<div class="ttc" id="classTHD_html_aab9c733d38c73363911a3d444c7023a3"><div class="ttname"><a href="classTHD.html#aab9c733d38c73363911a3d444c7023a3">THD::binlog_need_explicit_defaults_ts</a></div><div class="ttdeci">bool binlog_need_explicit_defaults_ts</div><div class="ttdoc">The member is served for marking a query that CREATEs or ALTERs a table declared with a TIMESTAMP col...</div><div class="ttdef"><b>Definition:</b> sql_class.h:2311</div></div>
<div class="ttc" id="classTHD_html_a5d23050388716b61772b6d92ab169efd"><div class="ttname"><a href="classTHD.html#a5d23050388716b61772b6d92ab169efd">THD::get_thd</a></div><div class="ttdeci">THD * get_thd() override</div><div class="ttdoc">Within MDL subsystem this one is only used for DEBUG_SYNC. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2711</div></div>
<div class="ttc" id="classTHD_html_a0b900818471bdf035f73ae1a94585c5b"><div class="ttname"><a href="classTHD.html#a0b900818471bdf035f73ae1a94585c5b">THD::clear_binlog_local_stmt_filter</a></div><div class="ttdeci">void clear_binlog_local_stmt_filter()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1546</div></div>
<div class="ttc" id="classTHD_html_a63fd9e4a122c7ca66e4a142546838e9b"><div class="ttname"><a href="classTHD.html#a63fd9e4a122c7ca66e4a142546838e9b">THD::set_current_stmt_binlog_format_row_if_mixed</a></div><div class="ttdeci">void set_current_stmt_binlog_format_row_if_mixed()</div><div class="ttdef"><b>Definition:</b> sql_class.h:3082</div></div>
<div class="ttc" id="string__type_8h_html"><div class="ttname"><a href="string__type_8h.html">string_type.h</a></div></div>
<div class="ttc" id="classTHD_html_a080358e9f81acc7851daf28249e66fab"><div class="ttname"><a href="classTHD.html#a080358e9f81acc7851daf28249e66fab">THD::m_statement_psi</a></div><div class="ttdeci">PSI_statement_locker * m_statement_psi</div><div class="ttdoc">Current statement instrumentation. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2155</div></div>
<div class="ttc" id="classPrealloced__array_html_a006de3e49114ae44f3899e1e464fb93e"><div class="ttname"><a href="classPrealloced__array.html#a006de3e49114ae44f3899e1e464fb93e">Prealloced_array::push_back</a></div><div class="ttdeci">bool push_back(const Element_type &amp;element)</div><div class="ttdoc">Copies an element into the back of the array. </div><div class="ttdef"><b>Definition:</b> prealloced_array.h:303</div></div>
<div class="ttc" id="classTHD_html_a86ea5ed5d26bc93bebd3eb13403965ec"><div class="ttname"><a href="classTHD.html#a86ea5ed5d26bc93bebd3eb13403965ec">THD::bool_value</a></div><div class="ttdeci">bool bool_value</div><div class="ttdef"><b>Definition:</b> sql_class.h:2494</div></div>
<div class="ttc" id="namespacedd_html"><div class="ttname"><a href="namespacedd.html">dd</a></div><div class="ttdoc">The version of the current data dictionary table definitions. </div><div class="ttdef"><b>Definition:</b> dictionary_client.h:40</div></div>
<div class="ttc" id="classOpen__tables__state_html_ae7f147f0ac9ab667b16b8e8d8ec8e42d"><div class="ttname"><a href="classOpen__tables__state.html#ae7f147f0ac9ab667b16b8e8d8ec8e42d">Open_tables_state::temporary_tables</a></div><div class="ttdeci">TABLE * temporary_tables</div><div class="ttdoc">List of temporary tables used by this thread. </div><div class="ttdef"><b>Definition:</b> sql_class.h:482</div></div>
<div class="ttc" id="classTHD_html_a1392e83d82ac8244b141f4444af3618d"><div class="ttname"><a href="classTHD.html#a1392e83d82ac8244b141f4444af3618d">THD::unlock_query_plan</a></div><div class="ttdeci">void unlock_query_plan()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1091</div></div>
<div class="ttc" id="classTHD_html_a83effea31814e8e258a817be7e290677"><div class="ttname"><a href="classTHD.html#a83effea31814e8e258a817be7e290677">THD::set_current_stmt_binlog_format_row</a></div><div class="ttdeci">void set_current_stmt_binlog_format_row()</div><div class="ttdef"><b>Definition:</b> sql_class.h:3106</div></div>
<div class="ttc" id="classTHD_html_aa4bc77c43005680d2bffde550b99aa23"><div class="ttname"><a href="classTHD.html#aa4bc77c43005680d2bffde550b99aa23">THD::main_lex</a></div><div class="ttdeci">std::unique_ptr&lt; LEX &gt; main_lex</div><div class="ttdoc">The lex to hold the parsed tree of conventional (non-prepared) queries. </div><div class="ttdef"><b>Definition:</b> sql_class.h:860</div></div>
<div class="ttc" id="classTHD_html_a95a15e2f06bddac703c87fafa474324b"><div class="ttname"><a href="classTHD.html#a95a15e2f06bddac703c87fafa474324b">THD::binlog_accessed_db_names</a></div><div class="ttdeci">List&lt; char &gt; * binlog_accessed_db_names</div><div class="ttdef"><b>Definition:</b> sql_class.h:1611</div></div>
<div class="ttc" id="group__MYSYS_html_gaa9cde2cb17c7b3008c8b06016c20194a"><div class="ttname"><a href="group__MYSYS.html#gaa9cde2cb17c7b3008c8b06016c20194a">strmake_root</a></div><div class="ttdeci">char * strmake_root(MEM_ROOT *root, const char *str, size_t len)</div><div class="ttdef"><b>Definition:</b> my_alloc.cc:259</div></div>
<div class="ttc" id="group__group__cs__shutdown__kill__constants_html_gga06133bb686f1030c73086378cab8d27bacc26796d601d054d19882287328ca780"><div class="ttname"><a href="group__group__cs__shutdown__kill__constants.html#gga06133bb686f1030c73086378cab8d27bacc26796d601d054d19882287328ca780">KILL_QUERY</a></div><div class="ttdoc">Query level of the KILL command. </div><div class="ttdef"><b>Definition:</b> mysql_com.h:971</div></div>
<div class="ttc" id="classTHD_html_a941fcac803fd6fc8f8e44d1584e0109c"><div class="ttname"><a href="classTHD.html#a941fcac803fd6fc8f8e44d1584e0109c">THD::is_attachable_transaction_active</a></div><div class="ttdeci">bool is_attachable_transaction_active() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3066</div></div>
<div class="ttc" id="classSql__condition_html_ab0602581e19cddb609bfe10c44be4e83"><div class="ttname"><a href="classSql__condition.html#ab0602581e19cddb609bfe10c44be4e83">Sql_condition::enum_severity_level</a></div><div class="ttdeci">enum_severity_level</div><div class="ttdoc">Enumeration value describing the severity of the condition. </div><div class="ttdef"><b>Definition:</b> sql_error.h:58</div></div>
<div class="ttc" id="classTHD_html_aa925a3479a17297908fc462a7ce305bd"><div class="ttname"><a href="classTHD.html#aa925a3479a17297908fc462a7ce305bd">THD::is_regular</a></div><div class="ttdeci">bool is_regular() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:822</div></div>
<div class="ttc" id="classTHD_html_ae69035c8d6414f480a6a1da4361f955f"><div class="ttname"><a href="classTHD.html#ae69035c8d6414f480a6a1da4361f955f">THD::binlog_invoker</a></div><div class="ttdeci">void binlog_invoker()</div><div class="ttdef"><b>Definition:</b> sql_class.h:3959</div></div>
<div class="ttc" id="classSub__statement__state_html_a2d5af94f344fed20f2c5f0d1b2140606"><div class="ttname"><a href="classSub__statement__state.html#a2d5af94f344fed20f2c5f0d1b2140606">Sub_statement_state::client_capabilities</a></div><div class="ttdeci">ulong client_capabilities</div><div class="ttdef"><b>Definition:</b> sql_class.h:624</div></div>
<div class="ttc" id="classTHD_html_a112d8a7987b227066823714538d74a3e"><div class="ttname"><a href="classTHD.html#a112d8a7987b227066823714538d74a3e">THD::is_a_srv_session</a></div><div class="ttdeci">bool is_a_srv_session() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:4157</div></div>
<div class="ttc" id="structMEM__ROOT_html"><div class="ttname"><a href="structMEM__ROOT.html">MEM_ROOT</a></div><div class="ttdoc">The MEM_ROOT is a simple arena, where allocations are carved out of larger blocks. </div><div class="ttdef"><b>Definition:</b> my_alloc.h:77</div></div>
<div class="ttc" id="classTHD_html_abfe23d3b671f93b0cf0a43a5aa39eeac"><div class="ttname"><a href="classTHD.html#abfe23d3b671f93b0cf0a43a5aa39eeac">THD::LOCK_thd_data</a></div><div class="ttdeci">mysql_mutex_t LOCK_thd_data</div><div class="ttdoc">Protects THD data accessed from other threads. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1043</div></div>
<div class="ttc" id="my__sqlcommand_8h_html"><div class="ttname"><a href="my__sqlcommand_8h.html">my_sqlcommand.h</a></div></div>
<div class="ttc" id="classTHD_html_ad41e300171a192db94fce0cb9f79d425"><div class="ttname"><a href="classTHD.html#ad41e300171a192db94fce0cb9f79d425">THD::time_zone</a></div><div class="ttdeci">Time_zone * time_zone()</div><div class="ttdef"><b>Definition:</b> sql_class.h:2761</div></div>
<div class="ttc" id="classTHD_html_a9a8643ad137c40e64e67ba38b7be6ba7"><div class="ttname"><a href="classTHD.html#a9a8643ad137c40e64e67ba38b7be6ba7">THD::user_var_events</a></div><div class="ttdeci">Prealloced_array&lt; Binlog_user_var_event *, 2 &gt; user_var_events</div><div class="ttdef"><b>Definition:</b> sql_class.h:2295</div></div>
<div class="ttc" id="classGlobal__read__lock_html_a8c34d4b48148521722d6b7451444dbab"><div class="ttname"><a href="classGlobal__read__lock.html#a8c34d4b48148521722d6b7451444dbab">Global_read_lock::is_acquired</a></div><div class="ttdeci">bool is_acquired() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:739</div></div>
<div class="ttc" id="classTHD_html_a52fe5e91658cebc3e820e204e411bf3b"><div class="ttname"><a href="classTHD.html#a52fe5e91658cebc3e820e204e411bf3b">THD::m_catalog</a></div><div class="ttdeci">LEX_CSTRING m_catalog</div><div class="ttdoc">Currently selected catalog. </div><div class="ttdef"><b>Definition:</b> sql_class.h:882</div></div>
<div class="ttc" id="classTHD_html_af67488547215fbfa878c19666e6fa242"><div class="ttname"><a href="classTHD.html#af67488547215fbfa878c19666e6fa242">THD::global_read_lock</a></div><div class="ttdeci">Global_read_lock global_read_lock</div><div class="ttdef"><b>Definition:</b> sql_class.h:1808</div></div>
<div class="ttc" id="structTABLE__LIST_html"><div class="ttname"><a href="structTABLE__LIST.html">TABLE_LIST</a></div><div class="ttdef"><b>Definition:</b> table.h:2540</div></div>
<div class="ttc" id="classProtocol__classic_html_a10fdce232a6ecc82034400107b443712"><div class="ttname"><a href="classProtocol__classic.html#a10fdce232a6ecc82034400107b443712">Protocol_classic::claim_memory_ownership</a></div><div class="ttdeci">void claim_memory_ownership(bool claim)</div><div class="ttdef"><b>Definition:</b> protocol_classic.cc:1363</div></div>
<div class="ttc" id="hp__test1_8cc_html_a6eec09a91807e20d7b3d6ef3da594067"><div class="ttname"><a href="hp__test1_8cc.html#a6eec09a91807e20d7b3d6ef3da594067">flags</a></div><div class="ttdeci">static int flags[50]</div><div class="ttdef"><b>Definition:</b> hp_test1.cc:39</div></div>
<div class="ttc" id="current__thd_8cc_html_a325e4fbea847aaf44935eb9784a607a4"><div class="ttname"><a href="current__thd_8cc.html#a325e4fbea847aaf44935eb9784a607a4">current_thd</a></div><div class="ttdeci">thread_local THD * current_thd</div><div class="ttdef"><b>Definition:</b> current_thd.cc:25</div></div>
<div class="ttc" id="group__MYSYS_html_gabcbcbc02c3972135cae6f04693507d85"><div class="ttname"><a href="group__MYSYS.html#gabcbcbc02c3972135cae6f04693507d85">dirname_length</a></div><div class="ttdeci">size_t dirname_length(const char *name)</div><div class="ttdoc">Get the string length of the directory part of name, including the last FN_LIBCHAR. </div><div class="ttdef"><b>Definition:</b> mf_dirname.cc:51</div></div>
<div class="ttc" id="session__tracker_8h_html"><div class="ttname"><a href="session__tracker_8h.html">session_tracker.h</a></div></div>
<div class="ttc" id="classTHD_html_a14a9d44f36d35decd324684c4ff78fc5"><div class="ttname"><a href="classTHD.html#a14a9d44f36d35decd324684c4ff78fc5">THD::get_trans_pos</a></div><div class="ttdeci">void get_trans_pos(const char **file_var, my_off_t *pos_var) const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2345</div></div>
<div class="ttc" id="locked__tables__list_8h_html_a77fee489173235058762d07e721b7476ae592a6b4882bb655fe510aafbbcf0c48"><div class="ttname"><a href="locked__tables__list_8h.html#a77fee489173235058762d07e721b7476ae592a6b4882bb655fe510aafbbcf0c48">LTM_NONE</a></div><div class="ttdef"><b>Definition:</b> locked_tables_list.h:45</div></div>
<div class="ttc" id="classTHD_html_a906df227b978f39c5acddf6d1458b559"><div class="ttname"><a href="classTHD.html#a906df227b978f39c5acddf6d1458b559">THD::m_parser_state</a></div><div class="ttdeci">Parser_state * m_parser_state</div><div class="ttdoc">Internal parser state. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2532</div></div>
<div class="ttc" id="classTHD_html_af0bf2465e33617b91b60ba9e6cde41be"><div class="ttname"><a href="classTHD.html#af0bf2465e33617b91b60ba9e6cde41be">THD::set_skip_readonly_check</a></div><div class="ttdeci">void set_skip_readonly_check()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1636</div></div>
<div class="ttc" id="classTHD_html_a9671e550bcaae88b814b8fddf100faa4"><div class="ttname"><a href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4">THD::binlog_filter_state</a></div><div class="ttdeci">binlog_filter_state</div><div class="ttdef"><b>Definition:</b> sql_class.h:1536</div></div>
<div class="ttc" id="classTHD_html_af5d1905438f291bca24b789a0253c15d"><div class="ttname"><a href="classTHD.html#af5d1905438f291bca24b789a0253c15d">THD::DEFAULT_WHERE</a></div><div class="ttdeci">static const char *const DEFAULT_WHERE</div><div class="ttdef"><b>Definition:</b> sql_class.h:975</div></div>
<div class="ttc" id="classTHD_html_a8510c1d76b680fa087c73c09402389f2"><div class="ttname"><a href="classTHD.html#a8510c1d76b680fa087c73c09402389f2">THD::server_status</a></div><div class="ttdeci">uint server_status</div><div class="ttdef"><b>Definition:</b> sql_class.h:2213</div></div>
<div class="ttc" id="classthd__scheduler_html_a82d870430f2bc6a6a372009336995a81"><div class="ttname"><a href="classthd__scheduler.html#a82d870430f2bc6a6a372009336995a81">thd_scheduler::thd_scheduler</a></div><div class="ttdeci">thd_scheduler()</div><div class="ttdef"><b>Definition:</b> sql_class.h:199</div></div>
<div class="ttc" id="classTHD_html_a2967d1c32ec25ed3055eb941717196da"><div class="ttname"><a href="classTHD.html#a2967d1c32ec25ed3055eb941717196da">THD::set_invoker</a></div><div class="ttdeci">void set_invoker(const LEX_STRING *user, const LEX_STRING *host)</div><div class="ttdef"><b>Definition:</b> sql_class.h:3962</div></div>
<div class="ttc" id="sql__class_8h_html_a72c83217b7613b5afda5d424fe70d56eaa11a38b780db1a59973d7f3a270ce2aa"><div class="ttname"><a href="sql__class_8h.html#a72c83217b7613b5afda5d424fe70d56eaa11a38b780db1a59973d7f3a270ce2aa">Secondary_engine_optimization::PRIMARY_ONLY</a></div><div class="ttdoc">The current statement should only use tables from primary storage engines. </div></div>
<div class="ttc" id="structMYSQL__LOCK_html"><div class="ttname"><a href="structMYSQL__LOCK.html">MYSQL_LOCK</a></div><div class="ttdef"><b>Definition:</b> lock.h:38</div></div>
<div class="ttc" id="classTHD_html_a5478e43509784ed9c9fd8d288c5ada1f"><div class="ttname"><a href="classTHD.html#a5478e43509784ed9c9fd8d288c5ada1f">THD::set_admin_connection</a></div><div class="ttdeci">void set_admin_connection(bool admin)</div><div class="ttdef"><b>Definition:</b> sql_class.h:1339</div></div>
<div class="ttc" id="classTHD_html_ad74dd2ff7880807d0fc97364aa35b870"><div class="ttname"><a href="classTHD.html#ad74dd2ff7880807d0fc97364aa35b870">THD::unioned_events</a></div><div class="ttdeci">bool unioned_events</div><div class="ttdef"><b>Definition:</b> sql_class.h:2512</div></div>
<div class="ttc" id="classTHD_html_a1b47cf643618ce7e5c4947d95cd556ca"><div class="ttname"><a href="classTHD.html#a1b47cf643618ce7e5c4947d95cd556ca">THD::get_gtid_next_list_const</a></div><div class="ttdeci">const Gtid_set * get_gtid_next_list_const() const</div><div class="ttdoc">Return the value of @gtid_next_list: either a Gtid_set or NULL. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3144</div></div>
<div class="ttc" id="structTHD_1_1Transaction__state_html_a5be46bfecab41065dd08fb6f516183dd"><div class="ttname"><a href="structTHD_1_1Transaction__state.html#a5be46bfecab41065dd08fb6f516183dd">THD::Transaction_state::m_ha_data</a></div><div class="ttdeci">Prealloced_array&lt; Ha_data, PREALLOC_NUM_HA &gt; m_ha_data</div><div class="ttdoc">Ha_data array. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1684</div></div>
<div class="ttc" id="opt__trace__context_8h_html"><div class="ttname"><a href="opt__trace__context_8h.html">opt_trace_context.h</a></div><div class="ttdoc">This contains the declaration of class Opt_trace_context, which is needed to declare THD...</div></div>
<div class="ttc" id="classTHD_html_ab24e1cfc4d4c1b560238f62d1b582236"><div class="ttname"><a href="classTHD.html#ab24e1cfc4d4c1b560238f62d1b582236">THD::check_for_truncated_fields</a></div><div class="ttdeci">enum_check_fields check_for_truncated_fields</div><div class="ttdef"><b>Definition:</b> sql_class.h:2292</div></div>
<div class="ttc" id="classTHD_html_a7778162d67f41c9593424726538b3f72"><div class="ttname"><a href="classTHD.html#a7778162d67f41c9593424726538b3f72">THD::binlog_flush_pending_rows_event</a></div><div class="ttdeci">int binlog_flush_pending_rows_event(bool stmt_end)</div><div class="ttdef"><b>Definition:</b> sql_class.h:1459</div></div>
<div class="ttc" id="classQuery__arena_html_ac04e25b87dac73f6e2683d67ba271a01"><div class="ttname"><a href="classQuery__arena.html#ac04e25b87dac73f6e2683d67ba271a01">Query_arena::Query_arena</a></div><div class="ttdeci">Query_arena()</div><div class="ttdef"><b>Definition:</b> sql_class.h:278</div></div>
<div class="ttc" id="classTHD_html_a1197110cf6918c978e7b31581f6166bc"><div class="ttname"><a href="classTHD.html#a1197110cf6918c978e7b31581f6166bc">THD::set_catalog</a></div><div class="ttdeci">void set_catalog(const LEX_CSTRING &amp;catalog)</div><div class="ttdef"><b>Definition:</b> sql_class.h:1269</div></div>
<div class="ttc" id="structSystem__status__var_html"><div class="ttname"><a href="structSystem__status__var.html">System_status_var</a></div><div class="ttdoc">Per thread status variables. </div><div class="ttdef"><b>Definition:</b> system_variables.h:429</div></div>
<div class="ttc" id="classGlobal__read__lock_html"><div class="ttname"><a href="classGlobal__read__lock.html">Global_read_lock</a></div><div class="ttdoc">An instance of the global read lock in a connection. </div><div class="ttdef"><b>Definition:</b> sql_class.h:705</div></div>
<div class="ttc" id="classTHD_html_a8e1cec2bf1439b840ae7547805c53a22"><div class="ttname"><a href="classTHD.html#a8e1cec2bf1439b840ae7547805c53a22">THD::want_privilege</a></div><div class="ttdeci">ulong want_privilege</div><div class="ttdoc">Used by Item::check_column_privileges() to tell which privileges to check for. </div><div class="ttdef"><b>Definition:</b> sql_class.h:851</div></div>
<div class="ttc" id="thread__type_8h_html_adade01b1d73317cd10a128e7843f240ba65fce7bbaee140f7979c86de907a4927"><div class="ttname"><a href="thread__type_8h.html#adade01b1d73317cd10a128e7843f240ba65fce7bbaee140f7979c86de907a4927">SYSTEM_THREAD_SLAVE_WORKER</a></div><div class="ttdef"><b>Definition:</b> thread_type.h:41</div></div>
<div class="ttc" id="classTHD_html_ae3ded25e710e145f8ce3ece524a07e31"><div class="ttname"><a href="classTHD.html#ae3ded25e710e145f8ce3ece524a07e31">THD::ulonglong_value</a></div><div class="ttdeci">ulonglong ulonglong_value</div><div class="ttdef"><b>Definition:</b> sql_class.h:2497</div></div>
<div class="ttc" id="classSub__statement__state_html_a7c02ea0eec10dd2578eeee32458c4175"><div class="ttname"><a href="classSub__statement__state.html#a7c02ea0eec10dd2578eeee32458c4175">Sub_statement_state::auto_inc_intervals_forced</a></div><div class="ttdeci">Discrete_intervals_list auto_inc_intervals_forced</div><div class="ttdef"><b>Definition:</b> sql_class.h:620</div></div>
<div class="ttc" id="classTHD_html_a9671e550bcaae88b814b8fddf100faa4a7da8c1a8d0dec904be4f12f34cd7877f"><div class="ttname"><a href="classTHD.html#a9671e550bcaae88b814b8fddf100faa4a7da8c1a8d0dec904be4f12f34cd7877f">THD::BINLOG_FILTER_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> sql_class.h:1537</div></div>
<div class="ttc" id="classDiscrete__intervals__list_html"><div class="ttname"><a href="classDiscrete__intervals__list.html">Discrete_intervals_list</a></div><div class="ttdoc">List of Discrete_interval objects. </div><div class="ttdef"><b>Definition:</b> discrete_interval.h:86</div></div>
<div class="ttc" id="classTHD_html_a243f64d93ef80540453157679ec48abd"><div class="ttname"><a href="classTHD.html#a243f64d93ef80540453157679ec48abd">THD::owned_sid</a></div><div class="ttdeci">rpl_sid owned_sid</div><div class="ttdoc">For convenience, this contains the SID component of the GTID stored in owned_gtid. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3405</div></div>
<div class="ttc" id="classTHD_html_a8f64f234afe77623840e171722df19d4"><div class="ttname"><a href="classTHD.html#a8f64f234afe77623840e171722df19d4">THD::set_binlog_local_stmt_filter</a></div><div class="ttdeci">void set_binlog_local_stmt_filter()</div><div class="ttdef"><b>Definition:</b> sql_class.h:1551</div></div>
<div class="ttc" id="classTHD_html_abe809757af06d33d391f553d930ec663"><div class="ttname"><a href="classTHD.html#abe809757af06d33d391f553d930ec663">THD::update_previous_found_rows</a></div><div class="ttdeci">void update_previous_found_rows()</div><div class="ttdef"><b>Definition:</b> sql_class.h:2791</div></div>
<div class="ttc" id="classOpen__tables__state_html_a4e89b13dfb91c0b4d5bf33965c2eb704"><div class="ttname"><a href="classOpen__tables__state.html#a4e89b13dfb91c0b4d5bf33965c2eb704">Open_tables_state::open_tables</a></div><div class="ttdeci">TABLE * open_tables</div><div class="ttdoc">List of regular tables in use by this thread. </div><div class="ttdef"><b>Definition:</b> sql_class.h:476</div></div>
<div class="ttc" id="mysql__com__server_8h_html"><div class="ttname"><a href="mysql__com__server_8h.html">mysql_com_server.h</a></div><div class="ttdoc">Definitions private to the server, used in the networking layer to notify specific events...</div></div>
<div class="ttc" id="my__inttypes_8h_html_a718b4eb2652c286f4d42dc18a8e71a1a"><div class="ttname"><a href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a></div><div class="ttdeci">unsigned long ulong</div><div class="ttdef"><b>Definition:</b> my_inttypes.h:48</div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html_aa3c37e23c685aef2ce233f9f8e4d69e3"><div class="ttname"><a href="classTHD_1_1Query__plan.html#aa3c37e23c685aef2ce233f9f8e4d69e3">THD::Query_plan::get_command</a></div><div class="ttdeci">enum_sql_command get_command() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1246</div></div>
<div class="ttc" id="classTHD_html_a946efa2cae945b26d8f3fa4588a49825"><div class="ttname"><a href="classTHD.html#a946efa2cae945b26d8f3fa4588a49825">THD::set_log_reset</a></div><div class="ttdeci">void set_log_reset()</div><div class="ttdoc">Set when binlog reset operation is started. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3443</div></div>
<div class="ttc" id="group__psi__abi__thread_html_ga2b98ed163438e5b60ff305f2bb143420"><div class="ttname"><a href="group__psi__abi__thread.html#ga2b98ed163438e5b60ff305f2bb143420">PSI_thread</a></div><div class="ttdeci">struct PSI_thread PSI_thread</div><div class="ttdef"><b>Definition:</b> psi_thread_bits.h:71</div></div>
<div class="ttc" id="sql_2handler_8h_html_a9eca5571cb03b2bea1246c948d9244fb"><div class="ttname"><a href="sql_2handler_8h.html#a9eca5571cb03b2bea1246c948d9244fb">enum_tx_isolation</a></div><div class="ttdeci">enum_tx_isolation</div><div class="ttdef"><b>Definition:</b> handler.h:2647</div></div>
<div class="ttc" id="config__static_8h_html_a65e9886d74aaee76545e83dd09011727"><div class="ttname"><a href="config__static_8h.html#a65e9886d74aaee76545e83dd09011727">false</a></div><div class="ttdeci">#define false</div><div class="ttdef"><b>Definition:</b> config_static.h:43</div></div>
<div class="ttc" id="structBinlog__user__var__event_html"><div class="ttname"><a href="structBinlog__user__var__event.html">Binlog_user_var_event</a></div><div class="ttdef"><b>Definition:</b> binlog.h:87</div></div>
<div class="ttc" id="namespacegis_html_a1e3bf735dbe640151561b282f0f4dba5"><div class="ttname"><a href="namespacegis.html#a1e3bf735dbe640151561b282f0f4dba5">gis::length</a></div><div class="ttdeci">bool length(const dd::Spatial_reference_system *srs, const Geometry *g1, double *length, bool *null) noexcept</div><div class="ttdoc">Computes the length of linestrings and multilinestrings. </div><div class="ttdef"><b>Definition:</b> length.cc:75</div></div>
<div class="ttc" id="structstatement_html"><div class="ttname"><a href="structstatement.html">statement</a></div><div class="ttdef"><b>Definition:</b> mysqlslap.cc:212</div></div>
<div class="ttc" id="unionU_html"><div class="ttname"><a href="unionU.html">U</a></div><div class="ttdef"><b>Definition:</b> dtoa.cc:601</div></div>
<div class="ttc" id="classTHD_html_abe2eb9fbdca2b08427543ca967060c50"><div class="ttname"><a href="classTHD.html#abe2eb9fbdca2b08427543ca967060c50">THD::ulong_value</a></div><div class="ttdeci">ulong ulong_value</div><div class="ttdef"><b>Definition:</b> sql_class.h:2496</div></div>
<div class="ttc" id="classTHD_html_a3559e1ca5768b59d02e522e4b2de2d5b"><div class="ttname"><a href="classTHD.html#a3559e1ca5768b59d02e522e4b2de2d5b">THD::m_current_stage_key</a></div><div class="ttdeci">unsigned int m_current_stage_key</div><div class="ttdef"><b>Definition:</b> sql_class.h:1272</div></div>
<div class="ttc" id="classOpen__tables__state_html_a043bd361333c7c44f57dcab18c17061a"><div class="ttname"><a href="classOpen__tables__state.html#a043bd361333c7c44f57dcab18c17061a">Open_tables_state::lock</a></div><div class="ttdeci">MYSQL_LOCK * lock</div><div class="ttdef"><b>Definition:</b> sql_class.h:497</div></div>
<div class="ttc" id="classCost__model__server_html"><div class="ttname"><a href="classCost__model__server.html">Cost_model_server</a></div><div class="ttdoc">API for getting cost estimates for server operations that are not directly related to a table object...</div><div class="ttdef"><b>Definition:</b> opt_costmodel.h:41</div></div>
<div class="ttc" id="classTHD_html_a47d4763fe18ce036fb8818b119f33172"><div class="ttname"><a href="classTHD.html#a47d4763fe18ce036fb8818b119f33172">THD::rewritten_query</a></div><div class="ttdeci">const String &amp; rewritten_query() const</div><div class="ttdoc">Get the rewritten query (with passwords obfuscated etc.) from the THD. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3832</div></div>
<div class="ttc" id="classTHD_html_a3baa9d83db0a55395cf59e4fa5ffdb47"><div class="ttname"><a href="classTHD.html#a3baa9d83db0a55395cf59e4fa5ffdb47">THD::reset_gtid_persisted_by_se</a></div><div class="ttdeci">void reset_gtid_persisted_by_se()</div><div class="ttdoc">Reset by SE at transaction end after persisting GTID. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3455</div></div>
<div class="ttc" id="structNET_html"><div class="ttname"><a href="structNET.html">NET</a></div><div class="ttdef"><b>Definition:</b> mysql_com.h:867</div></div>
<div class="ttc" id="classTHD_html_a0f4215af86cc9ad1bc0fbbd6aaa72aa8"><div class="ttname"><a href="classTHD.html#a0f4215af86cc9ad1bc0fbbd6aaa72aa8">THD::binlog_next_event_pos</a></div><div class="ttdeci">rpl_event_coordinates binlog_next_event_pos</div><div class="ttdef"><b>Definition:</b> sql_class.h:1422</div></div>
<div class="ttc" id="group__Runtime__Environment_html_gaf3ca455b4e3e525a662ef572d60f9290"><div class="ttname"><a href="group__Runtime__Environment.html#gaf3ca455b4e3e525a662ef572d60f9290">free_items</a></div><div class="ttdeci">void free_items(Item *item)</div><div class="ttdef"><b>Definition:</b> sql_parse.cc:1154</div></div>
<div class="ttc" id="sql__class_8h_html_ab1b767dc054df6f88b991bb7fb140df6"><div class="ttname"><a href="sql__class_8h.html#ab1b767dc054df6f88b991bb7fb140df6">thd_get_psi</a></div><div class="ttdeci">PSI_thread * thd_get_psi(THD *thd)</div><div class="ttdoc">Get reference to Performance Schema object for THD object. </div><div class="ttdef"><b>Definition:</b> sql_thd_api.cc:106</div></div>
<div class="ttc" id="my__base_8h_html_a8e16914016eb2acc5eefdbbcad5d9eb5"><div class="ttname"><a href="my__base_8h.html#a8e16914016eb2acc5eefdbbcad5d9eb5">ha_rows</a></div><div class="ttdeci">my_off_t ha_rows</div><div class="ttdef"><b>Definition:</b> my_base.h:1136</div></div>
<div class="ttc" id="classTHD_html_ad9748d74b75b90a1be5195cfbcb7fc51"><div class="ttname"><a href="classTHD.html#ad9748d74b75b90a1be5195cfbcb7fc51">THD::charset</a></div><div class="ttdeci">const CHARSET_INFO * charset() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2987</div></div>
<div class="ttc" id="classTHD_html_aefa31e20d51632b18162108e6a7c9ddf"><div class="ttname"><a href="classTHD.html#aefa31e20d51632b18162108e6a7c9ddf">THD::m_idle_state</a></div><div class="ttdeci">PSI_idle_locker_state m_idle_state</div><div class="ttdoc">Idle instrumentation state. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2172</div></div>
<div class="ttc" id="sql__digest__stream_8h_html"><div class="ttname"><a href="sql__digest__stream_8h.html">sql_digest_stream.h</a></div></div>
<div class="ttc" id="namespacedd__cache__unittest_html_a764c739a313dbbad860dde98a463a4f3"><div class="ttname"><a href="namespacedd__cache__unittest.html#a764c739a313dbbad860dde98a463a4f3">dd_cache_unittest::insert</a></div><div class="ttdeci">void insert(dd::cache::SPI_lru_cache_owner_ptr &amp;c, dd::Object_id id)</div><div class="ttdef"><b>Definition:</b> dictionary_client.cc:3186</div></div>
<div class="ttc" id="classReprepare__observer_html"><div class="ttname"><a href="classReprepare__observer.html">Reprepare_observer</a></div><div class="ttdoc">An interface that is used to take an action when the locking module notices that a table version has ...</div><div class="ttdef"><b>Definition:</b> sql_prepare.h:79</div></div>
<div class="ttc" id="classTHD_html_a23f1f9abc2c8558fb84e9f2f01572111"><div class="ttname"><a href="classTHD.html#a23f1f9abc2c8558fb84e9f2f01572111">THD::m_is_fatal_error</a></div><div class="ttdeci">bool m_is_fatal_error</div><div class="ttdoc">Set to true if execution of the current compound statement can not continue. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2432</div></div>
<div class="ttc" id="classTHD_html_acb1cc6e175db738ea3d29e2a2a222447"><div class="ttname"><a href="classTHD.html#acb1cc6e175db738ea3d29e2a2a222447">THD::get_proc_info</a></div><div class="ttdeci">const char * get_proc_info() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1279</div></div>
<div class="ttc" id="sql__security__ctx_8h_html"><div class="ttname"><a href="sql__security__ctx_8h.html">sql_security_ctx.h</a></div></div>
<div class="ttc" id="classTHD_html_a96fe0e9626d34012250088f2cb021f00"><div class="ttname"><a href="classTHD.html#a96fe0e9626d34012250088f2cb021f00">THD::is_init_file_system_thread</a></div><div class="ttdeci">bool is_init_file_system_thread() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2233</div></div>
<div class="ttc" id="classTHD_html_a5f975240beaa300ea8df45d13fd8b5da"><div class="ttname"><a href="classTHD.html#a5f975240beaa300ea8df45d13fd8b5da">THD::fill_information_schema_tables</a></div><div class="ttdeci">bool fill_information_schema_tables() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:2859</div></div>
<div class="ttc" id="classTHD_html_a50a475b6f4adf6739ea32108d0f41575"><div class="ttname"><a href="classTHD.html#a50a475b6f4adf6739ea32108d0f41575">THD::utime_after_lock</a></div><div class="ttdeci">ulonglong utime_after_lock</div><div class="ttdef"><b>Definition:</b> sql_class.h:1349</div></div>
<div class="ttc" id="sql__class_8h_html_a992081146e42306b19cfed116c03d71d"><div class="ttname"><a href="sql__class_8h.html#a992081146e42306b19cfed116c03d71d">thd_enter_cond</a></div><div class="ttdeci">void thd_enter_cond(void *opaque_thd, mysql_cond_t *cond, mysql_mutex_t *mutex, const PSI_stage_info *stage, PSI_stage_info *old_stage, const char *src_function, const char *src_file, int src_line)</div><div class="ttdoc">Set thread entering a condition. </div><div class="ttdef"><b>Definition:</b> sql_thd_internal_api.cc:131</div></div>
<div class="ttc" id="classTHD_html_a82b245d235b2cf892ad20143b0991b9e"><div class="ttname"><a href="classTHD.html#a82b245d235b2cf892ad20143b0991b9e">THD::is_operating_gtid_table_implicitly</a></div><div class="ttdeci">bool is_operating_gtid_table_implicitly</div><div class="ttdef"><b>Definition:</b> sql_class.h:2019</div></div>
<div class="ttc" id="classTHD_html_a26b476d12e88c240b6115dcb10961f45"><div class="ttname"><a href="classTHD.html#a26b476d12e88c240b6115dcb10961f45">THD::first_successful_insert_id_in_prev_stmt</a></div><div class="ttdeci">ulonglong first_successful_insert_id_in_prev_stmt</div><div class="ttdef"><b>Definition:</b> sql_class.h:1874</div></div>
<div class="ttc" id="my__alloc_8h_html"><div class="ttname"><a href="my__alloc_8h.html">my_alloc.h</a></div><div class="ttdoc">This file follows Google coding style, except for the name MEM_ROOT (which is kept for historical rea...</div></div>
<div class="ttc" id="classdd_1_1DD__kill__immunizer_html"><div class="ttname"><a href="classdd_1_1DD__kill__immunizer.html">dd::DD_kill_immunizer</a></div><div class="ttdoc">RAII class for immunizing the THD from kill operations. </div><div class="ttdef"><b>Definition:</b> dd_kill_immunizer.h:45</div></div>
<div class="ttc" id="classTHD_html_a26f0a6e5db9eb66cfddc6b416f62e171"><div class="ttname"><a href="classTHD.html#a26f0a6e5db9eb66cfddc6b416f62e171">THD::main_da</a></div><div class="ttdeci">Diagnostics_area main_da</div><div class="ttdef"><b>Definition:</b> sql_class.h:3987</div></div>
<div class="ttc" id="classTHD_html"><div class="ttname"><a href="classTHD.html">THD</a></div><div class="ttdoc">For each client connection we create a separate thread with THD serving as a thread/connection descri...</div><div class="ttdef"><b>Definition:</b> sql_class.h:803</div></div>
<div class="ttc" id="dialog_8cc_html_ae7bd12bd7c9e418a420087971d0a7e31"><div class="ttname"><a href="dialog_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a></div><div class="ttdeci">Dialog Client Authentication nullptr</div><div class="ttdef"><b>Definition:</b> dialog.cc:353</div></div>
<div class="ttc" id="classSession__tracker_html"><div class="ttname"><a href="classSession__tracker.html">Session_tracker</a></div><div class="ttdoc">Session_tracker This class holds an object each for all tracker classes and provides methods necessar...</div><div class="ttdef"><b>Definition:</b> session_tracker.h:119</div></div>
<div class="ttc" id="namespacedblwr_1_1recv_html_a4d87e29e585a1f0ddb67f6f0b3b2d0ea"><div class="ttname"><a href="namespacedblwr_1_1recv.html#a4d87e29e585a1f0ddb67f6f0b3b2d0ea">dblwr::recv::find</a></div><div class="ttdeci">const byte * find(const Pages *pages, const page_id_t &amp;page_id) noexcept</div><div class="ttdoc">Find a doublewrite copy of a page. </div><div class="ttdef"><b>Definition:</b> buf0dblwr.cc:2222</div></div>
<div class="ttc" id="classTHD_html_a28e51949e4e855dfa954c7c57903b54b"><div class="ttname"><a href="classTHD.html#a28e51949e4e855dfa954c7c57903b54b">THD::audit_class_mask</a></div><div class="ttdeci">Prealloced_array&lt; unsigned long, 11 &gt; audit_class_mask</div><div class="ttdoc">Array of bits indicating which audit classes have already been added to the list of audit plugins whi...</div><div class="ttdef"><b>Definition:</b> sql_class.h:2548</div></div>
<div class="ttc" id="classTHD_html_a774cee2b08db68e391dc0ac83c976f0e"><div class="ttname"><a href="classTHD.html#a774cee2b08db68e391dc0ac83c976f0e">THD::previous_found_rows</a></div><div class="ttdeci">ulonglong previous_found_rows</div><div class="ttdoc">Stores the result of the FOUND_ROWS() function. </div><div class="ttdef"><b>Definition:</b> sql_class.h:2005</div></div>
<div class="ttc" id="classTHD_html_a3fa3f267d7ce6e0af0504fc0b17345db"><div class="ttname"><a href="classTHD.html#a3fa3f267d7ce6e0af0504fc0b17345db">THD::rli_slave</a></div><div class="ttdeci">Relay_log_info * rli_slave</div><div class="ttdef"><b>Definition:</b> sql_class.h:932</div></div>
<div class="ttc" id="classTHD_html_a4c93c37902bc696c3aa2046e26e00d8b"><div class="ttname"><a href="classTHD.html#a4c93c37902bc696c3aa2046e26e00d8b">THD::clear_active_vio</a></div><div class="ttdeci">void clear_active_vio()</div><div class="ttdef"><b>Definition:</b> sql_class.h:2619</div></div>
<div class="ttc" id="classTHD_html_a0c32070602a983dc5effd97fc6ec7dbd"><div class="ttname"><a href="classTHD.html#a0c32070602a983dc5effd97fc6ec7dbd">THD::initial_status_var</a></div><div class="ttdeci">struct System_status_var * initial_status_var</div><div class="ttdef"><b>Definition:</b> sql_class.h:991</div></div>
<div class="ttc" id="classTHD_html_adb224252d8f140238876bd4c4de594ba"><div class="ttname"><a href="classTHD.html#adb224252d8f140238876bd4c4de594ba">THD::rli_fake</a></div><div class="ttdeci">Relay_log_info * rli_fake</div><div class="ttdef"><b>Definition:</b> sql_class.h:930</div></div>
<div class="ttc" id="classsp__rcontext_html"><div class="ttname"><a href="classsp__rcontext.html">sp_rcontext</a></div><div class="ttdef"><b>Definition:</b> sp_rcontext.h:76</div></div>
<div class="ttc" id="classTHD_html_ac93312f3ed4c070c7e32af2d176ba947"><div class="ttname"><a href="classTHD.html#ac93312f3ed4c070c7e32af2d176ba947">THD::m_se_gtid_flags</a></div><div class="ttdeci">Se_GTID_flagset m_se_gtid_flags</div><div class="ttdoc">Flags for SE GTID persistence. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3424</div></div>
<div class="ttc" id="my__sqlcommand_8h_html_a46bba265a20f1784df6b9802aec4122aa80dbd5557446de815aaf1ee96602b232"><div class="ttname"><a href="my__sqlcommand_8h.html#a46bba265a20f1784df6b9802aec4122aa80dbd5557446de815aaf1ee96602b232">SQLCOM_END</a></div><div class="ttdef"><b>Definition:</b> my_sqlcommand.h:206</div></div>
<div class="ttc" id="classTHD_html_a3989c5c7c9961b4e950b5919a0823d2a"><div class="ttname"><a href="classTHD.html#a3989c5c7c9961b4e950b5919a0823d2a">THD::copy_db_to</a></div><div class="ttdeci">bool copy_db_to(char **p_db, size_t *p_db_length) const</div><div class="ttdef"><b>Definition:</b> sql_class.h:3595</div></div>
<div class="ttc" id="structTHR__LOCK__INFO_html"><div class="ttname"><a href="structTHR__LOCK__INFO.html">THR_LOCK_INFO</a></div><div class="ttdef"><b>Definition:</b> thr_lock.h:118</div></div>
<div class="ttc" id="structMDL__key_html"><div class="ttname"><a href="structMDL__key.html">MDL_key</a></div><div class="ttdoc">Metadata lock object key. </div><div class="ttdef"><b>Definition:</b> mdl.h:350</div></div>
<div class="ttc" id="classTHD_html_ac8a4198ecd3940d4888af6a6cc44479e"><div class="ttname"><a href="classTHD.html#ac8a4198ecd3940d4888af6a6cc44479e">THD::reset_db</a></div><div class="ttdeci">void reset_db(const LEX_CSTRING &amp;new_db)</div><div class="ttdoc">Set the current database; use shallow copy of C-string. </div><div class="ttdef"><b>Definition:</b> sql_class.h:3573</div></div>
<div class="ttc" id="classTHD_1_1Query__plan_html_a8a7b1abb6ae755b06eb3df0d7929fc68"><div class="ttname"><a href="classTHD_1_1Query__plan.html#a8a7b1abb6ae755b06eb3df0d7929fc68">THD::Query_plan::is_ps</a></div><div class="ttdeci">bool is_ps</div><div class="ttdoc">True if query is run in prepared statement. </div><div class="ttdef"><b>Definition:</b> sql_class.h:1213</div></div>
<div class="ttc" id="classTHD_html_a3f35983a2342c6d2c336a1a444d83954"><div class="ttname"><a href="classTHD.html#a3f35983a2342c6d2c336a1a444d83954">THD::get_binlog_accessed_db_names</a></div><div class="ttdeci">List&lt; char &gt; * get_binlog_accessed_db_names() const</div><div class="ttdef"><b>Definition:</b> sql_class.h:1652</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5bd71961b401a432086d0fb290a87f3f.html">sql</a></li><li class="navelem"><a class="el" href="sql__class_8h.html">sql_class.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
