<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: sql/server_component/log_builtins_filter.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('log__builtins__filter_8cc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">log_builtins_filter.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;mysqld_error.h&gt;</code><br />
<code>#include &quot;<a class="el" href="log__builtins__filter__imp_8h_source.html">log_builtins_filter_imp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="log__builtins__imp_8h_source.html">log_builtins_imp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__atomic_8h_source.html">my_atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__systime_8h_source.html">my_systime.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mysys__err_8h_source.html">mysys_err.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="derror_8h_source.html">sql/derror.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="log_8h_source.html">sql/log.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mysqld_8h_source.html">sql/mysqld.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0656fa9baf7aa9f50fed1b7c1ac5b1aa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a0656fa9baf7aa9f50fed1b7c1ac5b1aa">THROTTLE_DEFAULT_WINDOW_SIZE_IN_SECONDS</a>&#160;&#160;&#160;60</td></tr>
<tr class="memdesc:a0656fa9baf7aa9f50fed1b7c1ac5b1aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">services: log filter: basic filtering  <a href="#a0656fa9baf7aa9f50fed1b7c1ac5b1aa">More...</a><br /></td></tr>
<tr class="separator:a0656fa9baf7aa9f50fed1b7c1ac5b1aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7254a7a14f6f0ab938a4a7b4a35acad9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a7254a7a14f6f0ab938a4a7b4a35acad9">THROTTLE_MICROSECOND_MULTIPLIER</a>&#160;&#160;&#160;1000000</td></tr>
<tr class="separator:a7254a7a14f6f0ab938a4a7b4a35acad9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a35a6609933af217bbee296817c81c60a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a35a6609933af217bbee296817c81c60a">log_filter_ruleset_full</a> (<a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *rs)</td></tr>
<tr class="memdesc:a35a6609933af217bbee296817c81c60a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predicate: can we add any more rules?  <a href="#a35a6609933af217bbee296817c81c60a">More...</a><br /></td></tr>
<tr class="separator:a35a6609933af217bbee296817c81c60a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d1267177c83d5b0ab6bb120eaab0e8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="log__builtins__filter_8h.html#aa435e0263f68ab4ef5064aaff6e53654">log_filter_rule</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a55d1267177c83d5b0ab6bb120eaab0e8">log_builtins_filter_rule_init</a> (<a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *ruleset)</td></tr>
<tr class="memdesc:a55d1267177c83d5b0ab6bb120eaab0e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a new rule.  <a href="#a55d1267177c83d5b0ab6bb120eaab0e8">More...</a><br /></td></tr>
<tr class="separator:a55d1267177c83d5b0ab6bb120eaab0e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa88f6bf9d846c1082a6d0b1b92fb0fe3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#aa88f6bf9d846c1082a6d0b1b92fb0fe3">log_builtins_filter_rule_free</a> (<a class="el" href="log__builtins__filter_8h.html#aa435e0263f68ab4ef5064aaff6e53654">log_filter_rule</a> *ri)</td></tr>
<tr class="memdesc:aa88f6bf9d846c1082a6d0b1b92fb0fe3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release all resources associated with a filter rule.  <a href="#aa88f6bf9d846c1082a6d0b1b92fb0fe3">More...</a><br /></td></tr>
<tr class="separator:aa88f6bf9d846c1082a6d0b1b92fb0fe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30006bebf5e8cb22264071eb542807e6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a30006bebf5e8cb22264071eb542807e6">log_builtins_filter_rule_remove</a> (<a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *ruleset, int elem)</td></tr>
<tr class="memdesc:a30006bebf5e8cb22264071eb542807e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release filter rule (key/value pair) with the index "elem" in "ruleset".  <a href="#a30006bebf5e8cb22264071eb542807e6">More...</a><br /></td></tr>
<tr class="separator:a30006bebf5e8cb22264071eb542807e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40314ff6344f720f62cb4e23ed491ba0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a40314ff6344f720f62cb4e23ed491ba0">log_builtins_filter_ruleset_new</a> (<a class="el" href="log__builtins__filter_8h.html#a28a04bf68dbafe1433847cf306f528ae">log_filter_tag</a> *tag, size_t <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>)</td></tr>
<tr class="memdesc:a40314ff6344f720f62cb4e23ed491ba0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new set of filter rules.  <a href="#a40314ff6344f720f62cb4e23ed491ba0">More...</a><br /></td></tr>
<tr class="separator:a40314ff6344f720f62cb4e23ed491ba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad660455147906e0ddcc40e7b23ef7789"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#ad660455147906e0ddcc40e7b23ef7789">log_builtins_filter_ruleset_lock</a> (<a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *ruleset, <a class="el" href="log__builtins__filter_8h.html#a832bc0ba2e9aadfcbb658b834a683f4d">log_builtins_filter_lock</a> lt)</td></tr>
<tr class="memdesc:ad660455147906e0ddcc40e7b23ef7789"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock and get the filter rules.  <a href="#ad660455147906e0ddcc40e7b23ef7789">More...</a><br /></td></tr>
<tr class="separator:ad660455147906e0ddcc40e7b23ef7789"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97391f76d895d37d2d6b60d954d3994"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#af97391f76d895d37d2d6b60d954d3994">log_builtins_filter_ruleset_drop</a> (<a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *ruleset)</td></tr>
<tr class="memdesc:af97391f76d895d37d2d6b60d954d3994"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drop an entire filter rule-set.  <a href="#af97391f76d895d37d2d6b60d954d3994">More...</a><br /></td></tr>
<tr class="separator:af97391f76d895d37d2d6b60d954d3994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa00bd0dea2b1f619b39f08241dd9c25b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#aa00bd0dea2b1f619b39f08241dd9c25b">log_builtins_filter_ruleset_unlock</a> (<a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *ruleset)</td></tr>
<tr class="memdesc:aa00bd0dea2b1f619b39f08241dd9c25b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock filter ruleset.  <a href="#aa00bd0dea2b1f619b39f08241dd9c25b">More...</a><br /></td></tr>
<tr class="separator:aa00bd0dea2b1f619b39f08241dd9c25b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe376df7587274c4d38c3e2adf68b605"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#abe376df7587274c4d38c3e2adf68b605">log_builtins_filter_ruleset_free</a> (<a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> **ruleset)</td></tr>
<tr class="memdesc:abe376df7587274c4d38c3e2adf68b605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free filter ruleset.  <a href="#abe376df7587274c4d38c3e2adf68b605">More...</a><br /></td></tr>
<tr class="separator:abe376df7587274c4d38c3e2adf68b605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aede27004a33dd571ff67f8903773370a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#aede27004a33dd571ff67f8903773370a">log_builtins_filter_set_defaults</a> (<a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *ruleset)</td></tr>
<tr class="memdesc:aede27004a33dd571ff67f8903773370a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defaults for when the configuration engine isn't loaded; aim for 5.7 compatibilty.  <a href="#aede27004a33dd571ff67f8903773370a">More...</a><br /></td></tr>
<tr class="separator:aede27004a33dd571ff67f8903773370a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11439513e6fe6575e395483c5ec55e45"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a11439513e6fe6575e395483c5ec55e45">log_builtins_filter_exit</a> ()</td></tr>
<tr class="memdesc:a11439513e6fe6575e395483c5ec55e45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deinitialize filtering engine.  <a href="#a11439513e6fe6575e395483c5ec55e45">More...</a><br /></td></tr>
<tr class="separator:a11439513e6fe6575e395483c5ec55e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34e82f31c4c13964e2685963583fc8f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a34e82f31c4c13964e2685963583fc8f7">log_builtins_filter_init</a> ()</td></tr>
<tr class="memdesc:a34e82f31c4c13964e2685963583fc8f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize filtering engine.  <a href="#a34e82f31c4c13964e2685963583fc8f7">More...</a><br /></td></tr>
<tr class="separator:a34e82f31c4c13964e2685963583fc8f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e0ffa4ae311ed259fd24ead0524ed9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="log__builtins__filter_8h.html#ab4d17c22269871f3b060f7d45a150e66">log_filter_apply</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#af5e0ffa4ae311ed259fd24ead0524ed9">log_filter_try_apply</a> (<a class="el" href="log__shared_8h.html#abef61f7610a42c29cd8b3a92f391143f">log_line</a> *ll, int ln, <a class="el" href="log__builtins__filter_8h.html#aa435e0263f68ab4ef5064aaff6e53654">log_filter_rule</a> *<a class="el" href="pfs__example__plugin__employee_8cc.html#ab3f8ffa864d702be7152eed806293ad9">r</a>)</td></tr>
<tr class="memdesc:af5e0ffa4ae311ed259fd24ead0524ed9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the action of an individual rule to an individual log line (or a part thereof, i.e.  <a href="#af5e0ffa4ae311ed259fd24ead0524ed9">More...</a><br /></td></tr>
<tr class="separator:af5e0ffa4ae311ed259fd24ead0524ed9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ff731ee452c029c2b6e357a36e395e7"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="log__builtins__filter_8h.html#a44aea05f29027fd03e973385f0af47d4">log_filter_match</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a9ff731ee452c029c2b6e357a36e395e7">log_filter_try_match</a> (<a class="el" href="log__shared_8h.html#ad21911bb1e1fa9dd868e83040531f7e8">log_item</a> *li, <a class="el" href="log__builtins__filter_8h.html#aa435e0263f68ab4ef5064aaff6e53654">log_filter_rule</a> *ri)</td></tr>
<tr class="memdesc:a9ff731ee452c029c2b6e357a36e395e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to match an individual log line-field against an individual rule's condition.  <a href="#a9ff731ee452c029c2b6e357a36e395e7">More...</a><br /></td></tr>
<tr class="separator:a9ff731ee452c029c2b6e357a36e395e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef2e8ef5761ccf46c4b902e2ff6e712a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#aef2e8ef5761ccf46c4b902e2ff6e712a">log_builtins_filter_run</a> (<a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *ruleset, <a class="el" href="log__shared_8h.html#abef61f7610a42c29cd8b3a92f391143f">log_line</a> *ll)</td></tr>
<tr class="memdesc:aef2e8ef5761ccf46c4b902e2ff6e712a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply all matching rules from a filter rule set to a given log line.  <a href="#aef2e8ef5761ccf46c4b902e2ff6e712a">More...</a><br /></td></tr>
<tr class="separator:aef2e8ef5761ccf46c4b902e2ff6e712a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8c4f350628a1eacbf200809648bba24"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#ad8c4f350628a1eacbf200809648bba24">log_builtins_filter_update_verbosity</a> (int verbosity)</td></tr>
<tr class="memdesc:ad8c4f350628a1eacbf200809648bba24"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is part of the 5.7 emulation: If &ndash;log_error_verbosity is changed, we generate an artificial filter rule from it here.  <a href="#ad8c4f350628a1eacbf200809648bba24">More...</a><br /></td></tr>
<tr class="separator:ad8c4f350628a1eacbf200809648bba24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62686119c0b3742d7fb786e64c33f555"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a62686119c0b3742d7fb786e64c33f555">log_builtins_filter_parse_suppression_list</a> (char *<a class="el" href="test__udf__registration_8cc.html#a96e3cff2f3e1d8eda47115215d03ff32">list</a>, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="myisamlog_8cc.html#a63c3b620cc1cd0b4a2850c8d9804fde2">update</a>)</td></tr>
<tr class="memdesc:a62686119c0b3742d7fb786e64c33f555"><td class="mdescLeft">&#160;</td><td class="mdescRight">@global.log_error_suppression_list accepts a comma-separated list of error-codes that should not be included in the error-log.  <a href="#a62686119c0b3742d7fb786e64c33f555">More...</a><br /></td></tr>
<tr class="separator:a62686119c0b3742d7fb786e64c33f555"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5cbf0682f11f341ecb829a6b4f3284dd"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a5cbf0682f11f341ecb829a6b4f3284dd">filter_inited</a> = <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#a65e9886d74aaee76545e83dd09011727">false</a></td></tr>
<tr class="separator:a5cbf0682f11f341ecb829a6b4f3284dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92f065f23fe5c2a933d6bba7a06dec3a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a92f065f23fe5c2a933d6bba7a06dec3a">filter_rule_uuid</a> = 0</td></tr>
<tr class="separator:a92f065f23fe5c2a933d6bba7a06dec3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a517ea6a8cd47bdc95507dbbeea6caa59"><td class="memItemLeft" align="right" valign="top"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a517ea6a8cd47bdc95507dbbeea6caa59">log_filter_builtin_rules</a> = <a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a></td></tr>
<tr class="separator:a517ea6a8cd47bdc95507dbbeea6caa59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58700966948c7eaab8d8e37de6b72bf6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="log__builtins__filter_8h.html#a28a04bf68dbafe1433847cf306f528ae">log_filter_tag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log__builtins__filter_8cc.html#a58700966948c7eaab8d8e37de6b72bf6">rule_tag_builtin</a> = {&quot;log_filter_builtin&quot;, nullptr}</td></tr>
<tr class="separator:a58700966948c7eaab8d8e37de6b72bf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0656fa9baf7aa9f50fed1b7c1ac5b1aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0656fa9baf7aa9f50fed1b7c1ac5b1aa">&#9670;&nbsp;</a></span>THROTTLE_DEFAULT_WINDOW_SIZE_IN_SECONDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THROTTLE_DEFAULT_WINDOW_SIZE_IN_SECONDS&#160;&#160;&#160;60</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>services: log filter: basic filtering </p>
<p>This implementation, "dragnet" is currently the default filter and therefore built-in. Basic configuration is built into the server proper (via log_error_verbosity etc.); for advanced configuration, load the service log_filter_dragnet which implements a configuration language for this engine. See there for details about the Configuration Stage. Some of the code-paths are only available via the configuration language or an equivalent service (but not without any such service loaded).</p>
<p>At present, the design is such that multiple threads can call the filter concurrently; the ruleset is global and shared between all users.</p>
<p>FILTERING STAGE</p>
<p>At run time, the filter iterates over its rule-set. For each rule, if the condition contains a well-known item, it looks for an item of that type in the event. If the condition contains an ad hoc-item, it looks for an item of any ad hoc-type with the given key within the event.</p>
<p>If there is a match, the filter will verify whether the storage class of the value in the event and that in the condition are either both strings, or both not. If the classes do not match, it flags an error. Otherwise, it now compares both values using the requested comparator, and reports the result.</p>
<p>If a log event matches a rule, an action ("suppress log line", "delete field", etc.) will be applied to that event.</p>
<p>LOCKING</p>
<p>During the filtering stage, a shared lock on the ruleset is held. An exclusive lock on the ruleset is only taken as response to the user's changing of the filter configuration, which should be rare.</p>
<p>For debugging puroposes, rules feature a counter of how often events matched them; this counter is updated atomically.</p>
<p>Rate-limiting ("throttle") needs some bookkeeping data (when does the current window expire? how many matches have we had so far within the current window? etc.). A write-lock is taken on the individual rule (not the entire ruleset) to update this information; any throttling-related actions taken on the event happen after this lock has been released.</p>
<p>The event itself is not locked. </p>

</div>
</div>
<a id="a7254a7a14f6f0ab938a4a7b4a35acad9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7254a7a14f6f0ab938a4a7b4a35acad9">&#9670;&nbsp;</a></span>THROTTLE_MICROSECOND_MULTIPLIER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THROTTLE_MICROSECOND_MULTIPLIER&#160;&#160;&#160;1000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a11439513e6fe6575e395483c5ec55e45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11439513e6fe6575e395483c5ec55e45">&#9670;&nbsp;</a></span>log_builtins_filter_exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int log_builtins_filter_exit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deinitialize filtering engine. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success! </td></tr>
    <tr><td class="paramname">-1</td><td>De-initialize? Filter wasn't even initialized! </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a34e82f31c4c13964e2685963583fc8f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34e82f31c4c13964e2685963583fc8f7">&#9670;&nbsp;</a></span>log_builtins_filter_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int log_builtins_filter_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize filtering engine. </p>
<p>We need to do this early, before the component system is up.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success! </td></tr>
    <tr><td class="paramname">-1</td><td>Couldn't initialize ruleset </td></tr>
    <tr><td class="paramname">-2</td><td>Filter was already initialized? </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a62686119c0b3742d7fb786e64c33f555"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62686119c0b3742d7fb786e64c33f555">&#9670;&nbsp;</a></span>log_builtins_filter_parse_suppression_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int log_builtins_filter_parse_suppression_list </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>@global.log_error_suppression_list accepts a comma-separated list of error-codes that should not be included in the error-log. </p>
<p>Events with a severity of System or Error can not be filtered in this way and will always be forwarded to the log-sinks.</p>
<p>This provides simple filtering for cases where the flexibility of the loadable filter-language is not needed. (The same engine is used however, just with a more limited interface.)</p>
<p>For this filtering to be active, @global.log_error_services has to feature "log_filter_internal", as it does by default. When that is the case, one or both of log_error_verbosity and this variable may be used. Only one of "log_filter_internal" and "log_filter_dragnet" should be used at a time.</p>
<p>The semantics follow that of our system variables; that is to say, when called with update==false, the function acts as a check-function that validates the entire list given to it; when called with update==true, it creates filter-rules from the list items. This way, we either create all rules, or no rules, rather than ending up with an incomplete rule-set when we encounter a problem in the input.</p>
<p>The return value encodes the location in the argument where the failure occurred, like so:</p><ul>
<li>if 0 is returned, no issues were detected</li>
<li>if a value less than zero is returned, -(retval + 1) is the byte position (counting from 0) in the list argument at which point the failure was detected</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">list</td><td>list of error-codes that should not appear in the error-log </td></tr>
    <tr><td class="paramname">update</td><td>false: verify list only true: create filtering rules from suppression list</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">!0</td><td>failure (see above) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa88f6bf9d846c1082a6d0b1b92fb0fe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa88f6bf9d846c1082a6d0b1b92fb0fe3">&#9670;&nbsp;</a></span>log_builtins_filter_rule_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int log_builtins_filter_rule_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#aa435e0263f68ab4ef5064aaff6e53654">log_filter_rule</a> *&#160;</td>
          <td class="paramname"><em>ri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Release all resources associated with a filter rule. </p>
<p>Leaves a "gap" (an uninitialized rule) for immediate re-filling; if this is undesired, use log_builtins_filter_rule_remove() (see there). Must hold rule-set lock.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ri</td><td>the rule to release</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">the</td><td>return value from mysql_rwlock_destroy() </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a55d1267177c83d5b0ab6bb120eaab0e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55d1267177c83d5b0ab6bb120eaab0e8">&#9670;&nbsp;</a></span>log_builtins_filter_rule_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="log__builtins__filter_8h.html#aa435e0263f68ab4ef5064aaff6e53654">log_filter_rule</a>* log_builtins_filter_rule_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *&#160;</td>
          <td class="paramname"><em>ruleset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize a new rule. </p>
<p>This clears the first unused rule. It does not update the rules count; this is for the caller to do if it succeeds in setting up the rule to its satisfaction. If the caller fails, it should log_builtins_filter_rule_free() the incomplete rule.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">nullptr</td><td>could not initialize rule. Do not call rule_free. </td></tr>
    <tr><td class="paramname">!nullptr</td><td>the address of the rule. fill in. on success, caller must increase rule count. on failure, it must call rule_free. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a30006bebf5e8cb22264071eb542807e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30006bebf5e8cb22264071eb542807e6">&#9670;&nbsp;</a></span>log_builtins_filter_rule_remove()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void log_builtins_filter_rule_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *&#160;</td>
          <td class="paramname"><em>ruleset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>elem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Release filter rule (key/value pair) with the index "elem" in "ruleset". </p>
<p>This frees whichever of key and value were dynamically allocated. It then moves any trailing items to fill the "gap" and decreases the counter of elements in the rule-set.</p>
<p>If the intention is to leave a "gap" in the bag that may immediately be overwritten with an updated element, use log_builtins_filter_rule_free() instead.</p>
<p>Caller must hold rule-set lock.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ruleset</td><td>filter rule-set </td></tr>
    <tr><td class="paramname">elem</td><td>index of the filter rule to release </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af97391f76d895d37d2d6b60d954d3994"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af97391f76d895d37d2d6b60d954d3994">&#9670;&nbsp;</a></span>log_builtins_filter_ruleset_drop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void log_builtins_filter_ruleset_drop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *&#160;</td>
          <td class="paramname"><em>ruleset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Drop an entire filter rule-set. </p>
<p>Must hold lock. </p>

</div>
</div>
<a id="abe376df7587274c4d38c3e2adf68b605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe376df7587274c4d38c3e2adf68b605">&#9670;&nbsp;</a></span>log_builtins_filter_ruleset_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void log_builtins_filter_ruleset_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> **&#160;</td>
          <td class="paramname"><em>ruleset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Free filter ruleset. </p>

</div>
</div>
<a id="ad660455147906e0ddcc40e7b23ef7789"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad660455147906e0ddcc40e7b23ef7789">&#9670;&nbsp;</a></span>log_builtins_filter_ruleset_lock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int log_builtins_filter_ruleset_lock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *&#160;</td>
          <td class="paramname"><em>ruleset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a832bc0ba2e9aadfcbb658b834a683f4d">log_builtins_filter_lock</a>&#160;</td>
          <td class="paramname"><em>lt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Lock and get the filter rules. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ruleset</td><td>the ruleset to lock </td></tr>
    <tr><td class="paramname">lt</td><td>LOG_BUILTINS_LOCK_SHARED lock for reading LOG_BUILTINS_LOCK_EXCLUSIVE lock for writing</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>lock acquired </td></tr>
    <tr><td class="paramname">!0</td><td>failed to acquire lock </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a40314ff6344f720f62cb4e23ed491ba0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40314ff6344f720f62cb4e23ed491ba0">&#9670;&nbsp;</a></span>log_builtins_filter_ruleset_new()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a>* log_builtins_filter_ruleset_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a28a04bf68dbafe1433847cf306f528ae">log_filter_tag</a> *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a new set of filter rules. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tag</td><td>tag for this ruleset </td></tr>
    <tr><td class="paramname">count</td><td>number of rules to allocate, 0 for default</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">a</td><td>pointer to a ruleset structure, or nullptr on failure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa00bd0dea2b1f619b39f08241dd9c25b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa00bd0dea2b1f619b39f08241dd9c25b">&#9670;&nbsp;</a></span>log_builtins_filter_ruleset_unlock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void log_builtins_filter_ruleset_unlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *&#160;</td>
          <td class="paramname"><em>ruleset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unlock filter ruleset. </p>

</div>
</div>
<a id="aef2e8ef5761ccf46c4b902e2ff6e712a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef2e8ef5761ccf46c4b902e2ff6e712a">&#9670;&nbsp;</a></span>log_builtins_filter_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int log_builtins_filter_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *&#160;</td>
          <td class="paramname"><em>ruleset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="log__shared_8h.html#abef61f7610a42c29cd8b3a92f391143f">log_line</a> *&#160;</td>
          <td class="paramname"><em>ll</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply all matching rules from a filter rule set to a given log line. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ruleset</td><td>rule-set to apply </td></tr>
    <tr><td class="paramname">ll</td><td>the current log line</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>number of matched rules </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aede27004a33dd571ff67f8903773370a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aede27004a33dd571ff67f8903773370a">&#9670;&nbsp;</a></span>log_builtins_filter_set_defaults()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void log_builtins_filter_set_defaults </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *&#160;</td>
          <td class="paramname"><em>ruleset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defaults for when the configuration engine isn't loaded; aim for 5.7 compatibilty. </p>

</div>
</div>
<a id="ad8c4f350628a1eacbf200809648bba24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8c4f350628a1eacbf200809648bba24">&#9670;&nbsp;</a></span>log_builtins_filter_update_verbosity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int log_builtins_filter_update_verbosity </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbosity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is part of the 5.7 emulation: If &ndash;log_error_verbosity is changed, we generate an artificial filter rule from it here. </p>
<p>For this filtering to be active, @global.log_error_services has to feature "log_filter_internal", as it does by default. When that is the case, one or both of log_error_verbosity and log_error_suppression_list (see below) may be used. Only one of "log_filter_internal" and "log_filter_dragnet" should be used at a time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verbosity</td><td>log_error_verbosity style, range(1,3) 1:errors, 2:+=warnings, 3:+=notes</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">!0</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a35a6609933af217bbee296817c81c60a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35a6609933af217bbee296817c81c60a">&#9670;&nbsp;</a></span>log_filter_ruleset_full()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> log_filter_ruleset_full </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a> *&#160;</td>
          <td class="paramname"><em>rs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Predicate: can we add any more rules? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rs</td><td>the ruleset to check</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>full, no more rules can be added </td></tr>
    <tr><td class="paramname">false</td><td>not full, further rules can be added </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af5e0ffa4ae311ed259fd24ead0524ed9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5e0ffa4ae311ed259fd24ead0524ed9">&#9670;&nbsp;</a></span>log_filter_try_apply()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="log__builtins__filter_8h.html#ab4d17c22269871f3b060f7d45a150e66">log_filter_apply</a> log_filter_try_apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__shared_8h.html#abef61f7610a42c29cd8b3a92f391143f">log_line</a> *&#160;</td>
          <td class="paramname"><em>ll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#aa435e0263f68ab4ef5064aaff6e53654">log_filter_rule</a> *&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply the action of an individual rule to an individual log line (or a part thereof, i.e. </p>
<p>a "field"). At this point, we already know that the current log line matches the condition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ll</td><td>the current log line </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ln</td><td>index of the matching field, -1 for none (when a test for absence matched) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">r</td><td>the rule to apply. internal state may be changed (i.e. the number of seen matches for a throttle rule)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">log_filter_apply</td><td>0 on success, an error-code otherwise </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9ff731ee452c029c2b6e357a36e395e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ff731ee452c029c2b6e357a36e395e7">&#9670;&nbsp;</a></span>log_filter_try_match()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="log__builtins__filter_8h.html#a44aea05f29027fd03e973385f0af47d4">log_filter_match</a> log_filter_try_match </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__shared_8h.html#ad21911bb1e1fa9dd868e83040531f7e8">log_item</a> *&#160;</td>
          <td class="paramname"><em>li</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="log__builtins__filter_8h.html#aa435e0263f68ab4ef5064aaff6e53654">log_filter_rule</a> *&#160;</td>
          <td class="paramname"><em>ri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Try to match an individual log line-field against an individual rule's condition. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">li</td><td>the log item we try to match </td></tr>
    <tr><td class="paramname">ri</td><td>the rule containing the condition</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">log_filter_match</td><td>0 (LOG_FILTER_MATCH_SUCCESS) on match, 1 (LOG_FILTER_MATCH_UNSATISFIED) or an error-code otherwise </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a5cbf0682f11f341ecb829a6b4f3284dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cbf0682f11f341ecb829a6b4f3284dd">&#9670;&nbsp;</a></span>filter_inited</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> filter_inited = <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#a65e9886d74aaee76545e83dd09011727">false</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a92f065f23fe5c2a933d6bba7a06dec3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92f065f23fe5c2a933d6bba7a06dec3a">&#9670;&nbsp;</a></span>filter_rule_uuid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> filter_rule_uuid = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a517ea6a8cd47bdc95507dbbeea6caa59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a517ea6a8cd47bdc95507dbbeea6caa59">&#9670;&nbsp;</a></span>log_filter_builtin_rules</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="log__builtins__filter_8h.html#a1b63efa5fc9cc4b30ba88be1f7c0a5c4">log_filter_ruleset</a>* log_filter_builtin_rules = <a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a58700966948c7eaab8d8e37de6b72bf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58700966948c7eaab8d8e37de6b72bf6">&#9670;&nbsp;</a></span>rule_tag_builtin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="log__builtins__filter_8h.html#a28a04bf68dbafe1433847cf306f528ae">log_filter_tag</a> rule_tag_builtin = {&quot;log_filter_builtin&quot;, nullptr}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5bd71961b401a432086d0fb290a87f3f.html">sql</a></li><li class="navelem"><a class="el" href="dir_12a5ab756a4de267189eabf05ec2ce08.html">server_component</a></li><li class="navelem"><a class="el" href="log__builtins__filter_8cc.html">log_builtins_filter.cc</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
