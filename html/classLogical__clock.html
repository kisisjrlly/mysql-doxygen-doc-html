<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Logical_clock Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classLogical__clock.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classLogical__clock-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Logical_clock Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Logical timestamp generator for logical timestamping binlog transactions.  
 <a href="classLogical__clock.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rpl__trx__tracking_8h_source.html">rpl_trx_tracking.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8e2c961f872e91f374544c72ad35e52a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogical__clock.html#a8e2c961f872e91f374544c72ad35e52a">Logical_clock</a> ()</td></tr>
<tr class="separator:a8e2c961f872e91f374544c72ad35e52a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18398147c14dd22bb9543b479c2bee1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogical__clock.html#a18398147c14dd22bb9543b479c2bee1e">Logical_clock</a> (const <a class="el" href="classLogical__clock.html">Logical_clock</a> &amp;other)</td></tr>
<tr class="separator:a18398147c14dd22bb9543b479c2bee1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d2e019f74f509ac6244cd4a6e3f1101"><td class="memItemLeft" align="right" valign="top"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogical__clock.html#a1d2e019f74f509ac6244cd4a6e3f1101">step</a> ()</td></tr>
<tr class="memdesc:a1d2e019f74f509ac6244cd4a6e3f1101"><td class="mdescLeft">&#160;</td><td class="mdescRight">Steps the absolute value of the clock (state) to return an updated value.  <a href="#a1d2e019f74f509ac6244cd4a6e3f1101">More...</a><br /></td></tr>
<tr class="separator:a1d2e019f74f509ac6244cd4a6e3f1101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a245c0427e7eda455da53e26c4b8a0bf9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogical__clock.html#a245c0427e7eda455da53e26c4b8a0bf9">set_if_greater</a> (<a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> new_val)</td></tr>
<tr class="memdesc:a245c0427e7eda455da53e26c4b8a0bf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">To try setting the clock <em>forward</em>.  <a href="#a245c0427e7eda455da53e26c4b8a0bf9">More...</a><br /></td></tr>
<tr class="separator:a245c0427e7eda455da53e26c4b8a0bf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac686c90f57dbf876a7a87d648ef35700"><td class="memItemLeft" align="right" valign="top"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogical__clock.html#ac686c90f57dbf876a7a87d648ef35700">get_timestamp</a> ()</td></tr>
<tr class="memdesc:ac686c90f57dbf876a7a87d648ef35700"><td class="mdescLeft">&#160;</td><td class="mdescRight">Atomically fetch the current state.  <a href="#ac686c90f57dbf876a7a87d648ef35700">More...</a><br /></td></tr>
<tr class="separator:ac686c90f57dbf876a7a87d648ef35700"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc18ca694cbab72dbe865485d5632b9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogical__clock.html#afc18ca694cbab72dbe865485d5632b9c">get_offset</a> ()</td></tr>
<tr class="separator:afc18ca694cbab72dbe865485d5632b9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cf04e43d7f6d5a39fb58c3610408774"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogical__clock.html#a4cf04e43d7f6d5a39fb58c3610408774">update_offset</a> (<a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> new_offset)</td></tr>
<tr class="separator:a4cf04e43d7f6d5a39fb58c3610408774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a043d20ecb4d36c028e37003ffe20c7ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogical__clock.html#a043d20ecb4d36c028e37003ffe20c7ff">~Logical_clock</a> ()</td></tr>
<tr class="separator:a043d20ecb4d36c028e37003ffe20c7ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a66560c569f9cb6b8f75f68f5e9305c7c"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; <a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogical__clock.html#a66560c569f9cb6b8f75f68f5e9305c7c">state</a></td></tr>
<tr class="separator:a66560c569f9cb6b8f75f68f5e9305c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa09faf7c868830b13939d61013d75bba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLogical__clock.html#aa09faf7c868830b13939d61013d75bba">offset</a></td></tr>
<tr class="separator:aa09faf7c868830b13939d61013d75bba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Logical timestamp generator for logical timestamping binlog transactions. </p>
<p>A transaction is associated with two sequence numbers see <code>Transaction_ctx::last_committed</code> and <code>Transaction_ctx::sequence_number</code>. The class provides necessary interfaces including that of generating a next consecutive value for the latter. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8e2c961f872e91f374544c72ad35e52a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e2c961f872e91f374544c72ad35e52a">&#9670;&nbsp;</a></span>Logical_clock() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Logical_clock::Logical_clock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a18398147c14dd22bb9543b479c2bee1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18398147c14dd22bb9543b479c2bee1e">&#9670;&nbsp;</a></span>Logical_clock() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Logical_clock::Logical_clock </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLogical__clock.html">Logical_clock</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a043d20ecb4d36c028e37003ffe20c7ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a043d20ecb4d36c028e37003ffe20c7ff">&#9670;&nbsp;</a></span>~Logical_clock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Logical_clock::~Logical_clock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="afc18ca694cbab72dbe865485d5632b9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc18ca694cbab72dbe865485d5632b9c">&#9670;&nbsp;</a></span>get_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> Logical_clock::get_offset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac686c90f57dbf876a7a87d648ef35700"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac686c90f57dbf876a7a87d648ef35700">&#9670;&nbsp;</a></span>get_timestamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> Logical_clock::get_timestamp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Atomically fetch the current state. </p>
<dl class="section return"><dt>Returns</dt><dd>not subtracted "absolute" value. </dd></dl>

</div>
</div>
<a id="a245c0427e7eda455da53e26c4b8a0bf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a245c0427e7eda455da53e26c4b8a0bf9">&#9670;&nbsp;</a></span>set_if_greater()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> Logical_clock::set_if_greater </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a>&#160;</td>
          <td class="paramname"><em>new_val</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To try setting the clock <em>forward</em>. </p>
<p>The clock does not change when the new value is in the past which is reflected by the new value and by offset. In other words the function main effects is described as state= max(state, new_value). Offset that exceeds the new value indicates the binary log rotation to render such new value useless.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_val</td><td>a new value (offset included) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a (new) value of state member regardless whether it's changed or not. </dd></dl>

</div>
</div>
<a id="a1d2e019f74f509ac6244cd4a6e3f1101"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d2e019f74f509ac6244cd4a6e3f1101">&#9670;&nbsp;</a></span>step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> Logical_clock::step </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Steps the absolute value of the clock (state) to return an updated value. </p>
<p>The caller must be sure to call the method in no concurrent execution context so either offset and state can't change.</p>
<dl class="section return"><dt>Returns</dt><dd>incremented "absolute" value </dd></dl>

</div>
</div>
<a id="a4cf04e43d7f6d5a39fb58c3610408774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cf04e43d7f6d5a39fb58c3610408774">&#9670;&nbsp;</a></span>update_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Logical_clock::update_offset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a>&#160;</td>
          <td class="paramname"><em>new_offset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aa09faf7c868830b13939d61013d75bba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa09faf7c868830b13939d61013d75bba">&#9670;&nbsp;</a></span>offset</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> Logical_clock::offset</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a66560c569f9cb6b8f75f68f5e9305c7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66560c569f9cb6b8f75f68f5e9305c7c">&#9670;&nbsp;</a></span>state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;<a class="el" href="my__inttypes_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a>&gt; Logical_clock::state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>sql/<a class="el" href="rpl__trx__tracking_8h_source.html">rpl_trx_tracking.h</a></li>
<li>sql/<a class="el" href="rpl__trx__tracking_8cc.html">rpl_trx_tracking.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classLogical__clock.html">Logical_clock</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
