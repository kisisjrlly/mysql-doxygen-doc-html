<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: mysys/crypt_genhash_impl.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('crypt__genhash__impl_8cc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">crypt_genhash_impl.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;my_config.h&quot;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;openssl/evp.h&gt;</code><br />
<code>#include &lt;openssl/rand.h&gt;</code><br />
<code>#include &lt;openssl/sha.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;<a class="el" href="string_8h_source.html">string.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="time_8h_source.html">time.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="crypt__genhash__impl_8h_source.html">crypt_genhash_impl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="m__string_8h_source.html">m_string.h</a>&quot;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac4a843e8198726f003dfec406530f558"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a>&#160;&#160;&#160;EVP_MD_CTX</td></tr>
<tr class="separator:ac4a843e8198726f003dfec406530f558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14aa0c95ad1775ec290dc69b1ada1f6b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a14aa0c95ad1775ec290dc69b1ada1f6b">DIGEST_LEN</a>&#160;&#160;&#160;SHA256_DIGEST_LENGTH</td></tr>
<tr class="separator:a14aa0c95ad1775ec290dc69b1ada1f6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(a,  b)&#160;&#160;&#160;(((a) &gt; (b)) ? (a) : (b))</td></tr>
<tr class="separator:afa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(a,  b)&#160;&#160;&#160;(((a) &lt; (b)) ? (a) : (b))</td></tr>
<tr class="separator:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e785e979e3a959fb12155372b36e53"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#ab6e785e979e3a959fb12155372b36e53">b64_from_24bit</a>(B2,  B1,  B0,  N)</td></tr>
<tr class="separator:ab6e785e979e3a959fb12155372b36e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69479655ab94c875413d38689002ff98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a69479655ab94c875413d38689002ff98">ROUNDS</a>&#160;&#160;&#160;&quot;rounds=&quot;</td></tr>
<tr class="separator:a69479655ab94c875413d38689002ff98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a496424c7709a571215d80b87a9550a47"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a496424c7709a571215d80b87a9550a47">ROUNDSLEN</a>&#160;&#160;&#160;(sizeof(<a class="el" href="crypt__genhash__impl_8cc.html#a69479655ab94c875413d38689002ff98">ROUNDS</a>) - 1)</td></tr>
<tr class="separator:a496424c7709a571215d80b87a9550a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a90bbf2863fc1b80e921d676f5cacb83f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a90bbf2863fc1b80e921d676f5cacb83f">DIGESTCreate</a> (<a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a> **ctx)</td></tr>
<tr class="separator:a90bbf2863fc1b80e921d676f5cacb83f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac13234b1d4cebd4fc733e2f16455b4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a0ac13234b1d4cebd4fc733e2f16455b4">DIGESTInit</a> (<a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a> *ctx)</td></tr>
<tr class="separator:a0ac13234b1d4cebd4fc733e2f16455b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab230080ed830ad1d76d8c95a5b9be76f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#ab230080ed830ad1d76d8c95a5b9be76f">DIGESTUpdate</a> (<a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a> *ctx, const void *plaintext, int len)</td></tr>
<tr class="separator:ab230080ed830ad1d76d8c95a5b9be76f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96e3efb4dab57068a6d9ffebbb69869b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a96e3efb4dab57068a6d9ffebbb69869b">DIGESTFinal</a> (void *txt, <a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a> *ctx)</td></tr>
<tr class="separator:a96e3efb4dab57068a6d9ffebbb69869b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e61d3574b7fea1b18709a9b59f04920"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a5e61d3574b7fea1b18709a9b59f04920">DIGESTDestroy</a> (<a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a> **ctx)</td></tr>
<tr class="separator:a5e61d3574b7fea1b18709a9b59f04920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a881e33842dcc30c23f14a4f052242eab"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a881e33842dcc30c23f14a4f052242eab">strlcat</a> (char *dst, const char *src, size_t siz)</td></tr>
<tr class="memdesc:a881e33842dcc30c23f14a4f052242eab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size-bounded string copying and concatenation This is a replacement for STRLCPY(3)  <a href="#a881e33842dcc30c23f14a4f052242eab">More...</a><br /></td></tr>
<tr class="separator:a881e33842dcc30c23f14a4f052242eab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76ca15f4f00c87815cdab3904fe330f0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a76ca15f4f00c87815cdab3904fe330f0">getrounds</a> (const char *s)</td></tr>
<tr class="memdesc:a76ca15f4f00c87815cdab3904fe330f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the integer value after rounds= where ever it occurs in the string.  <a href="#a76ca15f4f00c87815cdab3904fe330f0">More...</a><br /></td></tr>
<tr class="separator:a76ca15f4f00c87815cdab3904fe330f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea7f411fb90b2704812cc8329118f38"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#afea7f411fb90b2704812cc8329118f38">extract_user_salt</a> (const char **salt_begin, const char **salt_end)</td></tr>
<tr class="memdesc:afea7f411fb90b2704812cc8329118f38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the interval which envelopes the user salt in a crypt password The crypt format is assumed to be $a$bbbb$cccccc\0 and the salt is found by counting the delimiters and marking begin and end.  <a href="#afea7f411fb90b2704812cc8329118f38">More...</a><br /></td></tr>
<tr class="separator:afea7f411fb90b2704812cc8329118f38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3245774910b95702a05f70ddf6d2d57"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#aa3245774910b95702a05f70ddf6d2d57">my_crypt_genhash</a> (char *ctbuffer, size_t ctbufflen, const char *plaintext, size_t plaintext_len, const char *switchsalt, const char **, unsigned int *num_rounds)</td></tr>
<tr class="separator:aa3245774910b95702a05f70ddf6d2d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a893492f4f37328b4818a63838ec10418"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a893492f4f37328b4818a63838ec10418">generate_user_salt</a> (char *<a class="el" href="test__sql__9__sessions_8cc.html#ac242a6dca06b33213957c913bd72414c">buffer</a>, int buffer_len)</td></tr>
<tr class="memdesc:a893492f4f37328b4818a63838ec10418"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a random string using ASCII characters but avoid seperator character.  <a href="#a893492f4f37328b4818a63838ec10418">More...</a><br /></td></tr>
<tr class="separator:a893492f4f37328b4818a63838ec10418"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53b83c3d45c1301d9bb6438906d71c6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a53b83c3d45c1301d9bb6438906d71c6f">xor_string</a> (char *to, int to_len, char *pattern, int pattern_len)</td></tr>
<tr class="separator:a53b83c3d45c1301d9bb6438906d71c6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac4e1cb8171d8e27b7de934c06c44fcce"><td class="memItemLeft" align="right" valign="top">static const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#ac4e1cb8171d8e27b7de934c06c44fcce">crypt_alg_magic</a> [] = &quot;$5&quot;</td></tr>
<tr class="separator:ac4e1cb8171d8e27b7de934c06c44fcce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af62f46ed237f6f121b1d81f1650b2eff"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#af62f46ed237f6f121b1d81f1650b2eff">crypt_alg_magic_len</a> = sizeof(<a class="el" href="crypt__genhash__impl_8cc.html#ac4e1cb8171d8e27b7de934c06c44fcce">crypt_alg_magic</a>) - 1</td></tr>
<tr class="separator:af62f46ed237f6f121b1d81f1650b2eff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd6a47909b894b40aaee09c9b6283c8"><td class="memItemLeft" align="right" valign="top">static unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt__genhash__impl_8cc.html#a4bd6a47909b894b40aaee09c9b6283c8">b64t</a> []</td></tr>
<tr class="separator:a4bd6a47909b894b40aaee09c9b6283c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab6e785e979e3a959fb12155372b36e53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6e785e979e3a959fb12155372b36e53">&#9670;&nbsp;</a></span>b64_from_24bit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define b64_from_24bit</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">B2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">B1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">B0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">N&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{                                                 \</div><div class="line">    uint32_t w = ((B2) &lt;&lt; 16) | ((B1) &lt;&lt; 8) | (B0); \</div><div class="line">    int <a class="code" href="xcom__base_8cc.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = (<a class="code" href="namespaceCounter.html#abea6ef92ca238b92ef57568827fc2b37">N</a>);                                    \</div><div class="line">    while (--n &gt;= 0 &amp;&amp; ctbufflen &gt; 0) {             \</div><div class="line">      *<a class="code" href="ctype-mb_8cc.html#a6bc6b007533335efe02bafff799ec64c">p</a>++ = <a class="code" href="crypt__genhash__impl_8cc.html#a4bd6a47909b894b40aaee09c9b6283c8">b64t</a>[w &amp; 0x3f];                        \</div><div class="line">      w &gt;&gt;= 6;                                      \</div><div class="line">      ctbufflen--;                                  \</div><div class="line">    }                                               \</div><div class="line">  }</div><div class="ttc" id="crypt__genhash__impl_8cc_html_a4bd6a47909b894b40aaee09c9b6283c8"><div class="ttname"><a href="crypt__genhash__impl_8cc.html#a4bd6a47909b894b40aaee09c9b6283c8">b64t</a></div><div class="ttdeci">static unsigned char b64t[]</div><div class="ttdef"><b>Definition:</b> crypt_genhash_impl.cc:126</div></div>
<div class="ttc" id="namespaceCounter_html_abea6ef92ca238b92ef57568827fc2b37"><div class="ttname"><a href="namespaceCounter.html#abea6ef92ca238b92ef57568827fc2b37">Counter::N</a></div><div class="ttdeci">std::atomic&lt; Type &gt; N</div><div class="ttdef"><b>Definition:</b> ut0counter.h:224</div></div>
<div class="ttc" id="xcom__base_8cc_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="xcom__base_8cc.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> xcom_base.cc:442</div></div>
<div class="ttc" id="ctype-mb_8cc_html_a6bc6b007533335efe02bafff799ec64c"><div class="ttname"><a href="ctype-mb_8cc.html#a6bc6b007533335efe02bafff799ec64c">p</a></div><div class="ttdeci">const char * p</div><div class="ttdef"><b>Definition:</b> ctype-mb.cc:1235</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4a843e8198726f003dfec406530f558"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4a843e8198726f003dfec406530f558">&#9670;&nbsp;</a></span>DIGEST_CTX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIGEST_CTX&#160;&#160;&#160;EVP_MD_CTX</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a14aa0c95ad1775ec290dc69b1ada1f6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14aa0c95ad1775ec290dc69b1ada1f6b">&#9670;&nbsp;</a></span>DIGEST_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIGEST_LEN&#160;&#160;&#160;SHA256_DIGEST_LENGTH</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afa99ec4acc4ecb2dc3c2d05da15d0e3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa99ec4acc4ecb2dc3c2d05da15d0e3f">&#9670;&nbsp;</a></span>MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((a) &gt; (b)) ? (a) : (b))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3acffbd305ee72dcd4593c0d8af64a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3acffbd305ee72dcd4593c0d8af64a4f">&#9670;&nbsp;</a></span>MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((a) &lt; (b)) ? (a) : (b))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a69479655ab94c875413d38689002ff98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69479655ab94c875413d38689002ff98">&#9670;&nbsp;</a></span>ROUNDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROUNDS&#160;&#160;&#160;&quot;rounds=&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a496424c7709a571215d80b87a9550a47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a496424c7709a571215d80b87a9550a47">&#9670;&nbsp;</a></span>ROUNDSLEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROUNDSLEN&#160;&#160;&#160;(sizeof(<a class="el" href="crypt__genhash__impl_8cc.html#a69479655ab94c875413d38689002ff98">ROUNDS</a>) - 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a90bbf2863fc1b80e921d676f5cacb83f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90bbf2863fc1b80e921d676f5cacb83f">&#9670;&nbsp;</a></span>DIGESTCreate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void DIGESTCreate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a> **&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5e61d3574b7fea1b18709a9b59f04920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e61d3574b7fea1b18709a9b59f04920">&#9670;&nbsp;</a></span>DIGESTDestroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void DIGESTDestroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a> **&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a96e3efb4dab57068a6d9ffebbb69869b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96e3efb4dab57068a6d9ffebbb69869b">&#9670;&nbsp;</a></span>DIGESTFinal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void DIGESTFinal </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>txt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0ac13234b1d4cebd4fc733e2f16455b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ac13234b1d4cebd4fc733e2f16455b4">&#9670;&nbsp;</a></span>DIGESTInit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void DIGESTInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab230080ed830ad1d76d8c95a5b9be76f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab230080ed830ad1d76d8c95a5b9be76f">&#9670;&nbsp;</a></span>DIGESTUpdate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void DIGESTUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypt__genhash__impl_8cc.html#ac4a843e8198726f003dfec406530f558">DIGEST_CTX</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afea7f411fb90b2704812cc8329118f38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afea7f411fb90b2704812cc8329118f38">&#9670;&nbsp;</a></span>extract_user_salt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int extract_user_salt </td>
          <td>(</td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>salt_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>salt_end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the interval which envelopes the user salt in a crypt password The crypt format is assumed to be $a$bbbb$cccccc\0 and the salt is found by counting the delimiters and marking begin and end. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">salt_begin</td><td>As input, pointer to start of crypt passwd, as output, pointer to first byte of the salt </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">salt_end</td><td>As input, pointer to the last byte in passwd, as output, pointer to the byte immediatly following the salt ($)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the salt identified </dd></dl>

</div>
</div>
<a id="a893492f4f37328b4818a63838ec10418"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a893492f4f37328b4818a63838ec10418">&#9670;&nbsp;</a></span>generate_user_salt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void generate_user_salt </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>buffer_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a random string using ASCII characters but avoid seperator character. </p>
<p>Stdlib rand and srand are used to produce pseudo random numbers between with about 7 bit worth of entropty between 1-127. </p>

</div>
</div>
<a id="a76ca15f4f00c87815cdab3904fe330f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76ca15f4f00c87815cdab3904fe330f0">&#9670;&nbsp;</a></span>getrounds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> getrounds </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the integer value after rounds= where ever it occurs in the string. </p>
<p>if the last char after the int is a , or $ that is fine anything else is an error. </p>

</div>
</div>
<a id="aa3245774910b95702a05f70ddf6d2d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3245774910b95702a05f70ddf6d2d57">&#9670;&nbsp;</a></span>my_crypt_genhash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* my_crypt_genhash </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ctbuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ctbufflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>plaintext_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>switchsalt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>num_rounds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a881e33842dcc30c23f14a4f052242eab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a881e33842dcc30c23f14a4f052242eab">&#9670;&nbsp;</a></span>strlcat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t strlcat </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>siz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Size-bounded string copying and concatenation This is a replacement for STRLCPY(3) </p>

</div>
</div>
<a id="a53b83c3d45c1301d9bb6438906d71c6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53b83c3d45c1301d9bb6438906d71c6f">&#9670;&nbsp;</a></span>xor_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void xor_string </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>to_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pattern_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4bd6a47909b894b40aaee09c9b6283c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bd6a47909b894b40aaee09c9b6283c8">&#9670;&nbsp;</a></span>b64t</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char b64t[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= </div><div class="line">    <span class="stringliteral">&quot;./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span></div></div><!-- fragment -->
</div>
</div>
<a id="ac4e1cb8171d8e27b7de934c06c44fcce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4e1cb8171d8e27b7de934c06c44fcce">&#9670;&nbsp;</a></span>crypt_alg_magic</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char crypt_alg_magic[] = &quot;$5&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af62f46ed237f6f121b1d81f1650b2eff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af62f46ed237f6f121b1d81f1650b2eff">&#9670;&nbsp;</a></span>crypt_alg_magic_len</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int crypt_alg_magic_len = sizeof(<a class="el" href="crypt__genhash__impl_8cc.html#ac4e1cb8171d8e27b7de934c06c44fcce">crypt_alg_magic</a>) - 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_7507adac5764e4f818c81969b3802964.html">mysys</a></li><li class="navelem"><a class="el" href="crypt__genhash__impl_8cc.html">crypt_genhash_impl.cc</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
