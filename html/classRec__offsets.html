<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Rec_offsets Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classRec__offsets.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classRec__offsets-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Rec_offsets Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A helper RAII wrapper for otherwise difficult to use sequence of:  
 <a href="classRec__offsets.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rem0rec_8h_source.html">rem0rec.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Rec_offsets:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classRec__offsets.png" usemap="#Rec_5Foffsets_map" alt=""/>
  <map id="Rec_5Foffsets_map" name="Rec_5Foffsets_map">
<area href="classut_1_1Non__copyable.html" title="A utility class which, if inherited from, prevents the descendant class from being copied..." alt="ut::Non_copyable" shape="rect" coords="0,0,110,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1278badb7d6d7840675a8aa09ba79814"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRec__offsets.html#a1278badb7d6d7840675a8aa09ba79814">Rec_offsets</a> ()</td></tr>
<tr class="memdesc:a1278badb7d6d7840675a8aa09ba79814"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares offsets to initially point to the fixed-size buffer, and marks the memory as allocated, but uninitialized.  <a href="#a1278badb7d6d7840675a8aa09ba79814">More...</a><br /></td></tr>
<tr class="separator:a1278badb7d6d7840675a8aa09ba79814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad24afd2e3014b9c7397e7fcc3f324167"><td class="memItemLeft" align="right" valign="top">const ulint *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRec__offsets.html#ad24afd2e3014b9c7397e7fcc3f324167">compute</a> (const <a class="el" href="rem0types_8h.html#a92caeffe2dc2fbe825a54aef9a163435">rec_t</a> *rec, const <a class="el" href="structdict__index__t.html">dict_index_t</a> *<a class="el" href="mysql_8cc.html#adfa69ae672499b1037123a1f17c5552b">index</a>)</td></tr>
<tr class="memdesc:ad24afd2e3014b9c7397e7fcc3f324167"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes offsets for given record.  <a href="#ad24afd2e3014b9c7397e7fcc3f324167">More...</a><br /></td></tr>
<tr class="separator:ad24afd2e3014b9c7397e7fcc3f324167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a115df7e92a7b8d0aedc5a8d946feb5c5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRec__offsets.html#a115df7e92a7b8d0aedc5a8d946feb5c5">~Rec_offsets</a> ()</td></tr>
<tr class="memdesc:a115df7e92a7b8d0aedc5a8d946feb5c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocated dynamically allocated memory, if any.  <a href="#a115df7e92a7b8d0aedc5a8d946feb5c5">More...</a><br /></td></tr>
<tr class="separator:a115df7e92a7b8d0aedc5a8d946feb5c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a5377d83ce4b7b6c7689d16dff759353c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mem0mem_8h.html#a29a10a74bdb0acc8a530dd6ec3c8538a">mem_heap_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRec__offsets.html#a5377d83ce4b7b6c7689d16dff759353c">m_heap</a> {<a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>}</td></tr>
<tr class="memdesc:a5377d83ce4b7b6c7689d16dff759353c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to heap used by rec_get_offsets().  <a href="#a5377d83ce4b7b6c7689d16dff759353c">More...</a><br /></td></tr>
<tr class="separator:a5377d83ce4b7b6c7689d16dff759353c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a091ab984d1f0f40c1ab2e9d32e3a5c6a"><td class="memItemLeft" align="right" valign="top">ulint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRec__offsets.html#a091ab984d1f0f40c1ab2e9d32e3a5c6a">m_preallocated_buffer</a> [<a class="el" href="rec_8h.html#a643331b3c693c488a44fff722cf1d056">REC_OFFS_NORMAL_SIZE</a>]</td></tr>
<tr class="memdesc:a091ab984d1f0f40c1ab2e9d32e3a5c6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer with size large enough to handle common cases without having to use heap.  <a href="#a091ab984d1f0f40c1ab2e9d32e3a5c6a">More...</a><br /></td></tr>
<tr class="separator:a091ab984d1f0f40c1ab2e9d32e3a5c6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a305029c951869ab4b78d2b6b5044ffca"><td class="memItemLeft" align="right" valign="top">ulint *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRec__offsets.html#a305029c951869ab4b78d2b6b5044ffca">m_offsets</a> {<a class="el" href="classRec__offsets.html#a091ab984d1f0f40c1ab2e9d32e3a5c6a">m_preallocated_buffer</a>}</td></tr>
<tr class="separator:a305029c951869ab4b78d2b6b5044ffca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_methods_classut_1_1Non__copyable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classut_1_1Non__copyable')"><img src="closed.png" alt="-"/>&#160;Private Member Functions inherited from <a class="el" href="classut_1_1Non__copyable.html">ut::Non_copyable</a></td></tr>
<tr class="memitem:a62c6c17da6d0f846c214cd7c92363af0 inherit pub_methods_classut_1_1Non__copyable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classut_1_1Non__copyable.html#a62c6c17da6d0f846c214cd7c92363af0">Non_copyable</a> (const <a class="el" href="classut_1_1Non__copyable.html">Non_copyable</a> &amp;)=delete</td></tr>
<tr class="separator:a62c6c17da6d0f846c214cd7c92363af0 inherit pub_methods_classut_1_1Non__copyable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf19630c386efe5b9d6a0524432e9d25 inherit pub_methods_classut_1_1Non__copyable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classut_1_1Non__copyable.html">Non_copyable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classut_1_1Non__copyable.html#aaf19630c386efe5b9d6a0524432e9d25">operator=</a> (const <a class="el" href="classut_1_1Non__copyable.html">Non_copyable</a> &amp;)=delete</td></tr>
<tr class="separator:aaf19630c386efe5b9d6a0524432e9d25 inherit pub_methods_classut_1_1Non__copyable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72c01a3115f65c1938c2f3718cf7000 inherit pub_methods_classut_1_1Non__copyable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classut_1_1Non__copyable.html#ad72c01a3115f65c1938c2f3718cf7000">Non_copyable</a> ()=default</td></tr>
<tr class="separator:ad72c01a3115f65c1938c2f3718cf7000 inherit pub_methods_classut_1_1Non__copyable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f697530467938f341c620c7d05d030 inherit pub_methods_classut_1_1Non__copyable"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classut_1_1Non__copyable.html#a77f697530467938f341c620c7d05d030">~Non_copyable</a> ()=default</td></tr>
<tr class="separator:a77f697530467938f341c620c7d05d030 inherit pub_methods_classut_1_1Non__copyable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A helper RAII wrapper for otherwise difficult to use sequence of: </p>
<p>ulint offsets_[REC_OFFS_NORMAL_SIZE]; rec_offs_init(offsets_); mem_heap_t *heap = nullptr;</p>
<p>const ulint *offsets = rec_get_offsets(rec, index, offsets_, ULINT_UNDEFINED, &amp;heap);</p>
<p>DO_SOMETHING(offsets);</p>
<p>if (heap != nullptr) { mem_heap_free(heap); }</p>
<p>With this helper you can simply do:</p>
<p>DO_SOMETHING(Rec_offsets().compute(rec,index));</p>
<p>And if you need to reuse the memory allocated offsets several times you can: Rec_offsets offsets; for(rec: recs) DO_SOMTHING(offsets.compute(rec,index)) </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1278badb7d6d7840675a8aa09ba79814"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1278badb7d6d7840675a8aa09ba79814">&#9670;&nbsp;</a></span>Rec_offsets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Rec_offsets::Rec_offsets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepares offsets to initially point to the fixed-size buffer, and marks the memory as allocated, but uninitialized. </p>
<p>You first need to call compute() to use it </p>

</div>
</div>
<a id="a115df7e92a7b8d0aedc5a8d946feb5c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a115df7e92a7b8d0aedc5a8d946feb5c5">&#9670;&nbsp;</a></span>~Rec_offsets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Rec_offsets::~Rec_offsets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deallocated dynamically allocated memory, if any. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad24afd2e3014b9c7397e7fcc3f324167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24afd2e3014b9c7397e7fcc3f324167">&#9670;&nbsp;</a></span>compute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const ulint* Rec_offsets::compute </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rem0types_8h.html#a92caeffe2dc2fbe825a54aef9a163435">rec_t</a> *&#160;</td>
          <td class="paramname"><em>rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdict__index__t.html">dict_index_t</a> *&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes offsets for given record. </p>
<p>Returned array is owned by this instance. You can use its value as long as this object does not go out of scope (which can free the buffer), and you don't call compute() again (which can overwrite the offsets). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rec</td><td>The record for which you want to compute the offsets </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>The index which contains the record </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to offsets array owned by this instance. Valid till next call to compute() or end of this instance lifetime. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5377d83ce4b7b6c7689d16dff759353c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5377d83ce4b7b6c7689d16dff759353c">&#9670;&nbsp;</a></span>m_heap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mem0mem_8h.html#a29a10a74bdb0acc8a530dd6ec3c8538a">mem_heap_t</a>* Rec_offsets::m_heap {<a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to heap used by rec_get_offsets(). </p>
<p>Initially nullptr. If row is really big, rec_get_offsets() may need to allocate new buffer for offsets. At, first, when heap is null, rec_get_offsets() will create new heap, and pass it back via reference. On subsequent calls, we will pass this heap, so it is reused if needed. Therefore all allocated buffers are in this heap, if it is not nullptr </p>

</div>
</div>
<a id="a305029c951869ab4b78d2b6b5044ffca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a305029c951869ab4b78d2b6b5044ffca">&#9670;&nbsp;</a></span>m_offsets</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ulint* Rec_offsets::m_offsets {<a class="el" href="classRec__offsets.html#a091ab984d1f0f40c1ab2e9d32e3a5c6a">m_preallocated_buffer</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a091ab984d1f0f40c1ab2e9d32e3a5c6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a091ab984d1f0f40c1ab2e9d32e3a5c6a">&#9670;&nbsp;</a></span>m_preallocated_buffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ulint Rec_offsets::m_preallocated_buffer[<a class="el" href="rec_8h.html#a643331b3c693c488a44fff722cf1d056">REC_OFFS_NORMAL_SIZE</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer with size large enough to handle common cases without having to use heap. </p>
<p>This is the initial value of m_offsets. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>storage/innobase/include/<a class="el" href="rem0rec_8h_source.html">rem0rec.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classRec__offsets.html">Rec_offsets</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
