<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: storage/innobase/include/trx0rec.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('trx0rec_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">trx0rec.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="trx0rec_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*****************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">Copyright (c) 1996, 2020, Oracle and/or its affiliates.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">This program is free software; you can redistribute it and/or modify it under</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">the terms of the GNU General Public License, version 2.0, as published by the</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">Free Software Foundation.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">This program is also distributed with certain software (including but not</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">limited to OpenSSL) that is licensed under separate terms, as designated in a</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">particular file or component or in included license documentation. The authors</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">of MySQL hereby grant you an additional permission to link the program and</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">your derivative works with the separately licensed software that they have</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">included with MySQL.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">FOR A PARTICULAR PURPOSE. See the GNU General Public License, version 2.0,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">for more details.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">You should have received a copy of the GNU General Public License along with</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">this program; if not, write to the Free Software Foundation, Inc.,</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">*****************************************************************************/</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/** @file include/trx0rec.h</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> Transaction undo log record</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> Created 3/26/1996 Heikki Tuuri</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> *******************************************************/</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#ifndef trx0rec_h</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#define trx0rec_h</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;univ.i&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="data0data_8h.html">data0data.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="dict0types_8h.html">dict0types.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lob0undo_8h.html">lob0undo.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mtr0mtr_8h.html">mtr0mtr.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="page0types_8h.html">page0types.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rem0types_8h.html">rem0types.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="row0log_8h.html">row0log.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="row0types_8h.html">row0types.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="trx0types_8h.html">trx0types.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#ifndef UNIV_HOTBACKUP</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="que0types_8h.html">que0types.h</a>&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/** Copies the undo record to the heap.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">@param[in]      undo_page       Undo Page</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">@param[in]      undo_offset     offset of the undo record in the page</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">@param[in]      heap            heap where copied</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">@return copy of undo log record */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;UNIV_INLINE</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<a class="code" href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">trx_undo_rec_t</a> *<a class="code" href="trx0rec_8h.html#af31abdf6a056c7fac0a3e2b4cc16929b">trx_undo_rec_copy</a>(<span class="keyword">const</span> <a class="code" href="page0types_8h.html#ac84908ddc97c37107986280aa8f37897">page_t</a> *undo_page, uint32_t undo_offset,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                  <a class="code" href="structmem__block__info__t.html">mem_heap_t</a> *heap);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">/** Reads the undo log record type.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> @return record type */</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;UNIV_INLINE</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;ulint <a class="code" href="trx0rec_8h.html#ac16587ee578cdb99b41525cd4a9e3658">trx_undo_rec_get_type</a>(</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">const</span> <a class="code" href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">trx_undo_rec_t</a> *undo_rec); <span class="comment">/*!&lt; in: undo log record */</span><span class="comment"></span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/** Reads from an undo log record the record compiler info.</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> @return compiler info */</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;UNIV_INLINE</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;ulint <a class="code" href="trx0rec_8h.html#a0f620ad159449f5ef50b0896f129b577">trx_undo_rec_get_cmpl_info</a>(</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">const</span> <a class="code" href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">trx_undo_rec_t</a> *undo_rec); <span class="comment">/*!&lt; in: undo log record */</span><span class="comment"></span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">/** Returns TRUE if an undo log record contains an extern storage field.</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> @return true if extern */</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;UNIV_INLINE</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;ibool <a class="code" href="trx0rec_8h.html#a1aebcafefa1ee5c243da7e9249c9f5e2">trx_undo_rec_get_extern_storage</a>(</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keyword">const</span> <a class="code" href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">trx_undo_rec_t</a> *undo_rec); <span class="comment">/*!&lt; in: undo log record */</span><span class="comment"></span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">/** Reads the undo log record number.</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> @return undo no */</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;UNIV_INLINE</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<a class="code" href="trx0types_8h.html#a4661d2883c1cd5d8f1cfbd63b553f1bc">undo_no_t</a> <a class="code" href="trx0rec_8h.html#a06cc7356840b50f7c121dd50ecad82a2">trx_undo_rec_get_undo_no</a>(</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">const</span> <a class="code" href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">trx_undo_rec_t</a> *undo_rec); <span class="comment">/*!&lt; in: undo log record */</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/** Returns the start of the undo record data area. */</span></div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#aa33615de4352554c23bc129777776c50">   82</a></span>&#160;<span class="preprocessor">#define trx_undo_rec_get_ptr(undo_rec, undo_no) \</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">  ((undo_rec) + trx_undo_rec_get_offset(undo_no))</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/** Reads from an undo log record the table ID</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">@param[in]      undo_rec        Undo log record</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">@return the table ID */</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<a class="code" href="dict0types_8h.html#ac877e05c194a7c04fa5921c88cdcb1f7">table_id_t</a> <a class="code" href="trx0rec_8h.html#afabb59f72f20367f7d622b40ce1eda7e">trx_undo_rec_get_table_id</a>(<span class="keyword">const</span> <a class="code" href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">trx_undo_rec_t</a> *undo_rec)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    MY_ATTRIBUTE((warn_unused_result));</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">/** Builds a row reference from an undo log record.</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"> @return pointer to remaining part of undo record */</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="trx0rec_8h.html#af342f2995de54e084d2ea5e042f50c6c">trx_undo_rec_get_row_ref</a>(</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr,           <span class="comment">/*!&lt; in: remaining part of a copy of an undo log</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">                         record, at the start of the row reference;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">                         NOTE that this copy of the undo log record must</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">                         be preserved as long as the row reference is</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">                         used, as we do NOT copy the data in the</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">                         record! */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="structdict__index__t.html">dict_index_t</a> *<a class="code" href="mysql_8cc.html#adfa69ae672499b1037123a1f17c5552b">index</a>, <span class="comment">/*!&lt; in: clustered index */</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="structdtuple__t.html">dtuple_t</a> **ref,      <span class="comment">/*!&lt; out, own: row reference */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="structmem__block__info__t.html">mem_heap_t</a> *heap);   <span class="comment">/*!&lt; in: memory heap from which the memory</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">                         needed is allocated */</span><span class="comment"></span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">/** Reads from an undo log update record the system field values of the old</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> version.</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> @return remaining part of undo log record after reading these values */</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="trx0rec_8h.html#a324bbc5d0dd2ad6bcf2caf37ea2ef88a">trx_undo_update_rec_get_sys_cols</a>(</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr,      <span class="comment">/*!&lt; in: remaining part of undo</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">                          log record after reading</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">                          general parameters */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a> *trx_id,     <span class="comment">/*!&lt; out: trx id */</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="trx0types_8h.html#ad3ccac613ce33a8680d147c4a4f12e94">roll_ptr_t</a> *roll_ptr, <span class="comment">/*!&lt; out: roll ptr */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    ulint *info_bits);    <span class="comment">/*!&lt; out: info bits state */</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">struct </span><a class="code" href="structtype__cmpl__t.html">type_cmpl_t</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/** Builds an update vector based on a remaining part of an undo log record.</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> @return remaining part of the record, NULL if an error detected, which</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> means that the record is corrupted. */</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="trx0rec_8h.html#a302b5ca1f95234d5ad91b3d34227423e">trx_undo_update_rec_get_update</a>(</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr,            <span class="comment">/*!&lt; in: remaining part in update undo log</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">                                record, after reading the row reference</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">                                NOTE that this copy of the undo log record must</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">                                be preserved as long as the update vector is</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">                                used, as we do NOT copy the data in the</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">                                record! */</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keyword">const</span> <a class="code" href="structdict__index__t.html">dict_index_t</a> *<a class="code" href="mysql_8cc.html#adfa69ae672499b1037123a1f17c5552b">index</a>,  <span class="comment">/*!&lt; in: clustered index */</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    ulint <a class="code" href="namespacebinary__log_1_1transaction_1_1compression.html#a22a3b5d8096f4c73ced74c0b668df0be">type</a>,                 <span class="comment">/*!&lt; in: TRX_UNDO_UPD_EXIST_REC,</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">                                TRX_UNDO_UPD_DEL_REC, or</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">                                TRX_UNDO_DEL_MARK_REC; in the last case,</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">                                only trx id and roll ptr fields are added to</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">                                the update vector */</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a> trx_id,            <span class="comment">/*!&lt; in: transaction id from this undo record */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="trx0types_8h.html#ad3ccac613ce33a8680d147c4a4f12e94">roll_ptr_t</a> roll_ptr,        <span class="comment">/*!&lt; in: roll pointer from this undo record */</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    ulint info_bits,            <span class="comment">/*!&lt; in: info bits from this undo record */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="structtrx__t.html">trx_t</a> *trx,                 <span class="comment">/*!&lt; in: transaction */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="structmem__block__info__t.html">mem_heap_t</a> *heap,           <span class="comment">/*!&lt; in: memory heap from which the memory</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">                                needed is allocated */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="structupd__t.html">upd_t</a> **upd,                <span class="comment">/*!&lt; out, own: update vector */</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="structlob_1_1undo__vers__t.html">lob::undo_vers_t</a> *lob_undo, <span class="comment">/*!&lt; out: LOB undo information. */</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="structtype__cmpl__t.html">type_cmpl_t</a> &amp;type_cmpl);    <span class="comment">/*!&lt; out: type compilation info */</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/** Builds a partial row from an update undo log record, for purge.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> It contains the columns which occur as ordering in any index of the table.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> Any missing columns are indicated by col-&gt;mtype == DATA_MISSING.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> @return pointer to remaining part of undo record */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="trx0rec_8h.html#a59e51ec89401164642aa4bf9e329858d">trx_undo_rec_get_partial_row</a>(</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr,     <span class="comment">/*!&lt; in: remaining part in update undo log</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">                         record of a suitable type, at the start of</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">                         the stored index columns;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">                         NOTE that this copy of the undo log record must</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">                         be preserved as long as the partial row is</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">                         used, as we do NOT copy the data in the</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">                         record! */</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="structdict__index__t.html">dict_index_t</a> *<a class="code" href="mysql_8cc.html#adfa69ae672499b1037123a1f17c5552b">index</a>, <span class="comment">/*!&lt; in: clustered index */</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="structdtuple__t.html">dtuple_t</a> **row,      <span class="comment">/*!&lt; out, own: partial row */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    ibool ignore_prefix, <span class="comment">/*!&lt; in: flag to indicate if we</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">                  expect blob prefixes in undo. Used</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">                  only in the assertion. */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="structmem__block__info__t.html">mem_heap_t</a> *heap)    <span class="comment">/*!&lt; in: memory heap from which the memory</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">                         needed is allocated */</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    MY_ATTRIBUTE((warn_unused_result));<span class="comment"></span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">/** Writes information to an undo log about an insert, update, or a delete</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> marking of a clustered index record. This information is used in a rollback of</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> the transaction and in consistent reads that must look to the history of this</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> transaction.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> @return DB_SUCCESS or error code */</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<a class="code" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> <a class="code" href="trx0rec_8h.html#a9b4faef28fe9a4375884b236e33d740e">trx_undo_report_row_operation</a>(</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    ulint <a class="code" href="hp__test1_8cc.html#a6eec09a91807e20d7b3d6ef3da594067">flags</a>,                 <span class="comment">/*!&lt; in: if BTR_NO_UNDO_LOG_FLAG bit is</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">                                 set, does nothing */</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    ulint op_type,               <span class="comment">/*!&lt; in: TRX_UNDO_INSERT_OP or</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">                                 TRX_UNDO_MODIFY_OP */</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="structque__thr__t.html">que_thr_t</a> *thr,              <span class="comment">/*!&lt; in: query thread */</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="structdict__index__t.html">dict_index_t</a> *<a class="code" href="mysql_8cc.html#adfa69ae672499b1037123a1f17c5552b">index</a>,         <span class="comment">/*!&lt; in: clustered index */</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keyword">const</span> <a class="code" href="structdtuple__t.html">dtuple_t</a> *clust_entry, <span class="comment">/*!&lt; in: in the case of an insert,</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">                                 index entry to insert into the</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">                                 clustered index, otherwise NULL */</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keyword">const</span> <a class="code" href="structupd__t.html">upd_t</a> *<a class="code" href="myisamlog_8cc.html#a63c3b620cc1cd0b4a2850c8d9804fde2">update</a>,         <span class="comment">/*!&lt; in: in the case of an update,</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">                                 the update vector, otherwise NULL */</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    ulint <a class="code" href="structtype__cmpl__t.html#a9568a18de326cd40fea0883ae56a6365">cmpl_info</a>,             <span class="comment">/*!&lt; in: compiler info on secondary</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">                                 index updates */</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keyword">const</span> <a class="code" href="rem0types_8h.html#a92caeffe2dc2fbe825a54aef9a163435">rec_t</a> *rec,            <span class="comment">/*!&lt; in: case of an update or delete</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">                                 marking, the record in the clustered</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">                                 index, otherwise NULL */</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keyword">const</span> ulint *offsets,        <span class="comment">/*!&lt; in: rec_get_offsets(rec) */</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="trx0types_8h.html#ad3ccac613ce33a8680d147c4a4f12e94">roll_ptr_t</a> *roll_ptr)        <span class="comment">/*!&lt; out: rollback pointer to the</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">                                 inserted undo log record,</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">                                 0 if BTR_NO_UNDO_LOG</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">                                 flag was specified */</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    MY_ATTRIBUTE((warn_unused_result));</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/** status bit used for trx_undo_prev_version_build() */</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/** TRX_UNDO_PREV_IN_PURGE tells trx_undo_prev_version_build() that it</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">is being called purge view and we would like to get the purge record</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">even it is in the purge view (in normal case, it will return without</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">fetching the purge record */</span></div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#adaee338d1ea2904c4a781ea0499d78d9">  198</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_PREV_IN_PURGE 0x1</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">/** This tells trx_undo_prev_version_build() to fetch the old value in</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">the undo log (which is the after image for an update) */</span></div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#a30c05f98e384bce86a905b7f694f3cca">  202</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_GET_OLD_V_VALUE 0x2</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">/** Build a previous version of a clustered index record. The caller must hold</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">a latch on the index page of the clustered index record.</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">If the vrow passed to this function is not null, then this function will store</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">information about virtual columns from the requested version in vrow, unless the</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">change did not affect any secondary index nor ordering field of clustered index</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">(the change has UPD_NODE_NO_ORD_CHANGE flag) in which case the requested</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">information can not be reconstructed from undo log, and the caller may assume</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">that the (virtual) columns of secondary index have the same values they have in</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">the more recent version (the one `rec` comes from).</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">Equivalently, if the vrow is not returned, it is either because it was not</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">requested, or not available due to UPD_NODE_NO_ORD_CHANGE.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">Obviously vrow is also not set in case rec is the oldest version in history,</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">in which case we also set old_vers to NULL.</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">@param[in]      index_rec       clustered index record in the index tree</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">@param[in]      index_mtr       mtr which contains the latch to index_rec page</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">                                and purge_view</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">@param[in]      rec             version of a clustered index record</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">@param[in]      index           clustered index</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">@param[in,out]  offsets         rec_get_offsets(rec, index)</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">@param[in]      heap            memory heap from which the memory needed is</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">                                allocated</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">@param[out]     old_vers        previous version, or NULL if rec is the first</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">                                inserted version, or if history data has been</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">                                deleted</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">@param[in]      v_heap          memory heap used to create vrow dtuple if it is</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">                                not yet created. This heap diffs from &quot;heap&quot;</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">                                above in that it could be</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">                                prebuilt-&gt;old_vers_heap for selection</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">@param[out]     vrow            virtual column info, if any</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">@param[in]      v_status        status determine if it is going into this</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">                                function by purge thread or not. And if we read</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">                                &quot;after image&quot; of undo log has been rebuilt</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">@param[in]      lob_undo        LOB undo information.</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">@retval true if previous version was built, or if it was an insert or the table</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">has been rebuilt</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">@retval false if the previous version is earlier than purge_view, or being</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">purged, which means that it may have been removed */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="trx0rec_8h.html#a0b355a2322627ee073a9585ca24fb7d1">trx_undo_prev_version_build</a>(<span class="keyword">const</span> <a class="code" href="rem0types_8h.html#a92caeffe2dc2fbe825a54aef9a163435">rec_t</a> *index_rec, <a class="code" href="structmtr__t.html">mtr_t</a> *index_mtr,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="rem0types_8h.html#a92caeffe2dc2fbe825a54aef9a163435">rec_t</a> *rec, <span class="keyword">const</span> <a class="code" href="structdict__index__t.html">dict_index_t</a> *<a class="code" href="mysql_8cc.html#adfa69ae672499b1037123a1f17c5552b">index</a>,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                                 ulint *offsets, <a class="code" href="structmem__block__info__t.html">mem_heap_t</a> *heap,</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                 <a class="code" href="rem0types_8h.html#a92caeffe2dc2fbe825a54aef9a163435">rec_t</a> **old_vers, <a class="code" href="structmem__block__info__t.html">mem_heap_t</a> *v_heap,</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="structdtuple__t.html">dtuple_t</a> **vrow, ulint v_status,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                 <a class="code" href="structlob_1_1undo__vers__t.html">lob::undo_vers_t</a> *lob_undo);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !UNIV_HOTBACKUP */</span><span class="preprocessor"></span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">/** Parses a redo log record of adding an undo log record.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"> @return end of log record or NULL */</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="trx0rec_8h.html#a21a41486ecad84531c6f852c73288ce4">trx_undo_parse_add_undo_rec</a>(<a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr,     <span class="comment">/*!&lt; in: buffer */</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                  <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *end_ptr, <span class="comment">/*!&lt; in: buffer end */</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                  <a class="code" href="page0types_8h.html#ac84908ddc97c37107986280aa8f37897">page_t</a> *<a class="code" href="ctype-mb_8cc.html#adf406aa6822ceac22d62ef63cc2879c0">page</a>); <span class="comment">/*!&lt; in: page or NULL */</span><span class="comment"></span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">/** Parses a redo log record of erasing of an undo page end.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> @return end of log record or NULL */</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="trx0rec_8h.html#a9356d49e12323fc80c96cd83dd2cf938">trx_undo_parse_erase_page_end</a>(<a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr,     <span class="comment">/*!&lt; in: buffer */</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                    <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *end_ptr, <span class="comment">/*!&lt; in: buffer end */</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                    <a class="code" href="page0types_8h.html#ac84908ddc97c37107986280aa8f37897">page_t</a> *<a class="code" href="ctype-mb_8cc.html#adf406aa6822ceac22d62ef63cc2879c0">page</a>,  <span class="comment">/*!&lt; in: page or NULL */</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                    <a class="code" href="structmtr__t.html">mtr_t</a> *mtr);   <span class="comment">/*!&lt; in: mtr or NULL */</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">/** Read from an undo log record a non-virtual column value.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">@param[in,out]  ptr             pointer to remaining part of the undo record</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">@param[in,out]  field           stored field</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">@param[in,out]  len             length of the field, or UNIV_SQL_NULL</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">@param[in,out]  orig_len        original length of the locally stored part</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">of an externally stored column, or 0</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">@return remaining part of undo log record after reading these values */</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="trx0rec_8h.html#a51f0a7c02bc5673d59ebec7ceaad7862">trx_undo_rec_get_col_val</a>(<span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr, <span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> **field, ulint *len,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                               ulint *orig_len);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">/** Read virtual column value from undo log</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">@param[in]      table           the table</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">@param[in]      ptr             undo log pointer</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">@param[in,out]  row             the dtuple to fill</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">@param[in]      in_purge        called by purge thread</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">@param[in]      online          true if this is from online DDL log</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">@param[in]      col_map         online rebuild column map</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">@param[in,out]  heap            memory heap to keep value when necessary */</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordtype">void</span> <a class="code" href="trx0rec_8h.html#a343761be8957a62e701c95166e2081a1">trx_undo_read_v_cols</a>(<span class="keyword">const</span> <a class="code" href="structdict__table__t.html">dict_table_t</a> *table, <span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr,</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                          <span class="keyword">const</span> <a class="code" href="structdtuple__t.html">dtuple_t</a> *row, <span class="keywordtype">bool</span> in_purge, <span class="keywordtype">bool</span> online,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                          <span class="keyword">const</span> ulint *col_map, <a class="code" href="structmem__block__info__t.html">mem_heap_t</a> *heap);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">/** Read virtual column index from undo log or online log if the log</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">contains such info, and in the undo log case, verify the column is</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">still indexed, and output its position</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">@param[in]      table           the table</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">@param[in]      ptr             undo log pointer</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">@param[in]      first_v_col     if this is the first virtual column, which</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">                                has the version marker</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">@param[in,out]  is_undo_log     this function is used to parse both undo log,</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">                                and online log for virtual columns. So</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">                                check to see if this is undo log. When</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">                                first_v_col is true, is_undo_log is output,</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">                                when first_v_col is false, is_undo_log is input</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">@param[in,out]  field_no        the column number</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">@return remaining part of undo log record after reading these values */</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="trx0rec_8h.html#afc4a542764a35a68b6e6b7f056aa0e60">trx_undo_read_v_idx</a>(<span class="keyword">const</span> <a class="code" href="structdict__table__t.html">dict_table_t</a> *table, <span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr,</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                <span class="keywordtype">bool</span> first_v_col, <span class="keywordtype">bool</span> *is_undo_log,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                ulint *field_no);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#ifndef UNIV_HOTBACKUP</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/* Types of an undo log record: these have to be smaller than 16, as the</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">compilation info multiplied by 16 is ORed to this value in an undo log</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">record */</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#a68638a104879e7d71a298f105e931a12">  307</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_INSERT_REC 11 </span><span class="comment">/* fresh insert into clustered index */</span><span class="preprocessor"></span></div><div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#ab3bb6122832fe57dc4a20e56484d7e9f">  308</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_UPD_EXIST_REC        \</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">  12 </span><span class="comment">/* update of a non-delete-marked \</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">     record */</span><span class="preprocessor"></span></div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#adad68e3a0bdf312e5ac4231cae931f7c">  311</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_UPD_DEL_REC                \</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">  13 </span><span class="comment">/* update of a delete marked record to \</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">     a not delete marked record; also the   \</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">     fields of the record can change */</span><span class="preprocessor"></span></div><div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#a81d03d47210ccfb93579a4fb30bbbee1">  315</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_DEL_MARK_REC              \</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">  14 </span><span class="comment">/* delete marking of a record; fields \</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">     do not change */</span><span class="preprocessor"></span></div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#ac7e3157451dbb20e57c176474aba8196">  318</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_CMPL_INFO_MULT           \</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor">  16 </span><span class="comment">/* compilation info is multiplied by \</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">     this and ORed to the type above */</span><span class="preprocessor"></span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#aa1034d3bdf5448388235380b1876be79">  322</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_MODIFY_BLOB              \</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">  64 </span><span class="comment">/* If this bit is set in type_cmpl,  \</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">     then the undo log record has support \</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">     for partial update of BLOBs. Also to \</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">     make the undo log format extensible, \</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">     introducing a new flag next to the   \</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">     type_cmpl flag. */</span><span class="preprocessor"></span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#a80d5348d1a573af4aef6f3d08eadaeba">  330</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_UPD_EXTERN                \</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="preprocessor">  128 </span><span class="comment">/* This bit can be ORed to type_cmpl \</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">      to denote that we updated external   \</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">      storage fields: used by purge to     \</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">      free the external storage */</span><span class="preprocessor"></span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">/* Operation type flags used in trx_undo_report_row_operation */</span></div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#a89624e3de13054fc0c468b458bb892b1">  337</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_INSERT_OP 1</span></div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="trx0rec_8h.html#a0c5248a5e8a2db6408ecd658de204eb9">  338</a></span>&#160;<span class="preprocessor">#define TRX_UNDO_MODIFY_OP 2</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">/** The type and compilation info flag in the undo record for update.</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">For easier understanding let the 8 bits be numbered as</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">7, 6, 5, 4, 3, 2, 1, 0. */</span></div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="structtype__cmpl__t.html">  343</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structtype__cmpl__t.html">type_cmpl_t</a> {</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="structtype__cmpl__t.html#ac47c10f0b88cbed7befd28b8660cc850">  344</a></span>&#160;  <a class="code" href="structtype__cmpl__t.html#ac47c10f0b88cbed7befd28b8660cc850">type_cmpl_t</a>() : <a class="code" href="structtype__cmpl__t.html#a7a998851fc4c89590e2890ebf6607daf">m_flag</a>(0) {}</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="structtype__cmpl__t.html#a901dd6a6274b36c029b40074411aecde">  346</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="structtype__cmpl__t.html#a901dd6a6274b36c029b40074411aecde">read</a>(<span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="structtype__cmpl__t.html#a7a998851fc4c89590e2890ebf6607daf">m_flag</a> = <a class="code" href="mach0data_8h.html#acf88b63514b5f2c9070493440e4e22b5">mach_read_from_1</a>(ptr);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">return</span> (ptr + 1);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="structtype__cmpl__t.html#a4a80bc1b290a9a23fe85ffe6ef80d8ac">  351</a></span>&#160;  ulint <a class="code" href="structtype__cmpl__t.html#a4a80bc1b290a9a23fe85ffe6ef80d8ac">type_info</a>() {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">/* Get 0-3 */</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="structtype__cmpl__t.html#a7a998851fc4c89590e2890ebf6607daf">m_flag</a> &amp; 0x0F);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="structtype__cmpl__t.html#a9568a18de326cd40fea0883ae56a6365">  356</a></span>&#160;  ulint <a class="code" href="structtype__cmpl__t.html#a9568a18de326cd40fea0883ae56a6365">cmpl_info</a>() {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">/* Get bits 5 and 4 */</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span> ((<a class="code" href="structtype__cmpl__t.html#a7a998851fc4c89590e2890ebf6607daf">m_flag</a> &gt;&gt; 4) &amp; 0x03);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">  /** Is an LOB updated by this update operation.</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">  @return true if LOB is updated, false otherwise. */</span></div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="structtype__cmpl__t.html#aa6cdeb106ea014797941b93d4ab8ae62">  363</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structtype__cmpl__t.html#aa6cdeb106ea014797941b93d4ab8ae62">is_lob_updated</a>() {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">/* Check if bit 7 is set. */</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="structtype__cmpl__t.html#a7a998851fc4c89590e2890ebf6607daf">m_flag</a> &amp; <a class="code" href="trx0rec_8h.html#a80d5348d1a573af4aef6f3d08eadaeba">TRX_UNDO_UPD_EXTERN</a>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">  /** Does the undo log record contains information about LOB partial</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">  update vector.</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">  @return true if undo contains LOB update info. */</span></div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="structtype__cmpl__t.html#aac297bb42d1d608aa065064a7b5fe99a">  371</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structtype__cmpl__t.html#aac297bb42d1d608aa065064a7b5fe99a">is_lob_undo</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">/* Check if bit 6 is set. */</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="structtype__cmpl__t.html#a7a998851fc4c89590e2890ebf6607daf">m_flag</a> &amp; <a class="code" href="trx0rec_8h.html#aa1034d3bdf5448388235380b1876be79">TRX_UNDO_MODIFY_BLOB</a>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="structtype__cmpl__t.html#a7a998851fc4c89590e2890ebf6607daf">  377</a></span>&#160;  uint8_t <a class="code" href="structtype__cmpl__t.html#a7a998851fc4c89590e2890ebf6607daf">m_flag</a>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;};</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">/** Reads from an undo log record the general parameters.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"> @return remaining part of undo log record after reading these values */</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="trx0rec_8h.html#a2322117e1e3b2610ff39a17e60f1b8e3">trx_undo_rec_get_pars</a>(</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">trx_undo_rec_t</a> *undo_rec, <span class="comment">/*!&lt; in: undo log record */</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    ulint *<a class="code" href="namespacebinary__log_1_1transaction_1_1compression.html#a22a3b5d8096f4c73ced74c0b668df0be">type</a>,              <span class="comment">/*!&lt; out: undo record type:</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">                              TRX_UNDO_INSERT_REC, ... */</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    ulint *<a class="code" href="structtype__cmpl__t.html#a9568a18de326cd40fea0883ae56a6365">cmpl_info</a>,         <span class="comment">/*!&lt; out: compiler info, relevant only</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">                              for update type records */</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordtype">bool</span> *updated_extern,     <span class="comment">/*!&lt; out: true if we updated an</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">                              externally stored fild */</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="trx0types_8h.html#a4661d2883c1cd5d8f1cfbd63b553f1bc">undo_no_t</a> *undo_no,       <span class="comment">/*!&lt; out: undo log record number */</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="dict0types_8h.html#ac877e05c194a7c04fa5921c88cdcb1f7">table_id_t</a> *table_id,     <span class="comment">/*!&lt; out: table id */</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="structtype__cmpl__t.html">type_cmpl_t</a> &amp;type_cmpl);  <span class="comment">/*!&lt; out: type compilation info. */</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">/** Get the max free space of undo log by assuming it&#39;s a fresh new page</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">and the free space doesn&#39;t count for the undo log header too. */</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="trx0rec_8h.html#aff965f452d447f88d7d5cfb7f042bd58">trx_undo_max_free_space</a>();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">/** Decide if the following undo log record is a multi-value virtual column</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">@param[in]     undo_rec        undo log record</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">@return true if this is a multi-value virtual column log, otherwise false */</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="trx0rec_8h.html#afddad8a35a6f71bb6dc604d772b1832b">trx_undo_rec_is_multi_value</a>(<span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *undo_rec);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">/** Read from an undo log record of a multi-value virtual column.</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">@param[in]      ptr     pointer to remaining part of the undo record</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">@param[in,out]  field   stored field, nullptr if the col is no longer</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">                        indexed or existing, in the latter case,</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">                        this function will only skip the log</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">@param[in,out]  heap    memory heap</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">@return remaining part of undo log record after reading these values */</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="trx0rec_8h.html#a1043e8db416626276800c8da5637ab8e">trx_undo_rec_get_multi_value</a>(<span class="keyword">const</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *ptr, <a class="code" href="structdfield__t.html">dfield_t</a> *field,</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                         <a class="code" href="structmem__block__info__t.html">mem_heap_t</a> *heap);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#include &quot;trx0rec.ic&quot;</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !UNIV_HOTBACKUP */</span><span class="preprocessor"></span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* trx0rec_h */</span><span class="preprocessor"></span></div><div class="ttc" id="rem0types_8h_html"><div class="ttname"><a href="rem0types_8h.html">rem0types.h</a></div><div class="ttdoc">Record manager global types. </div></div>
<div class="ttc" id="trx0types_8h_html_a0b302ec5d015d6388eb98277b58048c7"><div class="ttname"><a href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">trx_undo_rec_t</a></div><div class="ttdeci">byte trx_undo_rec_t</div><div class="ttdoc">Undo log record. </div><div class="ttdef"><b>Definition:</b> trx0types.h:173</div></div>
<div class="ttc" id="structtype__cmpl__t_html_ac47c10f0b88cbed7befd28b8660cc850"><div class="ttname"><a href="structtype__cmpl__t.html#ac47c10f0b88cbed7befd28b8660cc850">type_cmpl_t::type_cmpl_t</a></div><div class="ttdeci">type_cmpl_t()</div><div class="ttdef"><b>Definition:</b> trx0rec.h:344</div></div>
<div class="ttc" id="trx0rec_8h_html_af31abdf6a056c7fac0a3e2b4cc16929b"><div class="ttname"><a href="trx0rec_8h.html#af31abdf6a056c7fac0a3e2b4cc16929b">trx_undo_rec_copy</a></div><div class="ttdeci">UNIV_INLINE trx_undo_rec_t * trx_undo_rec_copy(const page_t *undo_page, uint32_t undo_offset, mem_heap_t *heap)</div><div class="ttdoc">Copies the undo record to the heap. </div></div>
<div class="ttc" id="trx0types_8h_html_ad3ccac613ce33a8680d147c4a4f12e94"><div class="ttname"><a href="trx0types_8h.html#ad3ccac613ce33a8680d147c4a4f12e94">roll_ptr_t</a></div><div class="ttdeci">ib_id_t roll_ptr_t</div><div class="ttdoc">Rollback pointer (DB_ROLL_PTR, DATA_ROLL_PTR) </div><div class="ttdef"><b>Definition:</b> trx0types.h:146</div></div>
<div class="ttc" id="lob0undo_8h_html"><div class="ttname"><a href="lob0undo_8h.html">lob0undo.h</a></div><div class="ttdoc">Undo logging small changes to BLOBs. </div></div>
<div class="ttc" id="trx0rec_8h_html_ac16587ee578cdb99b41525cd4a9e3658"><div class="ttname"><a href="trx0rec_8h.html#ac16587ee578cdb99b41525cd4a9e3658">trx_undo_rec_get_type</a></div><div class="ttdeci">UNIV_INLINE ulint trx_undo_rec_get_type(const trx_undo_rec_t *undo_rec)</div><div class="ttdoc">Reads the undo log record type. </div></div>
<div class="ttc" id="structtrx__t_html"><div class="ttname"><a href="structtrx__t.html">trx_t</a></div><div class="ttdef"><b>Definition:</b> trx0trx.h:833</div></div>
<div class="ttc" id="trx0rec_8h_html_a59e51ec89401164642aa4bf9e329858d"><div class="ttname"><a href="trx0rec_8h.html#a59e51ec89401164642aa4bf9e329858d">trx_undo_rec_get_partial_row</a></div><div class="ttdeci">byte * trx_undo_rec_get_partial_row(const byte *ptr, dict_index_t *index, dtuple_t **row, ibool ignore_prefix, mem_heap_t *heap)</div><div class="ttdoc">Builds a partial row from an update undo log record, for purge. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:1937</div></div>
<div class="ttc" id="trx0rec_8h_html_a21a41486ecad84531c6f852c73288ce4"><div class="ttname"><a href="trx0rec_8h.html#a21a41486ecad84531c6f852c73288ce4">trx_undo_parse_add_undo_rec</a></div><div class="ttdeci">byte * trx_undo_parse_add_undo_rec(byte *ptr, byte *end_ptr, page_t *page)</div><div class="ttdoc">Parses a redo log record of adding an undo log record. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:102</div></div>
<div class="ttc" id="trx0rec_8h_html_af342f2995de54e084d2ea5e042f50c6c"><div class="ttname"><a href="trx0rec_8h.html#af342f2995de54e084d2ea5e042f50c6c">trx_undo_rec_get_row_ref</a></div><div class="ttdeci">byte * trx_undo_rec_get_row_ref(byte *ptr, dict_index_t *index, dtuple_t **ref, mem_heap_t *heap)</div><div class="ttdoc">Builds a row reference from an undo log record. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:678</div></div>
<div class="ttc" id="structtype__cmpl__t_html_a9568a18de326cd40fea0883ae56a6365"><div class="ttname"><a href="structtype__cmpl__t.html#a9568a18de326cd40fea0883ae56a6365">type_cmpl_t::cmpl_info</a></div><div class="ttdeci">ulint cmpl_info()</div><div class="ttdef"><b>Definition:</b> trx0rec.h:356</div></div>
<div class="ttc" id="trx0rec_8h_html_a9b4faef28fe9a4375884b236e33d740e"><div class="ttname"><a href="trx0rec_8h.html#a9b4faef28fe9a4375884b236e33d740e">trx_undo_report_row_operation</a></div><div class="ttdeci">dberr_t trx_undo_report_row_operation(ulint flags, ulint op_type, que_thr_t *thr, dict_index_t *index, const dtuple_t *clust_entry, const upd_t *update, ulint cmpl_info, const rec_t *rec, const ulint *offsets, roll_ptr_t *roll_ptr)</div><div class="ttdoc">Writes information to an undo log about an insert, update, or a delete marking of a clustered index r...</div><div class="ttdef"><b>Definition:</b> trx0rec.cc:2128</div></div>
<div class="ttc" id="trx0rec_8h_html_a343761be8957a62e701c95166e2081a1"><div class="ttname"><a href="trx0rec_8h.html#a343761be8957a62e701c95166e2081a1">trx_undo_read_v_cols</a></div><div class="ttdeci">void trx_undo_read_v_cols(const dict_table_t *table, const byte *ptr, const dtuple_t *row, bool in_purge, bool online, const ulint *col_map, mem_heap_t *heap)</div><div class="ttdoc">Read virtual column value from undo log. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:2674</div></div>
<div class="ttc" id="structdict__table__t_html"><div class="ttname"><a href="structdict__table__t.html">dict_table_t</a></div><div class="ttdoc">Data structure for a database table. </div><div class="ttdef"><b>Definition:</b> dict0mem.h:1532</div></div>
<div class="ttc" id="mach0data_8h_html_acf88b63514b5f2c9070493440e4e22b5"><div class="ttname"><a href="mach0data_8h.html#acf88b63514b5f2c9070493440e4e22b5">mach_read_from_1</a></div><div class="ttdeci">UNIV_INLINE uint8_t mach_read_from_1(const byte *b)</div><div class="ttdoc">The following function is used to fetch data from one byte. </div></div>
<div class="ttc" id="trx0rec_8h_html_a51f0a7c02bc5673d59ebec7ceaad7862"><div class="ttname"><a href="trx0rec_8h.html#a51f0a7c02bc5673d59ebec7ceaad7862">trx_undo_rec_get_col_val</a></div><div class="ttdeci">byte * trx_undo_rec_get_col_val(const byte *ptr, const byte **field, ulint *len, ulint *orig_len)</div><div class="ttdoc">Read from an undo log record a non-virtual column value. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:636</div></div>
<div class="ttc" id="page0types_8h_html"><div class="ttname"><a href="page0types_8h.html">page0types.h</a></div><div class="ttdoc">Index page routines. </div></div>
<div class="ttc" id="trx0rec_8h_html_a2322117e1e3b2610ff39a17e60f1b8e3"><div class="ttname"><a href="trx0rec_8h.html#a2322117e1e3b2610ff39a17e60f1b8e3">trx_undo_rec_get_pars</a></div><div class="ttdeci">byte * trx_undo_rec_get_pars(trx_undo_rec_t *undo_rec, ulint *type, ulint *cmpl_info, bool *updated_extern, undo_no_t *undo_no, table_id_t *table_id, type_cmpl_t &amp;type_cmpl)</div><div class="ttdoc">Reads from an undo log record the general parameters. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:550</div></div>
<div class="ttc" id="structmem__block__info__t_html"><div class="ttname"><a href="structmem__block__info__t.html">mem_block_info_t</a></div><div class="ttdoc">The info structure stored at the beginning of a heap block. </div><div class="ttdef"><b>Definition:</b> mem0mem.h:349</div></div>
<div class="ttc" id="trx0rec_8h_html_a0f620ad159449f5ef50b0896f129b577"><div class="ttname"><a href="trx0rec_8h.html#a0f620ad159449f5ef50b0896f129b577">trx_undo_rec_get_cmpl_info</a></div><div class="ttdeci">UNIV_INLINE ulint trx_undo_rec_get_cmpl_info(const trx_undo_rec_t *undo_rec)</div><div class="ttdoc">Reads from an undo log record the record compiler info. </div></div>
<div class="ttc" id="data0data_8h_html"><div class="ttname"><a href="data0data_8h.html">data0data.h</a></div><div class="ttdoc">SQL data field and tuple. </div></div>
<div class="ttc" id="que0types_8h_html"><div class="ttname"><a href="que0types_8h.html">que0types.h</a></div><div class="ttdoc">Query graph global types. </div></div>
<div class="ttc" id="structtype__cmpl__t_html_a901dd6a6274b36c029b40074411aecde"><div class="ttname"><a href="structtype__cmpl__t.html#a901dd6a6274b36c029b40074411aecde">type_cmpl_t::read</a></div><div class="ttdeci">const byte * read(const byte *ptr)</div><div class="ttdef"><b>Definition:</b> trx0rec.h:346</div></div>
<div class="ttc" id="trx0rec_8h_html_aff965f452d447f88d7d5cfb7f042bd58"><div class="ttname"><a href="trx0rec_8h.html#aff965f452d447f88d7d5cfb7f042bd58">trx_undo_max_free_space</a></div><div class="ttdeci">size_t trx_undo_max_free_space()</div><div class="ttdoc">Get the max free space of undo log by assuming it&amp;#39;s a fresh new page and the free space doesn&amp;#39;t count...</div><div class="ttdef"><b>Definition:</b> trx0rec.cc:159</div></div>
<div class="ttc" id="ctype-mb_8cc_html_adf406aa6822ceac22d62ef63cc2879c0"><div class="ttname"><a href="ctype-mb_8cc.html#adf406aa6822ceac22d62ef63cc2879c0">page</a></div><div class="ttdeci">int page</div><div class="ttdef"><b>Definition:</b> ctype-mb.cc:1234</div></div>
<div class="ttc" id="mysql_8cc_html_adfa69ae672499b1037123a1f17c5552b"><div class="ttname"><a href="mysql_8cc.html#adfa69ae672499b1037123a1f17c5552b">index</a></div><div class="ttdeci">char * index(const char *, int c)</div><div class="ttdef"><b>Definition:</b> mysql.cc:2928</div></div>
<div class="ttc" id="dict0types_8h_html"><div class="ttname"><a href="dict0types_8h.html">dict0types.h</a></div><div class="ttdoc">Data dictionary global types. </div></div>
<div class="ttc" id="structtype__cmpl__t_html_a4a80bc1b290a9a23fe85ffe6ef80d8ac"><div class="ttname"><a href="structtype__cmpl__t.html#a4a80bc1b290a9a23fe85ffe6ef80d8ac">type_cmpl_t::type_info</a></div><div class="ttdeci">ulint type_info()</div><div class="ttdef"><b>Definition:</b> trx0rec.h:351</div></div>
<div class="ttc" id="rem0types_8h_html_a92caeffe2dc2fbe825a54aef9a163435"><div class="ttname"><a href="rem0types_8h.html#a92caeffe2dc2fbe825a54aef9a163435">rec_t</a></div><div class="ttdeci">byte rec_t</div><div class="ttdef"><b>Definition:</b> rem0types.h:39</div></div>
<div class="ttc" id="structdtuple__t_html"><div class="ttname"><a href="structdtuple__t.html">dtuple_t</a></div><div class="ttdoc">Structure for an SQL data tuple of fields (logical record) </div><div class="ttdef"><b>Definition:</b> data0data.h:711</div></div>
<div class="ttc" id="db0err_8h_html_a6fdd08971b32ee513b20967238f1654d"><div class="ttname"><a href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a></div><div class="ttdeci">dberr_t</div><div class="ttdef"><b>Definition:</b> db0err.h:38</div></div>
<div class="ttc" id="trx0rec_8h_html_a9356d49e12323fc80c96cd83dd2cf938"><div class="ttname"><a href="trx0rec_8h.html#a9356d49e12323fc80c96cd83dd2cf938">trx_undo_parse_erase_page_end</a></div><div class="ttdeci">byte * trx_undo_parse_erase_page_end(byte *ptr, byte *end_ptr, page_t *page, mtr_t *mtr)</div><div class="ttdoc">Parses a redo log record of erasing of an undo page end. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:2104</div></div>
<div class="ttc" id="structtype__cmpl__t_html_aac297bb42d1d608aa065064a7b5fe99a"><div class="ttname"><a href="structtype__cmpl__t.html#aac297bb42d1d608aa065064a7b5fe99a">type_cmpl_t::is_lob_undo</a></div><div class="ttdeci">bool is_lob_undo() const</div><div class="ttdoc">Does the undo log record contains information about LOB partial update vector. </div><div class="ttdef"><b>Definition:</b> trx0rec.h:371</div></div>
<div class="ttc" id="row0types_8h_html"><div class="ttname"><a href="row0types_8h.html">row0types.h</a></div><div class="ttdoc">Row operation global types. </div></div>
<div class="ttc" id="structque__thr__t_html"><div class="ttname"><a href="structque__thr__t.html">que_thr_t</a></div><div class="ttdef"><b>Definition:</b> que0que.h:251</div></div>
<div class="ttc" id="structdfield__t_html"><div class="ttname"><a href="structdfield__t.html">dfield_t</a></div><div class="ttdoc">Structure for an SQL data field. </div><div class="ttdef"><b>Definition:</b> data0data.h:639</div></div>
<div class="ttc" id="namespacebinary__log_1_1transaction_1_1compression_html_a22a3b5d8096f4c73ced74c0b668df0be"><div class="ttname"><a href="namespacebinary__log_1_1transaction_1_1compression.html#a22a3b5d8096f4c73ced74c0b668df0be">binary_log::transaction::compression::type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> base.h:36</div></div>
<div class="ttc" id="myisamlog_8cc_html_a63c3b620cc1cd0b4a2850c8d9804fde2"><div class="ttname"><a href="myisamlog_8cc.html#a63c3b620cc1cd0b4a2850c8d9804fde2">update</a></div><div class="ttdeci">static uint update</div><div class="ttdef"><b>Definition:</b> myisamlog.cc:90</div></div>
<div class="ttc" id="trx0types_8h_html"><div class="ttname"><a href="trx0types_8h.html">trx0types.h</a></div><div class="ttdoc">Transaction system global type definitions. </div></div>
<div class="ttc" id="dict0types_8h_html_ac877e05c194a7c04fa5921c88cdcb1f7"><div class="ttname"><a href="dict0types_8h.html#ac877e05c194a7c04fa5921c88cdcb1f7">table_id_t</a></div><div class="ttdeci">ib_id_t table_id_t</div><div class="ttdoc">Table or partition identifier (unique within an InnoDB instance). </div><div class="ttdef"><b>Definition:</b> dict0types.h:215</div></div>
<div class="ttc" id="structtype__cmpl__t_html_aa6cdeb106ea014797941b93d4ab8ae62"><div class="ttname"><a href="structtype__cmpl__t.html#aa6cdeb106ea014797941b93d4ab8ae62">type_cmpl_t::is_lob_updated</a></div><div class="ttdeci">bool is_lob_updated()</div><div class="ttdoc">Is an LOB updated by this update operation. </div><div class="ttdef"><b>Definition:</b> trx0rec.h:363</div></div>
<div class="ttc" id="trx0rec_8h_html_a0b355a2322627ee073a9585ca24fb7d1"><div class="ttname"><a href="trx0rec_8h.html#a0b355a2322627ee073a9585ca24fb7d1">trx_undo_prev_version_build</a></div><div class="ttdeci">bool trx_undo_prev_version_build(const rec_t *index_rec, mtr_t *index_mtr, const rec_t *rec, const dict_index_t *index, ulint *offsets, mem_heap_t *heap, rec_t **old_vers, mem_heap_t *v_heap, const dtuple_t **vrow, ulint v_status, lob::undo_vers_t *lob_undo)</div><div class="ttdoc">Build a previous version of a clustered index record. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:2457</div></div>
<div class="ttc" id="trx0rec_8h_html_a06cc7356840b50f7c121dd50ecad82a2"><div class="ttname"><a href="trx0rec_8h.html#a06cc7356840b50f7c121dd50ecad82a2">trx_undo_rec_get_undo_no</a></div><div class="ttdeci">UNIV_INLINE undo_no_t trx_undo_rec_get_undo_no(const trx_undo_rec_t *undo_rec)</div><div class="ttdoc">Reads the undo log record number. </div></div>
<div class="ttc" id="trx0rec_8h_html_a80d5348d1a573af4aef6f3d08eadaeba"><div class="ttname"><a href="trx0rec_8h.html#a80d5348d1a573af4aef6f3d08eadaeba">TRX_UNDO_UPD_EXTERN</a></div><div class="ttdeci">#define TRX_UNDO_UPD_EXTERN</div><div class="ttdef"><b>Definition:</b> trx0rec.h:330</div></div>
<div class="ttc" id="trx0types_8h_html_a91afca43a639c098efe14a9069a1d4ec"><div class="ttname"><a href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a></div><div class="ttdeci">ib_id_t trx_id_t</div><div class="ttdoc">Transaction identifier (DB_TRX_ID, DATA_TRX_ID) </div><div class="ttdef"><b>Definition:</b> trx0types.h:144</div></div>
<div class="ttc" id="trx0rec_8h_html_a302b5ca1f95234d5ad91b3d34227423e"><div class="ttname"><a href="trx0rec_8h.html#a302b5ca1f95234d5ad91b3d34227423e">trx_undo_update_rec_get_update</a></div><div class="ttdeci">byte * trx_undo_update_rec_get_update(const byte *ptr, const dict_index_t *index, ulint type, trx_id_t trx_id, roll_ptr_t roll_ptr, ulint info_bits, trx_t *trx, mem_heap_t *heap, upd_t **upd, lob::undo_vers_t *lob_undo, type_cmpl_t &amp;type_cmpl)</div><div class="ttdoc">Builds an update vector based on a remaining part of an undo log record. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:1728</div></div>
<div class="ttc" id="trx0rec_8h_html_a324bbc5d0dd2ad6bcf2caf37ea2ef88a"><div class="ttname"><a href="trx0rec_8h.html#a324bbc5d0dd2ad6bcf2caf37ea2ef88a">trx_undo_update_rec_get_sys_cols</a></div><div class="ttdeci">byte * trx_undo_update_rec_get_sys_cols(const byte *ptr, trx_id_t *trx_id, roll_ptr_t *roll_ptr, ulint *info_bits)</div><div class="ttdoc">Reads from an undo log update record the system field values of the old version. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:1705</div></div>
<div class="ttc" id="row0log_8h_html"><div class="ttname"><a href="row0log_8h.html">row0log.h</a></div><div class="ttdoc">Modification log for online index creation and online table rebuild. </div></div>
<div class="ttc" id="trx0rec_8h_html_afc4a542764a35a68b6e6b7f056aa0e60"><div class="ttname"><a href="trx0rec_8h.html#afc4a542764a35a68b6e6b7f056aa0e60">trx_undo_read_v_idx</a></div><div class="ttdeci">const byte * trx_undo_read_v_idx(const dict_table_t *table, const byte *ptr, bool first_v_col, bool *is_undo_log, ulint *field_no)</div><div class="ttdoc">Read virtual column index from undo log or online log if the log contains such info, and in the undo log case, verify the column is still indexed, and output its position. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:351</div></div>
<div class="ttc" id="trx0rec_8h_html_a1043e8db416626276800c8da5637ab8e"><div class="ttname"><a href="trx0rec_8h.html#a1043e8db416626276800c8da5637ab8e">trx_undo_rec_get_multi_value</a></div><div class="ttdeci">const byte * trx_undo_rec_get_multi_value(const byte *ptr, dfield_t *field, mem_heap_t *heap)</div><div class="ttdoc">Read from an undo log record of a multi-value virtual column. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:620</div></div>
<div class="ttc" id="page0types_8h_html_ac84908ddc97c37107986280aa8f37897"><div class="ttname"><a href="page0types_8h.html#ac84908ddc97c37107986280aa8f37897">page_t</a></div><div class="ttdeci">byte page_t</div><div class="ttdoc">Type of the index page. </div><div class="ttdef"><b>Definition:</b> page0types.h:148</div></div>
<div class="ttc" id="mtr0mtr_8h_html"><div class="ttname"><a href="mtr0mtr_8h.html">mtr0mtr.h</a></div><div class="ttdoc">Mini-transaction buffer. </div></div>
<div class="ttc" id="structtype__cmpl__t_html"><div class="ttname"><a href="structtype__cmpl__t.html">type_cmpl_t</a></div><div class="ttdoc">The type and compilation info flag in the undo record for update. </div><div class="ttdef"><b>Definition:</b> trx0rec.h:343</div></div>
<div class="ttc" id="structlob_1_1undo__vers__t_html"><div class="ttname"><a href="structlob_1_1undo__vers__t.html">lob::undo_vers_t</a></div><div class="ttdoc">The list of modifications to be applied on LOBs to get older versions. </div><div class="ttdef"><b>Definition:</b> lob0undo.h:144</div></div>
<div class="ttc" id="hp__test1_8cc_html_a6eec09a91807e20d7b3d6ef3da594067"><div class="ttname"><a href="hp__test1_8cc.html#a6eec09a91807e20d7b3d6ef3da594067">flags</a></div><div class="ttdeci">static int flags[50]</div><div class="ttdef"><b>Definition:</b> hp_test1.cc:39</div></div>
<div class="ttc" id="libmysql_2authentication__win_2common_8h_html_a0c8186d9b9b7880309c27230bbb5e69d"><div class="ttname"><a href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a></div><div class="ttdeci">unsigned char byte</div><div class="ttdoc">Blob class. </div><div class="ttdef"><b>Definition:</b> common.h:159</div></div>
<div class="ttc" id="trx0rec_8h_html_aa1034d3bdf5448388235380b1876be79"><div class="ttname"><a href="trx0rec_8h.html#aa1034d3bdf5448388235380b1876be79">TRX_UNDO_MODIFY_BLOB</a></div><div class="ttdeci">#define TRX_UNDO_MODIFY_BLOB</div><div class="ttdef"><b>Definition:</b> trx0rec.h:322</div></div>
<div class="ttc" id="structmtr__t_html"><div class="ttname"><a href="structmtr__t.html">mtr_t</a></div><div class="ttdoc">Mini-transaction handle and buffer. </div><div class="ttdef"><b>Definition:</b> mtr0mtr.h:169</div></div>
<div class="ttc" id="trx0rec_8h_html_a1aebcafefa1ee5c243da7e9249c9f5e2"><div class="ttname"><a href="trx0rec_8h.html#a1aebcafefa1ee5c243da7e9249c9f5e2">trx_undo_rec_get_extern_storage</a></div><div class="ttdeci">UNIV_INLINE ibool trx_undo_rec_get_extern_storage(const trx_undo_rec_t *undo_rec)</div><div class="ttdoc">Returns TRUE if an undo log record contains an extern storage field. </div></div>
<div class="ttc" id="trx0rec_8h_html_afddad8a35a6f71bb6dc604d772b1832b"><div class="ttname"><a href="trx0rec_8h.html#afddad8a35a6f71bb6dc604d772b1832b">trx_undo_rec_is_multi_value</a></div><div class="ttdeci">bool trx_undo_rec_is_multi_value(const byte *undo_rec)</div><div class="ttdoc">Decide if the following undo log record is a multi-value virtual column. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:231</div></div>
<div class="ttc" id="trx0rec_8h_html_afabb59f72f20367f7d622b40ce1eda7e"><div class="ttname"><a href="trx0rec_8h.html#afabb59f72f20367f7d622b40ce1eda7e">trx_undo_rec_get_table_id</a></div><div class="ttdeci">table_id_t trx_undo_rec_get_table_id(const trx_undo_rec_t *undo_rec)</div><div class="ttdoc">Reads from an undo log record the table ID. </div><div class="ttdef"><b>Definition:</b> trx0rec.cc:590</div></div>
<div class="ttc" id="trx0types_8h_html_a4661d2883c1cd5d8f1cfbd63b553f1bc"><div class="ttname"><a href="trx0types_8h.html#a4661d2883c1cd5d8f1cfbd63b553f1bc">undo_no_t</a></div><div class="ttdeci">ib_id_t undo_no_t</div><div class="ttdoc">Undo number. </div><div class="ttdef"><b>Definition:</b> trx0types.h:148</div></div>
<div class="ttc" id="structtype__cmpl__t_html_a7a998851fc4c89590e2890ebf6607daf"><div class="ttname"><a href="structtype__cmpl__t.html#a7a998851fc4c89590e2890ebf6607daf">type_cmpl_t::m_flag</a></div><div class="ttdeci">uint8_t m_flag</div><div class="ttdef"><b>Definition:</b> trx0rec.h:377</div></div>
<div class="ttc" id="structupd__t_html"><div class="ttname"><a href="structupd__t.html">upd_t</a></div><div class="ttdef"><b>Definition:</b> row0upd.h:580</div></div>
<div class="ttc" id="structdict__index__t_html"><div class="ttname"><a href="structdict__index__t.html">dict_index_t</a></div><div class="ttdoc">Data structure for an index. </div><div class="ttdef"><b>Definition:</b> dict0mem.h:886</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_70f20ecf11358dff00a0daf546d3147e.html">storage</a></li><li class="navelem"><a class="el" href="dir_3fec0aa9607ea05e0bb1c96aee1a8c4e.html">innobase</a></li><li class="navelem"><a class="el" href="dir_9b7ed1f29269ffabdc4c5f5522a0db25.html">include</a></li><li class="navelem"><a class="el" href="trx0rec_8h.html">trx0rec.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
