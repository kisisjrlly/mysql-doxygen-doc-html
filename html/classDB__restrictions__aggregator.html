<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: DB_restrictions_aggregator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classDB__restrictions__aggregator.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classDB__restrictions__aggregator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DB_restrictions_aggregator Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Restriction aggregator for database restrictions.  
 <a href="classDB__restrictions__aggregator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="partial__revokes_8h_source.html">partial_revokes.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for DB_restrictions_aggregator:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classDB__restrictions__aggregator.png" usemap="#DB_5Frestrictions_5Faggregator_map" alt=""/>
  <map id="DB_5Frestrictions_5Faggregator_map" name="DB_5Frestrictions_5Faggregator_map">
<area href="classRestrictions__aggregator.html" title="Base class to perform aggregation of two restriction lists. " alt="Restrictions_aggregator" shape="rect" coords="568,0,842,24"/>
<area href="classDB__restrictions__aggregator__db__grant.html" title="Restriction aggregator for GRANT statement over database privileges. " alt="DB_restrictions_aggregator_db_grant" shape="rect" coords="0,112,274,136"/>
<area href="classDB__restrictions__aggregator__db__revoke.html" title="Restriction aggregator for REVOKE statement for database privileges. " alt="DB_restrictions_aggregator_db_revoke" shape="rect" coords="284,112,558,136"/>
<area href="classDB__restrictions__aggregator__global__grant.html" title="Restriction aggregator for GRANT statement for GLOBAL privileges. " alt="DB_restrictions_aggregator_global_grant" shape="rect" coords="568,112,842,136"/>
<area href="classDB__restrictions__aggregator__global__revoke.html" alt="DB_restrictions_aggregator_global_revoke" shape="rect" coords="852,112,1126,136"/>
<area href="classDB__restrictions__aggregator__set__role.html" title="Database restriction aggregator for SET ROLE statement. " alt="DB_restrictions_aggregator_set_role" shape="rect" coords="1136,112,1410,136"/>
<area href="classDB__restrictions__aggregator__global__revoke__all.html" title="Restriction aggregator for REVOKE statement over GLOBAL privileges. " alt="DB_restrictions_aggregator_global_revoke_all" shape="rect" coords="852,168,1126,192"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adcdd6c455154986a9e904e5b50fd519c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#adcdd6c455154986a9e904e5b50fd519c">generate</a> (<a class="el" href="classAbstract__restrictions.html">Abstract_restrictions</a> &amp;restrictions) override</td></tr>
<tr class="memdesc:adcdd6c455154986a9e904e5b50fd519c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver function to aggregate restriction lists.  <a href="#adcdd6c455154986a9e904e5b50fd519c">More...</a><br /></td></tr>
<tr class="separator:adcdd6c455154986a9e904e5b50fd519c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classRestrictions__aggregator"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classRestrictions__aggregator')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classRestrictions__aggregator.html">Restrictions_aggregator</a></td></tr>
<tr class="memitem:a1d1413368b33c0a87ff6f9dd95642493 inherit pub_methods_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#a1d1413368b33c0a87ff6f9dd95642493">~Restrictions_aggregator</a> ()</td></tr>
<tr class="memdesc:a1d1413368b33c0a87ff6f9dd95642493 inherit pub_methods_classRestrictions__aggregator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="classRestrictions__aggregator.html#a1d1413368b33c0a87ff6f9dd95642493">More...</a><br /></td></tr>
<tr class="separator:a1d1413368b33c0a87ff6f9dd95642493 inherit pub_methods_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:a8fc6080ebfbc44f0cc60ad90c05b5c9c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a8fc6080ebfbc44f0cc60ad90c05b5c9c">SQL_OP</a> { <a class="el" href="classDB__restrictions__aggregator.html#a8fc6080ebfbc44f0cc60ad90c05b5c9ca3d073f793b1baa86916103fca4fc468f">SQL_OP::SET_ROLE</a>, 
<a class="el" href="classDB__restrictions__aggregator.html#a8fc6080ebfbc44f0cc60ad90c05b5c9ca5fbb484d02805521cdb1da50d2b7a253">SQL_OP::GLOBAL_GRANT</a>
 }</td></tr>
<tr class="separator:a8fc6080ebfbc44f0cc60ad90c05b5c9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb59bed91a6cacf79595e31f28709f37"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#aeb59bed91a6cacf79595e31f28709f37">Status</a> = <a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003f">Restrictions_aggregator::Status</a></td></tr>
<tr class="separator:aeb59bed91a6cacf79595e31f28709f37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_types_classRestrictions__aggregator"><td colspan="2" onclick="javascript:toggleInherit('pro_types_classRestrictions__aggregator')"><img src="closed.png" alt="-"/>&#160;Protected Types inherited from <a class="el" href="classRestrictions__aggregator.html">Restrictions_aggregator</a></td></tr>
<tr class="memitem:afee5a425bf1358d9b4cf6c09c3d4003f inherit pro_types_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003f">Status</a> { <br />
&#160;&#160;<a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003fa902b0d55fddef6f8d651fe1035b7d4bd">Status::Error</a>, 
<a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003fa0eaadb4fcb48a0a0ed7bc9868be9fbaa">Status::Warning</a>, 
<a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003fa5364259abab90e94890f2ed2481b9824">Status::Validated</a>, 
<a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003fadacc57ae9b3078e0adfee2542d7fa034">Status::Aggregated</a>, 
<br />
&#160;&#160;<a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003fa7a25a533430ab9d67b61ae8a32d3ec89">Status::No_op</a>
<br />
 }</td></tr>
<tr class="separator:afee5a425bf1358d9b4cf6c09c3d4003f inherit pro_types_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:af714b821a31a792e48c42802d92724de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#af714b821a31a792e48c42802d92724de">DB_restrictions_aggregator</a> (const <a class="el" href="classAuth__id.html">Auth_id</a> &amp;grantor, const <a class="el" href="classAuth__id.html">Auth_id</a> grantee, const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> grantor_global_access, const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> grantee_global_access, const <a class="el" href="classDB__restrictions.html">DB_restrictions</a> &amp;grantor_restrictions, const <a class="el" href="classDB__restrictions.html">DB_restrictions</a> &amp;grantee_restrictions, const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> requested_access, const <a class="el" href="classSecurity__context.html">Security_context</a> *sctx)</td></tr>
<tr class="memdesc:af714b821a31a792e48c42802d92724de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for database level restrictions aggregator.  <a href="#af714b821a31a792e48c42802d92724de">More...</a><br /></td></tr>
<tr class="separator:af714b821a31a792e48c42802d92724de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cdef086f7ea4f65ee5b375a71522abf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a1cdef086f7ea4f65ee5b375a71522abf">find_if_require_next_level_operation</a> (<a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> &amp;rights) const override</td></tr>
<tr class="memdesc:a1cdef086f7ea4f65ee5b375a71522abf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get list of privileges that are not restricted through restriction list.  <a href="#a1cdef086f7ea4f65ee5b375a71522abf">More...</a><br /></td></tr>
<tr class="separator:a1cdef086f7ea4f65ee5b375a71522abf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c7548751cece3d8ce54c0620cfe043"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a86c7548751cece3d8ce54c0620cfe043">check_db_access_and_restrictions_collision</a> (const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> grantee_db_access, const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> grantee_restrictions, const std::string &amp;db_name) noexcept</td></tr>
<tr class="memdesc:a86c7548751cece3d8ce54c0620cfe043"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check possible descrepancy between DB access being granted and existing restrictions.  <a href="#a86c7548751cece3d8ce54c0620cfe043">More...</a><br /></td></tr>
<tr class="separator:a86c7548751cece3d8ce54c0620cfe043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ba136a884c7db54aa15e4b635b4c031"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a2ba136a884c7db54aa15e4b635b4c031">set_if_db_level_operation</a> (const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> requested_access, const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> restrictions_mask) noexcept</td></tr>
<tr class="memdesc:a2ba136a884c7db54aa15e4b635b4c031"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set privileges that needs to be processed further.  <a href="#a2ba136a884c7db54aa15e4b635b4c031">More...</a><br /></td></tr>
<tr class="separator:a2ba136a884c7db54aa15e4b635b4c031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ab0109688abeb4e6a33169ad58bcb21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a0ab0109688abeb4e6a33169ad58bcb21">aggregate_restrictions</a> (<a class="el" href="classDB__restrictions__aggregator.html#a8fc6080ebfbc44f0cc60ad90c05b5c9c">SQL_OP</a> sql_op, const <a class="el" href="auth__internal_8h.html#afc3a39e90dcc822bc08bde46aece5634">Db_access_map</a> *m_db_map, <a class="el" href="classDB__restrictions.html">DB_restrictions</a> &amp;restrictions)</td></tr>
<tr class="memdesc:a0ab0109688abeb4e6a33169ad58bcb21"><td class="mdescLeft">&#160;</td><td class="mdescRight">A helper method that aggregates the restrictions for global_grant and set_role operations since both are similar in nature.  <a href="#a0ab0109688abeb4e6a33169ad58bcb21">More...</a><br /></td></tr>
<tr class="separator:a0ab0109688abeb4e6a33169ad58bcb21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abebf57ed6d0950ce3412554f0742704a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#abebf57ed6d0950ce3412554f0742704a">get_grantee_db_access</a> (const std::string &amp;db_name) const</td></tr>
<tr class="memdesc:abebf57ed6d0950ce3412554f0742704a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetches the grantee's DB access on the specified DB If security context of current user exists and has some active roles then probe the security context since current user must be grantee.  <a href="#abebf57ed6d0950ce3412554f0742704a">More...</a><br /></td></tr>
<tr class="separator:abebf57ed6d0950ce3412554f0742704a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a166b484a94ac87379d0052fa1fca9b51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a166b484a94ac87379d0052fa1fca9b51">get_grantee_db_access</a> (const std::string &amp;db_name, <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> &amp;access) const</td></tr>
<tr class="memdesc:a166b484a94ac87379d0052fa1fca9b51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetches the grantee's DB access on the specified DB If security context of current user exists and has some active roles then probe the security context since current user must be grantee.  <a href="#a166b484a94ac87379d0052fa1fca9b51">More...</a><br /></td></tr>
<tr class="separator:a166b484a94ac87379d0052fa1fca9b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classRestrictions__aggregator"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classRestrictions__aggregator')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classRestrictions__aggregator.html">Restrictions_aggregator</a></td></tr>
<tr class="memitem:ab95ebcdf213678c9ca527826d2b2cea5 inherit pro_methods_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#ab95ebcdf213678c9ca527826d2b2cea5">Restrictions_aggregator</a> (const <a class="el" href="classAuth__id.html">Auth_id</a> &amp;grantor, const <a class="el" href="classAuth__id.html">Auth_id</a> grantee, const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> grantor_global_access, const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> grantee_global_access, const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> requested_access)</td></tr>
<tr class="memdesc:ab95ebcdf213678c9ca527826d2b2cea5 inherit pro_methods_classRestrictions__aggregator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classRestrictions__aggregator.html#ab95ebcdf213678c9ca527826d2b2cea5">More...</a><br /></td></tr>
<tr class="separator:ab95ebcdf213678c9ca527826d2b2cea5 inherit pro_methods_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fff0724335211b776d0aaec87fef774 inherit pro_methods_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#a6fff0724335211b776d0aaec87fef774">Restrictions_aggregator</a> (const <a class="el" href="classRestrictions__aggregator.html">Restrictions_aggregator</a> &amp;)=delete</td></tr>
<tr class="separator:a6fff0724335211b776d0aaec87fef774 inherit pro_methods_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4f203a410cb99da2d289cabea56777 inherit pro_methods_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRestrictions__aggregator.html">Restrictions_aggregator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#a8a4f203a410cb99da2d289cabea56777">operator=</a> (const <a class="el" href="classRestrictions__aggregator.html">Restrictions_aggregator</a> &amp;)=delete</td></tr>
<tr class="separator:a8a4f203a410cb99da2d289cabea56777 inherit pro_methods_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d54bdf7d346a1c64125aa2f26f2a1e4 inherit pro_methods_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#a0d54bdf7d346a1c64125aa2f26f2a1e4">Restrictions_aggregator</a> (const <a class="el" href="classRestrictions__aggregator.html">Restrictions_aggregator</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:a0d54bdf7d346a1c64125aa2f26f2a1e4 inherit pro_methods_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61c130ab44e1b80502a5bd8d3cc054ce inherit pro_methods_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRestrictions__aggregator.html">Restrictions_aggregator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#a61c130ab44e1b80502a5bd8d3cc054ce">operator=</a> (const <a class="el" href="classRestrictions__aggregator.html">Restrictions_aggregator</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:a61c130ab44e1b80502a5bd8d3cc054ce inherit pro_methods_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a895dbf20f396569ca5d971813bc50acd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a895dbf20f396569ca5d971813bc50acd">m_privs_not_processed</a> = 0</td></tr>
<tr class="memdesc:a895dbf20f396569ca5d971813bc50acd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Privileges that needs to be checked further through DB grants.  <a href="#a895dbf20f396569ca5d971813bc50acd">More...</a><br /></td></tr>
<tr class="separator:a895dbf20f396569ca5d971813bc50acd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6187d67c74d88ff5d9fa48ff79006b97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDB__restrictions.html">DB_restrictions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a6187d67c74d88ff5d9fa48ff79006b97">m_grantor_rl</a></td></tr>
<tr class="memdesc:a6187d67c74d88ff5d9fa48ff79006b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Database restrictions for grantor.  <a href="#a6187d67c74d88ff5d9fa48ff79006b97">More...</a><br /></td></tr>
<tr class="separator:a6187d67c74d88ff5d9fa48ff79006b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f89be6deb8705a210c69be0fef6bc60"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDB__restrictions.html">DB_restrictions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a5f89be6deb8705a210c69be0fef6bc60">m_grantee_rl</a></td></tr>
<tr class="memdesc:a5f89be6deb8705a210c69be0fef6bc60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Database restrictions for grantee.  <a href="#a5f89be6deb8705a210c69be0fef6bc60">More...</a><br /></td></tr>
<tr class="separator:a5f89be6deb8705a210c69be0fef6bc60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6d73918597929376005d49b60d32d3"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classSecurity__context.html">Security_context</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a7c6d73918597929376005d49b60d32d3">m_sctx</a></td></tr>
<tr class="memdesc:a7c6d73918597929376005d49b60d32d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Security context of the current user.  <a href="#a7c6d73918597929376005d49b60d32d3">More...</a><br /></td></tr>
<tr class="separator:a7c6d73918597929376005d49b60d32d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classRestrictions__aggregator"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classRestrictions__aggregator')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classRestrictions__aggregator.html">Restrictions_aggregator</a></td></tr>
<tr class="memitem:afd641aab8ef42f09d9226ce756490a0b inherit pro_attribs_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classAuth__id.html">Auth_id</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#afd641aab8ef42f09d9226ce756490a0b">m_grantor</a></td></tr>
<tr class="memdesc:afd641aab8ef42f09d9226ce756490a0b inherit pro_attribs_classRestrictions__aggregator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Grantor information.  <a href="classRestrictions__aggregator.html#afd641aab8ef42f09d9226ce756490a0b">More...</a><br /></td></tr>
<tr class="separator:afd641aab8ef42f09d9226ce756490a0b inherit pro_attribs_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0233a54d458e959ada2a32aa3ca01c6 inherit pro_attribs_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classAuth__id.html">Auth_id</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#ac0233a54d458e959ada2a32aa3ca01c6">m_grantee</a></td></tr>
<tr class="memdesc:ac0233a54d458e959ada2a32aa3ca01c6 inherit pro_attribs_classRestrictions__aggregator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Grantee information.  <a href="classRestrictions__aggregator.html#ac0233a54d458e959ada2a32aa3ca01c6">More...</a><br /></td></tr>
<tr class="separator:ac0233a54d458e959ada2a32aa3ca01c6 inherit pro_attribs_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f6e6ecc642b3e65e02a446f9810e7e4 inherit pro_attribs_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#a2f6e6ecc642b3e65e02a446f9810e7e4">m_grantor_global_access</a></td></tr>
<tr class="memdesc:a2f6e6ecc642b3e65e02a446f9810e7e4 inherit pro_attribs_classRestrictions__aggregator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global static privileges of grantor.  <a href="classRestrictions__aggregator.html#a2f6e6ecc642b3e65e02a446f9810e7e4">More...</a><br /></td></tr>
<tr class="separator:a2f6e6ecc642b3e65e02a446f9810e7e4 inherit pro_attribs_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45c58c92a6463a768c4d16ceef9cba3a inherit pro_attribs_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#a45c58c92a6463a768c4d16ceef9cba3a">m_grantee_global_access</a></td></tr>
<tr class="memdesc:a45c58c92a6463a768c4d16ceef9cba3a inherit pro_attribs_classRestrictions__aggregator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global static privileges of grantee.  <a href="classRestrictions__aggregator.html#a45c58c92a6463a768c4d16ceef9cba3a">More...</a><br /></td></tr>
<tr class="separator:a45c58c92a6463a768c4d16ceef9cba3a inherit pro_attribs_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5556a6fbcb68babd1913e0b06e573b09 inherit pro_attribs_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#a5556a6fbcb68babd1913e0b06e573b09">m_requested_access</a></td></tr>
<tr class="memdesc:a5556a6fbcb68babd1913e0b06e573b09 inherit pro_attribs_classRestrictions__aggregator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Privileges that are being granted or revoked.  <a href="classRestrictions__aggregator.html#a5556a6fbcb68babd1913e0b06e573b09">More...</a><br /></td></tr>
<tr class="separator:a5556a6fbcb68babd1913e0b06e573b09 inherit pro_attribs_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a994c629dc6e8d5b3af71aaca8eb9ddc8 inherit pro_attribs_classRestrictions__aggregator"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003f">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRestrictions__aggregator.html#a994c629dc6e8d5b3af71aaca8eb9ddc8">m_status</a></td></tr>
<tr class="memdesc:a994c629dc6e8d5b3af71aaca8eb9ddc8 inherit pro_attribs_classRestrictions__aggregator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal status of aggregation process.  <a href="classRestrictions__aggregator.html#a994c629dc6e8d5b3af71aaca8eb9ddc8">More...</a><br /></td></tr>
<tr class="separator:a994c629dc6e8d5b3af71aaca8eb9ddc8 inherit pro_attribs_classRestrictions__aggregator"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a2a734d4c8a128ad4ac8e5f19892b6c62"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003f">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a2a734d4c8a128ad4ac8e5f19892b6c62">validate</a> ()=0</td></tr>
<tr class="separator:a2a734d4c8a128ad4ac8e5f19892b6c62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76254cc5509dc61f5aef706dadef25e4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDB__restrictions__aggregator.html#a76254cc5509dc61f5aef706dadef25e4">aggregate</a> (<a class="el" href="classDB__restrictions.html">DB_restrictions</a> &amp;restrictions)=0</td></tr>
<tr class="separator:a76254cc5509dc61f5aef706dadef25e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Restriction aggregator for database restrictions. </p>
<p>An umbrella class to cover common methods. This is ultimately used for privilege aggregation in case of GRANT/REVOKE of database level privileges. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="aeb59bed91a6cacf79595e31f28709f37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb59bed91a6cacf79595e31f28709f37">&#9670;&nbsp;</a></span>Status</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003f">DB_restrictions_aggregator::Status</a> =  <a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003f">Restrictions_aggregator::Status</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a8fc6080ebfbc44f0cc60ad90c05b5c9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fc6080ebfbc44f0cc60ad90c05b5c9c">&#9670;&nbsp;</a></span>SQL_OP</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classDB__restrictions__aggregator.html#a8fc6080ebfbc44f0cc60ad90c05b5c9c">DB_restrictions_aggregator::SQL_OP</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a8fc6080ebfbc44f0cc60ad90c05b5c9ca3d073f793b1baa86916103fca4fc468f"></a>SET_ROLE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8fc6080ebfbc44f0cc60ad90c05b5c9ca5fbb484d02805521cdb1da50d2b7a253"></a>GLOBAL_GRANT&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af714b821a31a792e48c42802d92724de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af714b821a31a792e48c42802d92724de">&#9670;&nbsp;</a></span>DB_restrictions_aggregator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DB_restrictions_aggregator::DB_restrictions_aggregator </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAuth__id.html">Auth_id</a> &amp;&#160;</td>
          <td class="paramname"><em>grantor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAuth__id.html">Auth_id</a>&#160;</td>
          <td class="paramname"><em>grantee</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>grantor_global_access</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>grantee_global_access</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDB__restrictions.html">DB_restrictions</a> &amp;&#160;</td>
          <td class="paramname"><em>grantor_db_restrictions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDB__restrictions.html">DB_restrictions</a> &amp;&#160;</td>
          <td class="paramname"><em>grantee_db_restrictions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>requested_access</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSecurity__context.html">Security_context</a> *&#160;</td>
          <td class="paramname"><em>sctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor for database level restrictions aggregator. </p>
<p>Database restrictions will be fetched from global cache. Assumption: ACL cache is locked - at least in shared mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grantor</td><td>Grantor information </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grantee</td><td>Grantee information </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grantor_global_access</td><td>Static global privileges of grantor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grantee_global_access</td><td>Static global privileges of grantee </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grantor_db_restrictions</td><td>DB_restrictions of grantor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grantee_db_restrictions</td><td>DB_restrictions of grantee </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">requested_access</td><td>Privileges being granted/revoked through current statement </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sctx</td><td>Security_context of current user. Default value is nullptr </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a76254cc5509dc61f5aef706dadef25e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76254cc5509dc61f5aef706dadef25e4">&#9670;&nbsp;</a></span>aggregate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void DB_restrictions_aggregator::aggregate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDB__restrictions.html">DB_restrictions</a> &amp;&#160;</td>
          <td class="paramname"><em>restrictions</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classDB__restrictions__aggregator__db__revoke.html#ac5dccdbb574b4a31ac0470dece54690d">DB_restrictions_aggregator_db_revoke</a>, <a class="el" href="classDB__restrictions__aggregator__db__grant.html#a8622bbb46e5ad072ae965dcc51d6c876">DB_restrictions_aggregator_db_grant</a>, <a class="el" href="classDB__restrictions__aggregator__global__revoke__all.html#a24d65e8b0ec25a68a7f8b21382769cb2">DB_restrictions_aggregator_global_revoke_all</a>, <a class="el" href="classDB__restrictions__aggregator__global__revoke.html#ace0d9ec3d193fb4d3b320cce4fc4e21d">DB_restrictions_aggregator_global_revoke</a>, <a class="el" href="classDB__restrictions__aggregator__global__grant.html#a4c21040f584ae341ddc8339f6dc226bd">DB_restrictions_aggregator_global_grant</a>, and <a class="el" href="classDB__restrictions__aggregator__set__role.html#a99e90cc0d045d3c6ffc6537d248b904c">DB_restrictions_aggregator_set_role</a>.</p>

</div>
</div>
<a id="a0ab0109688abeb4e6a33169ad58bcb21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ab0109688abeb4e6a33169ad58bcb21">&#9670;&nbsp;</a></span>aggregate_restrictions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DB_restrictions_aggregator::aggregate_restrictions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDB__restrictions__aggregator.html#a8fc6080ebfbc44f0cc60ad90c05b5c9c">SQL_OP</a>&#160;</td>
          <td class="paramname"><em>sql_op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="auth__internal_8h.html#afc3a39e90dcc822bc08bde46aece5634">Db_access_map</a> *&#160;</td>
          <td class="paramname"><em>db_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDB__restrictions.html">DB_restrictions</a> &amp;&#160;</td>
          <td class="paramname"><em>restrictions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A helper method that aggregates the restrictions for global_grant and set_role operations since both are similar in nature. </p>
<p>Generates DB_restrictions based on the requested access, grantor and grantee's DB_restrictions in the ACL cache.</p><ul>
<li>If grantor has restrictions<ul>
<li>Retain Grantee's restrictions if it has more privileges than grantor</li>
<li>If grantee has restrictions than aggregate them</li>
<li>If grantee does not have restrictions keep only those restrictions of grantor for which there is no DB level access to grantee.</li>
</ul>
</li>
<li>else if grantee has restrictions<ul>
<li>Remove the restrictions on which global grant is requested.</li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sql_op</td><td>SQL statement type for which aggregation is to be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">db_map</td><td>DB_access_map used to fetch grantee's db access for SET ROLE </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">restrictions</td><td>Fills the paramter with the generated DB_restrictions. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a86c7548751cece3d8ce54c0620cfe043"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86c7548751cece3d8ce54c0620cfe043">&#9670;&nbsp;</a></span>check_db_access_and_restrictions_collision()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> DB_restrictions_aggregator::check_db_access_and_restrictions_collision </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>grantee_db_access</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>grantee_restrictions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>db_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check possible descrepancy between DB access being granted and existing restrictions. </p>
<p>For a given user account, if a privilege is present in:</p><ol type="1">
<li>Restriction list</li>
<li>List of DB privileges AND if server is running with &ndash;partial_revokes option, any further attempt to modify user's grant should be prevented. Such a case can occur in one of the following cases: A. DB Restriction is created, &ndash;partial_revokes is set to OFF, DB grant is created, &ndash;partial_revokes is set to ON again. B. DB Restriction is created, mysql.db table is modified with INSERT query.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">grantee_db_access</td><td>Database access to be granted </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grantee_restrictions</td><td>Existing restriction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">db_name</td><td>Database information</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Collision exists or not </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>No collision detected </td></tr>
    <tr><td class="paramname">true</td><td>Collision detected. Error raised. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1cdef086f7ea4f65ee5b375a71522abf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cdef086f7ea4f65ee5b375a71522abf">&#9670;&nbsp;</a></span>find_if_require_next_level_operation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> DB_restrictions_aggregator::find_if_require_next_level_operation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> &amp;&#160;</td>
          <td class="paramname"><em>rights</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get list of privileges that are not restricted through restriction list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">rights</td><td>Bitmask of privileges to be processed futher</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Any more privilegs remaining? </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>No privileges to be processed further </td></tr>
    <tr><td class="paramname">true</td><td>Either restricted privileges were removed or nothing needs to be filtered </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classRestrictions__aggregator.html#a2ff9e94865d614a93d9ed02531fab56e">Restrictions_aggregator</a>.</p>

</div>
</div>
<a id="adcdd6c455154986a9e904e5b50fd519c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcdd6c455154986a9e904e5b50fd519c">&#9670;&nbsp;</a></span>generate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> DB_restrictions_aggregator::generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAbstract__restrictions.html">Abstract_restrictions</a> &amp;&#160;</td>
          <td class="paramname"><em>restrictions</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Driver function to aggregate restriction lists. </p>
<p>Validate first and then aggregate the restrictionss from combinations of grantor &amp; grantee's restrictions, global access and grantee access.</p>
<p>We also perform dynamic cast here once and call method of respective derived classes. This way, dervied classes do not have to override aggregate and perform similar dynamic casting before proceeding.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">restrictions</td><td>Aggreatated restrictions for grantee</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status of aggregation process </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>Success </td></tr>
    <tr><td class="paramname">true</td><td>Failure. Error would have been raised. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classRestrictions__aggregator.html#aa51c18dd55124f4211d186e41ff4ce47">Restrictions_aggregator</a>.</p>

</div>
</div>
<a id="abebf57ed6d0950ce3412554f0742704a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abebf57ed6d0950ce3412554f0742704a">&#9670;&nbsp;</a></span>get_grantee_db_access() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> DB_restrictions_aggregator::get_grantee_db_access </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>db_name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fetches the grantee's DB access on the specified DB If security context of current user exists and has some active roles then probe the security context since current user must be grantee. </p>
<p>Otherwise, probe the usual ACL Cache.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">db_name</td><td>Database name for which we need to fetch the DB level access. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DB level access. </dd></dl>

</div>
</div>
<a id="a166b484a94ac87379d0052fa1fca9b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a166b484a94ac87379d0052fa1fca9b51">&#9670;&nbsp;</a></span>get_grantee_db_access() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DB_restrictions_aggregator::get_grantee_db_access </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>db_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> &amp;&#160;</td>
          <td class="paramname"><em>access</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fetches the grantee's DB access on the specified DB If security context of current user exists and has some active roles then probe the security context since current user must be grantee. </p>
<p>Otherwise, do not modify the access argument.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">db_name</td><td>Database name for which we need to fetch the DB level access. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">access</td><td>Access on the specified DB. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2ba136a884c7db54aa15e4b635b4c031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ba136a884c7db54aa15e4b635b4c031">&#9670;&nbsp;</a></span>set_if_db_level_operation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DB_restrictions_aggregator::set_if_db_level_operation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>requested_access</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>restrictions_mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set privileges that needs to be processed further. </p>
<p>These privileges are not restricted through revocations. So caller can safely proceed with further operations</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">requested_access</td><td>Privilege bitmask to be checked </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">restrictions_mask</td><td>Confirmed restrictions </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2a734d4c8a128ad4ac8e5f19892b6c62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a734d4c8a128ad4ac8e5f19892b6c62">&#9670;&nbsp;</a></span>validate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classRestrictions__aggregator.html#afee5a425bf1358d9b4cf6c09c3d4003f">Status</a> DB_restrictions_aggregator::validate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classDB__restrictions__aggregator__db__revoke.html#a9ad142be6d6e31a1780556f4833ad48f">DB_restrictions_aggregator_db_revoke</a>, <a class="el" href="classDB__restrictions__aggregator__db__grant.html#a31d012394abd1152068e2b44233627c5">DB_restrictions_aggregator_db_grant</a>, <a class="el" href="classDB__restrictions__aggregator__global__revoke__all.html#a5d950b39a609f83a0231b42e7931963a">DB_restrictions_aggregator_global_revoke_all</a>, <a class="el" href="classDB__restrictions__aggregator__global__revoke.html#a72f923ba1a7c45df75b039e4cbdc1076">DB_restrictions_aggregator_global_revoke</a>, <a class="el" href="classDB__restrictions__aggregator__global__grant.html#ab6ad0b47e9e444f80c3abe3127c115fd">DB_restrictions_aggregator_global_grant</a>, and <a class="el" href="classDB__restrictions__aggregator__set__role.html#abd3a4c6a7394ad09a174884015f9bfb0">DB_restrictions_aggregator_set_role</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5f89be6deb8705a210c69be0fef6bc60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f89be6deb8705a210c69be0fef6bc60">&#9670;&nbsp;</a></span>m_grantee_rl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDB__restrictions.html">DB_restrictions</a> DB_restrictions_aggregator::m_grantee_rl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Database restrictions for grantee. </p>

</div>
</div>
<a id="a6187d67c74d88ff5d9fa48ff79006b97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6187d67c74d88ff5d9fa48ff79006b97">&#9670;&nbsp;</a></span>m_grantor_rl</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDB__restrictions.html">DB_restrictions</a> DB_restrictions_aggregator::m_grantor_rl</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Database restrictions for grantor. </p>

</div>
</div>
<a id="a895dbf20f396569ca5d971813bc50acd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a895dbf20f396569ca5d971813bc50acd">&#9670;&nbsp;</a></span>m_privs_not_processed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> DB_restrictions_aggregator::m_privs_not_processed = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Privileges that needs to be checked further through DB grants. </p>

</div>
</div>
<a id="a7c6d73918597929376005d49b60d32d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6d73918597929376005d49b60d32d3">&#9670;&nbsp;</a></span>m_sctx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classSecurity__context.html">Security_context</a>* DB_restrictions_aggregator::m_sctx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Security context of the current user. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>sql/auth/<a class="el" href="partial__revokes_8h_source.html">partial_revokes.h</a></li>
<li>sql/auth/<a class="el" href="partial__revokes_8cc.html">partial_revokes.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classDB__restrictions__aggregator.html">DB_restrictions_aggregator</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
