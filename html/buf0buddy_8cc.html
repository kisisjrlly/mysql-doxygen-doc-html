<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: storage/innobase/buf/buf0buddy.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('buf0buddy_8cc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">buf0buddy.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Binary buddy allocator for compressed pages.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="buf0buddy_8h_source.html">buf0buddy.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buf0buf_8h_source.html">buf0buf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buf0flu_8h_source.html">buf0flu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buf0lru_8h_source.html">buf0lru.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dict0dict_8h_source.html">dict0dict.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="page0zip_8h_source.html">page0zip.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCheckZipFree.html">CheckZipFree</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a given zip_free list.  <a href="structCheckZipFree.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5f32b438660774b5dc9ba5679fde28e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a5f32b438660774b5dc9ba5679fde28e5">BUF_BUDDY_STAMP_OFFSET</a>&#160;&#160;&#160;<a class="el" href="fil0types_8h.html#a29c2aa0f9031b73866df74845b885163">FIL_PAGE_ARCH_LOG_NO_OR_SPACE_ID</a></td></tr>
<tr class="memdesc:a5f32b438660774b5dc9ba5679fde28e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">When freeing a buf we attempt to coalesce by looking at its buddy and deciding whether it is free or not.  <a href="#a5f32b438660774b5dc9ba5679fde28e5">More...</a><br /></td></tr>
<tr class="separator:a5f32b438660774b5dc9ba5679fde28e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea591dd780263e762dd6a3c11046e558"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#aea591dd780263e762dd6a3c11046e558">BUF_BUDDY_STAMP_FREE</a>&#160;&#160;&#160;<a class="el" href="structdict__sys__t.html#a0981ec4377247d05710378c2ea80e40a">dict_sys_t::s_log_space_first_id</a></td></tr>
<tr class="memdesc:aea591dd780263e762dd6a3c11046e558"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value that we stamp on all buffers that are currently on the zip_free list.  <a href="#aea591dd780263e762dd6a3c11046e558">More...</a><br /></td></tr>
<tr class="separator:aea591dd780263e762dd6a3c11046e558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8287b70f09624750b1ae2ed8941a6d52"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a8287b70f09624750b1ae2ed8941a6d52">BUF_BUDDY_STAMP_NONFREE</a>&#160;&#160;&#160;0XFFFFFFFFUL</td></tr>
<tr class="memdesc:a8287b70f09624750b1ae2ed8941a6d52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stamp value for non-free buffers.  <a href="#a8287b70f09624750b1ae2ed8941a6d52">More...</a><br /></td></tr>
<tr class="separator:a8287b70f09624750b1ae2ed8941a6d52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0742f0e7aad3918311018fea81926efc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a0742f0e7aad3918311018fea81926efc">buf_buddy_mem_invalid</a>(buf,  i)&#160;&#160;&#160;<a class="el" href="ut0dbg_8h.html#a17113dab7f37e298e889ac8818ab13d0">ut_ad</a>((i) &lt;= <a class="el" href="buf0types_8h.html#a52b22fcbbf428b283ce3ffbd73be2c4c">BUF_BUDDY_SIZES</a>)</td></tr>
<tr class="separator:a0742f0e7aad3918311018fea81926efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab12ad35745fb119fad66c165f4a7ff27"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#ab12ad35745fb119fad66c165f4a7ff27">buf_buddy_stamp_nonfree</a>(buf,  i)</td></tr>
<tr class="memdesc:ab12ad35745fb119fad66c165f4a7ff27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stamps a buddy nonfree.  <a href="#ab12ad35745fb119fad66c165f4a7ff27">More...</a><br /></td></tr>
<tr class="separator:ab12ad35745fb119fad66c165f4a7ff27"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a05e239e44baef98a36e4becaf1d4a77c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a05e239e44baef98a36e4becaf1d4a77c">buf_buddy_state_t</a> { <a class="el" href="buf0buddy_8cc.html#a05e239e44baef98a36e4becaf1d4a77ca9e83213c20f411b34f00cab5fc99af51">BUF_BUDDY_STATE_FREE</a>, 
<a class="el" href="buf0buddy_8cc.html#a05e239e44baef98a36e4becaf1d4a77ca277a958365d4f7c756d74ce3d4643354">BUF_BUDDY_STATE_USED</a>, 
<a class="el" href="buf0buddy_8cc.html#a05e239e44baef98a36e4becaf1d4a77ca4738435f95ac13c557a9805ccd39630b">BUF_BUDDY_STATE_PARTIALLY_USED</a>
 }<tr class="memdesc:a05e239e44baef98a36e4becaf1d4a77c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return type of buf_buddy_is_free()  <a href="buf0buddy_8cc.html#a05e239e44baef98a36e4becaf1d4a77c">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a05e239e44baef98a36e4becaf1d4a77c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1e4d8879713068fd76d3350ea6d36f67"><td class="memItemLeft" align="right" valign="top">UNIV_INLINE <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a1e4d8879713068fd76d3350ea6d36f67">buf_buddy_stamp_is_free</a> (const <a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *buf)</td></tr>
<tr class="memdesc:a1e4d8879713068fd76d3350ea6d36f67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a buddy is stamped free.  <a href="#a1e4d8879713068fd76d3350ea6d36f67">More...</a><br /></td></tr>
<tr class="separator:a1e4d8879713068fd76d3350ea6d36f67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6de053c39be91e8d38273ff19ce04d31"><td class="memItemLeft" align="right" valign="top">UNIV_INLINE void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a6de053c39be91e8d38273ff19ce04d31">buf_buddy_stamp_free</a> (<a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *buf, ulint i)</td></tr>
<tr class="memdesc:a6de053c39be91e8d38273ff19ce04d31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stamps a buddy free.  <a href="#a6de053c39be91e8d38273ff19ce04d31">More...</a><br /></td></tr>
<tr class="separator:a6de053c39be91e8d38273ff19ce04d31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad61475a0cac75ccf4c0bc0bef4fcb701"><td class="memItemLeft" align="right" valign="top">UNIV_INLINE void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#ad61475a0cac75ccf4c0bc0bef4fcb701">buf_buddy_get</a> (<a class="el" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="el" href="ctype-mb_8cc.html#adf406aa6822ceac22d62ef63cc2879c0">page</a>, ulint size)</td></tr>
<tr class="memdesc:ad61475a0cac75ccf4c0bc0bef4fcb701"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the offset of the buddy of a compressed page frame.  <a href="#ad61475a0cac75ccf4c0bc0bef4fcb701">More...</a><br /></td></tr>
<tr class="separator:ad61475a0cac75ccf4c0bc0bef4fcb701"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b75a65a273178d0e5b138a97c044a43"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a1b75a65a273178d0e5b138a97c044a43">buf_buddy_list_validate</a> (const <a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, ulint i)</td></tr>
<tr class="memdesc:a1b75a65a273178d0e5b138a97c044a43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a buddy list.  <a href="#a1b75a65a273178d0e5b138a97c044a43">More...</a><br /></td></tr>
<tr class="separator:a1b75a65a273178d0e5b138a97c044a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a873b76fad9dfe8134d2daeebde6cefdb"><td class="memItemLeft" align="right" valign="top">UNIV_INLINE <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a873b76fad9dfe8134d2daeebde6cefdb">buf_buddy_check_free</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, const <a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *buf, ulint i)</td></tr>
<tr class="memdesc:a873b76fad9dfe8134d2daeebde6cefdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Debug function to validate that a buffer is indeed free i.e.  <a href="#a873b76fad9dfe8134d2daeebde6cefdb">More...</a><br /></td></tr>
<tr class="separator:a873b76fad9dfe8134d2daeebde6cefdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e0190ada19420110e91af275ba7599"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="buf0buddy_8cc.html#a05e239e44baef98a36e4becaf1d4a77c">buf_buddy_state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#aa0e0190ada19420110e91af275ba7599">buf_buddy_is_free</a> (<a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *buf, ulint i)</td></tr>
<tr class="memdesc:aa0e0190ada19420110e91af275ba7599"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if a buf is free i.e.  <a href="#aa0e0190ada19420110e91af275ba7599">More...</a><br /></td></tr>
<tr class="separator:aa0e0190ada19420110e91af275ba7599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3c137afeab36f2d32764079ed787e0b"><td class="memItemLeft" align="right" valign="top">UNIV_INLINE void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#aa3c137afeab36f2d32764079ed787e0b">buf_buddy_add_to_free</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, <a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *buf, ulint i)</td></tr>
<tr class="memdesc:aa3c137afeab36f2d32764079ed787e0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a block to the head of the appropriate buddy free list.  <a href="#aa3c137afeab36f2d32764079ed787e0b">More...</a><br /></td></tr>
<tr class="separator:aa3c137afeab36f2d32764079ed787e0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a37dbf6c8b5e9a57409053b63da63a8"><td class="memItemLeft" align="right" valign="top">UNIV_INLINE void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a0a37dbf6c8b5e9a57409053b63da63a8">buf_buddy_remove_from_free</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, <a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *buf, ulint i)</td></tr>
<tr class="memdesc:a0a37dbf6c8b5e9a57409053b63da63a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a block from the appropriate buddy free list.  <a href="#a0a37dbf6c8b5e9a57409053b63da63a8">More...</a><br /></td></tr>
<tr class="separator:a0a37dbf6c8b5e9a57409053b63da63a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a315000105ee749ca887c27931e3ea82a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a315000105ee749ca887c27931e3ea82a">buf_buddy_alloc_zip</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, ulint i)</td></tr>
<tr class="memdesc:a315000105ee749ca887c27931e3ea82a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to allocate a block from buf_pool-&gt;zip_free[].  <a href="#a315000105ee749ca887c27931e3ea82a">More...</a><br /></td></tr>
<tr class="separator:a315000105ee749ca887c27931e3ea82a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c0a809a3f02061918f7809e80293a87"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a3c0a809a3f02061918f7809e80293a87">buf_buddy_block_free</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, void *buf)</td></tr>
<tr class="memdesc:a3c0a809a3f02061918f7809e80293a87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate a buffer frame of UNIV_PAGE_SIZE.  <a href="#a3c0a809a3f02061918f7809e80293a87">More...</a><br /></td></tr>
<tr class="separator:a3c0a809a3f02061918f7809e80293a87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99334769246743018b31d9e4bb6fe763"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a99334769246743018b31d9e4bb6fe763">buf_buddy_block_register</a> (<a class="el" href="structbuf__block__t.html">buf_block_t</a> *block)</td></tr>
<tr class="memdesc:a99334769246743018b31d9e4bb6fe763"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a buffer block to the buddy allocator.  <a href="#a99334769246743018b31d9e4bb6fe763">More...</a><br /></td></tr>
<tr class="separator:a99334769246743018b31d9e4bb6fe763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fa9ce6690d80c14c18e47fa440599fc"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a1fa9ce6690d80c14c18e47fa440599fc">buf_buddy_alloc_from</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, void *buf, ulint i, ulint j)</td></tr>
<tr class="memdesc:a1fa9ce6690d80c14c18e47fa440599fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a block from a bigger object.  <a href="#a1fa9ce6690d80c14c18e47fa440599fc">More...</a><br /></td></tr>
<tr class="separator:a1fa9ce6690d80c14c18e47fa440599fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa96e5b0de78690f99c410b7d3f1ca11a"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#aa96e5b0de78690f99c410b7d3f1ca11a">buf_buddy_alloc_low</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, ulint i)</td></tr>
<tr class="memdesc:aa96e5b0de78690f99c410b7d3f1ca11a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a block.  <a href="#aa96e5b0de78690f99c410b7d3f1ca11a">More...</a><br /></td></tr>
<tr class="separator:aa96e5b0de78690f99c410b7d3f1ca11a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af5c17f35f662a4d81392caebff1984"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a1af5c17f35f662a4d81392caebff1984">buf_buddy_relocate</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, void *src, void *dst, ulint i, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> force)</td></tr>
<tr class="memdesc:a1af5c17f35f662a4d81392caebff1984"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to relocate a block.  <a href="#a1af5c17f35f662a4d81392caebff1984">More...</a><br /></td></tr>
<tr class="separator:a1af5c17f35f662a4d81392caebff1984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d52408491c21e80b726d32799a6cc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a88d52408491c21e80b726d32799a6cc7">buf_buddy_free_low</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, void *buf, ulint i, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> has_zip_free)</td></tr>
<tr class="memdesc:a88d52408491c21e80b726d32799a6cc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate a block.  <a href="#a88d52408491c21e80b726d32799a6cc7">More...</a><br /></td></tr>
<tr class="separator:a88d52408491c21e80b726d32799a6cc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f3e8d374afe96c2e7d998fc57043c74"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a4f3e8d374afe96c2e7d998fc57043c74">buf_buddy_realloc</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool, void *buf, ulint size)</td></tr>
<tr class="memdesc:a4f3e8d374afe96c2e7d998fc57043c74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to reallocate a block.  <a href="#a4f3e8d374afe96c2e7d998fc57043c74">More...</a><br /></td></tr>
<tr class="separator:a4f3e8d374afe96c2e7d998fc57043c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89e563fdbb9e7113698e170c690978ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buf0buddy_8cc.html#a89e563fdbb9e7113698e170c690978ea">buf_buddy_condense_free</a> (<a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *buf_pool)</td></tr>
<tr class="memdesc:a89e563fdbb9e7113698e170c690978ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combine all pairs of free buddies.  <a href="#a89e563fdbb9e7113698e170c690978ea">More...</a><br /></td></tr>
<tr class="separator:a89e563fdbb9e7113698e170c690978ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Binary buddy allocator for compressed pages. </p>
<p>Created December 2006 by Marko Makela </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0742f0e7aad3918311018fea81926efc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0742f0e7aad3918311018fea81926efc">&#9670;&nbsp;</a></span>buf_buddy_mem_invalid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define buf_buddy_mem_invalid</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">buf, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="ut0dbg_8h.html#a17113dab7f37e298e889ac8818ab13d0">ut_ad</a>((i) &lt;= <a class="el" href="buf0types_8h.html#a52b22fcbbf428b283ce3ffbd73be2c4c">BUF_BUDDY_SIZES</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aea591dd780263e762dd6a3c11046e558"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea591dd780263e762dd6a3c11046e558">&#9670;&nbsp;</a></span>BUF_BUDDY_STAMP_FREE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUF_BUDDY_STAMP_FREE&#160;&#160;&#160;<a class="el" href="structdict__sys__t.html#a0981ec4377247d05710378c2ea80e40a">dict_sys_t::s_log_space_first_id</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Value that we stamp on all buffers that are currently on the zip_free list. </p>
<p>This value is stamped at BUF_BUDDY_STAMP_OFFSET offset </p>

</div>
</div>
<a id="a8287b70f09624750b1ae2ed8941a6d52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8287b70f09624750b1ae2ed8941a6d52">&#9670;&nbsp;</a></span>BUF_BUDDY_STAMP_NONFREE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUF_BUDDY_STAMP_NONFREE&#160;&#160;&#160;0XFFFFFFFFUL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stamp value for non-free buffers. </p>
<p>Will be overwritten by a non-zero value by the consumer of the block </p>

</div>
</div>
<a id="ab12ad35745fb119fad66c165f4a7ff27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab12ad35745fb119fad66c165f4a7ff27">&#9670;&nbsp;</a></span>buf_buddy_stamp_nonfree</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define buf_buddy_stamp_nonfree</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">buf, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                                          \</div><div class="line">    buf_buddy_mem_invalid(<a class="code" href="namespacebuf.html">buf</a>, i);                              \</div><div class="line">    memset(<a class="code" href="namespacebuf.html">buf</a>-&gt;stamp.bytes + <a class="code" href="buf0buddy_8cc.html#a5f32b438660774b5dc9ba5679fde28e5">BUF_BUDDY_STAMP_OFFSET</a>, 0xff, 4); \</div><div class="line">  } <span class="keywordflow">while</span> (0)</div><div class="ttc" id="buf0buddy_8cc_html_a5f32b438660774b5dc9ba5679fde28e5"><div class="ttname"><a href="buf0buddy_8cc.html#a5f32b438660774b5dc9ba5679fde28e5">BUF_BUDDY_STAMP_OFFSET</a></div><div class="ttdeci">#define BUF_BUDDY_STAMP_OFFSET</div><div class="ttdoc">When freeing a buf we attempt to coalesce by looking at its buddy and deciding whether it is free or ...</div><div class="ttdef"><b>Definition:</b> buf0buddy.cc:74</div></div>
<div class="ttc" id="namespacebuf_html"><div class="ttname"><a href="namespacebuf.html">buf</a></div><div class="ttdef"><b>Definition:</b> buf0block_hint.cc:29</div></div>
</div><!-- fragment -->
<p>Stamps a buddy nonfree. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buf</td><td>block to stamp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>block size </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5f32b438660774b5dc9ba5679fde28e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f32b438660774b5dc9ba5679fde28e5">&#9670;&nbsp;</a></span>BUF_BUDDY_STAMP_OFFSET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUF_BUDDY_STAMP_OFFSET&#160;&#160;&#160;<a class="el" href="fil0types_8h.html#a29c2aa0f9031b73866df74845b885163">FIL_PAGE_ARCH_LOG_NO_OR_SPACE_ID</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>When freeing a buf we attempt to coalesce by looking at its buddy and deciding whether it is free or not. </p>
<p>To ascertain if the buddy is free we look for BUF_BUDDY_STAMP_FREE at BUF_BUDDY_STAMP_OFFSET within the buddy. The question is how we can be sure that it is safe to look at BUF_BUDDY_STAMP_OFFSET. The answer lies in following invariants: All blocks allocated by buddy allocator are used for compressed page frame. A compressed table always have space_id &lt; dict_sys_t::s_log_space_first_id BUF_BUDDY_STAMP_OFFSET always points to the space_id field in a frame. &ndash; The above is true because we look at these fields when the corresponding buddy block is free which implies that: The block we are looking at must have an address aligned at the same size that its free buddy has. For example, if we have a free block of 8K then its buddy's address must be aligned at 8K as well. It is possible that the block we are looking at may have been further divided into smaller sized blocks but its starting address must still remain the start of a page frame i.e.: it cannot be middle of a block. For example, if we have a free block of size 8K then its buddy may be divided into blocks of, say, 1K, 1K, 2K, 4K but the buddy's address will still be the starting address of first 1K compressed page. What is important to note is that for any given block, the buddy's address cannot be in the middle of a larger block i.e.: in above example, our 8K block cannot have a buddy whose address is aligned on 8K but it is part of a larger 16K block. Offset within buf_buddy_free_t where free or non_free stamps are written. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a05e239e44baef98a36e4becaf1d4a77c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e239e44baef98a36e4becaf1d4a77c">&#9670;&nbsp;</a></span>buf_buddy_state_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="buf0buddy_8cc.html#a05e239e44baef98a36e4becaf1d4a77c">buf_buddy_state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return type of buf_buddy_is_free() </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a05e239e44baef98a36e4becaf1d4a77ca9e83213c20f411b34f00cab5fc99af51"></a>BUF_BUDDY_STATE_FREE&#160;</td><td class="fielddoc"><p>If the buddy to completely free. </p>
</td></tr>
<tr><td class="fieldname"><a id="a05e239e44baef98a36e4becaf1d4a77ca277a958365d4f7c756d74ce3d4643354"></a>BUF_BUDDY_STATE_USED&#160;</td><td class="fielddoc"><p>Buddy currently in used. </p>
</td></tr>
<tr><td class="fieldname"><a id="a05e239e44baef98a36e4becaf1d4a77ca4738435f95ac13c557a9805ccd39630b"></a>BUF_BUDDY_STATE_PARTIALLY_USED&#160;</td><td class="fielddoc"><p>Some sub-blocks in the buddy are in use. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa3c137afeab36f2d32764079ed787e0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3c137afeab36f2d32764079ed787e0b">&#9670;&nbsp;</a></span>buf_buddy_add_to_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UNIV_INLINE void buf_buddy_add_to_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a block to the head of the appropriate buddy free list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buf</td><td>block to be freed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of buf_pool-&gt;zip_free[] </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1fa9ce6690d80c14c18e47fa440599fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fa9ce6690d80c14c18e47fa440599fc">&#9670;&nbsp;</a></span>buf_buddy_alloc_from()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* buf_buddy_alloc_from </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate a block from a bigger object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>a block that is free to use </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of buf_pool-&gt;zip_free[] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>size of buf as an index of buf_pool-&gt;zip_free[] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>allocated block </dd></dl>

</div>
</div>
<a id="aa96e5b0de78690f99c410b7d3f1ca11a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa96e5b0de78690f99c410b7d3f1ca11a">&#9670;&nbsp;</a></span>buf_buddy_alloc_low()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* buf_buddy_alloc_low </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a block. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of buf_pool-&gt;zip_free[] or BUF_BUDDY_SIZES </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>allocated block, never NULL </dd></dl>

</div>
</div>
<a id="a315000105ee749ca887c27931e3ea82a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a315000105ee749ca887c27931e3ea82a">&#9670;&nbsp;</a></span>buf_buddy_alloc_zip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a>* buf_buddy_alloc_zip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Try to allocate a block from buf_pool-&gt;zip_free[]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of buf_pool-&gt;zip_free[] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>allocated block, or NULL if buf_pool-&gt;zip_free[] was empty </dd></dl>

</div>
</div>
<a id="a3c0a809a3f02061918f7809e80293a87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c0a809a3f02061918f7809e80293a87">&#9670;&nbsp;</a></span>buf_buddy_block_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void buf_buddy_block_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deallocate a buffer frame of UNIV_PAGE_SIZE. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>buffer frame to deallocate </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a99334769246743018b31d9e4bb6fe763"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99334769246743018b31d9e4bb6fe763">&#9670;&nbsp;</a></span>buf_buddy_block_register()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void buf_buddy_block_register </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__block__t.html">buf_block_t</a> *&#160;</td>
          <td class="paramname"><em>block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate a buffer block to the buddy allocator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>buffer frame to allocate </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a873b76fad9dfe8134d2daeebde6cefdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a873b76fad9dfe8134d2daeebde6cefdb">&#9670;&nbsp;</a></span>buf_buddy_check_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UNIV_INLINE <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> buf_buddy_check_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Debug function to validate that a buffer is indeed free i.e. </p>
<p>: in the zip_free[]. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>block to check </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of buf_pool-&gt;zip_free[] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if free </dd></dl>

</div>
</div>
<a id="a89e563fdbb9e7113698e170c690978ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89e563fdbb9e7113698e170c690978ea">&#9670;&nbsp;</a></span>buf_buddy_condense_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buf_buddy_condense_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Combine all pairs of free buddies. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a88d52408491c21e80b726d32799a6cc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88d52408491c21e80b726d32799a6cc7">&#9670;&nbsp;</a></span>buf_buddy_free_low()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buf_buddy_free_low </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>has_zip_free</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocate a block. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>block to be freed, must not be pointed to by the buffer pool </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of buf_pool-&gt;zip_free[], or BUF_BUDDY_SIZES </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">has_zip_free</td><td>whether has zip_free_mutex </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad61475a0cac75ccf4c0bc0bef4fcb701"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad61475a0cac75ccf4c0bc0bef4fcb701">&#9670;&nbsp;</a></span>buf_buddy_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UNIV_INLINE void* buf_buddy_get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the offset of the buddy of a compressed page frame. </p>
<dl class="section return"><dt>Returns</dt><dd>the buddy relative of page </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">page</td><td>in: compressed page </td></tr>
    <tr><td class="paramname">size</td><td>in: page size in bytes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa0e0190ada19420110e91af275ba7599"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e0190ada19420110e91af275ba7599">&#9670;&nbsp;</a></span>buf_buddy_is_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="buf0buddy_8cc.html#a05e239e44baef98a36e4becaf1d4a77c">buf_buddy_state_t</a> buf_buddy_is_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if a buf is free i.e. </p>
<p>: in the zip_free[]. </p><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">BUF_BUDDY_STATE_FREE</td><td>if fully free </td></tr>
    <tr><td class="paramname">BUF_BUDDY_STATE_USED</td><td>if currently in use </td></tr>
    <tr><td class="paramname">BUF_BUDDY_STATE_PARTIALLY_USED</td><td>if partially in use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>in: block to check </td></tr>
    <tr><td class="paramname">i</td><td>in: index of buf_pool-&gt;zip_free[] </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1b75a65a273178d0e5b138a97c044a43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b75a65a273178d0e5b138a97c044a43">&#9670;&nbsp;</a></span>buf_buddy_list_validate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void buf_buddy_list_validate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Validate a buddy list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>buddy size to validate </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4f3e8d374afe96c2e7d998fc57043c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f3e8d374afe96c2e7d998fc57043c74">&#9670;&nbsp;</a></span>buf_buddy_realloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> buf_buddy_realloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to reallocate a block. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>block to be reallocated, must be pointed to by the buffer pool </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>block size, up to UNIV_PAGE_SIZE </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>if succeeded or if failed because the block was fixed </td></tr>
    <tr><td class="paramname">false</td><td>if failed because of no free blocks. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1af5c17f35f662a4d81392caebff1984"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1af5c17f35f662a4d81392caebff1984">&#9670;&nbsp;</a></span>buf_buddy_relocate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> buf_buddy_relocate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Try to relocate a block. </p>
<p>The caller must hold zip_free_mutex, and this function will release and lock it again. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>block to relocate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dst</td><td>free block to relocated to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of buf_pool-&gt;zip_free[] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">force</td><td>true if we must relocated always </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if relocated </dd></dl>

</div>
</div>
<a id="a0a37dbf6c8b5e9a57409053b63da63a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a37dbf6c8b5e9a57409053b63da63a8">&#9670;&nbsp;</a></span>buf_buddy_remove_from_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UNIV_INLINE void buf_buddy_remove_from_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__pool__t.html">buf_pool_t</a> *&#160;</td>
          <td class="paramname"><em>buf_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a block from the appropriate buddy free list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_pool</td><td>buffer pool instance </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buf</td><td>block to be freed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of buf_pool-&gt;zip_free[] </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6de053c39be91e8d38273ff19ce04d31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6de053c39be91e8d38273ff19ce04d31">&#9670;&nbsp;</a></span>buf_buddy_stamp_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UNIV_INLINE void buf_buddy_stamp_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stamps a buddy free. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>in/out: block to stamp </td></tr>
    <tr><td class="paramname">i</td><td>in: block size </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1e4d8879713068fd76d3350ea6d36f67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e4d8879713068fd76d3350ea6d36f67">&#9670;&nbsp;</a></span>buf_buddy_stamp_is_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UNIV_INLINE <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> buf_buddy_stamp_is_free </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structbuf__buddy__free__t.html">buf_buddy_free_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if a buddy is stamped free. </p>
<dl class="section return"><dt>Returns</dt><dd>whether the buddy is free </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>in: block to check </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_70f20ecf11358dff00a0daf546d3147e.html">storage</a></li><li class="navelem"><a class="el" href="dir_3fec0aa9607ea05e0bb1c96aee1a8c4e.html">innobase</a></li><li class="navelem"><a class="el" href="dir_19e7dc57837d445aa8a255d4d3e40a16.html">buf</a></li><li class="navelem"><a class="el" href="buf0buddy_8cc.html">buf0buddy.cc</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
