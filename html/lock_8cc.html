<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: sql/lock.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lock_8cc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">lock.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Locking functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="lock_8h_source.html">sql/lock.h</a>&quot;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;<a class="el" href="string_8h_source.html">string.h</a>&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;atomic&gt;</code><br />
<code>#include &quot;<a class="el" href="lex__string_8h_source.html">lex_string.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="m__ctype_8h_source.html">m_ctype.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="m__string_8h_source.html">m_string.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__base_8h_source.html">my_base.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__dbug_8h_source.html">my_dbug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__inttypes_8h_source.html">my_inttypes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__sqlcommand_8h_source.html">my_sqlcommand.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__sys_8h_source.html">my_sys.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="service__mysql__alloc_8h_source.html">mysql/service_mysql_alloc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mysql__com_8h_source.html">mysql_com.h</a>&quot;</code><br />
<code>#include &quot;mysqld_error.h&quot;</code><br />
<code>#include &quot;<a class="el" href="auth__common_8h_source.html">sql/auth/auth_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="types_2event_8h_source.html">sql/dd/types/event.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="function_8h_source.html">sql/dd/types/function.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="procedure_8h_source.html">sql/dd/types/procedure.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dd_2types_2resource__group_8h_source.html">sql/dd/types/resource_group.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="debug__sync_8h_source.html">sql/debug_sync.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql_2handler_8h_source.html">sql/handler.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mysqld_8h_source.html">sql/mysqld.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="psi__memory__key_8h_source.html">sql/psi_memory_key.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="session__tracker_8h_source.html">sql/session_tracker.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__base_8h_source.html">sql/sql_base.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__class_8h_source.html">sql/sql_class.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__const_8h_source.html">sql/sql_const.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__db_8h_source.html">sql/sql_db.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__lex_8h_source.html">sql/sql_lex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__parse_8h_source.html">sql/sql_parse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="system__variables_8h_source.html">sql/system_variables.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql_2table_8h_source.html">sql/table.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="thr__lock_8h_source.html">thr_lock.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga65cffe586bef8fdfb5334d343c069df6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga65cffe586bef8fdfb5334d343c069df6">GET_LOCK_UNLOCK</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ga65cffe586bef8fdfb5334d343c069df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1bef164e121fc9d85a6e19eae9625365"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga1bef164e121fc9d85a6e19eae9625365">GET_LOCK_STORE_LOCKS</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ga1bef164e121fc9d85a6e19eae9625365"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab05ccbacd3296a75556d7ff52a41b642"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gab05ccbacd3296a75556d7ff52a41b642">get_lock_data</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **table_ptr, size_t <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="mi__test1_8cc.html#a6eec09a91807e20d7b3d6ef3da594067">flags</a>)</td></tr>
<tr class="memdesc:gab05ccbacd3296a75556d7ff52a41b642"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get lock structures from table structs and initialize locks.  <a href="group__Locking.html#gab05ccbacd3296a75556d7ff52a41b642">More...</a><br /></td></tr>
<tr class="separator:gab05ccbacd3296a75556d7ff52a41b642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadeee13e85dfc0f473985f24f862c633f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gadeee13e85dfc0f473985f24f862c633f">lock_external</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **table, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>)</td></tr>
<tr class="separator:gadeee13e85dfc0f473985f24f862c633f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2022104b54fa744b1e6276b24c76eb74"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga2022104b54fa744b1e6276b24c76eb74">unlock_external</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **table, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>)</td></tr>
<tr class="memdesc:ga2022104b54fa744b1e6276b24c76eb74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock a set of external.  <a href="group__Locking.html#ga2022104b54fa744b1e6276b24c76eb74">More...</a><br /></td></tr>
<tr class="separator:ga2022104b54fa744b1e6276b24c76eb74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6d04e38cbcf6f9f05f18134f7abfc81"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gaa6d04e38cbcf6f9f05f18134f7abfc81">print_lock_error</a> (int error, const char *)</td></tr>
<tr class="separator:gaa6d04e38cbcf6f9f05f18134f7abfc81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae733785070441f315fc2b7d071a2545e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gae733785070441f315fc2b7d071a2545e">lock_tables_check</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **tables, size_t <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="mi__test1_8cc.html#a6eec09a91807e20d7b3d6ef3da594067">flags</a>)</td></tr>
<tr class="memdesc:gae733785070441f315fc2b7d071a2545e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform semantic checks for mysql_lock_tables.  <a href="group__Locking.html#gae733785070441f315fc2b7d071a2545e">More...</a><br /></td></tr>
<tr class="separator:gae733785070441f315fc2b7d071a2545e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3cdefe9db62025f107be509007ba15d1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga3cdefe9db62025f107be509007ba15d1">reset_lock_data</a> (<a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *sql_lock)</td></tr>
<tr class="memdesc:ga3cdefe9db62025f107be509007ba15d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset lock type in lock data.  <a href="group__Locking.html#ga3cdefe9db62025f107be509007ba15d1">More...</a><br /></td></tr>
<tr class="separator:ga3cdefe9db62025f107be509007ba15d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga809f844742e6e1c59e194939ec1170ca"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga809f844742e6e1c59e194939ec1170ca">track_table_access</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **tables, size_t <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>)</td></tr>
<tr class="memdesc:ga809f844742e6e1c59e194939ec1170ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scan array of tables for access types; update transaction tracker accordingly.  <a href="group__Locking.html#ga809f844742e6e1c59e194939ec1170ca">More...</a><br /></td></tr>
<tr class="separator:ga809f844742e6e1c59e194939ec1170ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9085310cb26b5f8574f517a7373f4740"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga9085310cb26b5f8574f517a7373f4740">reset_lock_data_and_free</a> (<a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> **mysql_lock)</td></tr>
<tr class="memdesc:ga9085310cb26b5f8574f517a7373f4740"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset lock type in lock data and free.  <a href="group__Locking.html#ga9085310cb26b5f8574f517a7373f4740">More...</a><br /></td></tr>
<tr class="separator:ga9085310cb26b5f8574f517a7373f4740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga40d9de997ac2ee4f94f358ce1ac2d76a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga40d9de997ac2ee4f94f358ce1ac2d76a">mysql_lock_tables</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **tables, size_t <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="mi__test1_8cc.html#a6eec09a91807e20d7b3d6ef3da594067">flags</a>)</td></tr>
<tr class="memdesc:ga40d9de997ac2ee4f94f358ce1ac2d76a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock tables.  <a href="group__Locking.html#ga40d9de997ac2ee4f94f358ce1ac2d76a">More...</a><br /></td></tr>
<tr class="separator:ga40d9de997ac2ee4f94f358ce1ac2d76a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2bff80304c9d27f634976ac8fe60cd38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga2bff80304c9d27f634976ac8fe60cd38">mysql_unlock_tables</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *sql_lock)</td></tr>
<tr class="separator:ga2bff80304c9d27f634976ac8fe60cd38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafad092ec9a399db99abd75b57a9ee679"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gafad092ec9a399db99abd75b57a9ee679">mysql_unlock_some_tables</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **table, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>)</td></tr>
<tr class="memdesc:gafad092ec9a399db99abd75b57a9ee679"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock some of the tables locked by mysql_lock_tables.  <a href="group__Locking.html#gafad092ec9a399db99abd75b57a9ee679">More...</a><br /></td></tr>
<tr class="separator:gafad092ec9a399db99abd75b57a9ee679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e24a131cbe030c49d953669f804877d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga1e24a131cbe030c49d953669f804877d">mysql_unlock_read_tables</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *sql_lock)</td></tr>
<tr class="memdesc:ga1e24a131cbe030c49d953669f804877d"><td class="mdescLeft">&#160;</td><td class="mdescRight">unlock all tables locked for read.  <a href="group__Locking.html#ga1e24a131cbe030c49d953669f804877d">More...</a><br /></td></tr>
<tr class="separator:ga1e24a131cbe030c49d953669f804877d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad40fe56766e1b54e2fed60814aec1e58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gad40fe56766e1b54e2fed60814aec1e58">mysql_lock_remove</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *locked, <a class="el" href="structTABLE.html">TABLE</a> *table)</td></tr>
<tr class="memdesc:gad40fe56766e1b54e2fed60814aec1e58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to find the table in the list of locked tables.  <a href="group__Locking.html#gad40fe56766e1b54e2fed60814aec1e58">More...</a><br /></td></tr>
<tr class="separator:gad40fe56766e1b54e2fed60814aec1e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2320fa808c9d6523790e796d57e2331"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gad2320fa808c9d6523790e796d57e2331">mysql_lock_abort_for_thread</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> *table)</td></tr>
<tr class="memdesc:gad2320fa808c9d6523790e796d57e2331"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort one thread / table combination.  <a href="group__Locking.html#gad2320fa808c9d6523790e796d57e2331">More...</a><br /></td></tr>
<tr class="separator:gad2320fa808c9d6523790e796d57e2331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae8e0ecd1f7872040079f5319aacd93a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gae8e0ecd1f7872040079f5319aacd93a2">mysql_lock_merge</a> (<a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *a, <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *b)</td></tr>
<tr class="separator:gae8e0ecd1f7872040079f5319aacd93a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac67865dd0ef1b003fdee2182aba9a049"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gac67865dd0ef1b003fdee2182aba9a049">lock_schema_name</a> (<a class="el" href="classTHD.html">THD</a> *thd, const char *db)</td></tr>
<tr class="memdesc:gac67865dd0ef1b003fdee2182aba9a049"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain an exclusive metadata lock on a schema name.  <a href="group__Locking.html#gac67865dd0ef1b003fdee2182aba9a049">More...</a><br /></td></tr>
<tr class="separator:gac67865dd0ef1b003fdee2182aba9a049"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga377fe3850ef2fce0988a3cffb9128159"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga377fe3850ef2fce0988a3cffb9128159">lock_tablespace_names</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="lock_8h.html#ae495da91bce6f4bb749636280f38aba4">Tablespace_hash_set</a> *tablespace_set, <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> lock_wait_timeout)</td></tr>
<tr class="memdesc:ga377fe3850ef2fce0988a3cffb9128159"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acquire IX MDL lock each tablespace name from the given set.  <a href="group__Locking.html#ga377fe3850ef2fce0988a3cffb9128159">More...</a><br /></td></tr>
<tr class="separator:ga377fe3850ef2fce0988a3cffb9128159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab03d9cc9ff9682e9f2a961685fd90cb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gab03d9cc9ff9682e9f2a961685fd90cb3">lock_object_name</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structMDL__key.html#a391ec4bd98fec6852a48f7856546ed3b">MDL_key::enum_mdl_namespace</a> mdl_type, const char *db, const char *<a class="el" href="persisted__variable_8cc.html#a02b8247840db27f85191d734d51598fa">name</a>)</td></tr>
<tr class="memdesc:gab03d9cc9ff9682e9f2a961685fd90cb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain an exclusive metadata lock on an object name.  <a href="group__Locking.html#gab03d9cc9ff9682e9f2a961685fd90cb3">More...</a><br /></td></tr>
<tr class="separator:gab03d9cc9ff9682e9f2a961685fd90cb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82691cb3b460e6ded2d667eb8669f3e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga82691cb3b460e6ded2d667eb8669f3e4">acquire_shared_global_read_lock</a> (<a class="el" href="classTHD.html">THD</a> *thd, unsigned long lock_wait_timeout)</td></tr>
<tr class="memdesc:ga82691cb3b460e6ded2d667eb8669f3e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acquire protection against the global read lock.  <a href="group__Locking.html#ga82691cb3b460e6ded2d667eb8669f3e4">More...</a><br /></td></tr>
<tr class="separator:ga82691cb3b460e6ded2d667eb8669f3e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga9ec7eb7dbcce8449c3a6df36c3945b08"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga9ec7eb7dbcce8449c3a6df36c3945b08">thr_lock_errno_to_mysql</a> []</td></tr>
<tr class="separator:ga9ec7eb7dbcce8449c3a6df36c3945b08"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Locking functions. </p>
<p>Because of the new concurrent inserts, we must first get external locks before getting internal locks. If we do it in the other order, the status information is not up to date when called from the lock handler.</p>
<p>GENERAL DESCRIPTION OF LOCKING</p>
<p>When not using LOCK TABLES:</p>
<ul>
<li>For each SQL statement mysql_lock_tables() is called for all involved tables.<ul>
<li>mysql_lock_tables() will call table_handler-&gt;external_lock(thd,locktype) for each table. This is followed by a call to thr_multi_lock() for all tables.</li>
</ul>
</li>
<li>When statement is done, we call mysql_unlock_tables(). This will call thr_multi_unlock() followed by table_handler-&gt;external_lock(thd, F_UNLCK) for each table.</li>
<li>Note that mysql_unlock_tables() may be called several times as MySQL in some cases can free some tables earlier than others.</li>
<li>The above is true both for normal and temporary tables.</li>
<li>Temporary non transactional tables are never passed to thr_multi_lock() and we never call external_lock(thd, F_UNLOCK) on these.</li>
</ul>
<p>When using LOCK TABLES:</p>
<ul>
<li>LOCK TABLE will call mysql_lock_tables() for all tables. mysql_lock_tables() will call table_handler-&gt;external_lock(thd,locktype) for each table. This is followed by a call to thr_multi_lock() for all tables.</li>
<li><p class="startli">For each statement, we will call table_handler-&gt;start_stmt(THD) to inform the table handler that we are using the table.</p>
<p class="startli">The tables used can only be tables used in LOCK TABLES or a temporary table.</p>
</li>
<li>When statement is done, we will call ha_commit_stmt(thd);</li>
<li>When calling UNLOCK TABLES we call mysql_unlock_tables() for all tables used in LOCK TABLES</li>
</ul>
<p>If table_handler-&gt;external_lock(thd, locktype) fails, we call table_handler-&gt;external_lock(thd, F_UNLCK) for each table that was locked, excluding one that caused failure. That means handler must cleanup itself in case external_lock() fails. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5bd71961b401a432086d0fb290a87f3f.html">sql</a></li><li class="navelem"><a class="el" href="lock_8cc.html">lock.cc</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
