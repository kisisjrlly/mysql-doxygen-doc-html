<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Authorization IDs, roles and users</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('AUTHORIZATION_PAGE.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Authorization IDs, roles and users </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="AUTHORIZATION_ID"></a>
Authentication ID</h1>
<h2><a class="anchor" id="AUTH_ID_DEFINITION"></a>
Definition</h2>
<p>Each row in the mysql.user table is identified by a user and host tuple. This tuple is the authorization ID. A client can authenticate with an authorization ID and a password. The ID is then referred to as a user or user name.</p>
<h1><a class="anchor" id="AUTHORIZATION_PRIVILEGES"></a>
Privileges ID</h1>
<h2><a class="anchor" id="AUTH_PRIV_DEFINITION"></a>
Definition</h2>
<p>A privilege ID is a named token which can be granted to an authorization ID.</p>
<p>A privilege can either be effective or not effective. An effective privilege is a privilege which used in a session to evaluate if a particular operation is allowed or not. All effective privileges are granted or inherited but not all privileges are effective.</p>
<h1><a class="anchor" id="AUTHORIZATION_ROLES"></a>
Roles</h1>
<h2><a class="anchor" id="AUTH_ROLES_DEFINITION"></a>
Definition</h2>
<p>A role is an authorization ID which can be granted to another authorization ID by forming an directed edge between them in the role graph where every vertex is a unique authorization ID. When the effective privilege is calculated, all connected roles are visited according to their edge direction and their corresponding granted privileges are aggregated.</p>
<h2><a class="anchor" id="ACTIVE_ROLE"></a>
Active roles</h2>
<p>A role can either be active or inactive. Active roles are kept in a thread local list which exists solely for the lifetime of a client session. Granted roles can be made active by 1) a SET ROLE statement, 2) after authentication if the role is a default role, 3) after authentication if the global variable opt_always_activate_roles_on_login is set to true.</p>
<p>Example: To set the grated role <code>team</code>@<code>%</code> as an active role, after authentication, execute: SET ROLE team</p>
<h2><a class="anchor" id="DEFAULT_ROLE"></a>
Default roles</h2>
<p>Each authorization ID has a list of default roles. Default roles belonging to an authorization ID are made into active roles after authentication iff they are granted to this ID. If the list of default roles is empty then no roles are made active after authentication unless the client sets a SET ROLE statement.</p>
<h2><a class="anchor" id="MANDATORY_ROLE"></a>
Mandatory roles</h2>
<p>A mandatory role is an authorization ID which is implicitly granted to every other authorization ID which has authenticated, regardless if this role has been previously granted or not. Mandatory roles are specified in a global variable. It's not required that the specified list maps to any existing authorization ID but if there's no previous authorization ID then no mandatory role can be granted. Mandatory roles are processed sequentially as any other granted role when the effective privilege of an authorization ID needs to be calculated iff they are active.</p>
<h1><a class="anchor" id="AUTHORIZATION_CACHE"></a>
The effective privilege cache</h1>
<h2><a class="anchor" id="OVERVIEW"></a>
Overview</h2>
<p>To avoid recalculating the effective privilege at every step the result is saved into a cache (See Acl_cache ). The key to this cache is formed by concatenating authorization ID, the active roles and the version ID of the cache.</p>
<p>The cache is a lockless hash storage and each element is assembled using read-only operations on the shared role graph. </p><dl class="section see"><dt>See also</dt><dd>get_privilege_access_maps</dd></dl>
<h1><a class="anchor" id="AUTHORIZATION_SHOW_GRANTS"></a>
SHOW GRANTS</h1>
<p>The statements</p><div class="fragment"><div class="line"><a class="code" href="sql__yacc_8h.html#a15c9f7bd2f0e9686df5d9df4f3314aa9af6b54e2f964c3204c88d0d82a509f65a">SHOW</a> <a class="code" href="sql__yacc_8h.html#a15c9f7bd2f0e9686df5d9df4f3314aa9a8104d53d065fdf289549328c28425489">GRANT</a> </div></div><!-- fragment --><p> shows all effective privileges using the currently active roles for the current user.</p>
<p>The statement</p><div class="fragment"><div class="line"><a class="code" href="sql__yacc_8h.html#a15c9f7bd2f0e9686df5d9df4f3314aa9af6b54e2f964c3204c88d0d82a509f65a">SHOW</a> <a class="code" href="sql__yacc_8h.html#a15c9f7bd2f0e9686df5d9df4f3314aa9a8104d53d065fdf289549328c28425489">GRANT</a> FOR x <a class="code" href="sql__yacc_8h.html#a15c9f7bd2f0e9686df5d9df4f3314aa9a53e282c10d69c749caca093b96995d68">USING</a> y </div></div><!-- fragment --><p> is used for listing the effective privilege for x given y as active roles. If If y isn't specified then no roles are used. If x isn't specified then the current_user() is used. Mandatory roles are always excluded from the list of granted roles when this statement is used.</p>
<p>Example: To show the privilege for a role using no roles: </p><div class="fragment"><div class="line"><a class="code" href="sql__yacc_8h.html#a15c9f7bd2f0e9686df5d9df4f3314aa9af6b54e2f964c3204c88d0d82a509f65a">SHOW</a> <a class="code" href="sql__yacc_8h.html#a15c9f7bd2f0e9686df5d9df4f3314aa9a8dba5115ce7b2a2892da83aaea61f54a">GRANTS</a> FOR x. </div></div><!-- fragment --><p>SHOW-statements does not use the privilege cache and the effective privilege is recalculated on every execution. </p><dl class="section see"><dt>See also</dt><dd>mysql_show_grants</dd></dl>
<p>To show the role graph use</p><div class="fragment"><div class="line">SELECT <a class="code" href="auth__common_8h.html#a032be9b52f1c41d39503552eea6a3a04">roles_graphml</a>() </div></div><!-- fragment --><p>To investigate the role graph use the built in XML functions or the mysql.role_edges table. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="PAGE_SECURITY.html">Security</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
