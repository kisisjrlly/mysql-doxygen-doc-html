<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Rpl_applier_reader Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classRpl__applier__reader.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classRpl__applier__reader-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Rpl_applier_reader Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class provides the feature to read events from relay log files.  
 <a href="classRpl__applier__reader.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rpl__applier__reader_8h_source.html">rpl_applier_reader.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader_1_1Stage__controller.html">Stage_controller</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">It manages a stage and the related mutex and makes the process of locking and entering stage/unlock and exiting stage as monolithic operations.  <a href="classRpl__applier__reader_1_1Stage__controller.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8bf07cd8ec14259b41fef2e9f5f1e657"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a8bf07cd8ec14259b41fef2e9f5f1e657">Rpl_applier_reader</a> (<a class="el" href="classRelay__log__info.html">Relay_log_info</a> *rli)</td></tr>
<tr class="separator:a8bf07cd8ec14259b41fef2e9f5f1e657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d275844edfe8078e576b79acf92854e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a7d275844edfe8078e576b79acf92854e">Rpl_applier_reader</a> (const <a class="el" href="classRpl__applier__reader.html">Rpl_applier_reader</a> &amp;)=delete</td></tr>
<tr class="separator:a7d275844edfe8078e576b79acf92854e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8223c4652eac8d33ae43a9888096bd8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRpl__applier__reader.html">Rpl_applier_reader</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#ac8223c4652eac8d33ae43a9888096bd8">operator=</a> (const <a class="el" href="classRpl__applier__reader.html">Rpl_applier_reader</a> &amp;)=delete</td></tr>
<tr class="separator:ac8223c4652eac8d33ae43a9888096bd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af91aa7909bf698bbb60e2b41fb3acafa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#af91aa7909bf698bbb60e2b41fb3acafa">~Rpl_applier_reader</a> ()</td></tr>
<tr class="separator:af91aa7909bf698bbb60e2b41fb3acafa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac36508db2141ad3ed049e70eda7bccef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#ac36508db2141ad3ed049e70eda7bccef">open</a> (const char **errmsg)</td></tr>
<tr class="memdesc:ac36508db2141ad3ed049e70eda7bccef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open the first relay log file which will be read by applier and seek to correct position.  <a href="#ac36508db2141ad3ed049e70eda7bccef">More...</a><br /></td></tr>
<tr class="separator:ac36508db2141ad3ed049e70eda7bccef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fc58d183cfc0eeaa5d0d15668ca5a4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a9fc58d183cfc0eeaa5d0d15668ca5a4f">close</a> ()</td></tr>
<tr class="separator:a9fc58d183cfc0eeaa5d0d15668ca5a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef9e304aad99268337adaed0bcda7f27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLog__event.html">Log_event</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#aef9e304aad99268337adaed0bcda7f27">read_next_event</a> ()</td></tr>
<tr class="memdesc:aef9e304aad99268337adaed0bcda7f27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read next event from relay log.  <a href="#aef9e304aad99268337adaed0bcda7f27">More...</a><br /></td></tr>
<tr class="separator:aef9e304aad99268337adaed0bcda7f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a71a1907cdeaa9a8ab4c82b36beae8ea8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a71a1907cdeaa9a8ab4c82b36beae8ea8">move_to_next_log</a> ()</td></tr>
<tr class="memdesc:a71a1907cdeaa9a8ab4c82b36beae8ea8"><td class="mdescLeft">&#160;</td><td class="mdescRight">When reaching the end of current relay log file, close it and open next relay log.  <a href="#a71a1907cdeaa9a8ab4c82b36beae8ea8">More...</a><br /></td></tr>
<tr class="separator:a71a1907cdeaa9a8ab4c82b36beae8ea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7212a20215d1417d5caa8cf08e0f7b9b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a7212a20215d1417d5caa8cf08e0f7b9b">read_active_log_end_pos</a> ()</td></tr>
<tr class="memdesc:a7212a20215d1417d5caa8cf08e0f7b9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">It reads the coordinates up to which the receiver thread has written and check whether there is any event to be read.  <a href="#a7212a20215d1417d5caa8cf08e0f7b9b">More...</a><br /></td></tr>
<tr class="separator:a7212a20215d1417d5caa8cf08e0f7b9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ff7e8e603906f49c0f6e1eb8fdaedac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRotate__log__event.html">Rotate_log_event</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a5ff7e8e603906f49c0f6e1eb8fdaedac">generate_rotate_event</a> ()</td></tr>
<tr class="memdesc:a5ff7e8e603906f49c0f6e1eb8fdaedac"><td class="mdescLeft">&#160;</td><td class="mdescRight">In the case receiver thread says master skipped some events, it will generate a Rotate_log_event for applier to advance executed master log position.  <a href="#a5ff7e8e603906f49c0f6e1eb8fdaedac">More...</a><br /></td></tr>
<tr class="separator:a5ff7e8e603906f49c0f6e1eb8fdaedac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6102693a83b3f45f9cbdc0037760b28"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#af6102693a83b3f45f9cbdc0037760b28">purge_applied_logs</a> ()</td></tr>
<tr class="memdesc:af6102693a83b3f45f9cbdc0037760b28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Purge relay log files prior to m_rli-&gt;group_relay_log_name.  <a href="#af6102693a83b3f45f9cbdc0037760b28">More...</a><br /></td></tr>
<tr class="separator:af6102693a83b3f45f9cbdc0037760b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e98379769a3fdbdd4dee65dfacac2b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a4e98379769a3fdbdd4dee65dfacac2b8">wait_for_new_event</a> ()</td></tr>
<tr class="memdesc:a4e98379769a3fdbdd4dee65dfacac2b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for new events coming.  <a href="#a4e98379769a3fdbdd4dee65dfacac2b8">More...</a><br /></td></tr>
<tr class="separator:a4e98379769a3fdbdd4dee65dfacac2b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74ab6b08de846a04bbfbc6de2e6f39ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a74ab6b08de846a04bbfbc6de2e6f39ed">reopen_log_reader_if_needed</a> ()</td></tr>
<tr class="memdesc:a74ab6b08de846a04bbfbc6de2e6f39ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">It checks if the relaylog file reader should be reopened and then reopens the reader if receiver thread truncated some data from active relay log.  <a href="#a74ab6b08de846a04bbfbc6de2e6f39ed">More...</a><br /></td></tr>
<tr class="separator:a74ab6b08de846a04bbfbc6de2e6f39ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee728eb253262f96817a73631da9d20b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#aee728eb253262f96817a73631da9d20b">reset_seconds_behind_master</a> ()</td></tr>
<tr class="separator:aee728eb253262f96817a73631da9d20b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf652bb31237f522bc9ca3f2e16effbe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#abf652bb31237f522bc9ca3f2e16effbe">disable_relay_log_space_limit_if_needed</a> ()</td></tr>
<tr class="memdesc:abf652bb31237f522bc9ca3f2e16effbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporarily disables the receiver thread's check for log space, allowing it to queue more than log_space_limit events or rotate relay log.  <a href="#abf652bb31237f522bc9ca3f2e16effbe">More...</a><br /></td></tr>
<tr class="separator:abf652bb31237f522bc9ca3f2e16effbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2ace8ea6dd4da53bc50fe0d8c14c2a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#ac2ace8ea6dd4da53bc50fe0d8c14c2a3">debug_print_next_event_positions</a> ()</td></tr>
<tr class="separator:ac2ace8ea6dd4da53bc50fe0d8c14c2a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a70c6679669ceb317364364121f02b512"><td class="memItemLeft" align="right" valign="top"><a class="el" href="binlog__reader_8h.html#afc6ffb22090025e92b29be7e6ec231cb">Relaylog_file_reader</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a70c6679669ceb317364364121f02b512">m_relaylog_file_reader</a></td></tr>
<tr class="separator:a70c6679669ceb317364364121f02b512"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39e76af1e72583e21492dd9a082276dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRelay__log__info.html">Relay_log_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a39e76af1e72583e21492dd9a082276dd">m_rli</a> = <a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a></td></tr>
<tr class="separator:a39e76af1e72583e21492dd9a082276dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ba942f3ac1866569b32500d98498532"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a6ba942f3ac1866569b32500d98498532">m_errmsg</a> = <a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a></td></tr>
<tr class="memdesc:a6ba942f3ac1866569b32500d98498532"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the error message which is used internally.  <a href="#a6ba942f3ac1866569b32500d98498532">More...</a><br /></td></tr>
<tr class="separator:a6ba942f3ac1866569b32500d98498532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71ee6663ee63812df8a4dea7518b8093"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a71ee6663ee63812df8a4dea7518b8093">m_reading_active_log</a> = <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a></td></tr>
<tr class="separator:a71ee6663ee63812df8a4dea7518b8093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad079c205324e7435dc1b2dd9a4145048"><td class="memItemLeft" align="right" valign="top"><a class="el" href="my__inttypes_8h.html#a378b5b2448c7170f4b6bd225583e8a19">my_off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#ad079c205324e7435dc1b2dd9a4145048">m_log_end_pos</a> = 0</td></tr>
<tr class="memdesc:ad079c205324e7435dc1b2dd9a4145048"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores active log's end position.  <a href="#ad079c205324e7435dc1b2dd9a4145048">More...</a><br /></td></tr>
<tr class="separator:ad079c205324e7435dc1b2dd9a4145048"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d23b1a9034b416d9b058daf4ffde7b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structLOG__INFO.html">LOG_INFO</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a40d23b1a9034b416d9b058daf4ffde7b">m_linfo</a></td></tr>
<tr class="separator:a40d23b1a9034b416d9b058daf4ffde7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25f6f605cc876725e758e99e276ab6cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRpl__applier__reader.html#a25f6f605cc876725e758e99e276ab6cb">m_relay_log_purge</a> = <a class="el" href="mysqld_8h.html#ac66412d262cc7f5651e8887ff1ef7d21">relay_log_purge</a></td></tr>
<tr class="separator:a25f6f605cc876725e758e99e276ab6cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class provides the feature to read events from relay log files. </p>
<ul>
<li>Open() function just opens the first relay log file (rli-&gt;get_group_relay_log_name()) which need to be applied by slave.</li>
<li>read_next_event() just returns the events one by one. It will close() current relay log and open next relay log file automatically when reaching the end of current relay log. Internally each relay log file is opened and read by using a Relaylog_file_reader.</li>
<li>It will purge the applied relay logs accordingly when moving to next relay log.</li>
<li>When reaching the end of active relay log file, it will wait for new events coming and make MTS checkpoints accordingly while waiting for events. </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8bf07cd8ec14259b41fef2e9f5f1e657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bf07cd8ec14259b41fef2e9f5f1e657">&#9670;&nbsp;</a></span>Rpl_applier_reader() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rpl_applier_reader::Rpl_applier_reader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRelay__log__info.html">Relay_log_info</a> *&#160;</td>
          <td class="paramname"><em>rli</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rli</td><td>relay log info is used in the function. So rli should be initialized before initializing Rpl_applier_reader object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7d275844edfe8078e576b79acf92854e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d275844edfe8078e576b79acf92854e">&#9670;&nbsp;</a></span>Rpl_applier_reader() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Rpl_applier_reader::Rpl_applier_reader </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classRpl__applier__reader.html">Rpl_applier_reader</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af91aa7909bf698bbb60e2b41fb3acafa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af91aa7909bf698bbb60e2b41fb3acafa">&#9670;&nbsp;</a></span>~Rpl_applier_reader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Rpl_applier_reader::~Rpl_applier_reader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9fc58d183cfc0eeaa5d0d15668ca5a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fc58d183cfc0eeaa5d0d15668ca5a4f">&#9670;&nbsp;</a></span>close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Rpl_applier_reader::close </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac2ace8ea6dd4da53bc50fe0d8c14c2a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2ace8ea6dd4da53bc50fe0d8c14c2a3">&#9670;&nbsp;</a></span>debug_print_next_event_positions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rpl_applier_reader::debug_print_next_event_positions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abf652bb31237f522bc9ca3f2e16effbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf652bb31237f522bc9ca3f2e16effbe">&#9670;&nbsp;</a></span>disable_relay_log_space_limit_if_needed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rpl_applier_reader::disable_relay_log_space_limit_if_needed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Temporarily disables the receiver thread's check for log space, allowing it to queue more than log_space_limit events or rotate relay log. </p>
<p>This is needed to avoid a deadlock in the following situation :</p><ul>
<li>the I/O thread has reached log_space_limit</li>
<li>the SQL thread has read all relay logs, but cannot purge for some reasons: it has already purged all logs except the current one there are other logs than the current one but they're involved in a transaction that is not finished.</li>
</ul>
<p>Solution : Wake up the possibly waiting I/O thread, and set a boolean asking the I/O thread to temporarily ignore the log_space_limit constraint. Then the I/O thread stops waiting and reads one more event and starts honoring log_space_limit again.</p>
<p>If the SQL thread needs more events to be able to rotate the log (it might need to finish the current group first), then it can ask for one more at a time. Thus we don't outgrow the relay log indefinitely, but rather in a controlled manner, until the next rotate. </p>

</div>
</div>
<a id="a5ff7e8e603906f49c0f6e1eb8fdaedac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ff7e8e603906f49c0f6e1eb8fdaedac">&#9670;&nbsp;</a></span>generate_rotate_event()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRotate__log__event.html">Rotate_log_event</a> * Rpl_applier_reader::generate_rotate_event </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>In the case receiver thread says master skipped some events, it will generate a Rotate_log_event for applier to advance executed master log position. </p>

</div>
</div>
<a id="a71a1907cdeaa9a8ab4c82b36beae8ea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71a1907cdeaa9a8ab4c82b36beae8ea8">&#9670;&nbsp;</a></span>move_to_next_log()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Rpl_applier_reader::move_to_next_log </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>When reaching the end of current relay log file, close it and open next relay log. </p>
<p>purge old relay logs if necessary.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>Success </td></tr>
    <tr><td class="paramname">true</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac36508db2141ad3ed049e70eda7bccef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac36508db2141ad3ed049e70eda7bccef">&#9670;&nbsp;</a></span>open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Rpl_applier_reader::open </td>
          <td>(</td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>errmsg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open the first relay log file which will be read by applier and seek to correct position. </p>
<p>The file name and position are read from rli-&gt;get_group_master_log_name() and rli-&gt;get_group_relay_log_pos().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">errmsg</td><td>Set the error message to it if any error happens.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>Success </td></tr>
    <tr><td class="paramname">true</td><td>Error </td></tr>
  </table>
  </dd>
</dl>
<p>group_relay_log_name may be different from the one in index file. For example group_relay_log_name includes a full path. But the one in index file has relative path. So set group_relay_log_name to the one in index file. It guarantes MYSQL_BIN_LOG::purge works well.</p>

</div>
</div>
<a id="ac8223c4652eac8d33ae43a9888096bd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8223c4652eac8d33ae43a9888096bd8">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRpl__applier__reader.html">Rpl_applier_reader</a>&amp; Rpl_applier_reader::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classRpl__applier__reader.html">Rpl_applier_reader</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af6102693a83b3f45f9cbdc0037760b28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6102693a83b3f45f9cbdc0037760b28">&#9670;&nbsp;</a></span>purge_applied_logs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Rpl_applier_reader::purge_applied_logs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Purge relay log files prior to m_rli-&gt;group_relay_log_name. </p>
<p>It is used to be called MYSQL_BIN_LOG::purge_first_log</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>Success </td></tr>
    <tr><td class="paramname">true</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7212a20215d1417d5caa8cf08e0f7b9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7212a20215d1417d5caa8cf08e0f7b9b">&#9670;&nbsp;</a></span>read_active_log_end_pos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Rpl_applier_reader::read_active_log_end_pos </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>It reads the coordinates up to which the receiver thread has written and check whether there is any event to be read. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>The applier has read all events. </td></tr>
    <tr><td class="paramname">true</td><td>The applier is behind the receiver. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aef9e304aad99268337adaed0bcda7f27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef9e304aad99268337adaed0bcda7f27">&#9670;&nbsp;</a></span>read_next_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLog__event.html">Log_event</a> * Rpl_applier_reader::read_next_event </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read next event from relay log. </p>
<ul>
<li>It will wait until the receiver writes some events to relay log in case where there are no more events left to read from the active relay log.</li>
<li>The caller must hold m_rli-&gt;data_lock. The lock will be released temporarily while waiting and required after waking up.</li>
<li>The wait is protected by relay_log.lock_binlog_end_pos().</li>
</ul>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Log_event*</td><td>A valid Log_event object. </td></tr>
    <tr><td class="paramname">nullptr</td><td>Error happened or sql thread was killed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a74ab6b08de846a04bbfbc6de2e6f39ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74ab6b08de846a04bbfbc6de2e6f39ed">&#9670;&nbsp;</a></span>reopen_log_reader_if_needed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Rpl_applier_reader::reopen_log_reader_if_needed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>It checks if the relaylog file reader should be reopened and then reopens the reader if receiver thread truncated some data from active relay log. </p>
<p>The caller must hold m_rli-&gt;data_lock</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>Success </td></tr>
    <tr><td class="paramname">true</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aee728eb253262f96817a73631da9d20b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee728eb253262f96817a73631da9d20b">&#9670;&nbsp;</a></span>reset_seconds_behind_master()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Rpl_applier_reader::reset_seconds_behind_master </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4e98379769a3fdbdd4dee65dfacac2b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e98379769a3fdbdd4dee65dfacac2b8">&#9670;&nbsp;</a></span>wait_for_new_event()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Rpl_applier_reader::wait_for_new_event </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Waits for new events coming. </p>
<p>Returning successfully just means it gets a signal. That doesn't guarantee that any new event came.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>Success </td></tr>
    <tr><td class="paramname">true</td><td>Error. The thread is killed or flush failed while executing mts_checkpoint_routine.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>the The caller must hold m_rli-&gt;data_lock and relaylog.lock_binlog_end_pos(). </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a6ba942f3ac1866569b32500d98498532"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ba942f3ac1866569b32500d98498532">&#9670;&nbsp;</a></span>m_errmsg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* Rpl_applier_reader::m_errmsg = <a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores the error message which is used internally. </p>

</div>
</div>
<a id="a40d23b1a9034b416d9b058daf4ffde7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40d23b1a9034b416d9b058daf4ffde7b">&#9670;&nbsp;</a></span>m_linfo</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structLOG__INFO.html">LOG_INFO</a> Rpl_applier_reader::m_linfo</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad079c205324e7435dc1b2dd9a4145048"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad079c205324e7435dc1b2dd9a4145048">&#9670;&nbsp;</a></span>m_log_end_pos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="my__inttypes_8h.html#a378b5b2448c7170f4b6bd225583e8a19">my_off_t</a> Rpl_applier_reader::m_log_end_pos = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores active log's end position. </p>
<p>Thus avoids to call relay_log.get_binlog_log_pos() for each event. </p>

</div>
</div>
<a id="a71ee6663ee63812df8a4dea7518b8093"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71ee6663ee63812df8a4dea7518b8093">&#9670;&nbsp;</a></span>m_reading_active_log</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Rpl_applier_reader::m_reading_active_log = <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a25f6f605cc876725e758e99e276ab6cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25f6f605cc876725e758e99e276ab6cb">&#9670;&nbsp;</a></span>m_relay_log_purge</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Rpl_applier_reader::m_relay_log_purge = <a class="el" href="mysqld_8h.html#ac66412d262cc7f5651e8887ff1ef7d21">relay_log_purge</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a70c6679669ceb317364364121f02b512"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70c6679669ceb317364364121f02b512">&#9670;&nbsp;</a></span>m_relaylog_file_reader</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="binlog__reader_8h.html#afc6ffb22090025e92b29be7e6ec231cb">Relaylog_file_reader</a> Rpl_applier_reader::m_relaylog_file_reader</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a39e76af1e72583e21492dd9a082276dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39e76af1e72583e21492dd9a082276dd">&#9670;&nbsp;</a></span>m_rli</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRelay__log__info.html">Relay_log_info</a>* Rpl_applier_reader::m_rli = <a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>sql/<a class="el" href="rpl__applier__reader_8h_source.html">rpl_applier_reader.h</a></li>
<li>sql/<a class="el" href="rpl__applier__reader_8cc.html">rpl_applier_reader.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classRpl__applier__reader.html">Rpl_applier_reader</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
