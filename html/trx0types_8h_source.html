<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: storage/innobase/include/trx0types.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('trx0types_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">trx0types.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="trx0types_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*****************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">Copyright (c) 1996, 2020, Oracle and/or its affiliates. All Rights Reserved.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">This program is free software; you can redistribute it and/or modify it under</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">the terms of the GNU General Public License, version 2.0, as published by the</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">Free Software Foundation.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">This program is also distributed with certain software (including but not</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">limited to OpenSSL) that is licensed under separate terms, as designated in a</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">particular file or component or in included license documentation. The authors</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">of MySQL hereby grant you an additional permission to link the program and</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">your derivative works with the separately licensed software that they have</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">included with MySQL.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">FOR A PARTICULAR PURPOSE. See the GNU General Public License, version 2.0,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">for more details.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">You should have received a copy of the GNU General Public License along with</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">this program; if not, write to the Free Software Foundation, Inc.,</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">*****************************************************************************/</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/** @file include/trx0types.h</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> Transaction system global type definitions</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> Created 3/26/1996 Heikki Tuuri</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> *******************************************************/</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#ifndef trx0types_h</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#define trx0types_h</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="page0size_8h.html">page0size.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sync0rw_8h.html">sync0rw.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ut0byte_8h.html">ut0byte.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ut0mutex_8h.html">ut0mutex.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ut0new_8h.html">ut0new.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;atomic&gt;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;queue&gt;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//#include &lt;unordered_set&gt;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/** printf(3) format used for printing DB_TRX_ID and other system fields */</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a377b06d0a00a07b37e0acad670cdee22">   50</a></span>&#160;<span class="preprocessor">#define TRX_ID_FMT IB_ID_FMT</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/** Space id of the transaction system page (the system tablespace) */</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="trx0types_8h.html#ad30d6802ba5017c3db592827e1c90b03">   53</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="api0api_8h.html#a02e9c11b4a9783f4b0b89fcf060f8f28">space_id_t</a> <a class="code" href="trx0types_8h.html#ad30d6802ba5017c3db592827e1c90b03">TRX_SYS_SPACE</a> = 0;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">/** Page number of the transaction system page */</span></div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a4536dedefbd75b32425599e25e7b01fc">   56</a></span>&#160;<span class="preprocessor">#define TRX_SYS_PAGE_NO FSP_TRX_SYS_PAGE_NO</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/** Random value to check for corruption of trx_t */</span></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a2d4f0dbb79553916647c12513864a2c9">   59</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> ulint <a class="code" href="trx0types_8h.html#a2d4f0dbb79553916647c12513864a2c9">TRX_MAGIC_N</a> = 91118598;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">/** If this flag is set then the transaction cannot be rolled back</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">asynchronously. */</span></div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a671a381e3a8143e9612e31dc898960bc">   63</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> ib_uint32_t <a class="code" href="trx0types_8h.html#a671a381e3a8143e9612e31dc898960bc">TRX_FORCE_ROLLBACK_DISABLE</a> = 1 &lt;&lt; 29;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/** Was the transaction rolled back asynchronously or by the</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">owning thread. This flag is relevant only if TRX_FORCE_ROLLBACK</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">is set.  */</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a773741653a7a52c9fd9ef521805265af">   68</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> ib_uint32_t <a class="code" href="trx0types_8h.html#a773741653a7a52c9fd9ef521805265af">TRX_FORCE_ROLLBACK_ASYNC</a> = 1 &lt;&lt; 30;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">/** Mark the transaction for forced rollback */</span></div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a885c60219b17a02d06d4ab096803c02a">   71</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> ib_uint32_t <a class="code" href="trx0types_8h.html#a885c60219b17a02d06d4ab096803c02a">TRX_FORCE_ROLLBACK</a> = 1 &lt;&lt; 31;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">/** For masking out the above four flags */</span></div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a365d8e86502c13b65cd1749fd453f75a">   74</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> ib_uint32_t <a class="code" href="trx0types_8h.html#a365d8e86502c13b65cd1749fd453f75a">TRX_FORCE_ROLLBACK_MASK</a> = 0x1FFFFFFF;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">/** Transaction execution states when trx-&gt;state == TRX_STATE_ACTIVE */</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759f">   77</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759f">trx_que_t</a> {</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa1d4fdb057b83f63809adc81eb11576d2">   78</a></span>&#160;  <a class="code" href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa1d4fdb057b83f63809adc81eb11576d2">TRX_QUE_RUNNING</a>,      <span class="comment">/*!&lt; transaction is running */</span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa01e98856c706e749462e97060479bcfd">   79</a></span>&#160;  <a class="code" href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa01e98856c706e749462e97060479bcfd">TRX_QUE_LOCK_WAIT</a>,    <span class="comment">/*!&lt; transaction is waiting for</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">                        a lock */</span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa84d6f7b62b3c089187e37b6b384dfbcb">   81</a></span>&#160;  <a class="code" href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa84d6f7b62b3c089187e37b6b384dfbcb">TRX_QUE_ROLLING_BACK</a>, <span class="comment">/*!&lt; transaction is rolling back */</span></div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa7aeb76d40ddafe996b8f6fe7c6864c67">   82</a></span>&#160;  <a class="code" href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa7aeb76d40ddafe996b8f6fe7c6864c67">TRX_QUE_COMMITTING</a>    <span class="comment">/*!&lt; transaction is committing */</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;};</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/** Transaction states (trx_t::state) */</span></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfe">   86</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfe">trx_state_t</a> {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfeab6d43468942f04bb539f0a0ef3fda5e7">   88</a></span>&#160;  <a class="code" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfeab6d43468942f04bb539f0a0ef3fda5e7">TRX_STATE_NOT_STARTED</a>,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">  /** Same as not started but with additional semantics that it</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">  was rolled back asynchronously the last time it was active. */</span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfea715252714bf7cbda62aeeed0f155ba59">   92</a></span>&#160;  <a class="code" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfea715252714bf7cbda62aeeed0f155ba59">TRX_STATE_FORCED_ROLLBACK</a>,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfea78e4ef9dc7c38690f85ca0b99953c91f">   94</a></span>&#160;  <a class="code" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfea78e4ef9dc7c38690f85ca0b99953c91f">TRX_STATE_ACTIVE</a>,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">  /** Support for 2PC/XA */</span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfeaec0a7e922a9ac4226678ec8ffcdbbf73">   97</a></span>&#160;  <a class="code" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfeaec0a7e922a9ac4226678ec8ffcdbbf73">TRX_STATE_PREPARED</a>,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfea7b804d92242ae352a4346055734aef96">   99</a></span>&#160;  <a class="code" href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfea7b804d92242ae352a4346055734aef96">TRX_STATE_COMMITTED_IN_MEMORY</a></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;};</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/** Type of data dictionary operation */</span></div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599">  103</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599">trx_dict_op_t</a> {<span class="comment"></span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">  /** The transaction is not modifying the data dictionary. */</span></div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599a50ffbbfbd919460992d5508f4701b973">  105</a></span>&#160;  <a class="code" href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599a50ffbbfbd919460992d5508f4701b973">TRX_DICT_OP_NONE</a> = 0,<span class="comment"></span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">  /** The transaction is creating a table or an index, or</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">  dropping a table.  The table must be dropped in crash</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">  recovery.  This and TRX_DICT_OP_NONE are the only possible</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">  operation modes in crash recovery. */</span></div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599a0528c5f10ae8ece6516841f1f3e8e7f7">  110</a></span>&#160;  <a class="code" href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599a0528c5f10ae8ece6516841f1f3e8e7f7">TRX_DICT_OP_TABLE</a> = 1,<span class="comment"></span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">  /** The transaction is creating or dropping an index in an</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">  existing table.  In crash recovery, the data dictionary</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">  must be locked, but the table must not be dropped. */</span></div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599a9e7738bb967478dc6b673894b982466e">  114</a></span>&#160;  <a class="code" href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599a9e7738bb967478dc6b673894b982466e">TRX_DICT_OP_INDEX</a> = 2</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;};</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/** Memory objects */</span><span class="comment"></span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">/** @{ */</span><span class="comment"></span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">/** Transaction */</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">struct </span><a class="code" href="structtrx__t.html">trx_t</a>;<span class="comment"></span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">/** The locks and state of an active transaction */</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">struct </span><a class="code" href="structtrx__lock__t.html">trx_lock_t</a>;<span class="comment"></span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/** Transaction system */</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keyword">struct </span><a class="code" href="structtrx__sys__t.html">trx_sys_t</a>;<span class="comment"></span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">/** Signal */</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keyword">struct </span>trx_sig_t;<span class="comment"></span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">/** Rollback segment */</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keyword">struct </span><a class="code" href="structtrx__rseg__t.html">trx_rseg_t</a>;<span class="comment"></span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">/** Transaction undo log */</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">struct </span><a class="code" href="structtrx__undo__t.html">trx_undo_t</a>;<span class="comment"></span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">/** The control structure used in the purge operation */</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">struct </span><a class="code" href="structtrx__purge__t.html">trx_purge_t</a>;<span class="comment"></span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">/** Rollback command node in a query graph */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">struct </span><a class="code" href="structroll__node__t.html">roll_node_t</a>;<span class="comment"></span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/** Commit command node in a query graph */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">struct </span><a class="code" href="structcommit__node__t.html">commit_node_t</a>;<span class="comment"></span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">/** SAVEPOINT command node in a query graph */</span></div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a3f6397f57064f579d2c5d68884ba44e0">  138</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structtrx__named__savept__t.html">trx_named_savept_t</a>;<span class="comment"></span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">/** @} */</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">/** Row identifier (DB_ROW_ID, DATA_ROW_ID) */</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keyword">typedef</span> ib_id_t <a class="code" href="trx0types_8h.html#a3f6397f57064f579d2c5d68884ba44e0">row_id_t</a>;<span class="comment"></span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/** Transaction identifier (DB_TRX_ID, DATA_TRX_ID) */</span></div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">  144</a></span>&#160;<span class="keyword">typedef</span> ib_id_t <a class="code" href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a>;<span class="comment"></span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/** Rollback pointer (DB_ROLL_PTR, DATA_ROLL_PTR) */</span></div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="trx0types_8h.html#ad3ccac613ce33a8680d147c4a4f12e94">  146</a></span>&#160;<span class="keyword">typedef</span> ib_id_t <a class="code" href="trx0types_8h.html#ad3ccac613ce33a8680d147c4a4f12e94">roll_ptr_t</a>;<span class="comment"></span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">/** Undo number */</span></div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a4661d2883c1cd5d8f1cfbd63b553f1bc">  148</a></span>&#160;<span class="keyword">typedef</span> ib_id_t <a class="code" href="trx0types_8h.html#a4661d2883c1cd5d8f1cfbd63b553f1bc">undo_no_t</a>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">/** Maximum transaction identifier */</span></div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a37fe08c8602330df8b2357c759f1c948">  151</a></span>&#160;<span class="preprocessor">#define TRX_ID_MAX IB_ID_MAX</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">/** Transaction savepoint */</span></div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="structtrx__savept__t.html">  154</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structtrx__savept__t.html">trx_savept_t</a> {</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="structtrx__savept__t.html#a8b895c7baec9f7c4fc1ebceea9e875df">  155</a></span>&#160;  <a class="code" href="trx0types_8h.html#a4661d2883c1cd5d8f1cfbd63b553f1bc">undo_no_t</a> <a class="code" href="structtrx__savept__t.html#a8b895c7baec9f7c4fc1ebceea9e875df">least_undo_no</a>; <span class="comment">/*!&lt; least undo number to undo */</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;};</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">/** File objects */</span><span class="comment"></span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">/** @{ */</span><span class="comment"></span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">/** Transaction system header */</span></div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="trx0types_8h.html#abc7dff1e33c4bec72afa7fc0f1e8e165">  161</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> <a class="code" href="trx0types_8h.html#abc7dff1e33c4bec72afa7fc0f1e8e165">trx_sysf_t</a>;<span class="comment"></span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">/** Rollback segment array header */</span></div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a4e5a174061b59c084c23b13eb761e04c">  163</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> <a class="code" href="trx0types_8h.html#a4e5a174061b59c084c23b13eb761e04c">trx_rsegsf_t</a>;<span class="comment"></span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">/** Rollback segment header */</span></div><div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a8bdb9d55e50652fb2ff0952e136d5aba">  165</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> <a class="code" href="trx0types_8h.html#a8bdb9d55e50652fb2ff0952e136d5aba">trx_rsegf_t</a>;<span class="comment"></span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">/** Undo segment header */</span></div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a48f03c2f78d0f7ca9fa271dff3484e26">  167</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> <a class="code" href="trx0types_8h.html#a48f03c2f78d0f7ca9fa271dff3484e26">trx_usegf_t</a>;<span class="comment"></span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">/** Undo log header */</span></div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a64150d81cbf5eba60e4a902c2c8d7a1a">  169</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> <a class="code" href="trx0types_8h.html#a64150d81cbf5eba60e4a902c2c8d7a1a">trx_ulogf_t</a>;<span class="comment"></span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">/** Undo log page header */</span></div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a48243b30e18edafa533b4273840ad668">  171</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> <a class="code" href="trx0types_8h.html#a48243b30e18edafa533b4273840ad668">trx_upagef_t</a>;<span class="comment"></span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">/** Undo log record */</span></div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">  173</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> <a class="code" href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">trx_undo_rec_t</a>;<span class="comment"></span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">/** @} */</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a8d7dc342a58ab67f326d9139058605e2">  176</a></span>&#160;<span class="keyword">typedef</span> ib_mutex_t <a class="code" href="trx0types_8h.html#a8d7dc342a58ab67f326d9139058605e2">RsegMutex</a>;</div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a044545240fb71e3a64171596e66e0336">  177</a></span>&#160;<span class="keyword">typedef</span> ib_mutex_t <a class="code" href="trx0types_8h.html#a044545240fb71e3a64171596e66e0336">TrxMutex</a>;</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="trx0types_8h.html#ac731378a2d6ecb952f6cfe4e093568e8">  178</a></span>&#160;<span class="keyword">typedef</span> ib_mutex_t <a class="code" href="trx0types_8h.html#ac731378a2d6ecb952f6cfe4e093568e8">UndoMutex</a>;</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a7ee9bc504dcbfa844005c74ead830856">  179</a></span>&#160;<span class="keyword">typedef</span> ib_mutex_t <a class="code" href="trx0types_8h.html#a7ee9bc504dcbfa844005c74ead830856">PQMutex</a>;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="trx0types_8h.html#af2a8aeff6138cf8f68340a6bcb840cc2">  180</a></span>&#160;<span class="keyword">typedef</span> ib_mutex_t <a class="code" href="trx0types_8h.html#af2a8aeff6138cf8f68340a6bcb840cc2">TrxSysMutex</a>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">/** The rollback segment memory object */</span></div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html">  183</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structtrx__rseg__t.html">trx_rseg_t</a> {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">#ifdef UNIV_DEBUG</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">  /** Validate the curr_size member by re-calculating it.</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">  @param[in]  take_mutex  take the rseg-&gt;mutex. default is true.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">  @return true if valid, false otherwise. */</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordtype">bool</span> validate_curr_size(<span class="keywordtype">bool</span> take_mutex = <span class="keyword">true</span>);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* UNIV_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">  /** Enter the rseg-&gt;mutex. */</span></div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#afd6cba92aeb919b312b8cc945c6fcf8b">  192</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structtrx__rseg__t.html#afd6cba92aeb919b312b8cc945c6fcf8b">latch</a>() {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="ut0mutex_8h.html#aba9ab29617d78284418d99bc1a06865d">mutex_enter</a>(&amp;<a class="code" href="memcached_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="ut0dbg_8h.html#a17113dab7f37e298e889ac8818ab13d0">ut_ad</a>(validate_curr_size(<span class="keyword">false</span>));</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">  /** Exit the rseg-&gt;mutex. */</span></div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#af8bcd07540fc6a1a73fb0f6377603a75">  198</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structtrx__rseg__t.html#af8bcd07540fc6a1a73fb0f6377603a75">unlatch</a>() {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="ut0dbg_8h.html#a17113dab7f37e298e889ac8818ab13d0">ut_ad</a>(validate_curr_size(<span class="keyword">false</span>));</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="ut0mutex_8h.html#aa55ad8b49fb970ed42f72485f53e1547">mutex_exit</a>(&amp;<a class="code" href="memcached_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">  /** Decrement the current size of the rollback segment by the given number</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">  of pages.</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">  @param[in]  npages  number of pages to reduce in size. */</span></div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a4c372629685635f4ee2c69fef2f8da47">  206</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structtrx__rseg__t.html#a4c372629685635f4ee2c69fef2f8da47">decr_curr_size</a>(<a class="code" href="api0api_8h.html#a3a920291a017c14a72331c818adf2265">page_no_t</a> npages = 1) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="ut0dbg_8h.html#a17113dab7f37e298e889ac8818ab13d0">ut_ad</a>(curr_size &gt;= npages);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    curr_size -= npages;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">  /** Increment the current size of the rollback segment by the given number</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">  of pages. */</span></div><div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#aa217e93af95dfd2fa92f76a4df566516">  213</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structtrx__rseg__t.html#aa217e93af95dfd2fa92f76a4df566516">incr_curr_size</a>() { ++curr_size; }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">/* Get the current size of the rollback segment in pages.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">   @return current size of the rollback segment in pages. */</span></div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a2f590a3c33a41d44a274bec4f4ed18cf">  217</a></span>&#160;  <a class="code" href="api0api_8h.html#a3a920291a017c14a72331c818adf2265">page_no_t</a> <a class="code" href="structtrx__rseg__t.html#a2f590a3c33a41d44a274bec4f4ed18cf">get_curr_size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (curr_size); }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">/* Set the current size of the rollback segment in pages.</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">  @param[in]  npages  new value for the current size. */</span></div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a2fcdbb651b1ce550acd4b3f7cb306f49">  221</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structtrx__rseg__t.html#a2fcdbb651b1ce550acd4b3f7cb306f49">set_curr_size</a>(<a class="code" href="api0api_8h.html#a3a920291a017c14a72331c818adf2265">page_no_t</a> npages) { curr_size = npages; }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">/*--------------------------------------------------------*/</span><span class="comment"></span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">  /** rollback segment id == the index of its slot in the trx</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">  system file copy */</span></div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a16b502698fce6c48fc7c8e5a349cde81">  226</a></span>&#160;  <span class="keywordtype">size_t</span> <span class="keywordtype">id</span>{};</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">  /** mutex protecting the fields in this struct except id,space,page_no</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">  which are constant */</span></div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a483ab37e0bd0bd6e5641ce153d397963">  230</a></span>&#160;  <a class="code" href="trx0types_8h.html#a8d7dc342a58ab67f326d9139058605e2">RsegMutex</a> <a class="code" href="structtrx__rseg__t.html#a483ab37e0bd0bd6e5641ce153d397963">mutex</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">  /** space ID where the rollback segment header is placed */</span></div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a4ab14e26e47527d0e36ef06223f51b39">  233</a></span>&#160;  <a class="code" href="api0api_8h.html#a02e9c11b4a9783f4b0b89fcf060f8f28">space_id_t</a> space_id{};</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">  /** page number of the rollback segment header */</span></div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a6f2414dad1b532d11263e18afdfa8019">  236</a></span>&#160;  <a class="code" href="api0api_8h.html#a3a920291a017c14a72331c818adf2265">page_no_t</a> page_no{};</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">  /** page size of the relevant tablespace */</span></div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a7cee5afe1fe1ea7462632d25afc0bf1d">  239</a></span>&#160;  <a class="code" href="classpage__size__t.html">page_size_t</a> <a class="code" href="structtrx__rseg__t.html#a7cee5afe1fe1ea7462632d25afc0bf1d">page_size</a>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">  /** maximum allowed size in pages */</span></div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a99cc3ea3ca03ca2b805ac4e47ee85791">  242</a></span>&#160;  <a class="code" href="api0api_8h.html#a3a920291a017c14a72331c818adf2265">page_no_t</a> max_size{};</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">  /** current size in pages */</span></div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a4d1948156ce79e4f2bed72d32cb3b373">  246</a></span>&#160;  <a class="code" href="api0api_8h.html#a3a920291a017c14a72331c818adf2265">page_no_t</a> curr_size{};</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">/*--------------------------------------------------------*/</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">/* Fields for update undo logs */</span><span class="comment"></span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">  /** List of update undo logs */</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="innodb__utility_8h.html#af8087cee2d41561b30b9d1903cebfb3d">UT_LIST_BASE_NODE_T</a>(<a class="code" href="structtrx__undo__t.html">trx_undo_t</a>) update_undo_list;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">  /** List of update undo log segments cached for fast reuse */</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <a class="code" href="innodb__utility_8h.html#af8087cee2d41561b30b9d1903cebfb3d">UT_LIST_BASE_NODE_T</a>(<a class="code" href="structtrx__undo__t.html">trx_undo_t</a>) update_undo_cached;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">/*--------------------------------------------------------*/</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">/* Fields for insert undo logs */</span><span class="comment"></span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">  /** List of insert undo logs */</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="code" href="innodb__utility_8h.html#af8087cee2d41561b30b9d1903cebfb3d">UT_LIST_BASE_NODE_T</a>(<a class="code" href="structtrx__undo__t.html">trx_undo_t</a>) insert_undo_list;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">  /** List of insert undo log segments cached for fast reuse */</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="innodb__utility_8h.html#af8087cee2d41561b30b9d1903cebfb3d">UT_LIST_BASE_NODE_T</a>(<a class="code" href="structtrx__undo__t.html">trx_undo_t</a>) insert_undo_cached;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">/*--------------------------------------------------------*/</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">  /** Page number of the last not yet purged log header in the history</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">  list; FIL_NULL if all list purged */</span></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#acb14dc2b68b95b86340dd1689617eaed">  269</a></span>&#160;  <a class="code" href="api0api_8h.html#a3a920291a017c14a72331c818adf2265">page_no_t</a> last_page_no{};</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">  /** Byte offset of the last not yet purged log header */</span></div><div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a1d91936e94cfadd5bdb1aef400c76503">  272</a></span>&#160;  <span class="keywordtype">size_t</span> last_offset{};</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">  /** Transaction number of the last not yet purged log */</span></div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a06d2b6051c93d43fb30cdada1b7f7b0b">  275</a></span>&#160;  <a class="code" href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a> <a class="code" href="structtrx__rseg__t.html#a06d2b6051c93d43fb30cdada1b7f7b0b">last_trx_no</a>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">  /** true if the last not yet purged log needs purging */</span></div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a28194b2a8d4071f84d34b8561dd219ec">  278</a></span>&#160;  <span class="keywordtype">bool</span> last_del_marks{};</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">  /** Reference counter to track rseg allocated transactions. */</span></div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#a962b3eb55d7b53df682a5acb53e9b09c">  281</a></span>&#160;  std::atomic&lt;size_t&gt; trx_ref_count{};</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="structtrx__rseg__t.html#ae8f015f3d0173db8ae9d8b56291cfac4">  283</a></span>&#160;  std::ostream &amp;<a class="code" href="structtrx__rseg__t.html#ae8f015f3d0173db8ae9d8b56291cfac4">print</a>(std::ostream &amp;out)<span class="keyword"> const </span>{</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    out &lt;&lt; <span class="stringliteral">&quot;[trx_rseg_t: this=&quot;</span> &lt;&lt; (<span class="keywordtype">void</span> *)<span class="keyword">this</span> &lt;&lt; <span class="stringliteral">&quot;, id=&quot;</span> &lt;&lt; <span class="keywordtype">id</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, space_id=&quot;</span> &lt;&lt; space_id &lt;&lt; <span class="stringliteral">&quot;, page_no=&quot;</span> &lt;&lt; page_no</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;, curr_size=&quot;</span> &lt;&lt; curr_size &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">return</span> (out);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;};</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a61fbf68476d8289401317417442615a7">  291</a></span>&#160;<span class="keyword">inline</span> std::ostream &amp;<a class="code" href="trx0types_8h.html#a61fbf68476d8289401317417442615a7">operator&lt;&lt;</a>(std::ostream &amp;out, <span class="keyword">const</span> <a class="code" href="structtrx__rseg__t.html">trx_rseg_t</a> &amp;rseg) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">return</span> (rseg.<a class="code" href="structtrx__rseg__t.html#ae8f015f3d0173db8ae9d8b56291cfac4">print</a>(out));</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a880689ec07d5d17e4cab123554a124ce">  295</a></span>&#160;<span class="keyword">using</span> <a class="code" href="trx0types_8h.html#a880689ec07d5d17e4cab123554a124ce">Rsegs_Vector</a> = std::vector&lt;trx_rseg_t *, ut_allocator&lt;trx_rseg_t *&gt;&gt;;</div><div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a0f4dc290df176e008e1a712e4b13d829">  296</a></span>&#160;<span class="keyword">using</span> <a class="code" href="trx0types_8h.html#a0f4dc290df176e008e1a712e4b13d829">Rseg_Iterator</a> = Rsegs_Vector::iterator;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">/** This is a wrapper for a std::vector of trx_rseg_t object pointers. */</span></div><div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="classRsegs.html">  299</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRsegs.html">Rsegs</a> {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">  /** Default constructor */</span></div><div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="classRsegs.html#a7f6df25c4a226945570568c0e6b553f0">  302</a></span>&#160;  <a class="code" href="classRsegs.html#a7f6df25c4a226945570568c0e6b553f0">Rsegs</a>() : m_rsegs(), m_latch(), m_state(INIT) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#ifndef UNIV_HOTBACKUP</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="audit__api__message__emit_8cc.html#a9ab62ce08f07c43d34e2d46dcc0f5f68">init</a>();</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !UNIV_HOTBACKUP */</span><span class="preprocessor"></span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="classRsegs.html#a0c9105944ca2d723d739421865c8d7fb">  308</a></span>&#160;  <a class="code" href="classRsegs.html#a0c9105944ca2d723d739421865c8d7fb">~Rsegs</a>() {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">#ifndef UNIV_HOTBACKUP</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="audit__api__message__emit_8cc.html#a01a49a9b0f0ca5c91a68340c337a9b98">deinit</a>();</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !UNIV_HOTBACKUP */</span><span class="preprocessor"></span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">  /** Initialize */</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="audit__api__message__emit_8cc.html#a9ab62ce08f07c43d34e2d46dcc0f5f68">init</a>();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">  /** De-initialize */</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="audit__api__message__emit_8cc.html#a01a49a9b0f0ca5c91a68340c337a9b98">deinit</a>();</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">  /** Clear the vector of cached rollback segments leaving the</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">  reserved space allocated. */</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="namespaceCounter.html#abffd9234ba48273d835ae5cf193e3844">clear</a>();</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">  /** Add rollback segment.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">  @param[in]    rseg    rollback segment to add. */</span></div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="classRsegs.html#a501ecb0dbb0de6a40ab8e8bb9831b848">  326</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRsegs.html#a501ecb0dbb0de6a40ab8e8bb9831b848">push_back</a>(<a class="code" href="structtrx__rseg__t.html">trx_rseg_t</a> *rseg) { m_rsegs.push_back(rseg); }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">  /** Number of registered rsegs.</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">  @return size of rseg list. */</span></div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classRsegs.html#aa90ec8fa81e8a82279bb9d7202469018">  330</a></span>&#160;  ulint <a class="code" href="classRsegs.html#aa90ec8fa81e8a82279bb9d7202469018">size</a>() { <span class="keywordflow">return</span> (m_rsegs.size()); }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">  /** beginning iterator</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">  @return an iterator to the first element */</span></div><div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="classRsegs.html#ac8a03ce8af5ce516d76a6bb1a634048a">  334</a></span>&#160;  <a class="code" href="trx0types_8h.html#a0f4dc290df176e008e1a712e4b13d829">Rseg_Iterator</a> <a class="code" href="classRsegs.html#ac8a03ce8af5ce516d76a6bb1a634048a">begin</a>() { <span class="keywordflow">return</span> (m_rsegs.begin()); }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">  /** ending iterator</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">  @return an iterator to the end */</span></div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="classRsegs.html#a76b15ae855073e0f61a1e111cd4694c5">  338</a></span>&#160;  <a class="code" href="trx0types_8h.html#a0f4dc290df176e008e1a712e4b13d829">Rseg_Iterator</a> <a class="code" href="classRsegs.html#a76b15ae855073e0f61a1e111cd4694c5">end</a>() { <span class="keywordflow">return</span> (m_rsegs.end()); }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">  /** Find the rseg at the given slot in this vector.</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">  @param[in]    slot    a slot within the vector.</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">  @return an iterator to the end */</span></div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="classRsegs.html#a1b44020f2e610c8876e3cd489fe1e99b">  343</a></span>&#160;  <a class="code" href="structtrx__rseg__t.html">trx_rseg_t</a> *<a class="code" href="classRsegs.html#a1b44020f2e610c8876e3cd489fe1e99b">at</a>(ulint slot) { <span class="keywordflow">return</span> (m_rsegs.at(slot)); }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">  /** Find an rseg in the std::vector that uses the rseg_id given.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">  @param[in]    rseg_id         A slot in a durable array such as</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">                                  the TRX_SYS page or RSEG_ARRAY page.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">  @return a pointer to an trx_rseg_t that uses the rseg_id. */</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="structtrx__rseg__t.html">trx_rseg_t</a> *<a class="code" href="namespacedblwr_1_1recv.html#a4d87e29e585a1f0ddb67f6f0b3b2d0ea">find</a>(ulint rseg_id);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">  /** Sort the vector on trx_rseg_t::id */</span></div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="classRsegs.html#a90a25ba57051634cea142ec80fa29153">  352</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRsegs.html#a90a25ba57051634cea142ec80fa29153">sort</a>() {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (m_rsegs.empty()) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    std::sort(</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        m_rsegs.begin(), m_rsegs.end(),</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        [](<a class="code" href="structtrx__rseg__t.html">trx_rseg_t</a> *lhs, <a class="code" href="structtrx__rseg__t.html">trx_rseg_t</a> *rhs) { <span class="keywordflow">return</span> (rhs-&gt;id &gt; lhs-&gt;<a class="code" href="structtrx__rseg__t.html#a16b502698fce6c48fc7c8e5a349cde81">id</a>); });</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">  /** Get a shared lock on m_rsegs. */</span></div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classRsegs.html#a690df18cd10df60177fdba151d0bd4e5">  363</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRsegs.html#a690df18cd10df60177fdba151d0bd4e5">s_lock</a>() { <a class="code" href="sync0rw_8h.html#a75ab160551c85fc478837cda173ef4d0">rw_lock_s_lock</a>(m_latch); }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">  /** Get a shared lock on m_rsegs. */</span></div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classRsegs.html#ab8e96edd782181617432706e19f86aec">  366</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRsegs.html#ab8e96edd782181617432706e19f86aec">s_unlock</a>() { <a class="code" href="sync0rw_8h.html#a41172c45229ea4cbe60f4669b3b68994">rw_lock_s_unlock</a>(m_latch); }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">  /** Get a shared lock on m_rsegs. */</span></div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="classRsegs.html#ad5fa6277f8c1cd94bd76f51b9f45ffcb">  369</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRsegs.html#ad5fa6277f8c1cd94bd76f51b9f45ffcb">x_lock</a>() { <a class="code" href="sync0rw_8h.html#ad3004dd4636535a3aab2cecfdb7dae54">rw_lock_x_lock</a>(m_latch); }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">  /** Get a shared lock on m_rsegs. */</span></div><div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="classRsegs.html#acdefd94c291e46672ce9e5d8bcd3fafd">  372</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRsegs.html#acdefd94c291e46672ce9e5d8bcd3fafd">x_unlock</a>() { <a class="code" href="sync0rw_8h.html#ae10266de83fba11c12e595ca4ab1f17c">rw_lock_x_unlock</a>(m_latch); }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">  /** Return whether the undo tablespace is active.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">  @return true if active */</span></div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="classRsegs.html#ac6d7a95d67a14ba6b4d2f752a38e9769">  376</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classRsegs.html#ac6d7a95d67a14ba6b4d2f752a38e9769">is_active</a>() { <span class="keywordflow">return</span> (m_state == ACTIVE); }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">  /** Return whether the undo tablespace is inactive due to</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">  implicit selection by the purge thread.</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">  @return true if marked for truncation by the purge thread */</span></div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="classRsegs.html#a99b7ea890e3c548d06f954cfc5f72154">  381</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classRsegs.html#a99b7ea890e3c548d06f954cfc5f72154">is_inactive_implicit</a>() { <span class="keywordflow">return</span> (m_state == INACTIVE_IMPLICIT); }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">  /** Return whether the undo tablespace was made inactive by</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">  ALTER TABLESPACE.</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">  @return true if altered */</span></div><div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="classRsegs.html#a9e963cef44c61377a934951d45025c93">  386</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classRsegs.html#a9e963cef44c61377a934951d45025c93">is_inactive_explicit</a>() { <span class="keywordflow">return</span> (m_state == INACTIVE_EXPLICIT); }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">  /** Return whether the undo tablespace is empty and ready</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">  to be dropped.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">  @return true if empty */</span></div><div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="classRsegs.html#a691b9e6706efcb3b321463bf60422b87">  391</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classRsegs.html#a691b9e6706efcb3b321463bf60422b87">is_empty</a>() { <span class="keywordflow">return</span> (m_state == EMPTY); }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">  /** Return whether the undo tablespace is being initialized.</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">  @return true if empty */</span></div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="classRsegs.html#a9148fddcebec3bd9a06d4652a38cd4e1">  395</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classRsegs.html#a9148fddcebec3bd9a06d4652a38cd4e1">is_init</a>() { <span class="keywordflow">return</span> (m_state == INIT); }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">  /** Set the state of the rollback segments in this undo tablespace</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">  to ACTIVE for use by new transactions. */</span></div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="classRsegs.html#a5529a2ae92a688c7abd0628405fc0ca2">  399</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRsegs.html#a5529a2ae92a688c7abd0628405fc0ca2">set_active</a>() { m_state = ACTIVE; }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">  /** Set the state of the rollback segments in this undo</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">  tablespace to inactive_implicit. This means that it will be</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">  truncated and then made active again by the purge thread.</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">  It will not be used for new transactions until it becomes</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">  active again. */</span></div><div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="classRsegs.html#a1f075b436e4a0f0415571f081eada5c3">  406</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRsegs.html#a1f075b436e4a0f0415571f081eada5c3">set_inactive_implicit</a>() {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="ut0dbg_8h.html#a17113dab7f37e298e889ac8818ab13d0">ut_ad</a>(m_state == ACTIVE || m_state == INACTIVE_EXPLICIT);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    m_state = INACTIVE_IMPLICIT;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">  /** Make the undo tablespace inactive so that it will not be</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">  used for new transactions.  The purge thread will clear out</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">  all the undo logs, truncate it, and then mark it empty. */</span></div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classRsegs.html#abc522be32806944f94be4d7d0031ffa0">  414</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRsegs.html#abc522be32806944f94be4d7d0031ffa0">set_inactive_explicit</a>() { m_state = INACTIVE_EXPLICIT; }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">  /** Set the state of the undo tablespace to empty so that it</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">  can be dropped. */</span></div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="classRsegs.html#a0f8972cfc3ede67ec0d622563bda0b6a">  418</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classRsegs.html#a0f8972cfc3ede67ec0d622563bda0b6a">set_empty</a>() {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="ut0dbg_8h.html#a17113dab7f37e298e889ac8818ab13d0">ut_ad</a>(m_state == INACTIVE_EXPLICIT || m_state == ACTIVE ||</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          m_state == INIT || m_state == EMPTY);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    m_state = EMPTY;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">  /** std::vector of rollback segments */</span></div><div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="classRsegs.html#a4e3b533869b9a874d2d689352ffaf343">  425</a></span>&#160;  <a class="code" href="trx0types_8h.html#a880689ec07d5d17e4cab123554a124ce">Rsegs_Vector</a> <a class="code" href="classRsegs.html#a4e3b533869b9a874d2d689352ffaf343">m_rsegs</a>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">  /** RW lock to protect m_rsegs vector, m_active, and each</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">  trx_rseg_t::trx_ref_count within it.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">  m_rsegs:   x for adding elements, s for scanning, size etc.</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">  m_active:  x for modification, s for read</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">  each trx_rseg_t::trx_ref_count within m_rsegs</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">             s and atomic increment for modification, x for read */</span></div><div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="classRsegs.html#a20bbdf4d548bc5ccc4c3ea6364419ad6">  434</a></span>&#160;  <a class="code" href="structrw__lock__t.html">rw_lock_t</a> *<a class="code" href="classRsegs.html#a20bbdf4d548bc5ccc4c3ea6364419ad6">m_latch</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">/* The four states of an undo tablespace.</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">  INIT:     The initial state of an undo space that is being created or opened.</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">  ACTIVE:   The rollback segments in this tablespace can be allocated to new</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">            transactions.  The undo tablespace is ready for undo logs.</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">  INACTIVE_IMPLICIT: These rollback segments are no longer being used by new</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">            transactions.  They arre &#39;inactive&#39;. The truncate process</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">            is happening. This undo tablespace was selected by the</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">            purge thread implicitly. When the truncation process</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">            is complete, the next state is ACTIVE.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">  INACTIVE_EXPLICIT:  These rollback segments are no longer being used by new</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">            transactions.  They arre &#39;inactive&#39;. The truncate process</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">            is happening. This undo tablespace was selected by the</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">            an ALTER UNDO TABLESPACE  SET INACTIVE command. When the</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">            truncation process is complete, the next state is EMPTY.</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">  EMPTY:    The undo tablespace has been truncated but is no longer</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">            active. It is ready to be either dropped or set active</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">            explicitly. This state is also used when the undo tablespace and</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">            its rollback segments are being inititalized.</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">  These states are changed under an exclusive lock on m_latch and are read</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">  under a shared lock.</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">  The following actions can cause changes in these states:</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">  Init:         Implicit undo spaces are created at startup.</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">  Create:       Explicit undo tablespace creation at runtime.</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">  Mark:         Purge thread implicitly selects an undo space to truncate.</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">  SetInactive:  This ALTER UNDO TABLESPACE causes an explicit truncation.</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">  SetActive:    This ALTER UNDO TABLESPACE changes the target state from</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">                EMPTY to ACTIVE.</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">  Trucate:      The truncate process is completed by the purge thread.</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">  Drop:         Delete an EMPTY undo tablespace</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">  Crash:        A crash occurs</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">  Fixup:        At startup, if an undo space was being truncated with a crash.</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">  SaveDDState:  At startup, once the DD is available the state saved there</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">                will be applied.  INACTIVE_IMPLICIT is never saved to the DD.</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">                So the DD state INACTIVE means INACTIVE_EXPLICIT.</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">                See apply_dd_undo_state()</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">  State changes allowed: (Actions on states not mentioned are not allowed.)</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">  Init         from null -&gt; INIT -&gt; ACTIVE see srv_start()</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">               from null -&gt; INIT -&gt; EMPTY  see trx_rsegs_init()</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">  Create       from null -&gt; EMPTY -&gt; ACTIVE</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">  Mark         from INACTIVE_EXPLICIT -&gt; INACTIVE_EXPLICIT -&gt; Truncate</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">               from ACTIVE -&gt; INACTIVE_IMPLICIT -&gt; Truncate</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">  SetInactive  from ACTIVE -&gt; INACTIVE_EXPLICIT -&gt; Mark</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">               from INACTIVE_IMPLICIT -&gt; INACTIVE_EXPLICIT</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">               from INACTIVE_EXPLICIT -&gt; INACTIVE_EXPLICIT</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">               from EMPTY -&gt; EMPTY</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">  SetActive    from ACTIVE -&gt; ACTIVE</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">               from INACTIVE_IMPLICIT -&gt; INACTIVE_IMPLICIT</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">               from INACTIVE_EXPLICIT -&gt; INACTIVE_IMPLICIT</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">               from EMPTY -&gt; ACTIVE</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">  Truncate     from INACTIVE_IMPLICIT -&gt; ACTIVE</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">               from INACTIVE_EXPLICIT -&gt; EMPTY</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">  Drop         if ACTIVE -&gt; error returned</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">               if INACTIVE_IMPLICIT -&gt; error returned</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">               if INACTIVE_EXPLICIT -&gt; error returned</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">               from EMPTY -&gt; null</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">  Crash        if ACTIVE, at startup:  ACTIVE</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">               if INACTIVE_IMPLICIT, at startup: Fixup</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">               if INACTIVE_EXPLICIT, at startup: Fixup</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">               if EMPTY, at startup:  EMPTY</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">  Fixup        from INACTIVE_IMPLICIT before crash -&gt; INACTIVE_IMPLICIT -&gt; Mark</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">               from INACTIVE_EXPLICIT before crash -&gt; INACTIVE_IMPLICIT -&gt; Mark</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">  SaveDDState  from ACTIVE before crash -&gt; ACTIVE</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">               from INACTIVE_IMPLICIT before crash -&gt; ACTIVE</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">               from INACTIVE_EXPLICIT before crash -&gt; INACTIVE_EXPLICIT -&gt; Mark</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">               from EMPTY -&gt; EMPTY</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664">  505</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664">undo_space_states</a> {</div><div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a5b839400750bb9e598cda41e00f9a068">  506</a></span>&#160;    <a class="code" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a5b839400750bb9e598cda41e00f9a068">INIT</a>,</div><div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a5eb1046a790fa7f880744056aaa13361">  507</a></span>&#160;    <a class="code" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a5eb1046a790fa7f880744056aaa13361">ACTIVE</a>,</div><div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a484c059d2e6d144910f942cce181446e">  508</a></span>&#160;    <a class="code" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a484c059d2e6d144910f942cce181446e">INACTIVE_IMPLICIT</a>,</div><div class="line"><a name="l00509"></a><span class="lineno"><a class="line" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a62bc93048b531ad86e8e6f93f90dbd10">  509</a></span>&#160;    <a class="code" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a62bc93048b531ad86e8e6f93f90dbd10">INACTIVE_EXPLICIT</a>,</div><div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a230a43ea3ccdd1d6e72bb2e81db286f0">  510</a></span>&#160;    EMPTY</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  };</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">  /** The current state of this undo tablespace. */</span></div><div class="line"><a name="l00514"></a><span class="lineno"><a class="line" href="classRsegs.html#a6e6159a28e4182c5ba114eaa6dada745">  514</a></span>&#160;  <a class="code" href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664">undo_space_states</a> <a class="code" href="classRsegs.html#a6e6159a28e4182c5ba114eaa6dada745">m_state</a>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;};</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">/** Rollback segements from a given transaction with trx-no</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">scheduled for purge. */</span></div><div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html">  519</a></span>&#160;<span class="keyword">class </span><a class="code" href="classTrxUndoRsegs.html">TrxUndoRsegs</a> {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">  /** Default constructor */</span></div><div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#ac7b074233c5e67cf468199ca5f1891f4">  522</a></span>&#160;  <a class="code" href="classTrxUndoRsegs.html#ac7b074233c5e67cf468199ca5f1891f4">TrxUndoRsegs</a>() : m_trx_no() {}</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#a0d544966418e114d060584069cfff75e">  524</a></span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classTrxUndoRsegs.html#a0d544966418e114d060584069cfff75e">TrxUndoRsegs</a>(<a class="code" href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a> trx_no) : m_trx_no(trx_no) {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// Do nothing</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">  /** Get transaction number</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">  @return trx_id_t - get transaction number. */</span></div><div class="line"><a name="l00530"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#a1c6432d12b5b08a76d6e0990dfe80360">  530</a></span>&#160;  <a class="code" href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a> <a class="code" href="classTrxUndoRsegs.html#a1c6432d12b5b08a76d6e0990dfe80360">get_trx_no</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (m_trx_no); }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">  /** Add rollback segment.</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">  @param rseg rollback segment to add. */</span></div><div class="line"><a name="l00534"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#a6ffc97bb53fd3741f98eb9ffe7cc4ae1">  534</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTrxUndoRsegs.html#a6ffc97bb53fd3741f98eb9ffe7cc4ae1">push_back</a>(<a class="code" href="structtrx__rseg__t.html">trx_rseg_t</a> *rseg) { m_rsegs.push_back(rseg); }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">  /** Erase the element pointed by given iterator.</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">  @param[in]    it      iterator */</span></div><div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#a504a1f3182acc84f423179355c2f682a">  538</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTrxUndoRsegs.html#a504a1f3182acc84f423179355c2f682a">erase</a>(<a class="code" href="trx0types_8h.html#a0f4dc290df176e008e1a712e4b13d829">Rseg_Iterator</a> &amp;it) { m_rsegs.erase(it); }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">  /** Number of registered rsegs.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">  @return size of rseg list. */</span></div><div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#aae4c27d6ade3e74c4bf7c606964679c2">  542</a></span>&#160;  ulint <a class="code" href="classTrxUndoRsegs.html#aae4c27d6ade3e74c4bf7c606964679c2">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (m_rsegs.size()); }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">  @return an iterator to the first element */</span></div><div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#a151310f0b64ec1d77d4e4ef1578ba96c">  546</a></span>&#160;  <a class="code" href="trx0types_8h.html#a0f4dc290df176e008e1a712e4b13d829">Rseg_Iterator</a> <a class="code" href="classTrxUndoRsegs.html#a151310f0b64ec1d77d4e4ef1578ba96c">begin</a>() { <span class="keywordflow">return</span> (m_rsegs.begin()); }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">  /**</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">  @return an iterator to the end */</span></div><div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#a5cf366627f5bd6e76ea08015952e7dd1">  550</a></span>&#160;  <a class="code" href="trx0types_8h.html#a0f4dc290df176e008e1a712e4b13d829">Rseg_Iterator</a> <a class="code" href="classTrxUndoRsegs.html#a5cf366627f5bd6e76ea08015952e7dd1">end</a>() { <span class="keywordflow">return</span> (m_rsegs.end()); }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">  /** Append rollback segments from referred instance to current</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">  instance. */</span></div><div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#aa9dbc5f08187a5cacaecbc32ca28308b">  554</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classTrxUndoRsegs.html#aa9dbc5f08187a5cacaecbc32ca28308b">append</a>(<span class="keyword">const</span> <a class="code" href="classTrxUndoRsegs.html">TrxUndoRsegs</a> &amp;append_from) {</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="ut0dbg_8h.html#a17113dab7f37e298e889ac8818ab13d0">ut_ad</a>(get_trx_no() == append_from.<a class="code" href="classTrxUndoRsegs.html#a1c6432d12b5b08a76d6e0990dfe80360">get_trx_no</a>());</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    m_rsegs.insert(m_rsegs.end(), append_from.<a class="code" href="classTrxUndoRsegs.html#a98b3cf58d0d8a8e7b214d22f59f44ff3">m_rsegs</a>.begin(),</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                   append_from.<a class="code" href="classTrxUndoRsegs.html#a98b3cf58d0d8a8e7b214d22f59f44ff3">m_rsegs</a>.end());</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">  /** Compare two TrxUndoRsegs based on trx_no.</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">  @param lhs first element to compare</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">  @param rhs second element to compare</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">  @return true if elem1 &gt; elem2 else false.*/</span></div><div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#aac76125552d279183725f49633cf0d0b">  565</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classTrxUndoRsegs.html#aac76125552d279183725f49633cf0d0b">operator()</a>(<span class="keyword">const</span> <a class="code" href="classTrxUndoRsegs.html">TrxUndoRsegs</a> &amp;lhs, <span class="keyword">const</span> <a class="code" href="classTrxUndoRsegs.html">TrxUndoRsegs</a> &amp;rhs) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">return</span> (lhs.<a class="code" href="classTrxUndoRsegs.html#a7c2c277171a68bbd74141f818119a68c">m_trx_no</a> &gt; rhs.<a class="code" href="classTrxUndoRsegs.html#a7c2c277171a68bbd74141f818119a68c">m_trx_no</a>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">  /** Compiler defined copy-constructor/assignment operator</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">  should be fine given that there is no reference to a memory</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">  object outside scope of class object.*/</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; <span class="keyword">private</span>:<span class="comment"></span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">  /** The rollback segments transaction number. */</span></div><div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#a7c2c277171a68bbd74141f818119a68c">  575</a></span>&#160;  <a class="code" href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a> <a class="code" href="classTrxUndoRsegs.html#a7c2c277171a68bbd74141f818119a68c">m_trx_no</a>;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">  /** Rollback segments of a transaction, scheduled for purge. */</span></div><div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="classTrxUndoRsegs.html#a98b3cf58d0d8a8e7b214d22f59f44ff3">  578</a></span>&#160;  <a class="code" href="trx0types_8h.html#a880689ec07d5d17e4cab123554a124ce">Rsegs_Vector</a> <a class="code" href="classTrxUndoRsegs.html#a98b3cf58d0d8a8e7b214d22f59f44ff3">m_rsegs</a>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;};</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keyword">typedef</span> std::priority_queue&lt;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="classTrxUndoRsegs.html">TrxUndoRsegs</a>, std::vector&lt;TrxUndoRsegs, ut_allocator&lt;TrxUndoRsegs&gt;&gt;,</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="classTrxUndoRsegs.html">TrxUndoRsegs</a>&gt;</div><div class="line"><a name="l00584"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a2b2af0c3abd146b437f5659794024755">  584</a></span>&#160;    <a class="code" href="trx0types_8h.html#a2b2af0c3abd146b437f5659794024755">purge_pq_t</a>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a22fed8251df5649905afee900619683a">  586</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt;trx_id_t, ut_allocator&lt;trx_id_t&gt;&gt; <a class="code" href="trx0types_8h.html#a22fed8251df5649905afee900619683a">trx_ids_t</a>;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">/** Mapping read-write transactions from id to transaction instance, for</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">creating read views and during trx id lookup for MVCC and locking. */</span></div><div class="line"><a name="l00590"></a><span class="lineno"><a class="line" href="structTrxTrack.html">  590</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structTrxTrack.html">TrxTrack</a> {</div><div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="structTrxTrack.html#a19342987badc423d2479a765ee77f783">  591</a></span>&#160;  <span class="keyword">explicit</span> <a class="code" href="structTrxTrack.html#a19342987badc423d2479a765ee77f783">TrxTrack</a>(<a class="code" href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a> <span class="keywordtype">id</span>, <a class="code" href="structtrx__t.html">trx_t</a> *trx = <span class="keyword">nullptr</span>) : m_id(id), m_trx(trx) {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">// Do nothing</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="structTrxTrack.html#a3c38b3f1003284efaae93adbf5bc7acc">  595</a></span>&#160;  <a class="code" href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a> <a class="code" href="structTrxTrack.html#a3c38b3f1003284efaae93adbf5bc7acc">m_id</a>;</div><div class="line"><a name="l00596"></a><span class="lineno"><a class="line" href="structTrxTrack.html#a665a88371fda32935f4e16114da3a383">  596</a></span>&#160;  <a class="code" href="structtrx__t.html">trx_t</a> *<a class="code" href="structTrxTrack.html#a665a88371fda32935f4e16114da3a383">m_trx</a>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;};</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno"><a class="line" href="structTrxTrackHash.html">  599</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structTrxTrackHash.html">TrxTrackHash</a> {</div><div class="line"><a name="l00600"></a><span class="lineno"><a class="line" href="structTrxTrackHash.html#a4ce9b1752c3576de05a7a199a66aaa2b">  600</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structTrxTrackHash.html#a4ce9b1752c3576de05a7a199a66aaa2b">operator()</a>(<span class="keyword">const</span> <a class="code" href="structTrxTrack.html">TrxTrack</a> &amp;<a class="code" href="suite__stubs_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (<span class="keywordtype">size_t</span>(key.<a class="code" href="structTrxTrack.html#a3c38b3f1003284efaae93adbf5bc7acc">m_id</a>)); }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;};</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">Comparator for TrxMap */</span></div><div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="structTrxTrackHashCmp.html">  605</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structTrxTrackHashCmp.html">TrxTrackHashCmp</a> {</div><div class="line"><a name="l00606"></a><span class="lineno"><a class="line" href="structTrxTrackHashCmp.html#afdcbd20f9b7cd73f719a865945288ab8">  606</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structTrxTrackHashCmp.html#afdcbd20f9b7cd73f719a865945288ab8">operator()</a>(<span class="keyword">const</span> <a class="code" href="structTrxTrack.html">TrxTrack</a> &amp;lhs, <span class="keyword">const</span> <a class="code" href="structTrxTrack.html">TrxTrack</a> &amp;rhs)<span class="keyword"> const </span>{</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span> (lhs.<a class="code" href="structTrxTrack.html#a3c38b3f1003284efaae93adbf5bc7acc">m_id</a> == rhs.<a class="code" href="structTrxTrack.html#a3c38b3f1003284efaae93adbf5bc7acc">m_id</a>);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;};</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">Comparator for TrxMap */</span></div><div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="structTrxTrackCmp.html">  613</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structTrxTrackCmp.html">TrxTrackCmp</a> {</div><div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="structTrxTrackCmp.html#ad9764cbd60e66b768f90b00f7108ecda">  614</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structTrxTrackCmp.html#ad9764cbd60e66b768f90b00f7108ecda">operator()</a>(<span class="keyword">const</span> <a class="code" href="structTrxTrack.html">TrxTrack</a> &amp;lhs, <span class="keyword">const</span> <a class="code" href="structTrxTrack.html">TrxTrack</a> &amp;rhs)<span class="keyword"> const </span>{</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">return</span> (lhs.<a class="code" href="structTrxTrack.html#a3c38b3f1003284efaae93adbf5bc7acc">m_id</a> &lt; rhs.<a class="code" href="structTrxTrack.html#a3c38b3f1003284efaae93adbf5bc7acc">m_id</a>);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;};</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">// typedef std::unordered_set&lt;TrxTrack, TrxTrackHash, TrxTrackHashCmp&gt; TrxIdSet;</span></div><div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="trx0types_8h.html#ad5e0b307fa1d9c617a4c495ee17d42c9">  620</a></span>&#160;<span class="keyword">typedef</span> std::set&lt;TrxTrack, TrxTrackCmp, ut_allocator&lt;TrxTrack&gt;&gt; <a class="code" href="trx0types_8h.html#ad5e0b307fa1d9c617a4c495ee17d42c9">TrxIdSet</a>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="structTrxVersion.html">  622</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structTrxVersion.html">TrxVersion</a> {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <a class="code" href="structTrxVersion.html">TrxVersion</a>(<a class="code" href="structtrx__t.html">trx_t</a> *trx);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="structTrxVersion.html#a8dedefb50142143ab8481f8052d9b29f">  625</a></span>&#160;  <a class="code" href="structtrx__t.html">trx_t</a> *<a class="code" href="structTrxVersion.html#a8dedefb50142143ab8481f8052d9b29f">m_trx</a>;</div><div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="structTrxVersion.html#a6500e1200985f5546f22412eeccad97f">  626</a></span>&#160;  ulint <a class="code" href="structTrxVersion.html#a6500e1200985f5546f22412eeccad97f">m_version</a>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;};</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno"><a class="line" href="trx0types_8h.html#a13121c5e3c7e683afe964f2903433257">  629</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt;TrxVersion, ut_allocator&lt;TrxVersion&gt;&gt; <a class="code" href="trx0types_8h.html#a13121c5e3c7e683afe964f2903433257">hit_list_t</a>;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* trx0types_h */</span><span class="preprocessor"></span></div><div class="ttc" id="classRsegs_html_a76b15ae855073e0f61a1e111cd4694c5"><div class="ttname"><a href="classRsegs.html#a76b15ae855073e0f61a1e111cd4694c5">Rsegs::end</a></div><div class="ttdeci">Rseg_Iterator end()</div><div class="ttdoc">ending iterator </div><div class="ttdef"><b>Definition:</b> trx0types.h:338</div></div>
<div class="ttc" id="trx0types_8h_html_a773741653a7a52c9fd9ef521805265af"><div class="ttname"><a href="trx0types_8h.html#a773741653a7a52c9fd9ef521805265af">TRX_FORCE_ROLLBACK_ASYNC</a></div><div class="ttdeci">static const ib_uint32_t TRX_FORCE_ROLLBACK_ASYNC</div><div class="ttdoc">Was the transaction rolled back asynchronously or by the owning thread. </div><div class="ttdef"><b>Definition:</b> trx0types.h:68</div></div>
<div class="ttc" id="namespaceCounter_html_abffd9234ba48273d835ae5cf193e3844"><div class="ttname"><a href="namespaceCounter.html#abffd9234ba48273d835ae5cf193e3844">Counter::clear</a></div><div class="ttdeci">void clear(Shards&lt; COUNT &gt; &amp;shards) noexcept</div><div class="ttdoc">Clear the counter - reset to 0. </div><div class="ttdef"><b>Definition:</b> ut0counter.h:343</div></div>
<div class="ttc" id="structTrxVersion_html"><div class="ttname"><a href="structTrxVersion.html">TrxVersion</a></div><div class="ttdef"><b>Definition:</b> trx0types.h:622</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_a0d544966418e114d060584069cfff75e"><div class="ttname"><a href="classTrxUndoRsegs.html#a0d544966418e114d060584069cfff75e">TrxUndoRsegs::TrxUndoRsegs</a></div><div class="ttdeci">TrxUndoRsegs(trx_id_t trx_no)</div><div class="ttdef"><b>Definition:</b> trx0types.h:524</div></div>
<div class="ttc" id="trx0types_8h_html_a0b302ec5d015d6388eb98277b58048c7"><div class="ttname"><a href="trx0types_8h.html#a0b302ec5d015d6388eb98277b58048c7">trx_undo_rec_t</a></div><div class="ttdeci">byte trx_undo_rec_t</div><div class="ttdoc">Undo log record. </div><div class="ttdef"><b>Definition:</b> trx0types.h:173</div></div>
<div class="ttc" id="structTrxTrackHashCmp_html_afdcbd20f9b7cd73f719a865945288ab8"><div class="ttname"><a href="structTrxTrackHashCmp.html#afdcbd20f9b7cd73f719a865945288ab8">TrxTrackHashCmp::operator()</a></div><div class="ttdeci">bool operator()(const TrxTrack &amp;lhs, const TrxTrack &amp;rhs) const</div><div class="ttdef"><b>Definition:</b> trx0types.h:606</div></div>
<div class="ttc" id="trx0types_8h_html_a044545240fb71e3a64171596e66e0336"><div class="ttname"><a href="trx0types_8h.html#a044545240fb71e3a64171596e66e0336">TrxMutex</a></div><div class="ttdeci">ib_mutex_t TrxMutex</div><div class="ttdef"><b>Definition:</b> trx0types.h:177</div></div>
<div class="ttc" id="classRsegs_html"><div class="ttname"><a href="classRsegs.html">Rsegs</a></div><div class="ttdoc">This is a wrapper for a std::vector of trx_rseg_t object pointers. </div><div class="ttdef"><b>Definition:</b> trx0types.h:299</div></div>
<div class="ttc" id="classRsegs_html_acf8f9f396786a64a0940b5a7628f0664a5b839400750bb9e598cda41e00f9a068"><div class="ttname"><a href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a5b839400750bb9e598cda41e00f9a068">Rsegs::INIT</a></div><div class="ttdef"><b>Definition:</b> trx0types.h:506</div></div>
<div class="ttc" id="api0api_8h_html_a3a920291a017c14a72331c818adf2265"><div class="ttname"><a href="api0api_8h.html#a3a920291a017c14a72331c818adf2265">page_no_t</a></div><div class="ttdeci">uint32 page_no_t</div><div class="ttdoc">Page number. </div><div class="ttdef"><b>Definition:</b> api0api.h:57</div></div>
<div class="ttc" id="structrw__lock__t_html"><div class="ttname"><a href="structrw__lock__t.html">rw_lock_t</a></div><div class="ttdoc">The structure used in the spin lock implementation of a read-write lock. </div><div class="ttdef"><b>Definition:</b> sync0rw.h:564</div></div>
<div class="ttc" id="audit__api__message__emit_8cc_html_a01a49a9b0f0ca5c91a68340c337a9b98"><div class="ttname"><a href="audit__api__message__emit_8cc.html#a01a49a9b0f0ca5c91a68340c337a9b98">deinit</a></div><div class="ttdeci">static mysql_service_status_t deinit()</div><div class="ttdoc">Component deinitialization. </div><div class="ttdef"><b>Definition:</b> audit_api_message_emit.cc:579</div></div>
<div class="ttc" id="classRsegs_html_a501ecb0dbb0de6a40ab8e8bb9831b848"><div class="ttname"><a href="classRsegs.html#a501ecb0dbb0de6a40ab8e8bb9831b848">Rsegs::push_back</a></div><div class="ttdeci">void push_back(trx_rseg_t *rseg)</div><div class="ttdoc">Add rollback segment. </div><div class="ttdef"><b>Definition:</b> trx0types.h:326</div></div>
<div class="ttc" id="trx0types_8h_html_ad3ccac613ce33a8680d147c4a4f12e94"><div class="ttname"><a href="trx0types_8h.html#ad3ccac613ce33a8680d147c4a4f12e94">roll_ptr_t</a></div><div class="ttdeci">ib_id_t roll_ptr_t</div><div class="ttdoc">Rollback pointer (DB_ROLL_PTR, DATA_ROLL_PTR) </div><div class="ttdef"><b>Definition:</b> trx0types.h:146</div></div>
<div class="ttc" id="trx0types_8h_html_a14bf14fe533410dc0d7b3bb9e99afcfe"><div class="ttname"><a href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfe">trx_state_t</a></div><div class="ttdeci">trx_state_t</div><div class="ttdoc">Transaction states (trx_t::state) </div><div class="ttdef"><b>Definition:</b> trx0types.h:86</div></div>
<div class="ttc" id="structtrx__rseg__t_html_a7cee5afe1fe1ea7462632d25afc0bf1d"><div class="ttname"><a href="structtrx__rseg__t.html#a7cee5afe1fe1ea7462632d25afc0bf1d">trx_rseg_t::page_size</a></div><div class="ttdeci">page_size_t page_size</div><div class="ttdoc">page size of the relevant tablespace </div><div class="ttdef"><b>Definition:</b> trx0types.h:239</div></div>
<div class="ttc" id="trx0types_8h_html_a14bf14fe533410dc0d7b3bb9e99afcfeaec0a7e922a9ac4226678ec8ffcdbbf73"><div class="ttname"><a href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfeaec0a7e922a9ac4226678ec8ffcdbbf73">TRX_STATE_PREPARED</a></div><div class="ttdoc">Support for 2PC/XA. </div><div class="ttdef"><b>Definition:</b> trx0types.h:97</div></div>
<div class="ttc" id="trx0types_8h_html_a48243b30e18edafa533b4273840ad668"><div class="ttname"><a href="trx0types_8h.html#a48243b30e18edafa533b4273840ad668">trx_upagef_t</a></div><div class="ttdeci">byte trx_upagef_t</div><div class="ttdoc">Undo log page header. </div><div class="ttdef"><b>Definition:</b> trx0types.h:171</div></div>
<div class="ttc" id="trx0types_8h_html_a48f03c2f78d0f7ca9fa271dff3484e26"><div class="ttname"><a href="trx0types_8h.html#a48f03c2f78d0f7ca9fa271dff3484e26">trx_usegf_t</a></div><div class="ttdeci">byte trx_usegf_t</div><div class="ttdoc">Undo segment header. </div><div class="ttdef"><b>Definition:</b> trx0types.h:167</div></div>
<div class="ttc" id="structTrxTrackCmp_html_ad9764cbd60e66b768f90b00f7108ecda"><div class="ttname"><a href="structTrxTrackCmp.html#ad9764cbd60e66b768f90b00f7108ecda">TrxTrackCmp::operator()</a></div><div class="ttdeci">bool operator()(const TrxTrack &amp;lhs, const TrxTrack &amp;rhs) const</div><div class="ttdef"><b>Definition:</b> trx0types.h:614</div></div>
<div class="ttc" id="classRsegs_html_a1b44020f2e610c8876e3cd489fe1e99b"><div class="ttname"><a href="classRsegs.html#a1b44020f2e610c8876e3cd489fe1e99b">Rsegs::at</a></div><div class="ttdeci">trx_rseg_t * at(ulint slot)</div><div class="ttdoc">Find the rseg at the given slot in this vector. </div><div class="ttdef"><b>Definition:</b> trx0types.h:343</div></div>
<div class="ttc" id="trx0types_8h_html_a14bf14fe533410dc0d7b3bb9e99afcfea7b804d92242ae352a4346055734aef96"><div class="ttname"><a href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfea7b804d92242ae352a4346055734aef96">TRX_STATE_COMMITTED_IN_MEMORY</a></div><div class="ttdef"><b>Definition:</b> trx0types.h:99</div></div>
<div class="ttc" id="structtrx__rseg__t_html_a2f590a3c33a41d44a274bec4f4ed18cf"><div class="ttname"><a href="structtrx__rseg__t.html#a2f590a3c33a41d44a274bec4f4ed18cf">trx_rseg_t::get_curr_size</a></div><div class="ttdeci">page_no_t get_curr_size() const</div><div class="ttdef"><b>Definition:</b> trx0types.h:217</div></div>
<div class="ttc" id="structtrx__t_html"><div class="ttname"><a href="structtrx__t.html">trx_t</a></div><div class="ttdef"><b>Definition:</b> trx0trx.h:833</div></div>
<div class="ttc" id="structTrxTrackCmp_html"><div class="ttname"><a href="structTrxTrackCmp.html">TrxTrackCmp</a></div><div class="ttdoc">Comparator for TrxMap. </div><div class="ttdef"><b>Definition:</b> trx0types.h:613</div></div>
<div class="ttc" id="memcached_8c_html_a4acff8232e4aec9cd5c6dc200ac55ef3"><div class="ttname"><a href="memcached_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a></div><div class="ttdeci">pthread_mutex_t mutex</div><div class="ttdef"><b>Definition:</b> memcached.c:384</div></div>
<div class="ttc" id="structtrx__rseg__t_html_af8bcd07540fc6a1a73fb0f6377603a75"><div class="ttname"><a href="structtrx__rseg__t.html#af8bcd07540fc6a1a73fb0f6377603a75">trx_rseg_t::unlatch</a></div><div class="ttdeci">void unlatch()</div><div class="ttdoc">Exit the rseg-&gt;mutex. </div><div class="ttdef"><b>Definition:</b> trx0types.h:198</div></div>
<div class="ttc" id="structTrxTrack_html_a19342987badc423d2479a765ee77f783"><div class="ttname"><a href="structTrxTrack.html#a19342987badc423d2479a765ee77f783">TrxTrack::TrxTrack</a></div><div class="ttdeci">TrxTrack(trx_id_t id, trx_t *trx=nullptr)</div><div class="ttdef"><b>Definition:</b> trx0types.h:591</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_a1c6432d12b5b08a76d6e0990dfe80360"><div class="ttname"><a href="classTrxUndoRsegs.html#a1c6432d12b5b08a76d6e0990dfe80360">TrxUndoRsegs::get_trx_no</a></div><div class="ttdeci">trx_id_t get_trx_no() const</div><div class="ttdoc">Get transaction number. </div><div class="ttdef"><b>Definition:</b> trx0types.h:530</div></div>
<div class="ttc" id="structtrx__rseg__t_html_a483ab37e0bd0bd6e5641ce153d397963"><div class="ttname"><a href="structtrx__rseg__t.html#a483ab37e0bd0bd6e5641ce153d397963">trx_rseg_t::mutex</a></div><div class="ttdeci">RsegMutex mutex</div><div class="ttdoc">mutex protecting the fields in this struct except id,space,page_no which are constant ...</div><div class="ttdef"><b>Definition:</b> trx0types.h:230</div></div>
<div class="ttc" id="trx0types_8h_html_a64150d81cbf5eba60e4a902c2c8d7a1a"><div class="ttname"><a href="trx0types_8h.html#a64150d81cbf5eba60e4a902c2c8d7a1a">trx_ulogf_t</a></div><div class="ttdeci">byte trx_ulogf_t</div><div class="ttdoc">Undo log header. </div><div class="ttdef"><b>Definition:</b> trx0types.h:169</div></div>
<div class="ttc" id="classRsegs_html_a5529a2ae92a688c7abd0628405fc0ca2"><div class="ttname"><a href="classRsegs.html#a5529a2ae92a688c7abd0628405fc0ca2">Rsegs::set_active</a></div><div class="ttdeci">void set_active()</div><div class="ttdoc">Set the state of the rollback segments in this undo tablespace to ACTIVE for use by new transactions...</div><div class="ttdef"><b>Definition:</b> trx0types.h:399</div></div>
<div class="ttc" id="trx0types_8h_html_a14bf14fe533410dc0d7b3bb9e99afcfea715252714bf7cbda62aeeed0f155ba59"><div class="ttname"><a href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfea715252714bf7cbda62aeeed0f155ba59">TRX_STATE_FORCED_ROLLBACK</a></div><div class="ttdoc">Same as not started but with additional semantics that it was rolled back asynchronously the last tim...</div><div class="ttdef"><b>Definition:</b> trx0types.h:92</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_a6ffc97bb53fd3741f98eb9ffe7cc4ae1"><div class="ttname"><a href="classTrxUndoRsegs.html#a6ffc97bb53fd3741f98eb9ffe7cc4ae1">TrxUndoRsegs::push_back</a></div><div class="ttdeci">void push_back(trx_rseg_t *rseg)</div><div class="ttdoc">Add rollback segment. </div><div class="ttdef"><b>Definition:</b> trx0types.h:534</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_a5cf366627f5bd6e76ea08015952e7dd1"><div class="ttname"><a href="classTrxUndoRsegs.html#a5cf366627f5bd6e76ea08015952e7dd1">TrxUndoRsegs::end</a></div><div class="ttdeci">Rseg_Iterator end()</div><div class="ttdef"><b>Definition:</b> trx0types.h:550</div></div>
<div class="ttc" id="structTrxTrack_html"><div class="ttname"><a href="structTrxTrack.html">TrxTrack</a></div><div class="ttdoc">Mapping read-write transactions from id to transaction instance, for creating read views and during t...</div><div class="ttdef"><b>Definition:</b> trx0types.h:590</div></div>
<div class="ttc" id="classRsegs_html_a20bbdf4d548bc5ccc4c3ea6364419ad6"><div class="ttname"><a href="classRsegs.html#a20bbdf4d548bc5ccc4c3ea6364419ad6">Rsegs::m_latch</a></div><div class="ttdeci">rw_lock_t * m_latch</div><div class="ttdoc">RW lock to protect m_rsegs vector, m_active, and each trx_rseg_t::trx_ref_count within it...</div><div class="ttdef"><b>Definition:</b> trx0types.h:434</div></div>
<div class="ttc" id="classRsegs_html_a90a25ba57051634cea142ec80fa29153"><div class="ttname"><a href="classRsegs.html#a90a25ba57051634cea142ec80fa29153">Rsegs::sort</a></div><div class="ttdeci">void sort()</div><div class="ttdoc">Sort the vector on trx_rseg_t::id. </div><div class="ttdef"><b>Definition:</b> trx0types.h:352</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_ac7b074233c5e67cf468199ca5f1891f4"><div class="ttname"><a href="classTrxUndoRsegs.html#ac7b074233c5e67cf468199ca5f1891f4">TrxUndoRsegs::TrxUndoRsegs</a></div><div class="ttdeci">TrxUndoRsegs()</div><div class="ttdoc">Default constructor. </div><div class="ttdef"><b>Definition:</b> trx0types.h:522</div></div>
<div class="ttc" id="trx0types_8h_html_a34bba6fbd37f499f7874fc416547759fa84d6f7b62b3c089187e37b6b384dfbcb"><div class="ttname"><a href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa84d6f7b62b3c089187e37b6b384dfbcb">TRX_QUE_ROLLING_BACK</a></div><div class="ttdoc">transaction is rolling back </div><div class="ttdef"><b>Definition:</b> trx0types.h:81</div></div>
<div class="ttc" id="trx0types_8h_html_a0f4dc290df176e008e1a712e4b13d829"><div class="ttname"><a href="trx0types_8h.html#a0f4dc290df176e008e1a712e4b13d829">Rseg_Iterator</a></div><div class="ttdeci">Rsegs_Vector::iterator Rseg_Iterator</div><div class="ttdef"><b>Definition:</b> trx0types.h:296</div></div>
<div class="ttc" id="trx0types_8h_html_a4e5a174061b59c084c23b13eb761e04c"><div class="ttname"><a href="trx0types_8h.html#a4e5a174061b59c084c23b13eb761e04c">trx_rsegsf_t</a></div><div class="ttdeci">byte trx_rsegsf_t</div><div class="ttdoc">Rollback segment array header. </div><div class="ttdef"><b>Definition:</b> trx0types.h:163</div></div>
<div class="ttc" id="structcommit__node__t_html"><div class="ttname"><a href="structcommit__node__t.html">commit_node_t</a></div><div class="ttdoc">Commit command node in a query graph. </div><div class="ttdef"><b>Definition:</b> trx0trx.h:1293</div></div>
<div class="ttc" id="trx0types_8h_html_a880689ec07d5d17e4cab123554a124ce"><div class="ttname"><a href="trx0types_8h.html#a880689ec07d5d17e4cab123554a124ce">Rsegs_Vector</a></div><div class="ttdeci">std::vector&lt; trx_rseg_t *, ut_allocator&lt; trx_rseg_t * &gt; &gt; Rsegs_Vector</div><div class="ttdef"><b>Definition:</b> trx0types.h:295</div></div>
<div class="ttc" id="structroll__node__t_html"><div class="ttname"><a href="structroll__node__t.html">roll_node_t</a></div><div class="ttdoc">Rollback command node in a query graph. </div><div class="ttdef"><b>Definition:</b> trx0roll.h:155</div></div>
<div class="ttc" id="trx0types_8h_html_a34bba6fbd37f499f7874fc416547759fa01e98856c706e749462e97060479bcfd"><div class="ttname"><a href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa01e98856c706e749462e97060479bcfd">TRX_QUE_LOCK_WAIT</a></div><div class="ttdoc">transaction is waiting for a lock </div><div class="ttdef"><b>Definition:</b> trx0types.h:79</div></div>
<div class="ttc" id="trx0types_8h_html_a365d8e86502c13b65cd1749fd453f75a"><div class="ttname"><a href="trx0types_8h.html#a365d8e86502c13b65cd1749fd453f75a">TRX_FORCE_ROLLBACK_MASK</a></div><div class="ttdeci">static const ib_uint32_t TRX_FORCE_ROLLBACK_MASK</div><div class="ttdoc">For masking out the above four flags. </div><div class="ttdef"><b>Definition:</b> trx0types.h:74</div></div>
<div class="ttc" id="trx0types_8h_html_a3f6397f57064f579d2c5d68884ba44e0"><div class="ttname"><a href="trx0types_8h.html#a3f6397f57064f579d2c5d68884ba44e0">row_id_t</a></div><div class="ttdeci">ib_id_t row_id_t</div><div class="ttdoc">Row identifier (DB_ROW_ID, DATA_ROW_ID) </div><div class="ttdef"><b>Definition:</b> trx0types.h:138</div></div>
<div class="ttc" id="structtrx__rseg__t_html"><div class="ttname"><a href="structtrx__rseg__t.html">trx_rseg_t</a></div><div class="ttdoc">The rollback segment memory object. </div><div class="ttdef"><b>Definition:</b> trx0types.h:183</div></div>
<div class="ttc" id="audit__api__message__emit_8cc_html_a9ab62ce08f07c43d34e2d46dcc0f5f68"><div class="ttname"><a href="audit__api__message__emit_8cc.html#a9ab62ce08f07c43d34e2d46dcc0f5f68">init</a></div><div class="ttdeci">static mysql_service_status_t init()</div><div class="ttdoc">Component initialization. </div><div class="ttdef"><b>Definition:</b> audit_api_message_emit.cc:570</div></div>
<div class="ttc" id="sync0rw_8h_html_ae10266de83fba11c12e595ca4ab1f17c"><div class="ttname"><a href="sync0rw_8h.html#ae10266de83fba11c12e595ca4ab1f17c">rw_lock_x_unlock</a></div><div class="ttdeci">#define rw_lock_x_unlock(L)</div><div class="ttdef"><b>Definition:</b> sync0rw.h:314</div></div>
<div class="ttc" id="structtrx__savept__t_html"><div class="ttname"><a href="structtrx__savept__t.html">trx_savept_t</a></div><div class="ttdoc">Transaction savepoint. </div><div class="ttdef"><b>Definition:</b> trx0types.h:154</div></div>
<div class="ttc" id="sync0rw_8h_html_ad3004dd4636535a3aab2cecfdb7dae54"><div class="ttname"><a href="sync0rw_8h.html#ad3004dd4636535a3aab2cecfdb7dae54">rw_lock_x_lock</a></div><div class="ttdeci">#define rw_lock_x_lock(M)</div><div class="ttdef"><b>Definition:</b> sync0rw.h:289</div></div>
<div class="ttc" id="trx0types_8h_html_a14bf14fe533410dc0d7b3bb9e99afcfeab6d43468942f04bb539f0a0ef3fda5e7"><div class="ttname"><a href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfeab6d43468942f04bb539f0a0ef3fda5e7">TRX_STATE_NOT_STARTED</a></div><div class="ttdef"><b>Definition:</b> trx0types.h:88</div></div>
<div class="ttc" id="classRsegs_html_acf8f9f396786a64a0940b5a7628f0664a484c059d2e6d144910f942cce181446e"><div class="ttname"><a href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a484c059d2e6d144910f942cce181446e">Rsegs::INACTIVE_IMPLICIT</a></div><div class="ttdef"><b>Definition:</b> trx0types.h:508</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_a151310f0b64ec1d77d4e4ef1578ba96c"><div class="ttname"><a href="classTrxUndoRsegs.html#a151310f0b64ec1d77d4e4ef1578ba96c">TrxUndoRsegs::begin</a></div><div class="ttdeci">Rseg_Iterator begin()</div><div class="ttdef"><b>Definition:</b> trx0types.h:546</div></div>
<div class="ttc" id="classRsegs_html_ad5fa6277f8c1cd94bd76f51b9f45ffcb"><div class="ttname"><a href="classRsegs.html#ad5fa6277f8c1cd94bd76f51b9f45ffcb">Rsegs::x_lock</a></div><div class="ttdeci">void x_lock()</div><div class="ttdoc">Get a shared lock on m_rsegs. </div><div class="ttdef"><b>Definition:</b> trx0types.h:369</div></div>
<div class="ttc" id="classRsegs_html_a0c9105944ca2d723d739421865c8d7fb"><div class="ttname"><a href="classRsegs.html#a0c9105944ca2d723d739421865c8d7fb">Rsegs::~Rsegs</a></div><div class="ttdeci">~Rsegs()</div><div class="ttdef"><b>Definition:</b> trx0types.h:308</div></div>
<div class="ttc" id="trx0types_8h_html_a34bba6fbd37f499f7874fc416547759fa1d4fdb057b83f63809adc81eb11576d2"><div class="ttname"><a href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa1d4fdb057b83f63809adc81eb11576d2">TRX_QUE_RUNNING</a></div><div class="ttdoc">transaction is running </div><div class="ttdef"><b>Definition:</b> trx0types.h:78</div></div>
<div class="ttc" id="classTrxUndoRsegs_html"><div class="ttname"><a href="classTrxUndoRsegs.html">TrxUndoRsegs</a></div><div class="ttdoc">Rollback segements from a given transaction with trx-no scheduled for purge. </div><div class="ttdef"><b>Definition:</b> trx0types.h:519</div></div>
<div class="ttc" id="classRsegs_html_a690df18cd10df60177fdba151d0bd4e5"><div class="ttname"><a href="classRsegs.html#a690df18cd10df60177fdba151d0bd4e5">Rsegs::s_lock</a></div><div class="ttdeci">void s_lock()</div><div class="ttdoc">Get a shared lock on m_rsegs. </div><div class="ttdef"><b>Definition:</b> trx0types.h:363</div></div>
<div class="ttc" id="structTrxTrack_html_a3c38b3f1003284efaae93adbf5bc7acc"><div class="ttname"><a href="structTrxTrack.html#a3c38b3f1003284efaae93adbf5bc7acc">TrxTrack::m_id</a></div><div class="ttdeci">trx_id_t m_id</div><div class="ttdef"><b>Definition:</b> trx0types.h:595</div></div>
<div class="ttc" id="trx0types_8h_html_a2b2af0c3abd146b437f5659794024755"><div class="ttname"><a href="trx0types_8h.html#a2b2af0c3abd146b437f5659794024755">purge_pq_t</a></div><div class="ttdeci">std::priority_queue&lt; TrxUndoRsegs, std::vector&lt; TrxUndoRsegs, ut_allocator&lt; TrxUndoRsegs &gt; &gt;, TrxUndoRsegs &gt; purge_pq_t</div><div class="ttdef"><b>Definition:</b> trx0types.h:584</div></div>
<div class="ttc" id="classRsegs_html_a7f6df25c4a226945570568c0e6b553f0"><div class="ttname"><a href="classRsegs.html#a7f6df25c4a226945570568c0e6b553f0">Rsegs::Rsegs</a></div><div class="ttdeci">Rsegs()</div><div class="ttdoc">Default constructor. </div><div class="ttdef"><b>Definition:</b> trx0types.h:302</div></div>
<div class="ttc" id="sync0rw_8h_html"><div class="ttname"><a href="sync0rw_8h.html">sync0rw.h</a></div><div class="ttdoc">The read-write lock (for threads, not for database transactions) </div></div>
<div class="ttc" id="structTrxVersion_html_a8dedefb50142143ab8481f8052d9b29f"><div class="ttname"><a href="structTrxVersion.html#a8dedefb50142143ab8481f8052d9b29f">TrxVersion::m_trx</a></div><div class="ttdeci">trx_t * m_trx</div><div class="ttdef"><b>Definition:</b> trx0types.h:625</div></div>
<div class="ttc" id="classRsegs_html_a9148fddcebec3bd9a06d4652a38cd4e1"><div class="ttname"><a href="classRsegs.html#a9148fddcebec3bd9a06d4652a38cd4e1">Rsegs::is_init</a></div><div class="ttdeci">bool is_init()</div><div class="ttdoc">Return whether the undo tablespace is being initialized. </div><div class="ttdef"><b>Definition:</b> trx0types.h:395</div></div>
<div class="ttc" id="classRsegs_html_aa90ec8fa81e8a82279bb9d7202469018"><div class="ttname"><a href="classRsegs.html#aa90ec8fa81e8a82279bb9d7202469018">Rsegs::size</a></div><div class="ttdeci">ulint size()</div><div class="ttdoc">Number of registered rsegs. </div><div class="ttdef"><b>Definition:</b> trx0types.h:330</div></div>
<div class="ttc" id="structTrxVersion_html_a6500e1200985f5546f22412eeccad97f"><div class="ttname"><a href="structTrxVersion.html#a6500e1200985f5546f22412eeccad97f">TrxVersion::m_version</a></div><div class="ttdeci">ulint m_version</div><div class="ttdef"><b>Definition:</b> trx0types.h:626</div></div>
<div class="ttc" id="classRsegs_html_ac8a03ce8af5ce516d76a6bb1a634048a"><div class="ttname"><a href="classRsegs.html#ac8a03ce8af5ce516d76a6bb1a634048a">Rsegs::begin</a></div><div class="ttdeci">Rseg_Iterator begin()</div><div class="ttdoc">beginning iterator </div><div class="ttdef"><b>Definition:</b> trx0types.h:334</div></div>
<div class="ttc" id="trx0types_8h_html_a7ee9bc504dcbfa844005c74ead830856"><div class="ttname"><a href="trx0types_8h.html#a7ee9bc504dcbfa844005c74ead830856">PQMutex</a></div><div class="ttdeci">ib_mutex_t PQMutex</div><div class="ttdef"><b>Definition:</b> trx0types.h:179</div></div>
<div class="ttc" id="classRsegs_html_ab8e96edd782181617432706e19f86aec"><div class="ttname"><a href="classRsegs.html#ab8e96edd782181617432706e19f86aec">Rsegs::s_unlock</a></div><div class="ttdeci">void s_unlock()</div><div class="ttdoc">Get a shared lock on m_rsegs. </div><div class="ttdef"><b>Definition:</b> trx0types.h:366</div></div>
<div class="ttc" id="trx0types_8h_html_a885c60219b17a02d06d4ab096803c02a"><div class="ttname"><a href="trx0types_8h.html#a885c60219b17a02d06d4ab096803c02a">TRX_FORCE_ROLLBACK</a></div><div class="ttdeci">static const ib_uint32_t TRX_FORCE_ROLLBACK</div><div class="ttdoc">Mark the transaction for forced rollback. </div><div class="ttdef"><b>Definition:</b> trx0types.h:71</div></div>
<div class="ttc" id="ut0new_8h_html"><div class="ttname"><a href="ut0new_8h.html">ut0new.h</a></div><div class="ttdoc">Instrumented memory allocator. </div></div>
<div class="ttc" id="classRsegs_html_acf8f9f396786a64a0940b5a7628f0664"><div class="ttname"><a href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664">Rsegs::undo_space_states</a></div><div class="ttdeci">undo_space_states</div><div class="ttdef"><b>Definition:</b> trx0types.h:505</div></div>
<div class="ttc" id="trx0types_8h_html_a34bba6fbd37f499f7874fc416547759fa7aeb76d40ddafe996b8f6fe7c6864c67"><div class="ttname"><a href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759fa7aeb76d40ddafe996b8f6fe7c6864c67">TRX_QUE_COMMITTING</a></div><div class="ttdoc">transaction is committing </div><div class="ttdef"><b>Definition:</b> trx0types.h:82</div></div>
<div class="ttc" id="trx0types_8h_html_a13121c5e3c7e683afe964f2903433257"><div class="ttname"><a href="trx0types_8h.html#a13121c5e3c7e683afe964f2903433257">hit_list_t</a></div><div class="ttdeci">std::vector&lt; TrxVersion, ut_allocator&lt; TrxVersion &gt; &gt; hit_list_t</div><div class="ttdef"><b>Definition:</b> trx0types.h:629</div></div>
<div class="ttc" id="structTrxTrack_html_a665a88371fda32935f4e16114da3a383"><div class="ttname"><a href="structTrxTrack.html#a665a88371fda32935f4e16114da3a383">TrxTrack::m_trx</a></div><div class="ttdeci">trx_t * m_trx</div><div class="ttdef"><b>Definition:</b> trx0types.h:596</div></div>
<div class="ttc" id="classRsegs_html_a691b9e6706efcb3b321463bf60422b87"><div class="ttname"><a href="classRsegs.html#a691b9e6706efcb3b321463bf60422b87">Rsegs::is_empty</a></div><div class="ttdeci">bool is_empty()</div><div class="ttdoc">Return whether the undo tablespace is empty and ready to be dropped. </div><div class="ttdef"><b>Definition:</b> trx0types.h:391</div></div>
<div class="ttc" id="trx0types_8h_html_af79319b3cdfff988f01995fa51880599a9e7738bb967478dc6b673894b982466e"><div class="ttname"><a href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599a9e7738bb967478dc6b673894b982466e">TRX_DICT_OP_INDEX</a></div><div class="ttdoc">The transaction is creating or dropping an index in an existing table. </div><div class="ttdef"><b>Definition:</b> trx0types.h:114</div></div>
<div class="ttc" id="classRsegs_html_acf8f9f396786a64a0940b5a7628f0664a62bc93048b531ad86e8e6f93f90dbd10"><div class="ttname"><a href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a62bc93048b531ad86e8e6f93f90dbd10">Rsegs::INACTIVE_EXPLICIT</a></div><div class="ttdef"><b>Definition:</b> trx0types.h:509</div></div>
<div class="ttc" id="classRsegs_html_a4e3b533869b9a874d2d689352ffaf343"><div class="ttname"><a href="classRsegs.html#a4e3b533869b9a874d2d689352ffaf343">Rsegs::m_rsegs</a></div><div class="ttdeci">Rsegs_Vector m_rsegs</div><div class="ttdoc">std::vector of rollback segments </div><div class="ttdef"><b>Definition:</b> trx0types.h:425</div></div>
<div class="ttc" id="trx0types_8h_html_a2d4f0dbb79553916647c12513864a2c9"><div class="ttname"><a href="trx0types_8h.html#a2d4f0dbb79553916647c12513864a2c9">TRX_MAGIC_N</a></div><div class="ttdeci">static const ulint TRX_MAGIC_N</div><div class="ttdoc">Random value to check for corruption of trx_t. </div><div class="ttdef"><b>Definition:</b> trx0types.h:59</div></div>
<div class="ttc" id="trx0types_8h_html_a14bf14fe533410dc0d7b3bb9e99afcfea78e4ef9dc7c38690f85ca0b99953c91f"><div class="ttname"><a href="trx0types_8h.html#a14bf14fe533410dc0d7b3bb9e99afcfea78e4ef9dc7c38690f85ca0b99953c91f">TRX_STATE_ACTIVE</a></div><div class="ttdef"><b>Definition:</b> trx0types.h:94</div></div>
<div class="ttc" id="classRsegs_html_a9e963cef44c61377a934951d45025c93"><div class="ttname"><a href="classRsegs.html#a9e963cef44c61377a934951d45025c93">Rsegs::is_inactive_explicit</a></div><div class="ttdeci">bool is_inactive_explicit()</div><div class="ttdoc">Return whether the undo tablespace was made inactive by ALTER TABLESPACE. </div><div class="ttdef"><b>Definition:</b> trx0types.h:386</div></div>
<div class="ttc" id="ut0byte_8h_html"><div class="ttname"><a href="ut0byte_8h.html">ut0byte.h</a></div><div class="ttdoc">Utilities for byte operations. </div></div>
<div class="ttc" id="trx0types_8h_html_af79319b3cdfff988f01995fa51880599a50ffbbfbd919460992d5508f4701b973"><div class="ttname"><a href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599a50ffbbfbd919460992d5508f4701b973">TRX_DICT_OP_NONE</a></div><div class="ttdoc">The transaction is not modifying the data dictionary. </div><div class="ttdef"><b>Definition:</b> trx0types.h:105</div></div>
<div class="ttc" id="structtrx__rseg__t_html_a2fcdbb651b1ce550acd4b3f7cb306f49"><div class="ttname"><a href="structtrx__rseg__t.html#a2fcdbb651b1ce550acd4b3f7cb306f49">trx_rseg_t::set_curr_size</a></div><div class="ttdeci">void set_curr_size(page_no_t npages)</div><div class="ttdef"><b>Definition:</b> trx0types.h:221</div></div>
<div class="ttc" id="trx0types_8h_html_ad5e0b307fa1d9c617a4c495ee17d42c9"><div class="ttname"><a href="trx0types_8h.html#ad5e0b307fa1d9c617a4c495ee17d42c9">TrxIdSet</a></div><div class="ttdeci">std::set&lt; TrxTrack, TrxTrackCmp, ut_allocator&lt; TrxTrack &gt; &gt; TrxIdSet</div><div class="ttdef"><b>Definition:</b> trx0types.h:620</div></div>
<div class="ttc" id="structtrx__rseg__t_html_ae8f015f3d0173db8ae9d8b56291cfac4"><div class="ttname"><a href="structtrx__rseg__t.html#ae8f015f3d0173db8ae9d8b56291cfac4">trx_rseg_t::print</a></div><div class="ttdeci">std::ostream &amp; print(std::ostream &amp;out) const</div><div class="ttdef"><b>Definition:</b> trx0types.h:283</div></div>
<div class="ttc" id="ut0mutex_8h_html"><div class="ttname"><a href="ut0mutex_8h.html">ut0mutex.h</a></div><div class="ttdoc">Policy based mutexes. </div></div>
<div class="ttc" id="structtrx__savept__t_html_a8b895c7baec9f7c4fc1ebceea9e875df"><div class="ttname"><a href="structtrx__savept__t.html#a8b895c7baec9f7c4fc1ebceea9e875df">trx_savept_t::least_undo_no</a></div><div class="ttdeci">undo_no_t least_undo_no</div><div class="ttdoc">least undo number to undo </div><div class="ttdef"><b>Definition:</b> trx0types.h:155</div></div>
<div class="ttc" id="suite__stubs_8c_html_acd3d88da3c0e0313c3645ff34f62f542"><div class="ttname"><a href="suite__stubs_8c.html#acd3d88da3c0e0313c3645ff34f62f542">key</a></div><div class="ttdeci">static const char * key</div><div class="ttdef"><b>Definition:</b> suite_stubs.c:14</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_aa9dbc5f08187a5cacaecbc32ca28308b"><div class="ttname"><a href="classTrxUndoRsegs.html#aa9dbc5f08187a5cacaecbc32ca28308b">TrxUndoRsegs::append</a></div><div class="ttdeci">void append(const TrxUndoRsegs &amp;append_from)</div><div class="ttdoc">Append rollback segments from referred instance to current instance. </div><div class="ttdef"><b>Definition:</b> trx0types.h:554</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_a504a1f3182acc84f423179355c2f682a"><div class="ttname"><a href="classTrxUndoRsegs.html#a504a1f3182acc84f423179355c2f682a">TrxUndoRsegs::erase</a></div><div class="ttdeci">void erase(Rseg_Iterator &amp;it)</div><div class="ttdoc">Erase the element pointed by given iterator. </div><div class="ttdef"><b>Definition:</b> trx0types.h:538</div></div>
<div class="ttc" id="sync0rw_8h_html_a75ab160551c85fc478837cda173ef4d0"><div class="ttname"><a href="sync0rw_8h.html#a75ab160551c85fc478837cda173ef4d0">rw_lock_s_lock</a></div><div class="ttdeci">#define rw_lock_s_lock(M)</div><div class="ttdef"><b>Definition:</b> sync0rw.h:254</div></div>
<div class="ttc" id="trx0types_8h_html_a34bba6fbd37f499f7874fc416547759f"><div class="ttname"><a href="trx0types_8h.html#a34bba6fbd37f499f7874fc416547759f">trx_que_t</a></div><div class="ttdeci">trx_que_t</div><div class="ttdoc">Transaction execution states when trx-&gt;state == TRX_STATE_ACTIVE. </div><div class="ttdef"><b>Definition:</b> trx0types.h:77</div></div>
<div class="ttc" id="structTrxTrackHashCmp_html"><div class="ttname"><a href="structTrxTrackHashCmp.html">TrxTrackHashCmp</a></div><div class="ttdoc">Comparator for TrxMap. </div><div class="ttdef"><b>Definition:</b> trx0types.h:605</div></div>
<div class="ttc" id="api0api_8h_html_a02e9c11b4a9783f4b0b89fcf060f8f28"><div class="ttname"><a href="api0api_8h.html#a02e9c11b4a9783f4b0b89fcf060f8f28">space_id_t</a></div><div class="ttdeci">uint32 space_id_t</div><div class="ttdoc">Tablespace identifier. </div><div class="ttdef"><b>Definition:</b> api0api.h:59</div></div>
<div class="ttc" id="trx0types_8h_html_af79319b3cdfff988f01995fa51880599a0528c5f10ae8ece6516841f1f3e8e7f7"><div class="ttname"><a href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599a0528c5f10ae8ece6516841f1f3e8e7f7">TRX_DICT_OP_TABLE</a></div><div class="ttdoc">The transaction is creating a table or an index, or dropping a table. </div><div class="ttdef"><b>Definition:</b> trx0types.h:110</div></div>
<div class="ttc" id="ut0dbg_8h_html_a17113dab7f37e298e889ac8818ab13d0"><div class="ttname"><a href="ut0dbg_8h.html#a17113dab7f37e298e889ac8818ab13d0">ut_ad</a></div><div class="ttdeci">#define ut_ad(EXPR)</div><div class="ttdoc">Debug assertion. </div><div class="ttdef"><b>Definition:</b> ut0dbg.h:66</div></div>
<div class="ttc" id="structtrx__named__savept__t_html"><div class="ttname"><a href="structtrx__named__savept__t.html">trx_named_savept_t</a></div><div class="ttdoc">A savepoint set with SQL&amp;#39;s &quot;SAVEPOINT savepoint_id&quot; command. </div><div class="ttdef"><b>Definition:</b> trx0roll.h:167</div></div>
<div class="ttc" id="classRsegs_html_acdefd94c291e46672ce9e5d8bcd3fafd"><div class="ttname"><a href="classRsegs.html#acdefd94c291e46672ce9e5d8bcd3fafd">Rsegs::x_unlock</a></div><div class="ttdeci">void x_unlock()</div><div class="ttdoc">Get a shared lock on m_rsegs. </div><div class="ttdef"><b>Definition:</b> trx0types.h:372</div></div>
<div class="ttc" id="classpage__size__t_html"><div class="ttname"><a href="classpage__size__t.html">page_size_t</a></div><div class="ttdoc">Page size descriptor. </div><div class="ttdef"><b>Definition:</b> page0size.h:49</div></div>
<div class="ttc" id="trx0types_8h_html_a91afca43a639c098efe14a9069a1d4ec"><div class="ttname"><a href="trx0types_8h.html#a91afca43a639c098efe14a9069a1d4ec">trx_id_t</a></div><div class="ttdeci">ib_id_t trx_id_t</div><div class="ttdoc">Transaction identifier (DB_TRX_ID, DATA_TRX_ID) </div><div class="ttdef"><b>Definition:</b> trx0types.h:144</div></div>
<div class="ttc" id="innodb__utility_8h_html_af8087cee2d41561b30b9d1903cebfb3d"><div class="ttname"><a href="innodb__utility_8h.html#af8087cee2d41561b30b9d1903cebfb3d">UT_LIST_BASE_NODE_T</a></div><div class="ttdeci">#define UT_LIST_BASE_NODE_T(TYPE)</div><div class="ttdef"><b>Definition:</b> innodb_utility.h:47</div></div>
<div class="ttc" id="structtrx__rseg__t_html_afd6cba92aeb919b312b8cc945c6fcf8b"><div class="ttname"><a href="structtrx__rseg__t.html#afd6cba92aeb919b312b8cc945c6fcf8b">trx_rseg_t::latch</a></div><div class="ttdeci">void latch()</div><div class="ttdoc">Enter the rseg-&gt;mutex. </div><div class="ttdef"><b>Definition:</b> trx0types.h:192</div></div>
<div class="ttc" id="trx0types_8h_html_ac731378a2d6ecb952f6cfe4e093568e8"><div class="ttname"><a href="trx0types_8h.html#ac731378a2d6ecb952f6cfe4e093568e8">UndoMutex</a></div><div class="ttdeci">ib_mutex_t UndoMutex</div><div class="ttdef"><b>Definition:</b> trx0types.h:178</div></div>
<div class="ttc" id="sync0rw_8h_html_a41172c45229ea4cbe60f4669b3b68994"><div class="ttname"><a href="sync0rw_8h.html#a41172c45229ea4cbe60f4669b3b68994">rw_lock_s_unlock</a></div><div class="ttdeci">#define rw_lock_s_unlock(L)</div><div class="ttdef"><b>Definition:</b> sync0rw.h:313</div></div>
<div class="ttc" id="ut0mutex_8h_html_aba9ab29617d78284418d99bc1a06865d"><div class="ttname"><a href="ut0mutex_8h.html#aba9ab29617d78284418d99bc1a06865d">mutex_enter</a></div><div class="ttdeci">#define mutex_enter(M)</div><div class="ttdef"><b>Definition:</b> ut0mutex.h:115</div></div>
<div class="ttc" id="page0size_8h_html"><div class="ttname"><a href="page0size_8h.html">page0size.h</a></div><div class="ttdoc">A class describing a page size. </div></div>
<div class="ttc" id="trx0types_8h_html_af79319b3cdfff988f01995fa51880599"><div class="ttname"><a href="trx0types_8h.html#af79319b3cdfff988f01995fa51880599">trx_dict_op_t</a></div><div class="ttdeci">trx_dict_op_t</div><div class="ttdoc">Type of data dictionary operation. </div><div class="ttdef"><b>Definition:</b> trx0types.h:103</div></div>
<div class="ttc" id="classRsegs_html_a6e6159a28e4182c5ba114eaa6dada745"><div class="ttname"><a href="classRsegs.html#a6e6159a28e4182c5ba114eaa6dada745">Rsegs::m_state</a></div><div class="ttdeci">undo_space_states m_state</div><div class="ttdoc">The current state of this undo tablespace. </div><div class="ttdef"><b>Definition:</b> trx0types.h:514</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_aae4c27d6ade3e74c4bf7c606964679c2"><div class="ttname"><a href="classTrxUndoRsegs.html#aae4c27d6ade3e74c4bf7c606964679c2">TrxUndoRsegs::size</a></div><div class="ttdeci">ulint size() const</div><div class="ttdoc">Number of registered rsegs. </div><div class="ttdef"><b>Definition:</b> trx0types.h:542</div></div>
<div class="ttc" id="structtrx__undo__t_html"><div class="ttname"><a href="structtrx__undo__t.html">trx_undo_t</a></div><div class="ttdoc">Transaction undo log memory object; this is protected by the undo_mutex in the corresponding transact...</div><div class="ttdef"><b>Definition:</b> trx0undo.h:345</div></div>
<div class="ttc" id="structtrx__rseg__t_html_a06d2b6051c93d43fb30cdada1b7f7b0b"><div class="ttname"><a href="structtrx__rseg__t.html#a06d2b6051c93d43fb30cdada1b7f7b0b">trx_rseg_t::last_trx_no</a></div><div class="ttdeci">trx_id_t last_trx_no</div><div class="ttdoc">Transaction number of the last not yet purged log. </div><div class="ttdef"><b>Definition:</b> trx0types.h:275</div></div>
<div class="ttc" id="classRsegs_html_abc522be32806944f94be4d7d0031ffa0"><div class="ttname"><a href="classRsegs.html#abc522be32806944f94be4d7d0031ffa0">Rsegs::set_inactive_explicit</a></div><div class="ttdeci">void set_inactive_explicit()</div><div class="ttdoc">Make the undo tablespace inactive so that it will not be used for new transactions. </div><div class="ttdef"><b>Definition:</b> trx0types.h:414</div></div>
<div class="ttc" id="ut0mutex_8h_html_aa55ad8b49fb970ed42f72485f53e1547"><div class="ttname"><a href="ut0mutex_8h.html#aa55ad8b49fb970ed42f72485f53e1547">mutex_exit</a></div><div class="ttdeci">#define mutex_exit(M)</div><div class="ttdef"><b>Definition:</b> ut0mutex.h:122</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_a7c2c277171a68bbd74141f818119a68c"><div class="ttname"><a href="classTrxUndoRsegs.html#a7c2c277171a68bbd74141f818119a68c">TrxUndoRsegs::m_trx_no</a></div><div class="ttdeci">trx_id_t m_trx_no</div><div class="ttdoc">Compiler defined copy-constructor/assignment operator should be fine given that there is no reference...</div><div class="ttdef"><b>Definition:</b> trx0types.h:575</div></div>
<div class="ttc" id="trx0types_8h_html_a22fed8251df5649905afee900619683a"><div class="ttname"><a href="trx0types_8h.html#a22fed8251df5649905afee900619683a">trx_ids_t</a></div><div class="ttdeci">std::vector&lt; trx_id_t, ut_allocator&lt; trx_id_t &gt; &gt; trx_ids_t</div><div class="ttdef"><b>Definition:</b> trx0types.h:586</div></div>
<div class="ttc" id="classRsegs_html_a99b7ea890e3c548d06f954cfc5f72154"><div class="ttname"><a href="classRsegs.html#a99b7ea890e3c548d06f954cfc5f72154">Rsegs::is_inactive_implicit</a></div><div class="ttdeci">bool is_inactive_implicit()</div><div class="ttdoc">Return whether the undo tablespace is inactive due to implicit selection by the purge thread...</div><div class="ttdef"><b>Definition:</b> trx0types.h:381</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_a98b3cf58d0d8a8e7b214d22f59f44ff3"><div class="ttname"><a href="classTrxUndoRsegs.html#a98b3cf58d0d8a8e7b214d22f59f44ff3">TrxUndoRsegs::m_rsegs</a></div><div class="ttdeci">Rsegs_Vector m_rsegs</div><div class="ttdoc">Rollback segments of a transaction, scheduled for purge. </div><div class="ttdef"><b>Definition:</b> trx0types.h:578</div></div>
<div class="ttc" id="structtrx__rseg__t_html_a4c372629685635f4ee2c69fef2f8da47"><div class="ttname"><a href="structtrx__rseg__t.html#a4c372629685635f4ee2c69fef2f8da47">trx_rseg_t::decr_curr_size</a></div><div class="ttdeci">void decr_curr_size(page_no_t npages=1)</div><div class="ttdoc">Decrement the current size of the rollback segment by the given number of pages. </div><div class="ttdef"><b>Definition:</b> trx0types.h:206</div></div>
<div class="ttc" id="trx0types_8h_html_a61fbf68476d8289401317417442615a7"><div class="ttname"><a href="trx0types_8h.html#a61fbf68476d8289401317417442615a7">operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;out, const trx_rseg_t &amp;rseg)</div><div class="ttdef"><b>Definition:</b> trx0types.h:291</div></div>
<div class="ttc" id="structtrx__sys__t_html"><div class="ttname"><a href="structtrx__sys__t.html">trx_sys_t</a></div><div class="ttdoc">The transaction system central memory data structure. </div><div class="ttdef"><b>Definition:</b> trx0sys.h:468</div></div>
<div class="ttc" id="classTrxUndoRsegs_html_aac76125552d279183725f49633cf0d0b"><div class="ttname"><a href="classTrxUndoRsegs.html#aac76125552d279183725f49633cf0d0b">TrxUndoRsegs::operator()</a></div><div class="ttdeci">bool operator()(const TrxUndoRsegs &amp;lhs, const TrxUndoRsegs &amp;rhs)</div><div class="ttdoc">Compare two TrxUndoRsegs based on trx_no. </div><div class="ttdef"><b>Definition:</b> trx0types.h:565</div></div>
<div class="ttc" id="libmysql_2authentication__win_2common_8h_html_a0c8186d9b9b7880309c27230bbb5e69d"><div class="ttname"><a href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a></div><div class="ttdeci">unsigned char byte</div><div class="ttdoc">Blob class. </div><div class="ttdef"><b>Definition:</b> common.h:159</div></div>
<div class="ttc" id="structtrx__rseg__t_html_aa217e93af95dfd2fa92f76a4df566516"><div class="ttname"><a href="structtrx__rseg__t.html#aa217e93af95dfd2fa92f76a4df566516">trx_rseg_t::incr_curr_size</a></div><div class="ttdeci">void incr_curr_size()</div><div class="ttdoc">Increment the current size of the rollback segment by the given number of pages. </div><div class="ttdef"><b>Definition:</b> trx0types.h:213</div></div>
<div class="ttc" id="trx0types_8h_html_ad30d6802ba5017c3db592827e1c90b03"><div class="ttname"><a href="trx0types_8h.html#ad30d6802ba5017c3db592827e1c90b03">TRX_SYS_SPACE</a></div><div class="ttdeci">static const space_id_t TRX_SYS_SPACE</div><div class="ttdoc">Space id of the transaction system page (the system tablespace) </div><div class="ttdef"><b>Definition:</b> trx0types.h:53</div></div>
<div class="ttc" id="structtrx__lock__t_html"><div class="ttname"><a href="structtrx__lock__t.html">trx_lock_t</a></div><div class="ttdoc">Latching protocol for trx_lock_t::que_state. </div><div class="ttdef"><b>Definition:</b> trx0trx.h:562</div></div>
<div class="ttc" id="trx0types_8h_html_af2a8aeff6138cf8f68340a6bcb840cc2"><div class="ttname"><a href="trx0types_8h.html#af2a8aeff6138cf8f68340a6bcb840cc2">TrxSysMutex</a></div><div class="ttdeci">ib_mutex_t TrxSysMutex</div><div class="ttdef"><b>Definition:</b> trx0types.h:180</div></div>
<div class="ttc" id="trx0types_8h_html_a671a381e3a8143e9612e31dc898960bc"><div class="ttname"><a href="trx0types_8h.html#a671a381e3a8143e9612e31dc898960bc">TRX_FORCE_ROLLBACK_DISABLE</a></div><div class="ttdeci">static const ib_uint32_t TRX_FORCE_ROLLBACK_DISABLE</div><div class="ttdoc">If this flag is set then the transaction cannot be rolled back asynchronously. </div><div class="ttdef"><b>Definition:</b> trx0types.h:63</div></div>
<div class="ttc" id="structtrx__rseg__t_html_a16b502698fce6c48fc7c8e5a349cde81"><div class="ttname"><a href="structtrx__rseg__t.html#a16b502698fce6c48fc7c8e5a349cde81">trx_rseg_t::id</a></div><div class="ttdeci">size_t id</div><div class="ttdoc">rollback segment id == the index of its slot in the trx system file copy </div><div class="ttdef"><b>Definition:</b> trx0types.h:226</div></div>
<div class="ttc" id="structTrxTrackHash_html_a4ce9b1752c3576de05a7a199a66aaa2b"><div class="ttname"><a href="structTrxTrackHash.html#a4ce9b1752c3576de05a7a199a66aaa2b">TrxTrackHash::operator()</a></div><div class="ttdeci">size_t operator()(const TrxTrack &amp;key) const</div><div class="ttdef"><b>Definition:</b> trx0types.h:600</div></div>
<div class="ttc" id="classRsegs_html_acf8f9f396786a64a0940b5a7628f0664a5eb1046a790fa7f880744056aaa13361"><div class="ttname"><a href="classRsegs.html#acf8f9f396786a64a0940b5a7628f0664a5eb1046a790fa7f880744056aaa13361">Rsegs::ACTIVE</a></div><div class="ttdef"><b>Definition:</b> trx0types.h:507</div></div>
<div class="ttc" id="trx0types_8h_html_a4661d2883c1cd5d8f1cfbd63b553f1bc"><div class="ttname"><a href="trx0types_8h.html#a4661d2883c1cd5d8f1cfbd63b553f1bc">undo_no_t</a></div><div class="ttdeci">ib_id_t undo_no_t</div><div class="ttdoc">Undo number. </div><div class="ttdef"><b>Definition:</b> trx0types.h:148</div></div>
<div class="ttc" id="structTrxTrackHash_html"><div class="ttname"><a href="structTrxTrackHash.html">TrxTrackHash</a></div><div class="ttdef"><b>Definition:</b> trx0types.h:599</div></div>
<div class="ttc" id="trx0types_8h_html_a8d7dc342a58ab67f326d9139058605e2"><div class="ttname"><a href="trx0types_8h.html#a8d7dc342a58ab67f326d9139058605e2">RsegMutex</a></div><div class="ttdeci">ib_mutex_t RsegMutex</div><div class="ttdef"><b>Definition:</b> trx0types.h:176</div></div>
<div class="ttc" id="classRsegs_html_a1f075b436e4a0f0415571f081eada5c3"><div class="ttname"><a href="classRsegs.html#a1f075b436e4a0f0415571f081eada5c3">Rsegs::set_inactive_implicit</a></div><div class="ttdeci">void set_inactive_implicit()</div><div class="ttdoc">Set the state of the rollback segments in this undo tablespace to inactive_implicit. </div><div class="ttdef"><b>Definition:</b> trx0types.h:406</div></div>
<div class="ttc" id="trx0types_8h_html_a8bdb9d55e50652fb2ff0952e136d5aba"><div class="ttname"><a href="trx0types_8h.html#a8bdb9d55e50652fb2ff0952e136d5aba">trx_rsegf_t</a></div><div class="ttdeci">byte trx_rsegf_t</div><div class="ttdoc">Rollback segment header. </div><div class="ttdef"><b>Definition:</b> trx0types.h:165</div></div>
<div class="ttc" id="classRsegs_html_ac6d7a95d67a14ba6b4d2f752a38e9769"><div class="ttname"><a href="classRsegs.html#ac6d7a95d67a14ba6b4d2f752a38e9769">Rsegs::is_active</a></div><div class="ttdeci">bool is_active()</div><div class="ttdoc">Return whether the undo tablespace is active. </div><div class="ttdef"><b>Definition:</b> trx0types.h:376</div></div>
<div class="ttc" id="trx0types_8h_html_abc7dff1e33c4bec72afa7fc0f1e8e165"><div class="ttname"><a href="trx0types_8h.html#abc7dff1e33c4bec72afa7fc0f1e8e165">trx_sysf_t</a></div><div class="ttdeci">byte trx_sysf_t</div><div class="ttdoc">File objects. </div><div class="ttdef"><b>Definition:</b> trx0types.h:161</div></div>
<div class="ttc" id="namespacedblwr_1_1recv_html_a4d87e29e585a1f0ddb67f6f0b3b2d0ea"><div class="ttname"><a href="namespacedblwr_1_1recv.html#a4d87e29e585a1f0ddb67f6f0b3b2d0ea">dblwr::recv::find</a></div><div class="ttdeci">const byte * find(const Pages *pages, const page_id_t &amp;page_id) noexcept</div><div class="ttdoc">Find a doublewrite copy of a page. </div><div class="ttdef"><b>Definition:</b> buf0dblwr.cc:2222</div></div>
<div class="ttc" id="structtrx__purge__t_html"><div class="ttname"><a href="structtrx__purge__t.html">trx_purge_t</a></div><div class="ttdoc">The control structure used in the purge operation. </div><div class="ttdef"><b>Definition:</b> trx0purge.h:956</div></div>
<div class="ttc" id="classRsegs_html_a0f8972cfc3ede67ec0d622563bda0b6a"><div class="ttname"><a href="classRsegs.html#a0f8972cfc3ede67ec0d622563bda0b6a">Rsegs::set_empty</a></div><div class="ttdeci">void set_empty()</div><div class="ttdoc">Set the state of the undo tablespace to empty so that it can be dropped. </div><div class="ttdef"><b>Definition:</b> trx0types.h:418</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_70f20ecf11358dff00a0daf546d3147e.html">storage</a></li><li class="navelem"><a class="el" href="dir_3fec0aa9607ea05e0bb1c96aee1a8c4e.html">innobase</a></li><li class="navelem"><a class="el" href="dir_9b7ed1f29269ffabdc4c5f5522a0db25.html">include</a></li><li class="navelem"><a class="el" href="trx0types_8h.html">trx0types.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
