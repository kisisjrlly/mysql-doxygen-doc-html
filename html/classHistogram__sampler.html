<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Histogram_sampler Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classHistogram__sampler.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classHistogram__sampler-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Histogram_sampler Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="row0pread-histogram_8h_source.html">row0pread-histogram.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9e3e52e0b2830dddac6a345e7bcd252d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a9e3e52e0b2830dddac6a345e7bcd252d">Histogram_sampler</a> (size_t max_threads, int sampling_seed, double sampling_percentage, <a class="el" href="sql_2handler_8h.html#ae954cfd46ba0b8300368dccf2bebc842">enum_sampling_method</a> sampling_method)</td></tr>
<tr class="memdesc:a9e3e52e0b2830dddac6a345e7bcd252d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a9e3e52e0b2830dddac6a345e7bcd252d">More...</a><br /></td></tr>
<tr class="separator:a9e3e52e0b2830dddac6a345e7bcd252d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf66d0e51a0ee34fd63bab9a9f03b7e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#acf66d0e51a0ee34fd63bab9a9f03b7e9">~Histogram_sampler</a> ()</td></tr>
<tr class="memdesc:acf66d0e51a0ee34fd63bab9a9f03b7e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#acf66d0e51a0ee34fd63bab9a9f03b7e9">More...</a><br /></td></tr>
<tr class="separator:acf66d0e51a0ee34fd63bab9a9f03b7e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a888df7b7051369a4f27fd7c1926b3eff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a888df7b7051369a4f27fd7c1926b3eff">init</a> (<a class="el" href="structtrx__t.html">trx_t</a> *trx, <a class="el" href="structdict__index__t.html">dict_index_t</a> *<a class="el" href="mysql_8cc.html#adfa69ae672499b1037123a1f17c5552b">index</a>, <a class="el" href="structrow__prebuilt__t.html">row_prebuilt_t</a> *prebuilt)</td></tr>
<tr class="memdesc:a888df7b7051369a4f27fd7c1926b3eff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the sampler context.  <a href="#a888df7b7051369a4f27fd7c1926b3eff">More...</a><br /></td></tr>
<tr class="separator:a888df7b7051369a4f27fd7c1926b3eff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7e88f7e257c5567c447a2b2be032f98"><td class="memItemLeft" align="right" valign="top"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#ad7e88f7e257c5567c447a2b2be032f98">buffer_next</a> ()</td></tr>
<tr class="memdesc:ad7e88f7e257c5567c447a2b2be032f98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer next row.  <a href="#ad7e88f7e257c5567c447a2b2be032f98">More...</a><br /></td></tr>
<tr class="separator:ad7e88f7e257c5567c447a2b2be032f98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac688fbd8dc35b8a1370e77293129c25a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#ac688fbd8dc35b8a1370e77293129c25a">buffer_end</a> ()</td></tr>
<tr class="memdesc:ac688fbd8dc35b8a1370e77293129c25a"><td class="mdescLeft">&#160;</td><td class="mdescRight">End parallel read in case the reader thread is still active and wait for its exit.  <a href="#ac688fbd8dc35b8a1370e77293129c25a">More...</a><br /></td></tr>
<tr class="separator:ac688fbd8dc35b8a1370e77293129c25a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2068c8ef2fd6c2f8aff1dac06c4d6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a3e2068c8ef2fd6c2f8aff1dac06c4d6e">set</a> (<a class="el" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *buf)</td></tr>
<tr class="memdesc:a3e2068c8ef2fd6c2f8aff1dac06c4d6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the buffer.  <a href="#a3e2068c8ef2fd6c2f8aff1dac06c4d6e">More...</a><br /></td></tr>
<tr class="separator:a3e2068c8ef2fd6c2f8aff1dac06c4d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66723966491b586dfb13193d05ea6f61"><td class="memItemLeft" align="right" valign="top"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a66723966491b586dfb13193d05ea6f61">run</a> ()</td></tr>
<tr class="memdesc:a66723966491b586dfb13193d05ea6f61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the sampling process.  <a href="#a66723966491b586dfb13193d05ea6f61">More...</a><br /></td></tr>
<tr class="separator:a66723966491b586dfb13193d05ea6f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ba15333585510034d86c5359fbe3323"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a2ba15333585510034d86c5359fbe3323">skip</a> ()</td></tr>
<tr class="memdesc:a2ba15333585510034d86c5359fbe3323"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the processing of the record needs to be skipped.  <a href="#a2ba15333585510034d86c5359fbe3323">More...</a><br /></td></tr>
<tr class="separator:a2ba15333585510034d86c5359fbe3323"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ae034c4b6dc1a8b68b91b772161977227"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#ae034c4b6dc1a8b68b91b772161977227">wait_for_start_of_buffering</a> ()</td></tr>
<tr class="memdesc:ae034c4b6dc1a8b68b91b772161977227"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait till there is a request to buffer the next row.  <a href="#ae034c4b6dc1a8b68b91b772161977227">More...</a><br /></td></tr>
<tr class="separator:ae034c4b6dc1a8b68b91b772161977227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a652bdc39a48041079441c60193039c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a4a652bdc39a48041079441c60193039c">wait_for_end_of_buffering</a> ()</td></tr>
<tr class="memdesc:a4a652bdc39a48041079441c60193039c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait till the buffering of the row is complete.  <a href="#a4a652bdc39a48041079441c60193039c">More...</a><br /></td></tr>
<tr class="separator:a4a652bdc39a48041079441c60193039c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81c280b8ec8b19fc519cccebb4409e83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a81c280b8ec8b19fc519cccebb4409e83">signal_start_of_buffering</a> ()</td></tr>
<tr class="memdesc:a81c280b8ec8b19fc519cccebb4409e83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signal that the next row needs to be buffered.  <a href="#a81c280b8ec8b19fc519cccebb4409e83">More...</a><br /></td></tr>
<tr class="separator:a81c280b8ec8b19fc519cccebb4409e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc7228f0ec804cc1f34d0c411866a332"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#afc7228f0ec804cc1f34d0c411866a332">signal_end_of_buffering</a> ()</td></tr>
<tr class="memdesc:afc7228f0ec804cc1f34d0c411866a332"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signal that the buffering of the row is complete.  <a href="#afc7228f0ec804cc1f34d0c411866a332">More...</a><br /></td></tr>
<tr class="separator:afc7228f0ec804cc1f34d0c411866a332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa778418c6efcb37bb9588db432a91563"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#aa778418c6efcb37bb9588db432a91563">set_error_state</a> (<a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> err)</td></tr>
<tr class="memdesc:aa778418c6efcb37bb9588db432a91563"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the error state.  <a href="#aa778418c6efcb37bb9588db432a91563">More...</a><br /></td></tr>
<tr class="separator:aa778418c6efcb37bb9588db432a91563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62bbbadc4683474d905f42d6e34576ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a62bbbadc4683474d905f42d6e34576ce">is_error_set</a> () const</td></tr>
<tr class="separator:a62bbbadc4683474d905f42d6e34576ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98913fcc2fd49a94419c79906bb7435a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a98913fcc2fd49a94419c79906bb7435a">start_callback</a> (<a class="el" href="structParallel__reader_1_1Thread__ctx.html">Parallel_reader::Thread_ctx</a> *reader_thread_ctx)</td></tr>
<tr class="memdesc:a98913fcc2fd49a94419c79906bb7435a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Each parallel reader thread's init function.  <a href="#a98913fcc2fd49a94419c79906bb7435a">More...</a><br /></td></tr>
<tr class="separator:a98913fcc2fd49a94419c79906bb7435a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a721e0ccddba0ce4908e27f7ad6a508e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a721e0ccddba0ce4908e27f7ad6a508e5">finish_callback</a> (<a class="el" href="structParallel__reader_1_1Thread__ctx.html">Parallel_reader::Thread_ctx</a> *reader_thread_ctx)</td></tr>
<tr class="memdesc:a721e0ccddba0ce4908e27f7ad6a508e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Each parallel reader thread's end function.  <a href="#a721e0ccddba0ce4908e27f7ad6a508e5">More...</a><br /></td></tr>
<tr class="separator:a721e0ccddba0ce4908e27f7ad6a508e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a853a5e8925ce403460f0eb5d52983f5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a853a5e8925ce403460f0eb5d52983f5d">sample_rec</a> (const <a class="el" href="classParallel__reader_1_1Ctx.html">Parallel_reader::Ctx</a> *ctx, const <a class="el" href="rem0types_8h.html#a92caeffe2dc2fbe825a54aef9a163435">rec_t</a> *rec, ulint *offsets, const <a class="el" href="structdict__index__t.html">dict_index_t</a> *<a class="el" href="mysql_8cc.html#adfa69ae672499b1037123a1f17c5552b">index</a>, <a class="el" href="structrow__prebuilt__t.html">row_prebuilt_t</a> *prebuilt)</td></tr>
<tr class="memdesc:a853a5e8925ce403460f0eb5d52983f5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert the row in InnoDB format to MySQL format and store in the buffer for server to use.  <a href="#a853a5e8925ce403460f0eb5d52983f5d">More...</a><br /></td></tr>
<tr class="separator:a853a5e8925ce403460f0eb5d52983f5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a520063183bf6174726c9802dc86eae54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a520063183bf6174726c9802dc86eae54">process_non_leaf_rec</a> (const <a class="el" href="classParallel__reader_1_1Ctx.html">Parallel_reader::Ctx</a> *ctx, <a class="el" href="structrow__prebuilt__t.html">row_prebuilt_t</a> *prebuilt)</td></tr>
<tr class="memdesc:a520063183bf6174726c9802dc86eae54"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each record in a non-leaf block at level 1 (if leaf level is 0) check if the child page needs to be sampled and if so sample all the rows in the child page.  <a href="#a520063183bf6174726c9802dc86eae54">More...</a><br /></td></tr>
<tr class="separator:a520063183bf6174726c9802dc86eae54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a085051cfe7e93bd7350c6b2771d6296c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a085051cfe7e93bd7350c6b2771d6296c">process_leaf_rec</a> (const <a class="el" href="classParallel__reader_1_1Ctx.html">Parallel_reader::Ctx</a> *ctx, <a class="el" href="structrow__prebuilt__t.html">row_prebuilt_t</a> *prebuilt)</td></tr>
<tr class="memdesc:a085051cfe7e93bd7350c6b2771d6296c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the record in the leaf page.  <a href="#a085051cfe7e93bd7350c6b2771d6296c">More...</a><br /></td></tr>
<tr class="separator:a085051cfe7e93bd7350c6b2771d6296c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a971c88810d6a737539ae062e556d05ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a971c88810d6a737539ae062e556d05ed">m_buf</a> {<a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>}</td></tr>
<tr class="memdesc:a971c88810d6a737539ae062e556d05ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to store the sampled row which is in the MySQL format.  <a href="#a971c88810d6a737539ae062e556d05ed">More...</a><br /></td></tr>
<tr class="separator:a971c88810d6a737539ae062e556d05ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b99bc5dccc52b5169e4083c3dd36a38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="os0event_8h.html#ae24909be432e4a95bd956a707e4d1d20">os_event_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a4b99bc5dccc52b5169e4083c3dd36a38">m_start_buffer_event</a></td></tr>
<tr class="memdesc:a4b99bc5dccc52b5169e4083c3dd36a38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Event to notify if the next row needs to be buffered.  <a href="#a4b99bc5dccc52b5169e4083c3dd36a38">More...</a><br /></td></tr>
<tr class="separator:a4b99bc5dccc52b5169e4083c3dd36a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c0c16185c9d405e89881a6b2b341640"><td class="memItemLeft" align="right" valign="top"><a class="el" href="os0event_8h.html#ae24909be432e4a95bd956a707e4d1d20">os_event_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a1c0c16185c9d405e89881a6b2b341640">m_end_buffer_event</a></td></tr>
<tr class="memdesc:a1c0c16185c9d405e89881a6b2b341640"><td class="mdescLeft">&#160;</td><td class="mdescRight">Event to notify if the next row has been buffered.  <a href="#a1c0c16185c9d405e89881a6b2b341640">More...</a><br /></td></tr>
<tr class="separator:a1c0c16185c9d405e89881a6b2b341640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2714005f2e9062a4aaa30a98e7f283"><td class="memItemLeft" align="right" valign="top"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a5c2714005f2e9062a4aaa30a98e7f283">m_err</a> {<a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654da3a3f63d8e5653727f5af7fdeb326e16d">DB_SUCCESS</a>}</td></tr>
<tr class="memdesc:a5c2714005f2e9062a4aaa30a98e7f283"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error code when the row was buffered.  <a href="#a5c2714005f2e9062a4aaa30a98e7f283">More...</a><br /></td></tr>
<tr class="separator:a5c2714005f2e9062a4aaa30a98e7f283"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46dc276e8cd39cbdcfc07df1a3d73c8b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classParallel__reader.html">Parallel_reader</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a46dc276e8cd39cbdcfc07df1a3d73c8b">m_parallel_reader</a></td></tr>
<tr class="memdesc:a46dc276e8cd39cbdcfc07df1a3d73c8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The parallel reader.  <a href="#a46dc276e8cd39cbdcfc07df1a3d73c8b">More...</a><br /></td></tr>
<tr class="separator:a46dc276e8cd39cbdcfc07df1a3d73c8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaccf95580ccdf4f2eac50076f2d6dfbd"><td class="memItemLeft" align="right" valign="top">std::mt19937&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#aaccf95580ccdf4f2eac50076f2d6dfbd">m_random_generator</a></td></tr>
<tr class="memdesc:aaccf95580ccdf4f2eac50076f2d6dfbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Random generator engine used to provide us random uniformly distrubuted values required to decide if the row in question needs to be sampled or not.  <a href="#aaccf95580ccdf4f2eac50076f2d6dfbd">More...</a><br /></td></tr>
<tr class="separator:aaccf95580ccdf4f2eac50076f2d6dfbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a485b2b9a66b5edd0d05064165d2dfd50"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sql_2handler_8h.html#ae954cfd46ba0b8300368dccf2bebc842">enum_sampling_method</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a485b2b9a66b5edd0d05064165d2dfd50">m_sampling_method</a> {<a class="el" href="sql_2handler_8h.html#ae954cfd46ba0b8300368dccf2bebc842ab50339a10e1de285ac99d4c3990b8693">enum_sampling_method::NONE</a>}</td></tr>
<tr class="memdesc:a485b2b9a66b5edd0d05064165d2dfd50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sampling method to be used for sampling.  <a href="#a485b2b9a66b5edd0d05064165d2dfd50">More...</a><br /></td></tr>
<tr class="separator:a485b2b9a66b5edd0d05064165d2dfd50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a84fd927501930d6f6ea1385917ee2a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a5a84fd927501930d6f6ea1385917ee2a">m_sampling_percentage</a> {}</td></tr>
<tr class="memdesc:a5a84fd927501930d6f6ea1385917ee2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sampling percentage to be used for sampling.  <a href="#a5a84fd927501930d6f6ea1385917ee2a">More...</a><br /></td></tr>
<tr class="separator:a5a84fd927501930d6f6ea1385917ee2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1248949f278ff71b8f9e45758c4ee2c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a1248949f278ff71b8f9e45758c4ee2c5">m_sampling_seed</a> {}</td></tr>
<tr class="memdesc:a1248949f278ff71b8f9e45758c4ee2c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sampling seed to be used for sampling.  <a href="#a1248949f278ff71b8f9e45758c4ee2c5">More...</a><br /></td></tr>
<tr class="separator:a1248949f278ff71b8f9e45758c4ee2c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a012d4b3a0abc4a2bdfa5cf271031cd8a"><td class="memItemLeft" align="right" valign="top">std::atomic_size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a012d4b3a0abc4a2bdfa5cf271031cd8a">m_n_sampled</a></td></tr>
<tr class="memdesc:a012d4b3a0abc4a2bdfa5cf271031cd8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of rows sampled.  <a href="#a012d4b3a0abc4a2bdfa5cf271031cd8a">More...</a><br /></td></tr>
<tr class="separator:a012d4b3a0abc4a2bdfa5cf271031cd8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a4d3ed15ee3d0e815b52f1efe42a4316f"><td class="memItemLeft" align="right" valign="top">static std::uniform_real_distribution&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classHistogram__sampler.html#a4d3ed15ee3d0e815b52f1efe42a4316f">m_distribution</a></td></tr>
<tr class="memdesc:a4d3ed15ee3d0e815b52f1efe42a4316f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uniform distribution used by the random generator.  <a href="#a4d3ed15ee3d0e815b52f1efe42a4316f">More...</a><br /></td></tr>
<tr class="separator:a4d3ed15ee3d0e815b52f1efe42a4316f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9e3e52e0b2830dddac6a345e7bcd252d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e3e52e0b2830dddac6a345e7bcd252d">&#9670;&nbsp;</a></span>Histogram_sampler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Histogram_sampler::Histogram_sampler </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_threads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sampling_seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling_percentage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sql_2handler_8h.html#ae954cfd46ba0b8300368dccf2bebc842">enum_sampling_method</a>&#160;</td>
          <td class="paramname"><em>sampling_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">max_threads</td><td>Maximum number of threads to use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sampling_seed</td><td>seed to be used for sampling </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sampling_percentage</td><td>percentage of sampling that needs to be done </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sampling_method</td><td>sampling method to be used for sampling </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acf66d0e51a0ee34fd63bab9a9f03b7e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf66d0e51a0ee34fd63bab9a9f03b7e9">&#9670;&nbsp;</a></span>~Histogram_sampler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Histogram_sampler::~Histogram_sampler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac688fbd8dc35b8a1370e77293129c25a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac688fbd8dc35b8a1370e77293129c25a">&#9670;&nbsp;</a></span>buffer_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Histogram_sampler::buffer_end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>End parallel read in case the reader thread is still active and wait for its exit. </p>
<p>This can happen if we're ending sampling prematurely. </p>

</div>
</div>
<a id="ad7e88f7e257c5567c447a2b2be032f98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7e88f7e257c5567c447a2b2be032f98">&#9670;&nbsp;</a></span>buffer_next()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> Histogram_sampler::buffer_next </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Buffer next row. </p>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

</div>
</div>
<a id="a721e0ccddba0ce4908e27f7ad6a508e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a721e0ccddba0ce4908e27f7ad6a508e5">&#9670;&nbsp;</a></span>finish_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> Histogram_sampler::finish_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParallel__reader_1_1Thread__ctx.html">Parallel_reader::Thread_ctx</a> *&#160;</td>
          <td class="paramname"><em>reader_thread_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Each parallel reader thread's end function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reader_thread_ctx</td><td>context information related to the thread </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DB_SUCCESS or error code. </dd></dl>

</div>
</div>
<a id="a888df7b7051369a4f27fd7c1926b3eff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a888df7b7051369a4f27fd7c1926b3eff">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Histogram_sampler::init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtrx__t.html">trx_t</a> *&#160;</td>
          <td class="paramname"><em>trx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdict__index__t.html">dict_index_t</a> *&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrow__prebuilt__t.html">row_prebuilt_t</a> *&#160;</td>
          <td class="paramname"><em>prebuilt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the sampler context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">trx</td><td>Transaction used for parallel read. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>clustered index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prebuilt</td><td>prebuilt info </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>on success. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a62bbbadc4683474d905f42d6e34576ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62bbbadc4683474d905f42d6e34576ce">&#9670;&nbsp;</a></span>is_error_set()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Histogram_sampler::is_error_set </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true if in error state. </dd></dl>

</div>
</div>
<a id="a085051cfe7e93bd7350c6b2771d6296c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a085051cfe7e93bd7350c6b2771d6296c">&#9670;&nbsp;</a></span>process_leaf_rec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> Histogram_sampler::process_leaf_rec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParallel__reader_1_1Ctx.html">Parallel_reader::Ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrow__prebuilt__t.html">row_prebuilt_t</a> *&#160;</td>
          <td class="paramname"><em>prebuilt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process the record in the leaf page. </p>
<p>This would happen only when the root page is the leaf page and in such a case we process the page regardless of the sampling percentage. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>Parallel read context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prebuilt</td><td>Row meta-data cache. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

</div>
</div>
<a id="a520063183bf6174726c9802dc86eae54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a520063183bf6174726c9802dc86eae54">&#9670;&nbsp;</a></span>process_non_leaf_rec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> Histogram_sampler::process_non_leaf_rec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParallel__reader_1_1Ctx.html">Parallel_reader::Ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrow__prebuilt__t.html">row_prebuilt_t</a> *&#160;</td>
          <td class="paramname"><em>prebuilt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For each record in a non-leaf block at level 1 (if leaf level is 0) check if the child page needs to be sampled and if so sample all the rows in the child page. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>Parallel read context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prebuilt</td><td>Row meta-data cache. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

</div>
</div>
<a id="a66723966491b586dfb13193d05ea6f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66723966491b586dfb13193d05ea6f61">&#9670;&nbsp;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> Histogram_sampler::run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the sampling process. </p>
<dl class="section return"><dt>Returns</dt><dd>DB_SUCCESS or error code. </dd></dl>

</div>
</div>
<a id="a853a5e8925ce403460f0eb5d52983f5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a853a5e8925ce403460f0eb5d52983f5d">&#9670;&nbsp;</a></span>sample_rec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> Histogram_sampler::sample_rec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParallel__reader_1_1Ctx.html">Parallel_reader::Ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="rem0types_8h.html#a92caeffe2dc2fbe825a54aef9a163435">rec_t</a> *&#160;</td>
          <td class="paramname"><em>rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulint *&#160;</td>
          <td class="paramname"><em>offsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structdict__index__t.html">dict_index_t</a> *&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrow__prebuilt__t.html">row_prebuilt_t</a> *&#160;</td>
          <td class="paramname"><em>prebuilt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert the row in InnoDB format to MySQL format and store in the buffer for server to use. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>Parallel read context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rec</td><td>record that needs to be converted </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">offsets</td><td>offsets belonging to the record </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>index of the record </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prebuilt</td><td>Row meta-data cache. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DB_SUCCESS or error code. </dd></dl>

</div>
</div>
<a id="a3e2068c8ef2fd6c2f8aff1dac06c4d6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e2068c8ef2fd6c2f8aff1dac06c4d6e">&#9670;&nbsp;</a></span>set()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Histogram_sampler::set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>buffer to be used to store the row converted to MySQL format. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa778418c6efcb37bb9588db432a91563"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa778418c6efcb37bb9588db432a91563">&#9670;&nbsp;</a></span>set_error_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Histogram_sampler::set_error_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a>&#160;</td>
          <td class="paramname"><em>err</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the error state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">err</td><td>Error state to set to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afc7228f0ec804cc1f34d0c411866a332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc7228f0ec804cc1f34d0c411866a332">&#9670;&nbsp;</a></span>signal_end_of_buffering()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Histogram_sampler::signal_end_of_buffering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Signal that the buffering of the row is complete. </p>

</div>
</div>
<a id="a81c280b8ec8b19fc519cccebb4409e83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81c280b8ec8b19fc519cccebb4409e83">&#9670;&nbsp;</a></span>signal_start_of_buffering()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Histogram_sampler::signal_start_of_buffering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Signal that the next row needs to be buffered. </p>

</div>
</div>
<a id="a2ba15333585510034d86c5359fbe3323"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ba15333585510034d86c5359fbe3323">&#9670;&nbsp;</a></span>skip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Histogram_sampler::skip </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the processing of the record needs to be skipped. </p>
<p>In case of record belonging to non-leaf page, we decide if the child page pertaining to the record needs to be skipped. In case of record belonging to leaf page, we read the page regardless. </p><dl class="section return"><dt>Returns</dt><dd>true if it needs to be skipped, else false. </dd></dl>

</div>
</div>
<a id="a98913fcc2fd49a94419c79906bb7435a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98913fcc2fd49a94419c79906bb7435a">&#9670;&nbsp;</a></span>start_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> Histogram_sampler::start_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParallel__reader_1_1Thread__ctx.html">Parallel_reader::Thread_ctx</a> *&#160;</td>
          <td class="paramname"><em>reader_thread_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Each parallel reader thread's init function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reader_thread_ctx</td><td>context information related to the thread </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DB_SUCCESS or error code. </dd></dl>
<p>There are data members in row_prebuilt_t that cannot be accessed in multi-threaded mode e.g., blob_heap.</p>
<p>row_prebuilt_t is designed for single threaded access and to share it among threads is not recommended unless "you know what you are doing". This is very fragile code as it stands.</p>
<p>To solve the blob heap issue in prebuilt we request parallel reader thread to use blob heap per thread and we pass this blob heap to the InnoDB to MySQL row format conversion function. </p>

</div>
</div>
<a id="a4a652bdc39a48041079441c60193039c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a652bdc39a48041079441c60193039c">&#9670;&nbsp;</a></span>wait_for_end_of_buffering()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Histogram_sampler::wait_for_end_of_buffering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wait till the buffering of the row is complete. </p>

</div>
</div>
<a id="ae034c4b6dc1a8b68b91b772161977227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae034c4b6dc1a8b68b91b772161977227">&#9670;&nbsp;</a></span>wait_for_start_of_buffering()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Histogram_sampler::wait_for_start_of_buffering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wait till there is a request to buffer the next row. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a971c88810d6a737539ae062e556d05ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a971c88810d6a737539ae062e556d05ed">&#9670;&nbsp;</a></span>m_buf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="libmysql_2authentication__win_2common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>* Histogram_sampler::m_buf {<a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to store the sampled row which is in the MySQL format. </p>

</div>
</div>
<a id="a4d3ed15ee3d0e815b52f1efe42a4316f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d3ed15ee3d0e815b52f1efe42a4316f">&#9670;&nbsp;</a></span>m_distribution</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::uniform_real_distribution&lt; double &gt; Histogram_sampler::m_distribution</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Uniform distribution used by the random generator. </p>

</div>
</div>
<a id="a1c0c16185c9d405e89881a6b2b341640"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c0c16185c9d405e89881a6b2b341640">&#9670;&nbsp;</a></span>m_end_buffer_event</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="os0event_8h.html#ae24909be432e4a95bd956a707e4d1d20">os_event_t</a> Histogram_sampler::m_end_buffer_event</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Event to notify if the next row has been buffered. </p>

</div>
</div>
<a id="a5c2714005f2e9062a4aaa30a98e7f283"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c2714005f2e9062a4aaa30a98e7f283">&#9670;&nbsp;</a></span>m_err</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> Histogram_sampler::m_err {<a class="el" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654da3a3f63d8e5653727f5af7fdeb326e16d">DB_SUCCESS</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Error code when the row was buffered. </p>

</div>
</div>
<a id="a012d4b3a0abc4a2bdfa5cf271031cd8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a012d4b3a0abc4a2bdfa5cf271031cd8a">&#9670;&nbsp;</a></span>m_n_sampled</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic_size_t Histogram_sampler::m_n_sampled</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of rows sampled. </p>

</div>
</div>
<a id="a46dc276e8cd39cbdcfc07df1a3d73c8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46dc276e8cd39cbdcfc07df1a3d73c8b">&#9670;&nbsp;</a></span>m_parallel_reader</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classParallel__reader.html">Parallel_reader</a> Histogram_sampler::m_parallel_reader</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The parallel reader. </p>

</div>
</div>
<a id="aaccf95580ccdf4f2eac50076f2d6dfbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaccf95580ccdf4f2eac50076f2d6dfbd">&#9670;&nbsp;</a></span>m_random_generator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mt19937 Histogram_sampler::m_random_generator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Random generator engine used to provide us random uniformly distrubuted values required to decide if the row in question needs to be sampled or not. </p>

</div>
</div>
<a id="a485b2b9a66b5edd0d05064165d2dfd50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a485b2b9a66b5edd0d05064165d2dfd50">&#9670;&nbsp;</a></span>m_sampling_method</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sql_2handler_8h.html#ae954cfd46ba0b8300368dccf2bebc842">enum_sampling_method</a> Histogram_sampler::m_sampling_method {<a class="el" href="sql_2handler_8h.html#ae954cfd46ba0b8300368dccf2bebc842ab50339a10e1de285ac99d4c3990b8693">enum_sampling_method::NONE</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sampling method to be used for sampling. </p>

</div>
</div>
<a id="a5a84fd927501930d6f6ea1385917ee2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a84fd927501930d6f6ea1385917ee2a">&#9670;&nbsp;</a></span>m_sampling_percentage</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double Histogram_sampler::m_sampling_percentage {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sampling percentage to be used for sampling. </p>

</div>
</div>
<a id="a1248949f278ff71b8f9e45758c4ee2c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1248949f278ff71b8f9e45758c4ee2c5">&#9670;&nbsp;</a></span>m_sampling_seed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Histogram_sampler::m_sampling_seed {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sampling seed to be used for sampling. </p>

</div>
</div>
<a id="a4b99bc5dccc52b5169e4083c3dd36a38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b99bc5dccc52b5169e4083c3dd36a38">&#9670;&nbsp;</a></span>m_start_buffer_event</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="os0event_8h.html#ae24909be432e4a95bd956a707e4d1d20">os_event_t</a> Histogram_sampler::m_start_buffer_event</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Event to notify if the next row needs to be buffered. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>storage/innobase/include/<a class="el" href="row0pread-histogram_8h_source.html">row0pread-histogram.h</a></li>
<li>storage/innobase/row/<a class="el" href="row0pread-histogram_8cc.html">row0pread-histogram.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classHistogram__sampler.html">Histogram_sampler</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
