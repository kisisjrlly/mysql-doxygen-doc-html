<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: sql/sql_db.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sql__db_8cc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sql_db.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="sql__db_8h_source.html">sql/sql_db.h</a>&quot;</code><br />
<code>#include &quot;my_config.h&quot;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;<a class="el" href="string_8h_source.html">string.h</a>&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;atomic&gt;</code><br />
<code>#include &lt;set&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="lex__string_8h_source.html">lex_string.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="m__ctype_8h_source.html">m_ctype.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="m__string_8h_source.html">m_string.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__command_8h_source.html">my_command.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__dbug_8h_source.html">my_dbug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__dir_8h_source.html">my_dir.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__inttypes_8h_source.html">my_inttypes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__io_8h_source.html">my_io.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__macros_8h_source.html">my_macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__sys_8h_source.html">my_sys.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__thread__local_8h_source.html">my_thread_local.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="log__builtins_8h_source.html">mysql/components/services/log_builtins.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="log__shared_8h_source.html">mysql/components/services/log_shared.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mysql__file_8h_source.html">mysql/psi/mysql_file.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="psi_2mysql__mutex_8h_source.html">mysql/psi/mysql_mutex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="service__mysql__alloc_8h_source.html">mysql/service_mysql_alloc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mysql__com_8h_source.html">mysql_com.h</a>&quot;</code><br />
<code>#include &quot;mysqld_error.h&quot;</code><br />
<code>#include &quot;<a class="el" href="mysys__err_8h_source.html">mysys_err.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="auth__acls_8h_source.html">sql/auth/auth_acls.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="auth__common_8h_source.html">sql/auth/auth_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__security__ctx_8h_source.html">sql/auth/sql_security_ctx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="binlog_8h_source.html">sql/binlog.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dictionary__client_8h_source.html">sql/dd/cache/dictionary_client.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dd_8h_source.html">sql/dd/dd.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dd__schema_8h_source.html">sql/dd/dd_schema.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dd__table_8h_source.html">sql/dd/dd_table.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dictionary_8h_source.html">sql/dd/dictionary.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="string__type_8h_source.html">sql/dd/string_type.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="abstract__table_8h_source.html">sql/dd/types/abstract_table.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="types_2schema_8h_source.html">sql/dd/types/schema.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="upgrade_8h_source.html">sql/dd/upgrade_57/upgrade.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="debug__sync_8h_source.html">sql/debug_sync.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="derror_8h_source.html">sql/derror.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error__handler_8h_source.html">sql/error_handler.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="events_8h_source.html">sql/events.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql_2handler_8h_source.html">sql/handler.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="lock_8h_source.html">sql/lock.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="log_8h_source.html">sql/log.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="log__event_8h_source.html">sql/log_event.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mdl_8h_source.html">sql/mdl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mysqld_8h_source.html">sql/mysqld.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="psi__memory__key_8h_source.html">sql/psi_memory_key.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rpl__gtid_8h_source.html">sql/rpl_gtid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rpl__slave__commit__order__manager_8h_source.html">sql/rpl_slave_commit_order_manager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="session__tracker_8h_source.html">sql/session_tracker.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sp_8h_source.html">sql/sp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__base_8h_source.html">sql/sql_base.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__class_8h_source.html">sql/sql_class.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__const_8h_source.html">sql/sql_const.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__error_8h_source.html">sql/sql_error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__handler_8h_source.html">sql/sql_handler.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__table_8h_source.html">sql/sql_table.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="system__variables_8h_source.html">sql/system_variables.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql_2table_8h_source.html">sql/table.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="thd__raii_8h_source.html">sql/thd_raii.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="transaction_8h_source.html">sql/transaction.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__string_8h_source.html">sql_string.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="typelib_8h_source.html">typelib.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRmdir__error__handler.html">Rmdir_error_handler</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error handler which converts errors during database directory removal to warnings/messages to error log.  <a href="classRmdir__error__handler.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0a0861a4e72498aab21db76fdcb3580e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a0a0861a4e72498aab21db76fdcb3580e">find_unknown_and_remove_deletable_files</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structMY__DIR.html">MY_DIR</a> *dirp, const char *<a class="el" href="mysqldump_8cc.html#a38dcf0baefa35c1961c23cf3e06002b5">path</a>)</td></tr>
<tr class="memdesc:a0a0861a4e72498aab21db76fdcb3580e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auxiliary function which checks if database directory has any files which won't be deleted automatically - either because we know that these are temporary/backup files which are safe for delete or by dropping the tables in the database.  <a href="#a0a0861a4e72498aab21db76fdcb3580e">More...</a><br /></td></tr>
<tr class="separator:a0a0861a4e72498aab21db76fdcb3580e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab15c09f41467ae0bc49b381ca1832994"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#ab15c09f41467ae0bc49b381ca1832994">find_db_tables</a> (<a class="el" href="classTHD.html">THD</a> *thd, const <a class="el" href="classdd_1_1Schema.html">dd::Schema</a> &amp;schema, const char *db, <a class="el" href="structTABLE__LIST.html">TABLE_LIST</a> **tables)</td></tr>
<tr class="memdesc:ab15c09f41467ae0bc49b381ca1832994"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auxiliary function which retrieves list of all tables in the database from the data-dictionary.  <a href="#ab15c09f41467ae0bc49b381ca1832994">More...</a><br /></td></tr>
<tr class="separator:ab15c09f41467ae0bc49b381ca1832994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64edab7d099ea353fb922013a46ad43c"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a64edab7d099ea353fb922013a46ad43c">mysql_rm_arc_files</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structMY__DIR.html">MY_DIR</a> *dirp, const char *org_path)</td></tr>
<tr class="separator:a64edab7d099ea353fb922013a46ad43c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c1ced7ac4a4fcda7b637f143ebd2983"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a3c1ced7ac4a4fcda7b637f143ebd2983">rm_dir_w_symlink</a> (const char *org_path, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> send_error)</td></tr>
<tr class="separator:a3c1ced7ac4a4fcda7b637f143ebd2983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bcdfc239f8ba81a22204282286c6ab1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a8bcdfc239f8ba81a22204282286c6ab1">mysql_change_db_impl</a> (<a class="el" href="classTHD.html">THD</a> *thd, const <a class="el" href="lex__string_8h.html#a01c5da2ec635d24c374ba1a995dbe2aa">LEX_CSTRING</a> &amp;new_db_name, <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> new_db_access, const <a class="el" href="structCHARSET__INFO.html">CHARSET_INFO</a> *new_db_charset)</td></tr>
<tr class="memdesc:a8bcdfc239f8ba81a22204282286c6ab1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal implementation: switch current database to a valid one.  <a href="#a8bcdfc239f8ba81a22204282286c6ab1">More...</a><br /></td></tr>
<tr class="separator:a8bcdfc239f8ba81a22204282286c6ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff08fa325c5657a1b2fc250ddc00078c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#aff08fa325c5657a1b2fc250ddc00078c">get_default_db_collation</a> (const <a class="el" href="classdd_1_1Schema.html">dd::Schema</a> &amp;schema, const <a class="el" href="structCHARSET__INFO.html">CHARSET_INFO</a> **collation)</td></tr>
<tr class="separator:aff08fa325c5657a1b2fc250ddc00078c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53cb4d709eb19ece30b3d9a1ec9b442e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a53cb4d709eb19ece30b3d9a1ec9b442e">get_default_db_collation</a> (<a class="el" href="classTHD.html">THD</a> *thd, const char *db_name, const <a class="el" href="structCHARSET__INFO.html">CHARSET_INFO</a> **collation)</td></tr>
<tr class="memdesc:a53cb4d709eb19ece30b3d9a1ec9b442e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return default database collation.  <a href="#a53cb4d709eb19ece30b3d9a1ec9b442e">More...</a><br /></td></tr>
<tr class="separator:a53cb4d709eb19ece30b3d9a1ec9b442e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9de05c62b7f8060195f768fe32a179cb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a9de05c62b7f8060195f768fe32a179cb">thread_can_ignore_schema_read_only</a> (<a class="el" href="classTHD.html">THD</a> *thd)</td></tr>
<tr class="memdesc:a9de05c62b7f8060195f768fe32a179cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the thread type is allowed to ignore the schema read only option.  <a href="#a9de05c62b7f8060195f768fe32a179cb">More...</a><br /></td></tr>
<tr class="separator:a9de05c62b7f8060195f768fe32a179cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a799d22dd86836bdfe780dd255949d041"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a799d22dd86836bdfe780dd255949d041">check_schema_readonly</a> (<a class="el" href="classTHD.html">THD</a> *thd, const char *schema_name, <a class="el" href="structTABLE__SHARE.html">TABLE_SHARE</a> *share)</td></tr>
<tr class="memdesc:a799d22dd86836bdfe780dd255949d041"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the read_only option for the given schema, and report error if the schema is not writable.  <a href="#a799d22dd86836bdfe780dd255949d041">More...</a><br /></td></tr>
<tr class="separator:a799d22dd86836bdfe780dd255949d041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12651302762c33d214b51e96bfc23d35"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a12651302762c33d214b51e96bfc23d35">write_db_cmd_to_binlog</a> (<a class="el" href="classTHD.html">THD</a> *thd, const char *db, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> trx_cache)</td></tr>
<tr class="memdesc:a12651302762c33d214b51e96bfc23d35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auxiliary function which writes CREATE/ALTER or DROP DATABASE statement to the binary log overriding connection's current database with one being dropped.  <a href="#a12651302762c33d214b51e96bfc23d35">More...</a><br /></td></tr>
<tr class="separator:a12651302762c33d214b51e96bfc23d35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c6fde70b8562aae147bd83cfc4ca464"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a1c6fde70b8562aae147bd83cfc4ca464">set_db_default_charset</a> (const <a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structHA__CREATE__INFO.html">HA_CREATE_INFO</a> *create_info)</td></tr>
<tr class="separator:a1c6fde70b8562aae147bd83cfc4ca464"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad241d3ccff14a63839a0855b92ba62a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#ad241d3ccff14a63839a0855b92ba62a8">mysql_create_db</a> (<a class="el" href="classTHD.html">THD</a> *thd, const char *db, <a class="el" href="structHA__CREATE__INFO.html">HA_CREATE_INFO</a> *create_info)</td></tr>
<tr class="memdesc:ad241d3ccff14a63839a0855b92ba62a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a database.  <a href="#ad241d3ccff14a63839a0855b92ba62a8">More...</a><br /></td></tr>
<tr class="separator:ad241d3ccff14a63839a0855b92ba62a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69442493b41021b52068ebc500ce3cef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a69442493b41021b52068ebc500ce3cef">mysql_alter_db</a> (<a class="el" href="classTHD.html">THD</a> *thd, const char *db, <a class="el" href="structHA__CREATE__INFO.html">HA_CREATE_INFO</a> *create_info)</td></tr>
<tr class="separator:a69442493b41021b52068ebc500ce3cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79bcf6faf8dc1d82729f011965dff8bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a79bcf6faf8dc1d82729f011965dff8bb">mysql_rm_db</a> (<a class="el" href="classTHD.html">THD</a> *thd, const <a class="el" href="lex__string_8h.html#a01c5da2ec635d24c374ba1a995dbe2aa">LEX_CSTRING</a> &amp;db, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> if_exists)</td></tr>
<tr class="memdesc:a79bcf6faf8dc1d82729f011965dff8bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drop all tables, routines and events in a database and the database itself.  <a href="#a79bcf6faf8dc1d82729f011965dff8bb">More...</a><br /></td></tr>
<tr class="separator:a79bcf6faf8dc1d82729f011965dff8bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02641c3fbb1fe2e10633e2480f03a1d0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a02641c3fbb1fe2e10633e2480f03a1d0">backup_current_db_name</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="lex__string_8h.html#a1fb89d4ad1109660fb2b796efdb3933e">LEX_STRING</a> *saved_db_name)</td></tr>
<tr class="memdesc:a02641c3fbb1fe2e10633e2480f03a1d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backup the current database name before switch.  <a href="#a02641c3fbb1fe2e10633e2480f03a1d0">More...</a><br /></td></tr>
<tr class="separator:a02641c3fbb1fe2e10633e2480f03a1d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fe24d00084b2530a95beb4ea93856fe"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a3fe24d00084b2530a95beb4ea93856fe">cmp_db_names</a> (const char *db1_name, const char *db2_name)</td></tr>
<tr class="memdesc:a3fe24d00084b2530a95beb4ea93856fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true if db1_name is equal to db2_name, false otherwise.  <a href="#a3fe24d00084b2530a95beb4ea93856fe">More...</a><br /></td></tr>
<tr class="separator:a3fe24d00084b2530a95beb4ea93856fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dc64a1aaffc0db6e0ebf02729c89a2e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a9dc64a1aaffc0db6e0ebf02729c89a2e">mysql_change_db</a> (<a class="el" href="classTHD.html">THD</a> *thd, const <a class="el" href="lex__string_8h.html#a01c5da2ec635d24c374ba1a995dbe2aa">LEX_CSTRING</a> &amp;new_db_name, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> force_switch)</td></tr>
<tr class="memdesc:a9dc64a1aaffc0db6e0ebf02729c89a2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the current database and its attributes unconditionally.  <a href="#a9dc64a1aaffc0db6e0ebf02729c89a2e">More...</a><br /></td></tr>
<tr class="separator:a9dc64a1aaffc0db6e0ebf02729c89a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa15e10fb5945998c442daac30d876fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#aaa15e10fb5945998c442daac30d876fb">mysql_opt_change_db</a> (<a class="el" href="classTHD.html">THD</a> *thd, const <a class="el" href="lex__string_8h.html#a01c5da2ec635d24c374ba1a995dbe2aa">LEX_CSTRING</a> &amp;new_db_name, <a class="el" href="lex__string_8h.html#a1fb89d4ad1109660fb2b796efdb3933e">LEX_STRING</a> *saved_db_name, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> force_switch, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> *cur_db_changed)</td></tr>
<tr class="memdesc:aaa15e10fb5945998c442daac30d876fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the current database and its attributes if needed.  <a href="#aaa15e10fb5945998c442daac30d876fb">More...</a><br /></td></tr>
<tr class="separator:aaa15e10fb5945998c442daac30d876fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a85342a3a9008f594f1835fa6ac83d253"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a85342a3a9008f594f1835fa6ac83d253">del_exts</a> []</td></tr>
<tr class="separator:a85342a3a9008f594f1835fa6ac83d253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95397ef912956bf041aa586da73ffdb7"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structTYPELIB.html">TYPELIB</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__db_8cc.html#a95397ef912956bf041aa586da73ffdb7">deletable_extentions</a></td></tr>
<tr class="separator:a95397ef912956bf041aa586da73ffdb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a02641c3fbb1fe2e10633e2480f03a1d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02641c3fbb1fe2e10633e2480f03a1d0">&#9670;&nbsp;</a></span>backup_current_db_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void backup_current_db_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="lex__string_8h.html#a1fb89d4ad1109660fb2b796efdb3933e">LEX_STRING</a> *&#160;</td>
          <td class="paramname"><em>saved_db_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Backup the current database name before switch. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">thd</td><td>thread handle </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">saved_db_name</td><td>IN: "str" points to a buffer where to store the old database name, "length" contains the buffer size OUT: if the current (default) database is not NULL, its name is copied to the buffer pointed at by "str" and "length" is updated accordingly. Otherwise "str" is set to NULL and "length" is set to 0. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a799d22dd86836bdfe780dd255949d041"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a799d22dd86836bdfe780dd255949d041">&#9670;&nbsp;</a></span>check_schema_readonly()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> check_schema_readonly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>schema_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE__SHARE.html">TABLE_SHARE</a> *&#160;</td>
          <td class="paramname"><em>share</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the read_only option for the given schema, and report error if the schema is not writable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread context. </td></tr>
    <tr><td class="paramname">schema_name</td><td>Name of schema to check. </td></tr>
    <tr><td class="paramname">share</td><td>For tables, we cache the read only option in the table share, and can therefore get the read only option from the share.</td></tr>
  </table>
  </dd>
</dl>
<p>Caching the read only state in the table share is done for performance reasons. If a share is submitted, we get the read only state from the share. Otherwise, we get the schema object from the DD cache in order to see the read only state.</p>
<dl class="section return"><dt>Returns</dt><dd>false if the schema is writable, true if not. If returning true, then error is already reported. </dd></dl>

</div>
</div>
<a id="a3fe24d00084b2530a95beb4ea93856fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fe24d00084b2530a95beb4ea93856fe">&#9670;&nbsp;</a></span>cmp_db_names()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> cmp_db_names </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>db1_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>db2_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return true if db1_name is equal to db2_name, false otherwise. </p>
<p>The function allows to compare database names according to the MySQL rules. The database names db1 and db2 are equal if:</p><ul>
<li>db1 is NULL and db2 is NULL; or</li>
<li>db1 is not-NULL, db2 is not-NULL, db1 is equal (ignoring case) to db2 in system character set (UTF8). </li>
</ul>

</div>
</div>
<a id="ab15c09f41467ae0bc49b381ca1832994"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab15c09f41467ae0bc49b381ca1832994">&#9670;&nbsp;</a></span>find_db_tables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> find_db_tables </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdd_1_1Schema.html">dd::Schema</a> &amp;&#160;</td>
          <td class="paramname"><em>schema</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE__LIST.html">TABLE_LIST</a> **&#160;</td>
          <td class="paramname"><em>tables</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Auxiliary function which retrieves list of all tables in the database from the data-dictionary. </p>

</div>
</div>
<a id="a0a0861a4e72498aab21db76fdcb3580e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a0861a4e72498aab21db76fdcb3580e">&#9670;&nbsp;</a></span>find_unknown_and_remove_deletable_files()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> find_unknown_and_remove_deletable_files </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMY__DIR.html">MY_DIR</a> *&#160;</td>
          <td class="paramname"><em>dirp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Auxiliary function which checks if database directory has any files which won't be deleted automatically - either because we know that these are temporary/backup files which are safe for delete or by dropping the tables in the database. </p>
<p>Also deletes various temporary/backup files which are known to be safe to delete. </p>

</div>
</div>
<a id="aff08fa325c5657a1b2fc250ddc00078c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff08fa325c5657a1b2fc250ddc00078c">&#9670;&nbsp;</a></span>get_default_db_collation() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> get_default_db_collation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdd_1_1Schema.html">dd::Schema</a> &amp;&#160;</td>
          <td class="paramname"><em>schema</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structCHARSET__INFO.html">CHARSET_INFO</a> **&#160;</td>
          <td class="paramname"><em>collation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a53cb4d709eb19ece30b3d9a1ec9b442e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53cb4d709eb19ece30b3d9a1ec9b442e">&#9670;&nbsp;</a></span>get_default_db_collation() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> get_default_db_collation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>db_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structCHARSET__INFO.html">CHARSET_INFO</a> **&#160;</td>
          <td class="paramname"><em>collation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return default database collation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">thd</td><td>Thread context. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">db_name</td><td>Database name. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">collation</td><td>Charset object pointer if object exists else NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>false No error. true Error (thd-&gt;is_error is assumed to be set.) </dd></dl>

</div>
</div>
<a id="a69442493b41021b52068ebc500ce3cef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69442493b41021b52068ebc500ce3cef">&#9670;&nbsp;</a></span>mysql_alter_db()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> mysql_alter_db </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHA__CREATE__INFO.html">HA_CREATE_INFO</a> *&#160;</td>
          <td class="paramname"><em>create_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9dc64a1aaffc0db6e0ebf02729c89a2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dc64a1aaffc0db6e0ebf02729c89a2e">&#9670;&nbsp;</a></span>mysql_change_db()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> mysql_change_db </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="lex__string_8h.html#a01c5da2ec635d24c374ba1a995dbe2aa">LEX_CSTRING</a> &amp;&#160;</td>
          <td class="paramname"><em>new_db_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>force_switch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change the current database and its attributes unconditionally. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>thread handle </td></tr>
    <tr><td class="paramname">new_db_name</td><td>database name </td></tr>
    <tr><td class="paramname">force_switch</td><td>if force_switch is false, then the operation will fail if <pre class="fragment">                  - new_db_name is NULL or empty;

                  - OR new database name is invalid
                    (check_db_name() failed);

                  - OR user has no privilege on the new database;

                  - OR new database does not exist;

                if force_switch is true, then

                  - if new_db_name is NULL or empty, the current
                    database will be NULL, @@collation_database will
                    be set to @@collation_server, the operation will
                    succeed.

                  - if new database name is invalid
                    (check_db_name() failed), the current database
                    will be NULL, @@collation_database will be set to
                    @@collation_server, but the operation will fail;

                  - user privileges will not be checked
                    (THD::db_access however is updated);

                    TODO: is this really the intention?
                          (see sp-security.test).

                  - if new database does not exist,the current database
                    will be NULL, @@collation_database will be set to
                    @@collation_server, a warning will be thrown, the
                    operation will succeed.
</pre></td></tr>
  </table>
  </dd>
</dl>
<p>The function checks that the database name corresponds to a valid and existent database, checks access rights and changes the current database with database attributes (@collation_database session variable, THD::db_access).</p>
<p>This function is not the only way to switch the database that is currently employed. When the replication slave thread switches the database before executing a query, it calls thd-&gt;set_db directly. However, if the query, in turn, uses a stored routine, the stored routine will use this function, even if it's run on the slave.</p>
<p>This function allocates the name of the database on the system heap: this is necessary to be able to uniformly change the database from any module of the server. Up to 5.0 different modules were using different memory to store the name of the database, and this led to memory corruption: a stack pointer set by Stored Procedures was used by replication after the stack address was long gone.</p>
<dl class="section return"><dt>Returns</dt><dd>Operation status </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>Success </td></tr>
    <tr><td class="paramname">true</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8bcdfc239f8ba81a22204282286c6ab1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bcdfc239f8ba81a22204282286c6ab1">&#9670;&nbsp;</a></span>mysql_change_db_impl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void mysql_change_db_impl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="lex__string_8h.html#a01c5da2ec635d24c374ba1a995dbe2aa">LEX_CSTRING</a> &amp;&#160;</td>
          <td class="paramname"><em>new_db_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>new_db_access</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structCHARSET__INFO.html">CHARSET_INFO</a> *&#160;</td>
          <td class="paramname"><em>new_db_charset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal implementation: switch current database to a valid one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread context. </td></tr>
    <tr><td class="paramname">new_db_name</td><td>Name of the database to switch to. The function will take ownership of the name (the caller must not free the allocated memory). If the name is NULL, we're going to switch to NULL db. </td></tr>
    <tr><td class="paramname">new_db_access</td><td>Privileges of the new database. (with roles) </td></tr>
    <tr><td class="paramname">new_db_charset</td><td>Character set of the new database. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad241d3ccff14a63839a0855b92ba62a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad241d3ccff14a63839a0855b92ba62a8">&#9670;&nbsp;</a></span>mysql_create_db()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> mysql_create_db </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHA__CREATE__INFO.html">HA_CREATE_INFO</a> *&#160;</td>
          <td class="paramname"><em>create_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread handler </td></tr>
    <tr><td class="paramname">db</td><td>Name of database to create Function assumes that this is already validated. </td></tr>
    <tr><td class="paramname">create_info</td><td>Database create options (like character set)</td></tr>
  </table>
  </dd>
</dl>
<p>SIDE-EFFECTS</p><ol type="1">
<li>Report back to client that command succeeded (my_ok)</li>
<li>Report errors to client</li>
<li>Log event to binary log</li>
</ol>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>ok </td></tr>
    <tr><td class="paramname">true</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aaa15e10fb5945998c442daac30d876fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa15e10fb5945998c442daac30d876fb">&#9670;&nbsp;</a></span>mysql_opt_change_db()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> mysql_opt_change_db </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="lex__string_8h.html#a01c5da2ec635d24c374ba1a995dbe2aa">LEX_CSTRING</a> &amp;&#160;</td>
          <td class="paramname"><em>new_db_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="lex__string_8h.html#a1fb89d4ad1109660fb2b796efdb3933e">LEX_STRING</a> *&#160;</td>
          <td class="paramname"><em>saved_db_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>force_switch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> *&#160;</td>
          <td class="paramname"><em>cur_db_changed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change the current database and its attributes if needed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">thd</td><td>thread handle </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">new_db_name</td><td>database name </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">saved_db_name</td><td>IN: "str" points to a buffer where to store the old database name, "length" contains the buffer size OUT: if the current (default) database is not NULL, its name is copied to the buffer pointed at by "str" and "length" is updated accordingly. Otherwise "str" is set to NULL and "length" is set to 0. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">force_switch</td><td>if the change of the current database shall be forced </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>mysql_change_db() </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">cur_db_changed</td><td>out-flag to indicate whether the current database has been changed (valid only if the function suceeded) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a64edab7d099ea353fb922013a46ad43c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64edab7d099ea353fb922013a46ad43c">&#9670;&nbsp;</a></span>mysql_rm_arc_files()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long mysql_rm_arc_files </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMY__DIR.html">MY_DIR</a> *&#160;</td>
          <td class="paramname"><em>dirp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>org_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a79bcf6faf8dc1d82729f011965dff8bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79bcf6faf8dc1d82729f011965dff8bb">&#9670;&nbsp;</a></span>mysql_rm_db()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> mysql_rm_db </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="lex__string_8h.html#a01c5da2ec635d24c374ba1a995dbe2aa">LEX_CSTRING</a> &amp;&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>if_exists</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Drop all tables, routines and events in a database and the database itself. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread handle </td></tr>
    <tr><td class="paramname">db</td><td>Database name in the case given by user It's already validated and set to lower case (if needed) when we come here </td></tr>
    <tr><td class="paramname">if_exists</td><td>Don't give error if database doesn't exists</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>We do a "best effort" - try to drop as much as possible. If dropping the database itself fails, we try to binlog the drop of the tables we managed to do.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>OK (Database dropped) </td></tr>
    <tr><td class="paramname">true</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3c1ced7ac4a4fcda7b637f143ebd2983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c1ced7ac4a4fcda7b637f143ebd2983">&#9670;&nbsp;</a></span>rm_dir_w_symlink()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> rm_dir_w_symlink </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>org_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>send_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1c6fde70b8562aae147bd83cfc4ca464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c6fde70b8562aae147bd83cfc4ca464">&#9670;&nbsp;</a></span>set_db_default_charset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_db_default_charset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHA__CREATE__INFO.html">HA_CREATE_INFO</a> *&#160;</td>
          <td class="paramname"><em>create_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9de05c62b7f8060195f768fe32a179cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9de05c62b7f8060195f768fe32a179cb">&#9670;&nbsp;</a></span>thread_can_ignore_schema_read_only()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> thread_can_ignore_schema_read_only </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if the thread type is allowed to ignore the schema read only option. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread context.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the thread is allowed to ignore read only, otherwise false. </dd></dl>

</div>
</div>
<a id="a12651302762c33d214b51e96bfc23d35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12651302762c33d214b51e96bfc23d35">&#9670;&nbsp;</a></span>write_db_cmd_to_binlog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> write_db_cmd_to_binlog </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>trx_cache</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Auxiliary function which writes CREATE/ALTER or DROP DATABASE statement to the binary log overriding connection's current database with one being dropped. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a85342a3a9008f594f1835fa6ac83d253"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85342a3a9008f594f1835fa6ac83d253">&#9670;&nbsp;</a></span>del_exts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* del_exts[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {<span class="stringliteral">&quot;.frm&quot;</span>, <span class="stringliteral">&quot;.BAK&quot;</span>, <span class="stringliteral">&quot;.TMD&quot;</span>, <span class="stringliteral">&quot;.opt&quot;</span>,</div><div class="line">                          <span class="stringliteral">&quot;.OLD&quot;</span>, <span class="stringliteral">&quot;.cfg&quot;</span>, <span class="stringliteral">&quot;.SDI&quot;</span>, <a class="code" href="m__string_8h.html#a01a1e214486d9454ca611f01cb1cfc39">NullS</a>}</div><div class="ttc" id="m__string_8h_html_a01a1e214486d9454ca611f01cb1cfc39"><div class="ttname"><a href="m__string_8h.html#a01a1e214486d9454ca611f01cb1cfc39">NullS</a></div><div class="ttdeci">#define NullS</div><div class="ttdoc">Definition of the null string (a null pointer of type char *), used in some of our string handling co...</div><div class="ttdef"><b>Definition:</b> m_string.h:52</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a95397ef912956bf041aa586da73ffdb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95397ef912956bf041aa586da73ffdb7">&#9670;&nbsp;</a></span>deletable_extentions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTYPELIB.html">TYPELIB</a> deletable_extentions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {<a class="code" href="validate__password__imp_8cc.html#a16b6cf0b1e75b701a4a8d303cc4a5abd">array_elements</a>(<a class="code" href="sql__db_8cc.html#a85342a3a9008f594f1835fa6ac83d253">del_exts</a>) - 1, <span class="stringliteral">&quot;del_exts&quot;</span>,</div><div class="line">                                       <a class="code" href="sql__db_8cc.html#a85342a3a9008f594f1835fa6ac83d253">del_exts</a>, <span class="keyword">nullptr</span>}</div><div class="ttc" id="sql__db_8cc_html_a85342a3a9008f594f1835fa6ac83d253"><div class="ttname"><a href="sql__db_8cc.html#a85342a3a9008f594f1835fa6ac83d253">del_exts</a></div><div class="ttdeci">const char * del_exts[]</div><div class="ttdef"><b>Definition:</b> sql_db.cc:107</div></div>
<div class="ttc" id="validate__password__imp_8cc_html_a16b6cf0b1e75b701a4a8d303cc4a5abd"><div class="ttname"><a href="validate__password__imp_8cc.html#a16b6cf0b1e75b701a4a8d303cc4a5abd">array_elements</a></div><div class="ttdeci">#define array_elements(A)</div><div class="ttdef"><b>Definition:</b> validate_password_imp.cc:45</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5bd71961b401a432086d0fb290a87f3f.html">sql</a></li><li class="navelem"><a class="el" href="sql__db_8cc.html">sql_db.cc</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
