<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: sql/auth/sql_user_table.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sql__user__table_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sql_user_table.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="my__loglevel_8h_source.html">my_loglevel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sql__system__table__check_8h_source.html">sql/sql_system_table_check.h</a>&quot;</code><br />
</div>
<p><a href="sql__user__table_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAcl__table__intact.html">Acl_table_intact</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class to validate the flawlessness of ACL table before performing ACL operations.  <a href="classAcl__table__intact.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:af0dca1c283a462ac8f0bd7ff47f59480"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12">ACL_TABLES</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__user__table_8h.html#af0dca1c283a462ac8f0bd7ff47f59480">ACL_TABLES</a></td></tr>
<tr class="memdesc:af0dca1c283a462ac8f0bd7ff47f59480"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enum for ACL tables.  <a href="#af0dca1c283a462ac8f0bd7ff47f59480">More...</a><br /></td></tr>
<tr class="separator:af0dca1c283a462ac8f0bd7ff47f59480"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a2abc44793ab339f38e9f0725bb5fab12"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12">ACL_TABLES</a> { <br />
&#160;&#160;<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a9e29dc97079fb359cb685be2dba3a179">TABLE_USER</a> = 0, 
<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a41c5b5f00b097f48aa81e741e00cff9f">TABLE_DB</a>, 
<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a5543818730b52cc9036fb212341ad7c3">TABLE_TABLES_PRIV</a>, 
<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a46970fdcda796f82414fc9a00fd4bcad">TABLE_COLUMNS_PRIV</a>, 
<br />
&#160;&#160;<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a8db8e3ff0fe7e43cb080b0109e4442a0">TABLE_PROCS_PRIV</a>, 
<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a2224444ca8222bb5e0e62c375bce2cbc">TABLE_PROXIES_PRIV</a>, 
<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a5f579aa69b716faedc2ea18a89d5f885">TABLE_ROLE_EDGES</a>, 
<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a140ff8506d315da1509a943ffd080b7d">TABLE_DEFAULT_ROLES</a>, 
<br />
&#160;&#160;<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a5f50830699a003464450e14fd43ad255">TABLE_DYNAMIC_PRIV</a>, 
<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a06329a86c32b550951af1b11c53a7bc9">TABLE_PASSWORD_HISTORY</a>, 
<a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12a7302bbbc75f87a03fd8bfc693d5fed46">LAST_ENTRY</a>
<br />
 }<tr class="memdesc:a2abc44793ab339f38e9f0725bb5fab12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enum for ACL tables.  <a href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a2abc44793ab339f38e9f0725bb5fab12"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9213551572194a7db21d77453121e4fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sql__user__table_8h.html#a9213551572194a7db21d77453121e4fb">handle_grant_table</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE__LIST.html">TABLE_LIST</a> *tables, <a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12">ACL_TABLES</a> table_no, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> drop, <a class="el" href="structLEX__USER.html">LEX_USER</a> *user_from, <a class="el" href="structLEX__USER.html">LEX_USER</a> *user_to)</td></tr>
<tr class="memdesc:a9213551572194a7db21d77453121e4fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle a privilege table.  <a href="#a9213551572194a7db21d77453121e4fb">More...</a><br /></td></tr>
<tr class="separator:a9213551572194a7db21d77453121e4fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="af0dca1c283a462ac8f0bd7ff47f59480"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0dca1c283a462ac8f0bd7ff47f59480">&#9670;&nbsp;</a></span>ACL_TABLES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12">ACL_TABLES</a>  <a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12">ACL_TABLES</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enum for ACL tables. </p>
<p>Keep in sync with Acl_table_names </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a2abc44793ab339f38e9f0725bb5fab12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2abc44793ab339f38e9f0725bb5fab12">&#9670;&nbsp;</a></span>ACL_TABLES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12">ACL_TABLES</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enum for ACL tables. </p>
<p>Keep in sync with Acl_table_names </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a9e29dc97079fb359cb685be2dba3a179"></a>TABLE_USER&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a41c5b5f00b097f48aa81e741e00cff9f"></a>TABLE_DB&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a5543818730b52cc9036fb212341ad7c3"></a>TABLE_TABLES_PRIV&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a46970fdcda796f82414fc9a00fd4bcad"></a>TABLE_COLUMNS_PRIV&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a8db8e3ff0fe7e43cb080b0109e4442a0"></a>TABLE_PROCS_PRIV&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a2224444ca8222bb5e0e62c375bce2cbc"></a>TABLE_PROXIES_PRIV&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a5f579aa69b716faedc2ea18a89d5f885"></a>TABLE_ROLE_EDGES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a140ff8506d315da1509a943ffd080b7d"></a>TABLE_DEFAULT_ROLES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a5f50830699a003464450e14fd43ad255"></a>TABLE_DYNAMIC_PRIV&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a06329a86c32b550951af1b11c53a7bc9"></a>TABLE_PASSWORD_HISTORY&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a2abc44793ab339f38e9f0725bb5fab12a7302bbbc75f87a03fd8bfc693d5fed46"></a>LAST_ENTRY&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9213551572194a7db21d77453121e4fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9213551572194a7db21d77453121e4fb">&#9670;&nbsp;</a></span>handle_grant_table()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int handle_grant_table </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE__LIST.html">TABLE_LIST</a> *&#160;</td>
          <td class="paramname"><em>tables</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sql__user__table_8h.html#a2abc44793ab339f38e9f0725bb5fab12">ACL_TABLES</a>&#160;</td>
          <td class="paramname"><em>table_no</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>drop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLEX__USER.html">LEX_USER</a> *&#160;</td>
          <td class="paramname"><em>user_from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structLEX__USER.html">LEX_USER</a> *&#160;</td>
          <td class="paramname"><em>user_to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle a privilege table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>The thead handler </td></tr>
    <tr><td class="paramname">tables</td><td>The array with the four open tables. </td></tr>
    <tr><td class="paramname">table_no</td><td>The number of the table to handle (0..4). </td></tr>
    <tr><td class="paramname">drop</td><td>If user_from is to be dropped. </td></tr>
    <tr><td class="paramname">user_from</td><td>The the user to be searched/dropped/renamed. </td></tr>
    <tr><td class="paramname">user_to</td><td>The new name for the user if to be renamed, NULL otherwise.</td></tr>
  </table>
  </dd>
</dl>
<p>Scan through all records in a grant table and apply the requested operation. For the "user" table, a single index access is sufficient, since there is an unique index on (host, user). Delete from grant table if drop is true. Update in grant table if drop is false and user_to is not NULL. Search in grant table if drop is false and user_to is NULL.</p>
<dl class="section return"><dt>Returns</dt><dd>Operation result </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>OK, but no record matched. </td></tr>
    <tr><td class="paramname">&lt;</td><td>0 Error. </td></tr>
    <tr><td class="paramname">&gt;</td><td>0 At least one record matched. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5bd71961b401a432086d0fb290a87f3f.html">sql</a></li><li class="navelem"><a class="el" href="dir_1a808a163d09076bb7843dcdf3f1cd1a.html">auth</a></li><li class="navelem"><a class="el" href="sql__user__table_8h.html">sql_user_table.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
