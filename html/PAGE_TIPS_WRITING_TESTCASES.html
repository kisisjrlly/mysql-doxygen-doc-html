<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Other Tips for Writing Test Cases</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('PAGE_TIPS_WRITING_TESTCASES.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Other Tips for Writing Test Cases </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>
<p class="startli">Writing loops</p>
<p>If you need to do something in a loop, you can use something like this:</p>
<pre class="fragment">let $1= 10;
while ($1)
{
  # execute your statements here
  dec $1;
}</pre> <p class="endli"></p>
</li>
<li>
<p class="startli">Pausing between statements</p>
<p>To sleep between statements, use the <b>sleep</b> command. It supports fractions of a second. For example, <b>sleep 0.2</b>; sleeps 0.2 seconds.</p>
<p>Try not to use the <b>sleep</b> command more than necessary. The more of them there are, the slower the test suite becomes. In some cases, heavy reliance on sleep operations is an indicator that the logic of a test should be reconsidered. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Commenting the test result</p>
<p>When the output in a result file is not understandable by inspection, it can be helpful to have the test case write comments to the result file that provide context. You can use the <b>echo</b> command for this:</p>
<pre class="fragment">--echo # Comment to explain the following output</pre><p>Of course, the same line (without <b><code>--echo</code></b>) will need to be put in the corresponding place in the result file, if you are adding this to an existing test. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Sorting result sets</p>
<p>If a test case depends on <b>SELECT</b> output being in a particular row order, use an <b>ORDER BY</b> clause. Do not assume that rows will be selected in the same order they are inserted, particularly for tests that might be run multiple times under conditions that can change the order, such as with different storage engines, or with and without indexing.</p>
<p>If you do not want to add <b>ORDER BY</b> to the query, an alternative is to use the test command <b>sorted_result</b> which will sort the result of the following statement before putting it into the result file. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Performing file system operations</p>
<p>Avoid using <b>exec</b> or <b>system</b> to execute operating system commands for file system operations. This used to be very common, but OS commands tend to be platform specific, which reduces test portability. <a class="el" href="PAGE_MYSQLTEST.html">mysqltest</a> now has several commands to perform these operations portably, so these commands should be used instead: <b>remove_file</b>, <b>chmod</b>, <b>mkdir</b>, and so forth. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Local versus remote storage</p>
<p>Some test cases depend on being run on local storage, and may fail when run on remote storage such as a network share. For example, if the test result can be affected by differences between local and remote file system times, the expected result might not be obtained. Failure of these test cases under such circumstances does not indicate an actual malfunction. It is not generally possible to determine whether tests are being run on local storage. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Skipping consistency check or forcing restart after test</p>
<p>As mentioned before, a test case should leave the server in a "clean" state for the next test. In cases where this is not possible or too costly, the test may in stead ask for the consistency check to be skipped, and the server(s) to be restarted. This is done by this executing this command at any time during the test:</p>
<pre class="fragment">call mtr.force_restart();</pre><p class="endli">This signals to <a class="el" href="PAGE_MYSQL_TEST_RUN_PL.html">mysql-test-run.pl</a> that it should restart the server before the next test, and also skip the consistency check.  </p>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="PAGE_TESTING_TOOLS.html">Testing Tools</a></li><li class="navelem"><a class="el" href="PAGE_MYSQL_TEST_RUN.html">The MySQL Test Framework</a></li><li class="navelem"><a class="el" href="PAGE_WRITING_TESTCASES.html">Writing Test Cases</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
