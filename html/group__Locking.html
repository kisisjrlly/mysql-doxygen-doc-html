<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Locking</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__Locking.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Locking</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga65cffe586bef8fdfb5334d343c069df6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga65cffe586bef8fdfb5334d343c069df6">GET_LOCK_UNLOCK</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ga65cffe586bef8fdfb5334d343c069df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1bef164e121fc9d85a6e19eae9625365"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga1bef164e121fc9d85a6e19eae9625365">GET_LOCK_STORE_LOCKS</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ga1bef164e121fc9d85a6e19eae9625365"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab05ccbacd3296a75556d7ff52a41b642"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gab05ccbacd3296a75556d7ff52a41b642">get_lock_data</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **table_ptr, size_t <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="mi__test1_8cc.html#a6eec09a91807e20d7b3d6ef3da594067">flags</a>)</td></tr>
<tr class="memdesc:gab05ccbacd3296a75556d7ff52a41b642"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get lock structures from table structs and initialize locks.  <a href="#gab05ccbacd3296a75556d7ff52a41b642">More...</a><br /></td></tr>
<tr class="separator:gab05ccbacd3296a75556d7ff52a41b642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadeee13e85dfc0f473985f24f862c633f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gadeee13e85dfc0f473985f24f862c633f">lock_external</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **table, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>)</td></tr>
<tr class="separator:gadeee13e85dfc0f473985f24f862c633f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2022104b54fa744b1e6276b24c76eb74"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga2022104b54fa744b1e6276b24c76eb74">unlock_external</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **table, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>)</td></tr>
<tr class="memdesc:ga2022104b54fa744b1e6276b24c76eb74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock a set of external.  <a href="#ga2022104b54fa744b1e6276b24c76eb74">More...</a><br /></td></tr>
<tr class="separator:ga2022104b54fa744b1e6276b24c76eb74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6d04e38cbcf6f9f05f18134f7abfc81"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gaa6d04e38cbcf6f9f05f18134f7abfc81">print_lock_error</a> (int error, const char *)</td></tr>
<tr class="separator:gaa6d04e38cbcf6f9f05f18134f7abfc81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae733785070441f315fc2b7d071a2545e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gae733785070441f315fc2b7d071a2545e">lock_tables_check</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **tables, size_t <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="mi__test1_8cc.html#a6eec09a91807e20d7b3d6ef3da594067">flags</a>)</td></tr>
<tr class="memdesc:gae733785070441f315fc2b7d071a2545e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform semantic checks for mysql_lock_tables.  <a href="#gae733785070441f315fc2b7d071a2545e">More...</a><br /></td></tr>
<tr class="separator:gae733785070441f315fc2b7d071a2545e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3cdefe9db62025f107be509007ba15d1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga3cdefe9db62025f107be509007ba15d1">reset_lock_data</a> (<a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *sql_lock)</td></tr>
<tr class="memdesc:ga3cdefe9db62025f107be509007ba15d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset lock type in lock data.  <a href="#ga3cdefe9db62025f107be509007ba15d1">More...</a><br /></td></tr>
<tr class="separator:ga3cdefe9db62025f107be509007ba15d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga809f844742e6e1c59e194939ec1170ca"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga809f844742e6e1c59e194939ec1170ca">track_table_access</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **tables, size_t <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>)</td></tr>
<tr class="memdesc:ga809f844742e6e1c59e194939ec1170ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scan array of tables for access types; update transaction tracker accordingly.  <a href="#ga809f844742e6e1c59e194939ec1170ca">More...</a><br /></td></tr>
<tr class="separator:ga809f844742e6e1c59e194939ec1170ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9085310cb26b5f8574f517a7373f4740"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga9085310cb26b5f8574f517a7373f4740">reset_lock_data_and_free</a> (<a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> **mysql_lock)</td></tr>
<tr class="memdesc:ga9085310cb26b5f8574f517a7373f4740"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset lock type in lock data and free.  <a href="#ga9085310cb26b5f8574f517a7373f4740">More...</a><br /></td></tr>
<tr class="separator:ga9085310cb26b5f8574f517a7373f4740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga40d9de997ac2ee4f94f358ce1ac2d76a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga40d9de997ac2ee4f94f358ce1ac2d76a">mysql_lock_tables</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **tables, size_t <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="mi__test1_8cc.html#a6eec09a91807e20d7b3d6ef3da594067">flags</a>)</td></tr>
<tr class="memdesc:ga40d9de997ac2ee4f94f358ce1ac2d76a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock tables.  <a href="#ga40d9de997ac2ee4f94f358ce1ac2d76a">More...</a><br /></td></tr>
<tr class="separator:ga40d9de997ac2ee4f94f358ce1ac2d76a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2bff80304c9d27f634976ac8fe60cd38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga2bff80304c9d27f634976ac8fe60cd38">mysql_unlock_tables</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *sql_lock)</td></tr>
<tr class="separator:ga2bff80304c9d27f634976ac8fe60cd38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafad092ec9a399db99abd75b57a9ee679"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gafad092ec9a399db99abd75b57a9ee679">mysql_unlock_some_tables</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> **table, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="el" href="myisam__ftdump_8cc.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>)</td></tr>
<tr class="memdesc:gafad092ec9a399db99abd75b57a9ee679"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock some of the tables locked by mysql_lock_tables.  <a href="#gafad092ec9a399db99abd75b57a9ee679">More...</a><br /></td></tr>
<tr class="separator:gafad092ec9a399db99abd75b57a9ee679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e24a131cbe030c49d953669f804877d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga1e24a131cbe030c49d953669f804877d">mysql_unlock_read_tables</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *sql_lock)</td></tr>
<tr class="memdesc:ga1e24a131cbe030c49d953669f804877d"><td class="mdescLeft">&#160;</td><td class="mdescRight">unlock all tables locked for read.  <a href="#ga1e24a131cbe030c49d953669f804877d">More...</a><br /></td></tr>
<tr class="separator:ga1e24a131cbe030c49d953669f804877d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad40fe56766e1b54e2fed60814aec1e58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gad40fe56766e1b54e2fed60814aec1e58">mysql_lock_remove</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *locked, <a class="el" href="structTABLE.html">TABLE</a> *table)</td></tr>
<tr class="memdesc:gad40fe56766e1b54e2fed60814aec1e58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to find the table in the list of locked tables.  <a href="#gad40fe56766e1b54e2fed60814aec1e58">More...</a><br /></td></tr>
<tr class="separator:gad40fe56766e1b54e2fed60814aec1e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2320fa808c9d6523790e796d57e2331"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gad2320fa808c9d6523790e796d57e2331">mysql_lock_abort_for_thread</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structTABLE.html">TABLE</a> *table)</td></tr>
<tr class="memdesc:gad2320fa808c9d6523790e796d57e2331"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort one thread / table combination.  <a href="#gad2320fa808c9d6523790e796d57e2331">More...</a><br /></td></tr>
<tr class="separator:gad2320fa808c9d6523790e796d57e2331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae8e0ecd1f7872040079f5319aacd93a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gae8e0ecd1f7872040079f5319aacd93a2">mysql_lock_merge</a> (<a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *a, <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *b)</td></tr>
<tr class="separator:gae8e0ecd1f7872040079f5319aacd93a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac67865dd0ef1b003fdee2182aba9a049"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gac67865dd0ef1b003fdee2182aba9a049">lock_schema_name</a> (<a class="el" href="classTHD.html">THD</a> *thd, const char *db)</td></tr>
<tr class="memdesc:gac67865dd0ef1b003fdee2182aba9a049"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain an exclusive metadata lock on a schema name.  <a href="#gac67865dd0ef1b003fdee2182aba9a049">More...</a><br /></td></tr>
<tr class="separator:gac67865dd0ef1b003fdee2182aba9a049"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga377fe3850ef2fce0988a3cffb9128159"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga377fe3850ef2fce0988a3cffb9128159">lock_tablespace_names</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="lock_8h.html#ae495da91bce6f4bb749636280f38aba4">Tablespace_hash_set</a> *tablespace_set, <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> lock_wait_timeout)</td></tr>
<tr class="memdesc:ga377fe3850ef2fce0988a3cffb9128159"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acquire IX MDL lock each tablespace name from the given set.  <a href="#ga377fe3850ef2fce0988a3cffb9128159">More...</a><br /></td></tr>
<tr class="separator:ga377fe3850ef2fce0988a3cffb9128159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab03d9cc9ff9682e9f2a961685fd90cb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gab03d9cc9ff9682e9f2a961685fd90cb3">lock_object_name</a> (<a class="el" href="classTHD.html">THD</a> *thd, <a class="el" href="structMDL__key.html#a391ec4bd98fec6852a48f7856546ed3b">MDL_key::enum_mdl_namespace</a> mdl_type, const char *db, const char *<a class="el" href="persisted__variable_8cc.html#a02b8247840db27f85191d734d51598fa">name</a>)</td></tr>
<tr class="memdesc:gab03d9cc9ff9682e9f2a961685fd90cb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain an exclusive metadata lock on an object name.  <a href="#gab03d9cc9ff9682e9f2a961685fd90cb3">More...</a><br /></td></tr>
<tr class="separator:gab03d9cc9ff9682e9f2a961685fd90cb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82691cb3b460e6ded2d667eb8669f3e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga82691cb3b460e6ded2d667eb8669f3e4">acquire_shared_global_read_lock</a> (<a class="el" href="classTHD.html">THD</a> *thd, unsigned long lock_wait_timeout)</td></tr>
<tr class="memdesc:ga82691cb3b460e6ded2d667eb8669f3e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acquire protection against the global read lock.  <a href="#ga82691cb3b460e6ded2d667eb8669f3e4">More...</a><br /></td></tr>
<tr class="separator:ga82691cb3b460e6ded2d667eb8669f3e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7309e02862d35f0545a7ae3156208a37"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga7309e02862d35f0545a7ae3156208a37">Global_read_lock::lock_global_read_lock</a> (<a class="el" href="classTHD.html">THD</a> *thd)</td></tr>
<tr class="memdesc:ga7309e02862d35f0545a7ae3156208a37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take global read lock, wait if there is protection against lock.  <a href="#ga7309e02862d35f0545a7ae3156208a37">More...</a><br /></td></tr>
<tr class="separator:ga7309e02862d35f0545a7ae3156208a37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1794157685563fd81fb3a928dc9b4fbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga1794157685563fd81fb3a928dc9b4fbf">Global_read_lock::unlock_global_read_lock</a> (<a class="el" href="classTHD.html">THD</a> *thd)</td></tr>
<tr class="memdesc:ga1794157685563fd81fb3a928dc9b4fbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock global read lock.  <a href="#ga1794157685563fd81fb3a928dc9b4fbf">More...</a><br /></td></tr>
<tr class="separator:ga1794157685563fd81fb3a928dc9b4fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7ce9a72cd7dec6571f9f55f0c2ead88b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga7ce9a72cd7dec6571f9f55f0c2ead88b">Global_read_lock::make_global_read_lock_block_commit</a> (<a class="el" href="classTHD.html">THD</a> *thd)</td></tr>
<tr class="memdesc:ga7ce9a72cd7dec6571f9f55f0c2ead88b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make global read lock also block commits.  <a href="#ga7ce9a72cd7dec6571f9f55f0c2ead88b">More...</a><br /></td></tr>
<tr class="separator:ga7ce9a72cd7dec6571f9f55f0c2ead88b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae0ecdfcc6d8001f5a601d067de6f6982"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#gae0ecdfcc6d8001f5a601d067de6f6982">Global_read_lock::set_explicit_lock_duration</a> (<a class="el" href="classTHD.html">THD</a> *thd)</td></tr>
<tr class="memdesc:gae0ecdfcc6d8001f5a601d067de6f6982"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set explicit duration for metadata locks which are used to implement GRL.  <a href="#gae0ecdfcc6d8001f5a601d067de6f6982">More...</a><br /></td></tr>
<tr class="separator:gae0ecdfcc6d8001f5a601d067de6f6982"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga9ec7eb7dbcce8449c3a6df36c3945b08"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga9ec7eb7dbcce8449c3a6df36c3945b08">thr_lock_errno_to_mysql</a> []</td></tr>
<tr class="separator:ga9ec7eb7dbcce8449c3a6df36c3945b08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga94fe72a2ec087e3457aafd2a1911dc60"><td class="memItemLeft" align="right" valign="top">static std::atomic&lt; <a class="el" href="my__inttypes_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Locking.html#ga94fe72a2ec087e3457aafd2a1911dc60">Global_read_lock::m_atomic_active_requests</a></td></tr>
<tr class="separator:ga94fe72a2ec087e3457aafd2a1911dc60"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga1bef164e121fc9d85a6e19eae9625365"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1bef164e121fc9d85a6e19eae9625365">&#9670;&nbsp;</a></span>GET_LOCK_STORE_LOCKS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_LOCK_STORE_LOCKS&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ga65cffe586bef8fdfb5334d343c069df6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga65cffe586bef8fdfb5334d343c069df6">&#9670;&nbsp;</a></span>GET_LOCK_UNLOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_LOCK_UNLOCK&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga82691cb3b460e6ded2d667eb8669f3e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga82691cb3b460e6ded2d667eb8669f3e4">&#9670;&nbsp;</a></span>acquire_shared_global_read_lock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> acquire_shared_global_read_lock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>lock_wait_timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Acquire protection against the global read lock. </p>
<p>Acquire an intention exclusive lock to protect against others setting the global read lock. We follow the naming used by the backup lock help functions when naming this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread context. </td></tr>
    <tr><td class="paramname">lock_wait_timeout</td><td>Time to wait for lock acquisition.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>No error, meta data lock acquired. </td></tr>
    <tr><td class="paramname">true</td><td>Error, meta data lock not acquired. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab05ccbacd3296a75556d7ff52a41b642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab05ccbacd3296a75556d7ff52a41b642">&#9670;&nbsp;</a></span>get_lock_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> * get_lock_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> **&#160;</td>
          <td class="paramname"><em>table_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get lock structures from table structs and initialize locks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread handler </td></tr>
    <tr><td class="paramname">table_ptr</td><td>Pointer to tables that should be locks </td></tr>
    <tr><td class="paramname">count</td><td>Number of tables </td></tr>
    <tr><td class="paramname">flags</td><td>One of:<ul>
<li>GET_LOCK_UNLOCK : If we should send TL_IGNORE to store lock</li>
<li>GET_LOCK_STORE_LOCKS : Store lock info in TABLE </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gadeee13e85dfc0f473985f24f862c633f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadeee13e85dfc0f473985f24f862c633f">&#9670;&nbsp;</a></span>lock_external()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lock_external </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> **&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ga7309e02862d35f0545a7ae3156208a37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7309e02862d35f0545a7ae3156208a37">&#9670;&nbsp;</a></span>lock_global_read_lock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Global_read_lock::lock_global_read_lock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take global read lock, wait if there is protection against lock. </p>
<p>If the global read lock is already taken by this thread, then nothing is done.</p>
<p>See also "Handling of global read locks" above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Reference to thread.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">False</td><td>Success, global read lock set, commits are NOT blocked. </td></tr>
    <tr><td class="paramname">True</td><td>Failure, thread was killed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab03d9cc9ff9682e9f2a961685fd90cb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab03d9cc9ff9682e9f2a961685fd90cb3">&#9670;&nbsp;</a></span>lock_object_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> lock_object_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMDL__key.html#a391ec4bd98fec6852a48f7856546ed3b">MDL_key::enum_mdl_namespace</a>&#160;</td>
          <td class="paramname"><em>mdl_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtain an exclusive metadata lock on an object name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread handle. </td></tr>
    <tr><td class="paramname">mdl_type</td><td>Object type (currently functions, procedures and events can be name-locked). </td></tr>
    <tr><td class="paramname">db</td><td>The schema the object belongs to. </td></tr>
    <tr><td class="paramname">name</td><td>Object name in the schema.</td></tr>
  </table>
  </dd>
</dl>
<p>This function cannot be called while holding LOCK_open_mutex. This invariant is enforced by asserts in MDL_context::acquire_locks. To avoid deadlocks, we do not try to obtain exclusive metadata locks in LOCK TABLES mode, since in this mode there may be other metadata locks already taken by the current connection, and we must not wait for MDL locks while holding locks.</p>
<dl class="section note"><dt>Note</dt><dd>name is converted to lowercase before the lock is acquired since stored routine and event names are case insensitive.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>Success. </td></tr>
    <tr><td class="paramname">true</td><td>Failure: we're in LOCK TABLES mode, or out of memory, or this connection was killed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gac67865dd0ef1b003fdee2182aba9a049"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac67865dd0ef1b003fdee2182aba9a049">&#9670;&nbsp;</a></span>lock_schema_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> lock_schema_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>db</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtain an exclusive metadata lock on a schema name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread handle. </td></tr>
    <tr><td class="paramname">db</td><td>The database name.</td></tr>
  </table>
  </dd>
</dl>
<p>This function cannot be called while holding LOCK_open mutex. To avoid deadlocks, we do not try to obtain exclusive metadata locks in LOCK TABLES mode, since in this mode there may be other metadata locks already taken by the current connection, and we must not wait for MDL locks while holding locks.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>Success. </td></tr>
    <tr><td class="paramname">true</td><td>Failure: we're in LOCK TABLES mode, or out of memory, or this connection was killed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae733785070441f315fc2b7d071a2545e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae733785070441f315fc2b7d071a2545e">&#9670;&nbsp;</a></span>lock_tables_check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lock_tables_check </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> **&#160;</td>
          <td class="paramname"><em>tables</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform semantic checks for mysql_lock_tables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>The current thread </td></tr>
    <tr><td class="paramname">tables</td><td>The tables to lock </td></tr>
    <tr><td class="paramname">count</td><td>The number of tables to lock </td></tr>
    <tr><td class="paramname">flags</td><td>Lock flags </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if all the check passed, non zero if a check failed. </dd></dl>

</div>
</div>
<a id="ga377fe3850ef2fce0988a3cffb9128159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga377fe3850ef2fce0988a3cffb9128159">&#9670;&nbsp;</a></span>lock_tablespace_names()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> lock_tablespace_names </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="lock_8h.html#ae495da91bce6f4bb749636280f38aba4">Tablespace_hash_set</a> *&#160;</td>
          <td class="paramname"><em>tablespace_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>lock_wait_timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Acquire IX MDL lock each tablespace name from the given set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>- Thread invoking this function. </td></tr>
    <tr><td class="paramname">tablespace_set</td><td>- Set of tablespace names to be lock. </td></tr>
    <tr><td class="paramname">lock_wait_timeout</td><td>- Lock timeout.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true - On failure </dd>
<dd>
false - On Success. </dd></dl>

</div>
</div>
<a id="ga7ce9a72cd7dec6571f9f55f0c2ead88b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7ce9a72cd7dec6571f9f55f0c2ead88b">&#9670;&nbsp;</a></span>make_global_read_lock_block_commit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> Global_read_lock::make_global_read_lock_block_commit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make global read lock also block commits. </p>
<p>The scenario is:</p><ul>
<li>This thread has the global read lock.</li>
<li>Global read lock blocking of commits is not set.</li>
</ul>
<p>See also "Handling of global read locks" above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Reference to thread.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">False</td><td>Success, global read lock set, commits are blocked. </td></tr>
    <tr><td class="paramname">True</td><td>Failure, thread was killed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad2320fa808c9d6523790e796d57e2331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad2320fa808c9d6523790e796d57e2331">&#9670;&nbsp;</a></span>mysql_lock_abort_for_thread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mysql_lock_abort_for_thread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> *&#160;</td>
          <td class="paramname"><em>table</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort one thread / table combination. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread handler </td></tr>
    <tr><td class="paramname">table</td><td>Table that should be removed from lock queue </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae8e0ecd1f7872040079f5319aacd93a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae8e0ecd1f7872040079f5319aacd93a2">&#9670;&nbsp;</a></span>mysql_lock_merge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a>* mysql_lock_merge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="gad40fe56766e1b54e2fed60814aec1e58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad40fe56766e1b54e2fed60814aec1e58">&#9670;&nbsp;</a></span>mysql_lock_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mysql_lock_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td>
          <td class="paramname"><em>locked</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> *&#160;</td>
          <td class="paramname"><em>table</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to find the table in the list of locked tables. </p>
<p>In case of success, unlock the table and remove it from this list. If a table has more than one lock instance, removes them all.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>thread context </td></tr>
    <tr><td class="paramname">locked</td><td>list of locked tables </td></tr>
    <tr><td class="paramname">table</td><td>the table to unlock </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga40d9de997ac2ee4f94f358ce1ac2d76a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga40d9de997ac2ee4f94f358ce1ac2d76a">&#9670;&nbsp;</a></span>mysql_lock_tables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a>* mysql_lock_tables </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> **&#160;</td>
          <td class="paramname"><em>tables</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lock tables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>The current thread. </td></tr>
    <tr><td class="paramname">tables</td><td>An array of pointers to the tables to lock. </td></tr>
    <tr><td class="paramname">count</td><td>The number of tables to lock. </td></tr>
    <tr><td class="paramname">flags</td><td>Options: MYSQL_LOCK_IGNORE_GLOBAL_READ_ONLY Ignore SET GLOBAL READ_ONLY MYSQL_LOCK_IGNORE_TIMEOUT Use maximum timeout value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">A</td><td>lock structure pointer on success. </td></tr>
    <tr><td class="paramname">NULL</td><td>if an error or if wait on a lock was killed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1e24a131cbe030c49d953669f804877d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e24a131cbe030c49d953669f804877d">&#9670;&nbsp;</a></span>mysql_unlock_read_tables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mysql_unlock_read_tables </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td>
          <td class="paramname"><em>sql_lock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>unlock all tables locked for read. </p>

</div>
</div>
<a id="gafad092ec9a399db99abd75b57a9ee679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafad092ec9a399db99abd75b57a9ee679">&#9670;&nbsp;</a></span>mysql_unlock_some_tables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mysql_unlock_some_tables </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> **&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unlock some of the tables locked by mysql_lock_tables. </p>
<p>This will work even if get_lock_data fails (next unlock will free all) </p>

</div>
</div>
<a id="ga2bff80304c9d27f634976ac8fe60cd38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2bff80304c9d27f634976ac8fe60cd38">&#9670;&nbsp;</a></span>mysql_unlock_tables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mysql_unlock_tables </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td>
          <td class="paramname"><em>sql_lock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="gaa6d04e38cbcf6f9f05f18134f7abfc81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa6d04e38cbcf6f9f05f18134f7abfc81">&#9670;&nbsp;</a></span>print_lock_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void print_lock_error </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>table</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ga3cdefe9db62025f107be509007ba15d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3cdefe9db62025f107be509007ba15d1">&#9670;&nbsp;</a></span>reset_lock_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void reset_lock_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> *&#160;</td>
          <td class="paramname"><em>sql_lock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset lock type in lock data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sql_lock</td><td>Lock structures to reset.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>After a locking error we want to quit the locking of the table(s). The test case in the bug report for Bug #18544 has the following cases: 1. Locking error in lock_external() due to InnoDB timeout.<ol type="1">
<li>Locking error in get_lock_data() due to missing write permission.</li>
<li>Locking error in wait_if_global_read_lock() due to lock conflict.</li>
</ol>
</dd>
<dd>
In all these cases we have already set the lock type into the lock data of the open table(s). If the table(s) are in the open table cache, they could be reused with the non-zero lock type set. This could lead to ignoring a different lock type with the next lock.</dd>
<dd>
Clear the lock type of all lock data. This ensures that the next lock request will set its lock type properly. </dd></dl>

</div>
</div>
<a id="ga9085310cb26b5f8574f517a7373f4740"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9085310cb26b5f8574f517a7373f4740">&#9670;&nbsp;</a></span>reset_lock_data_and_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void reset_lock_data_and_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMYSQL__LOCK.html">MYSQL_LOCK</a> **&#160;</td>
          <td class="paramname"><em>mysql_lock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset lock type in lock data and free. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mysql_lock</td><td>Lock structures to reset. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae0ecdfcc6d8001f5a601d067de6f6982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae0ecdfcc6d8001f5a601d067de6f6982">&#9670;&nbsp;</a></span>set_explicit_lock_duration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Global_read_lock::set_explicit_lock_duration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set explicit duration for metadata locks which are used to implement GRL. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Reference to thread. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga809f844742e6e1c59e194939ec1170ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga809f844742e6e1c59e194939ec1170ca">&#9670;&nbsp;</a></span>track_table_access()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void track_table_access </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> **&#160;</td>
          <td class="paramname"><em>tables</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Scan array of tables for access types; update transaction tracker accordingly. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>The current thread. </td></tr>
    <tr><td class="paramname">tables</td><td>An array of pointers to the tables to lock. </td></tr>
    <tr><td class="paramname">count</td><td>The number of tables to lock. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga2022104b54fa744b1e6276b24c76eb74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2022104b54fa744b1e6276b24c76eb74">&#9670;&nbsp;</a></span>unlock_external()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unlock_external </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> **&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unlock a set of external. </p>

</div>
</div>
<a id="ga1794157685563fd81fb3a928dc9b4fbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1794157685563fd81fb3a928dc9b4fbf">&#9670;&nbsp;</a></span>unlock_global_read_lock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Global_read_lock::unlock_global_read_lock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTHD.html">THD</a> *&#160;</td>
          <td class="paramname"><em>thd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unlock global read lock. </p>
<p>Commits may or may not be blocked when this function is called.</p>
<p>See also "Handling of global read locks" above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Reference to thread. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ga94fe72a2ec087e3457aafd2a1911dc60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga94fe72a2ec087e3457aafd2a1911dc60">&#9670;&nbsp;</a></span>m_atomic_active_requests</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt; <a class="el" href="my__inttypes_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; Global_read_lock::m_atomic_active_requests</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ga9ec7eb7dbcce8449c3a6df36c3945b08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ec7eb7dbcce8449c3a6df36c3945b08">&#9670;&nbsp;</a></span>thr_lock_errno_to_mysql</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int thr_lock_errno_to_mysql[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {0, ER_LOCK_ABORTED,</div><div class="line">                                        ER_LOCK_WAIT_TIMEOUT, ER_LOCK_DEADLOCK}</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
