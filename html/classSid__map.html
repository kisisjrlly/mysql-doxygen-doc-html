<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Sid_map Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classSid__map.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSid__map-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Sid_map Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Represents a bidirectional map between SID and SIDNO.  
 <a href="classSid__map.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rpl__gtid_8h_source.html">rpl_gtid.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSid__map_1_1Node.html">Node</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Node pointed to by both the hash and the array.  <a href="structSid__map_1_1Node.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adcb420a3241258cc68ab42910133144d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#adcb420a3241258cc68ab42910133144d">Sid_map</a> (<a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *<a class="el" href="classSid__map.html#a0dd02514995333a3887ba4a93492a885">sid_lock</a>)</td></tr>
<tr class="memdesc:adcb420a3241258cc68ab42910133144d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create this Sid_map.  <a href="#adcb420a3241258cc68ab42910133144d">More...</a><br /></td></tr>
<tr class="separator:adcb420a3241258cc68ab42910133144d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02ebe48caba52d2bccd668088c25a8e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a02ebe48caba52d2bccd668088c25a8e8">~Sid_map</a> ()</td></tr>
<tr class="memdesc:a02ebe48caba52d2bccd668088c25a8e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy this Sid_map.  <a href="#a02ebe48caba52d2bccd668088c25a8e8">More...</a><br /></td></tr>
<tr class="separator:a02ebe48caba52d2bccd668088c25a8e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae1a2e63f72f82b16aad9d86ace04676"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rpl__gtid_8h.html#a3cf0e1a495b2402d8e6aa88f870316d5">enum_return_status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#aae1a2e63f72f82b16aad9d86ace04676">clear</a> ()</td></tr>
<tr class="memdesc:aae1a2e63f72f82b16aad9d86ace04676"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears this Sid_map (for RESET SLAVE)  <a href="#aae1a2e63f72f82b16aad9d86ace04676">More...</a><br /></td></tr>
<tr class="separator:aae1a2e63f72f82b16aad9d86ace04676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23aa9c0f385a44772e9e5c3955cca0cf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a23aa9c0f385a44772e9e5c3955cca0cf">add_sid</a> (const <a class="el" href="rpl__gtid_8h.html#ada65b12e73ca5b310f33aea1537852e6">rpl_sid</a> &amp;sid)</td></tr>
<tr class="memdesc:a23aa9c0f385a44772e9e5c3955cca0cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the given SID to this map if it does not already exist.  <a href="#a23aa9c0f385a44772e9e5c3955cca0cf">More...</a><br /></td></tr>
<tr class="separator:a23aa9c0f385a44772e9e5c3955cca0cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1667fd040c720d4ab8c35871f63926f4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a1667fd040c720d4ab8c35871f63926f4">sid_to_sidno</a> (const <a class="el" href="rpl__gtid_8h.html#ada65b12e73ca5b310f33aea1537852e6">rpl_sid</a> &amp;sid) const</td></tr>
<tr class="memdesc:a1667fd040c720d4ab8c35871f63926f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the SIDNO for a given SID.  <a href="#a1667fd040c720d4ab8c35871f63926f4">More...</a><br /></td></tr>
<tr class="separator:a1667fd040c720d4ab8c35871f63926f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9a138fb42883743ec9548a6e65a56f8"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="rpl__gtid_8h.html#ada65b12e73ca5b310f33aea1537852e6">rpl_sid</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#ae9a138fb42883743ec9548a6e65a56f8">sidno_to_sid</a> (<a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a> sidno, <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> need_lock=<a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#a65e9886d74aaee76545e83dd09011727">false</a>) const</td></tr>
<tr class="memdesc:ae9a138fb42883743ec9548a6e65a56f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the SID for a given SIDNO.  <a href="#ae9a138fb42883743ec9548a6e65a56f8">More...</a><br /></td></tr>
<tr class="separator:ae9a138fb42883743ec9548a6e65a56f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a136025a5e9fb2ea21eb4da9d44060fce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a136025a5e9fb2ea21eb4da9d44060fce">get_sorted_sidno</a> (<a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a> <a class="el" href="xcom__base_8cc.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) const</td></tr>
<tr class="memdesc:a136025a5e9fb2ea21eb4da9d44060fce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the n'th smallest sidno, in the order of the SID's UUID.  <a href="#a136025a5e9fb2ea21eb4da9d44060fce">More...</a><br /></td></tr>
<tr class="separator:a136025a5e9fb2ea21eb4da9d44060fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e1dbe6bf6fbaf1d6c3199cd407a620c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a4e1dbe6bf6fbaf1d6c3199cd407a620c">get_max_sidno</a> () const</td></tr>
<tr class="memdesc:a4e1dbe6bf6fbaf1d6c3199cd407a620c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the biggest sidno in this Sid_map.  <a href="#a4e1dbe6bf6fbaf1d6c3199cd407a620c">More...</a><br /></td></tr>
<tr class="separator:a4e1dbe6bf6fbaf1d6c3199cd407a620c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a930508aff1669dabea328064ada55"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#ae8a930508aff1669dabea328064ada55">get_sid_lock</a> () const</td></tr>
<tr class="memdesc:ae8a930508aff1669dabea328064ada55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the sid_lock.  <a href="#ae8a930508aff1669dabea328064ada55">More...</a><br /></td></tr>
<tr class="separator:ae8a930508aff1669dabea328064ada55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa02acc6896576b6a7f54fb55c1e359cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rpl__gtid_8h.html#a3cf0e1a495b2402d8e6aa88f870316d5">enum_return_status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#aa02acc6896576b6a7f54fb55c1e359cd">copy</a> (<a class="el" href="classSid__map.html">Sid_map</a> *dest)</td></tr>
<tr class="memdesc:aa02acc6896576b6a7f54fb55c1e359cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deep copy this Sid_map to dest.  <a href="#aa02acc6896576b6a7f54fb55c1e359cd">More...</a><br /></td></tr>
<tr class="separator:aa02acc6896576b6a7f54fb55c1e359cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a36a4e53afd262e046a287bd1717b8035"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rpl__gtid_8h.html#a3cf0e1a495b2402d8e6aa88f870316d5">enum_return_status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a36a4e53afd262e046a287bd1717b8035">add_node</a> (<a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a> sidno, const <a class="el" href="rpl__gtid_8h.html#ada65b12e73ca5b310f33aea1537852e6">rpl_sid</a> &amp;sid)</td></tr>
<tr class="memdesc:a36a4e53afd262e046a287bd1717b8035"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a Node from the given SIDNO and SID and add it to _sidno_to_sid, _sid_to_sidno, and _sorted.  <a href="#a36a4e53afd262e046a287bd1717b8035">More...</a><br /></td></tr>
<tr class="separator:a36a4e53afd262e046a287bd1717b8035"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:aa2c5af40baa34b4f4d1da980951711fd"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#aa2c5af40baa34b4f4d1da980951711fd">sid_map_get_key</a> (const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *ptr, size_t *length)</td></tr>
<tr class="separator:aa2c5af40baa34b4f4d1da980951711fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0dd02514995333a3887ba4a93492a885"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a0dd02514995333a3887ba4a93492a885">sid_lock</a></td></tr>
<tr class="memdesc:a0dd02514995333a3887ba4a93492a885"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read-write lock that protects updates to the number of SIDNOs.  <a href="#a0dd02514995333a3887ba4a93492a885">More...</a><br /></td></tr>
<tr class="separator:a0dd02514995333a3887ba4a93492a885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a613bafd04a309721fdd3f73d80883087"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPrealloced__array.html">Prealloced_array</a>&lt; <a class="el" href="structSid__map_1_1Node.html">Node</a> *, 8 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a613bafd04a309721fdd3f73d80883087">_sidno_to_sid</a></td></tr>
<tr class="memdesc:a613bafd04a309721fdd3f73d80883087"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array that maps SIDNO to SID; the element at index N points to a Node with SIDNO N-1.  <a href="#a613bafd04a309721fdd3f73d80883087">More...</a><br /></td></tr>
<tr class="separator:a613bafd04a309721fdd3f73d80883087"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07ed1599ba0f72a48373049779a2cd1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmalloc__unordered__map.html">malloc_unordered_map</a>&lt; <a class="el" href="rpl__gtid_8h.html#ada65b12e73ca5b310f33aea1537852e6">rpl_sid</a>, <a class="el" href="map__helpers_8h.html#ab9bfec3d68fe066cd76cd78c5039d012">unique_ptr_my_free</a>&lt; <a class="el" href="structSid__map_1_1Node.html">Node</a> &gt;, <a class="el" href="structbinary__log_1_1Hash__Uuid.html">binary_log::Hash_Uuid</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a07ed1599ba0f72a48373049779a2cd1e">_sid_to_sidno</a> {<a class="el" href="rpl__gtid__sid__map_8cc.html#a6e13f84ff6d0380ce41e8e69fdda9fbb">key_memory_Sid_map_Node</a>}</td></tr>
<tr class="memdesc:a07ed1599ba0f72a48373049779a2cd1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hash that maps SID to SIDNO.  <a href="#a07ed1599ba0f72a48373049779a2cd1e">More...</a><br /></td></tr>
<tr class="separator:a07ed1599ba0f72a48373049779a2cd1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8390d6f6dddffb8cc7b1adcf7cea6045"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPrealloced__array.html">Prealloced_array</a>&lt; <a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a>, 8 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a8390d6f6dddffb8cc7b1adcf7cea6045">_sorted</a></td></tr>
<tr class="memdesc:a8390d6f6dddffb8cc7b1adcf7cea6045"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array that maps numbers in the interval [0, get_max_sidno()-1] to SIDNOs, in order of increasing SID.  <a href="#a8390d6f6dddffb8cc7b1adcf7cea6045">More...</a><br /></td></tr>
<tr class="separator:a8390d6f6dddffb8cc7b1adcf7cea6045"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Represents a bidirectional map between SID and SIDNO. </p>
<p>SIDNOs are always numbers greater or equal to 1.</p>
<p>This data structure OPTIONALLY knows of a read-write lock that protects the number of SIDNOs. The lock is provided by the invoker of the constructor and it is generally the caller's responsibility to acquire the read lock. If the lock is not NULL, access methods assert that the caller already holds the read (or write) lock. If the lock is not NULL and a method of this class grows the number of SIDNOs, then the method temporarily upgrades this lock to a write lock and then degrades it to a read lock again; there will be a short period when the lock is not held at all. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adcb420a3241258cc68ab42910133144d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcb420a3241258cc68ab42910133144d">&#9670;&nbsp;</a></span>Sid_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sid_map::Sid_map </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *&#160;</td>
          <td class="paramname"><em>sid_lock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create this Sid_map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sid_lock</td><td>Read-write lock that protects updates to the number of SIDNOs. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a02ebe48caba52d2bccd668088c25a8e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02ebe48caba52d2bccd668088c25a8e8">&#9670;&nbsp;</a></span>~Sid_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sid_map::~Sid_map </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy this Sid_map. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a36a4e53afd262e046a287bd1717b8035"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36a4e53afd262e046a287bd1717b8035">&#9670;&nbsp;</a></span>add_node()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpl__gtid_8h.html#a3cf0e1a495b2402d8e6aa88f870316d5">enum_return_status</a> Sid_map::add_node </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a>&#160;</td>
          <td class="paramname"><em>sidno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="rpl__gtid_8h.html#ada65b12e73ca5b310f33aea1537852e6">rpl_sid</a> &amp;&#160;</td>
          <td class="paramname"><em>sid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a Node from the given SIDNO and SID and add it to _sidno_to_sid, _sid_to_sidno, and _sorted. </p>
<p>The caller must hold the write lock on sid_lock before invoking this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sidno</td><td>The SIDNO to add. </td></tr>
    <tr><td class="paramname">sid</td><td>The SID to add. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RETURN_STATUS_OK or RETURN_STATUS_REPORTED_ERROR. </dd></dl>

</div>
</div>
<a id="a23aa9c0f385a44772e9e5c3955cca0cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23aa9c0f385a44772e9e5c3955cca0cf">&#9670;&nbsp;</a></span>add_sid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a> Sid_map::add_sid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpl__gtid_8h.html#ada65b12e73ca5b310f33aea1537852e6">rpl_sid</a> &amp;&#160;</td>
          <td class="paramname"><em>sid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add the given SID to this map if it does not already exist. </p>
<p>The caller must hold the read lock or write lock on sid_lock before invoking this function. If the SID does not exist in this map, it will release the read lock, take a write lock, update the map, release the write lock, and take the read lock again.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sid</td><td>The SID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">SIDNO</td><td>The SIDNO for the SID (a new SIDNO if the SID did not exist, an existing if it did exist). </td></tr>
    <tr><td class="paramname">negative</td><td>Error. This function calls my_error. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aae1a2e63f72f82b16aad9d86ace04676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae1a2e63f72f82b16aad9d86ace04676">&#9670;&nbsp;</a></span>clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpl__gtid_8h.html#a3cf0e1a495b2402d8e6aa88f870316d5">enum_return_status</a> Sid_map::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears this Sid_map (for RESET SLAVE) </p>
<dl class="section return"><dt>Returns</dt><dd>RETURN_STATUS_OK or RETURN_STAUTS_REPORTED_ERROR </dd></dl>

</div>
</div>
<a id="aa02acc6896576b6a7f54fb55c1e359cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa02acc6896576b6a7f54fb55c1e359cd">&#9670;&nbsp;</a></span>copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpl__gtid_8h.html#a3cf0e1a495b2402d8e6aa88f870316d5">enum_return_status</a> Sid_map::copy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSid__map.html">Sid_map</a> *&#160;</td>
          <td class="paramname"><em>dest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deep copy this Sid_map to dest. </p>
<p>The caller must hold: the read lock on this sid_lock the write lock on the dest sid_lock before invoking this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">dest</td><td>The Sid_map to which the sids and sidnos will be copied. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RETURN_STATUS_OK or RETURN_STATUS_REPORTED_ERROR. </dd></dl>

</div>
</div>
<a id="a4e1dbe6bf6fbaf1d6c3199cd407a620c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e1dbe6bf6fbaf1d6c3199cd407a620c">&#9670;&nbsp;</a></span>get_max_sidno()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a> Sid_map::get_max_sidno </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the biggest sidno in this Sid_map. </p>
<p>The caller must hold the read or write lock on sid_lock before invoking this function. </p>

</div>
</div>
<a id="ae8a930508aff1669dabea328064ada55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8a930508aff1669dabea328064ada55">&#9670;&nbsp;</a></span>get_sid_lock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a>* Sid_map::get_sid_lock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the sid_lock. </p>

</div>
</div>
<a id="a136025a5e9fb2ea21eb4da9d44060fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a136025a5e9fb2ea21eb4da9d44060fce">&#9670;&nbsp;</a></span>get_sorted_sidno()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a> Sid_map::get_sorted_sidno </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a>&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the n'th smallest sidno, in the order of the SID's UUID. </p>
<p>The caller must hold the read or write lock on sid_lock before invoking this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>A number in the interval [0, get_max_sidno()-1], inclusively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa2c5af40baa34b4f4d1da980951711fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c5af40baa34b4f4d1da980951711fd">&#9670;&nbsp;</a></span>sid_map_get_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>* Sid_map::sid_map_get_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1667fd040c720d4ab8c35871f63926f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1667fd040c720d4ab8c35871f63926f4">&#9670;&nbsp;</a></span>sid_to_sidno()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a> Sid_map::sid_to_sidno </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="rpl__gtid_8h.html#ada65b12e73ca5b310f33aea1537852e6">rpl_sid</a> &amp;&#160;</td>
          <td class="paramname"><em>sid</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the SIDNO for a given SID. </p>
<p>The caller must hold the read lock on sid_lock before invoking this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sid</td><td>The SID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">SIDNO</td><td>if the given SID exists in this map. </td></tr>
    <tr><td class="paramname">0</td><td>if the given SID does not exist in this map. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae9a138fb42883743ec9548a6e65a56f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9a138fb42883743ec9548a6e65a56f8">&#9670;&nbsp;</a></span>sidno_to_sid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="rpl__gtid_8h.html#ada65b12e73ca5b310f33aea1537852e6">rpl_sid</a>&amp; Sid_map::sidno_to_sid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a>&#160;</td>
          <td class="paramname"><em>sidno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>need_lock</em> = <code><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#a65e9886d74aaee76545e83dd09011727">false</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the SID for a given SIDNO. </p>
<p>Raises an assertion if the SIDNO is not valid.</p>
<p>If need_lock is true, acquires sid_lock-&gt;rdlock; otherwise asserts that it is held already.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sidno</td><td>The SIDNO. </td></tr>
    <tr><td class="paramname">need_lock</td><td>If true, and sid_lock!=NULL, this function will acquire sid_lock before looking up the sid, and then release it. If false, and sid_lock!=NULL, this function will assert the sid_lock is already held. If sid_lock==NULL, nothing is done w.r.t. locking. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>The SIDNO does not exist in this map. </td></tr>
    <tr><td class="paramname">pointer</td><td>Pointer to the SID. The data is shared with this Sid_map, so should not be modified. It is safe to read the data even after this Sid_map is modified, but not if this Sid_map is destroyed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a07ed1599ba0f72a48373049779a2cd1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07ed1599ba0f72a48373049779a2cd1e">&#9670;&nbsp;</a></span>_sid_to_sidno</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmalloc__unordered__map.html">malloc_unordered_map</a>&lt;<a class="el" href="rpl__gtid_8h.html#ada65b12e73ca5b310f33aea1537852e6">rpl_sid</a>, <a class="el" href="map__helpers_8h.html#ab9bfec3d68fe066cd76cd78c5039d012">unique_ptr_my_free</a>&lt;<a class="el" href="structSid__map_1_1Node.html">Node</a>&gt;, <a class="el" href="structbinary__log_1_1Hash__Uuid.html">binary_log::Hash_Uuid</a>&gt; Sid_map::_sid_to_sidno {<a class="el" href="rpl__gtid__sid__map_8cc.html#a6e13f84ff6d0380ce41e8e69fdda9fbb">key_memory_Sid_map_Node</a>}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Hash that maps SID to SIDNO. </p>

</div>
</div>
<a id="a613bafd04a309721fdd3f73d80883087"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a613bafd04a309721fdd3f73d80883087">&#9670;&nbsp;</a></span>_sidno_to_sid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPrealloced__array.html">Prealloced_array</a>&lt;<a class="el" href="structSid__map_1_1Node.html">Node</a> *, 8&gt; Sid_map::_sidno_to_sid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Array that maps SIDNO to SID; the element at index N points to a Node with SIDNO N-1. </p>

</div>
</div>
<a id="a8390d6f6dddffb8cc7b1adcf7cea6045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8390d6f6dddffb8cc7b1adcf7cea6045">&#9670;&nbsp;</a></span>_sorted</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPrealloced__array.html">Prealloced_array</a>&lt;<a class="el" href="rpl__gtid_8h.html#a4873b950f954adcfa36c1665428ce3ff">rpl_sidno</a>, 8&gt; Sid_map::_sorted</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Array that maps numbers in the interval [0, get_max_sidno()-1] to SIDNOs, in order of increasing SID. </p>
<dl class="section see"><dt>See also</dt><dd>Sid_map::get_sorted_sidno. </dd></dl>

</div>
</div>
<a id="a0dd02514995333a3887ba4a93492a885"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dd02514995333a3887ba4a93492a885">&#9670;&nbsp;</a></span>sid_lock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a>* Sid_map::sid_lock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read-write lock that protects updates to the number of SIDNOs. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>sql/<a class="el" href="rpl__gtid_8h_source.html">rpl_gtid.h</a></li>
<li>sql/<a class="el" href="rpl__gtid__sid__map_8cc.html">rpl_gtid_sid_map.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classSid__map.html">Sid_map</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
