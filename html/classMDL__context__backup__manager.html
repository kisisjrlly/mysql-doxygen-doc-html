<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: MDL_context_backup_manager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classMDL__context__backup__manager.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classMDL__context__backup__manager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">MDL_context_backup_manager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class which is used to store MDL locks associated with XA transactions in prepared state which clients have disconnected.  
 <a href="classMDL__context__backup__manager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mdl__context__backup_8h_source.html">mdl_context_backup.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager_1_1MDL__context__backup.html">MDL_context_backup</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper around MDL_context class which allows to store it in backup manager's collection.  <a href="classMDL__context__backup__manager_1_1MDL__context__backup.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a83d02db0c94dd66aefa3580871903add"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a83d02db0c94dd66aefa3580871903add">MDL_context_backup_manager</a> (const <a class="el" href="classMDL__context__backup__manager.html">MDL_context_backup_manager</a> &amp;)=delete</td></tr>
<tr class="separator:a83d02db0c94dd66aefa3580871903add"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af57a8de4e49a9594623802345b703a42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#af57a8de4e49a9594623802345b703a42">operator=</a> (const <a class="el" href="classMDL__context__backup__manager.html">MDL_context_backup_manager</a> &amp;)=delete</td></tr>
<tr class="separator:af57a8de4e49a9594623802345b703a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8e993983a5e6b83895a8422360bbfeb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#aa8e993983a5e6b83895a8422360bbfeb">create_backup</a> (const <a class="el" href="classMDL__context.html">MDL_context</a> *context, const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *<a class="el" href="mi__test2_8cc.html#a30b3e7be7739a55bdf3f9c82becb1903">key</a>, const size_t keylen)</td></tr>
<tr class="memdesc:aa8e993983a5e6b83895a8422360bbfeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create backup from given MDL_context by cloning all transactional locks to backup context and adds to backup context manager collection.  <a href="#aa8e993983a5e6b83895a8422360bbfeb">More...</a><br /></td></tr>
<tr class="separator:aa8e993983a5e6b83895a8422360bbfeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a2fe74133cda805fb719d9e7d1ff77c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a6a2fe74133cda805fb719d9e7d1ff77c">create_backup</a> (<a class="el" href="mdl_8h.html#a1e6fbbe4110a5b3e32f1a8c13dd1a329">MDL_request_list</a> *mdl_requests, const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *<a class="el" href="mi__test2_8cc.html#a30b3e7be7739a55bdf3f9c82becb1903">key</a>, const size_t keylen)</td></tr>
<tr class="memdesc:a6a2fe74133cda805fb719d9e7d1ff77c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create backup MDL_context, process request on it and add to backup context manager collection.  <a href="#a6a2fe74133cda805fb719d9e7d1ff77c">More...</a><br /></td></tr>
<tr class="separator:a6a2fe74133cda805fb719d9e7d1ff77c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd4e4c69487cb8726cb7ccfce76e476"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a8bd4e4c69487cb8726cb7ccfce76e476">restore_backup</a> (<a class="el" href="classMDL__context.html">MDL_context</a> *mdl_context, const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *<a class="el" href="mi__test2_8cc.html#a30b3e7be7739a55bdf3f9c82becb1903">key</a>, const size_t keylen)</td></tr>
<tr class="memdesc:a8bd4e4c69487cb8726cb7ccfce76e476"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restore locks from backup to given MDL_context.  <a href="#a8bd4e4c69487cb8726cb7ccfce76e476">More...</a><br /></td></tr>
<tr class="separator:a8bd4e4c69487cb8726cb7ccfce76e476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59113a537409287bf6044787d8e8a5a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a59113a537409287bf6044787d8e8a5a4">delete_backup</a> (const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *<a class="el" href="mi__test2_8cc.html#a30b3e7be7739a55bdf3f9c82becb1903">key</a>, const size_t keylen)</td></tr>
<tr class="memdesc:a59113a537409287bf6044787d8e8a5a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete backup context and release associated locks.  <a href="#a59113a537409287bf6044787d8e8a5a4">More...</a><br /></td></tr>
<tr class="separator:a59113a537409287bf6044787d8e8a5a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a6c79a5b0eaa353fe4caff9be6b547c19"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a6c79a5b0eaa353fe4caff9be6b547c19">init</a> ()</td></tr>
<tr class="memdesc:a6c79a5b0eaa353fe4caff9be6b547c19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize member variables and singleton object.  <a href="#a6c79a5b0eaa353fe4caff9be6b547c19">More...</a><br /></td></tr>
<tr class="separator:a6c79a5b0eaa353fe4caff9be6b547c19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc5f8a5cf7baf9b1c6ed0ecf618b20c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classMDL__context__backup__manager.html">MDL_context_backup_manager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#accc5f8a5cf7baf9b1c6ed0ecf618b20c">instance</a> ()</td></tr>
<tr class="memdesc:accc5f8a5cf7baf9b1c6ed0ecf618b20c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return singleton object.  <a href="#accc5f8a5cf7baf9b1c6ed0ecf618b20c">More...</a><br /></td></tr>
<tr class="separator:accc5f8a5cf7baf9b1c6ed0ecf618b20c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72180a16b1c6c68a71f6ec7fcb3ce0b2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a72180a16b1c6c68a71f6ec7fcb3ce0b2">destroy</a> ()</td></tr>
<tr class="memdesc:a72180a16b1c6c68a71f6ec7fcb3ce0b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleanup and delete singleton object.  <a href="#a72180a16b1c6c68a71f6ec7fcb3ce0b2">More...</a><br /></td></tr>
<tr class="separator:a72180a16b1c6c68a71f6ec7fcb3ce0b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:ad1d608a8901ff3bd7dd410d1c570a4f4"><td class="memItemLeft" align="right" valign="top">typedef std::basic_string&lt; <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#ad1d608a8901ff3bd7dd410d1c570a4f4">MDL_context_backup_key</a></td></tr>
<tr class="memdesc:ad1d608a8901ff3bd7dd410d1c570a4f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key for uniquely identifying MDL_context in the MDL_context_backup map.  <a href="#ad1d608a8901ff3bd7dd410d1c570a4f4">More...</a><br /></td></tr>
<tr class="separator:ad1d608a8901ff3bd7dd410d1c570a4f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa72fa211ebdd656fa1cb0eb0ac89a8db"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; <a class="el" href="classMDL__context__backup__manager.html#ad1d608a8901ff3bd7dd410d1c570a4f4">MDL_context_backup_key</a>, std::unique_ptr&lt; <a class="el" href="classMDL__context__backup__manager_1_1MDL__context__backup.html">MDL_context_backup</a> &gt;, std::less&lt; <a class="el" href="classMDL__context__backup__manager.html#ad1d608a8901ff3bd7dd410d1c570a4f4">MDL_context_backup_key</a> &gt;, <a class="el" href="classMalloc__allocator.html">Malloc_allocator</a>&lt; std::pair&lt; const <a class="el" href="classMDL__context__backup__manager.html#ad1d608a8901ff3bd7dd410d1c570a4f4">MDL_context_backup_key</a>, std::unique_ptr&lt; <a class="el" href="classMDL__context__backup__manager_1_1MDL__context__backup.html">MDL_context_backup</a> &gt; &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#aa72fa211ebdd656fa1cb0eb0ac89a8db">Element_map_type</a></td></tr>
<tr class="separator:aa72fa211ebdd656fa1cb0eb0ac89a8db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a939ebbb3ad47a969e2337e1643e33d2c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a939ebbb3ad47a969e2337e1643e33d2c">MDL_context_backup_manager</a> (<a class="el" href="group__psi__abi__memory.html#ga902dd5c9fe51b8cbdd7438a30e43fdd0">PSI_memory_key</a> <a class="el" href="mi__test2_8cc.html#a30b3e7be7739a55bdf3f9c82becb1903">key</a>)</td></tr>
<tr class="separator:a939ebbb3ad47a969e2337e1643e33d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51d36bec11ab40b7d064ffbdd4787ab2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a51d36bec11ab40b7d064ffbdd4787ab2">~MDL_context_backup_manager</a> ()</td></tr>
<tr class="memdesc:a51d36bec11ab40b7d064ffbdd4787ab2"><td class="mdescLeft">&#160;</td><td class="mdescRight">destroy mutex and clear backup map  <a href="#a51d36bec11ab40b7d064ffbdd4787ab2">More...</a><br /></td></tr>
<tr class="separator:a51d36bec11ab40b7d064ffbdd4787ab2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f89cd8d4dc47933af577aa83e986950"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a0f89cd8d4dc47933af577aa83e986950">check_key_exist</a> (const <a class="el" href="classMDL__context__backup__manager.html#ad1d608a8901ff3bd7dd410d1c570a4f4">MDL_context_backup_key</a> &amp;key_obj)</td></tr>
<tr class="memdesc:a0f89cd8d4dc47933af577aa83e986950"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for presence of a record with specified key.  <a href="#a0f89cd8d4dc47933af577aa83e986950">More...</a><br /></td></tr>
<tr class="separator:a0f89cd8d4dc47933af577aa83e986950"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a3a4e2e870dddbe9d67783b07ebaa0344"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a3a4e2e870dddbe9d67783b07ebaa0344">init_psi_keys</a> (void)</td></tr>
<tr class="separator:a3a4e2e870dddbe9d67783b07ebaa0344"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a62593edeed7ce62845c271cb933b28d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMDL__context__backup__manager.html#aa72fa211ebdd656fa1cb0eb0ac89a8db">Element_map_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#a62593edeed7ce62845c271cb933b28d2">m_backup_map</a></td></tr>
<tr class="separator:a62593edeed7ce62845c271cb933b28d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2c06ec5324addfed734a1b3b21ef034"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmysql__mutex__t.html">mysql_mutex_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#ab2c06ec5324addfed734a1b3b21ef034">m_LOCK_mdl_context_backup</a></td></tr>
<tr class="separator:ab2c06ec5324addfed734a1b3b21ef034"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:aa2001783855b60a92e205b608c07b9cf"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classMDL__context__backup__manager.html">MDL_context_backup_manager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMDL__context__backup__manager.html#aa2001783855b60a92e205b608c07b9cf">m_single</a> = <a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a></td></tr>
<tr class="separator:aa2001783855b60a92e205b608c07b9cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class which is used to store MDL locks associated with XA transactions in prepared state which clients have disconnected. </p>
<p>These locks are not associated with any particular THD/thread. Later they will be retrieved by the thread which attempts to process the prepared XA transaction.</p>
<p>This is singleton class. It contains map where each element represents MDL_context of disconnected prepared XA transaction and holds related metadata locks. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="aa72fa211ebdd656fa1cb0eb0ac89a8db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa72fa211ebdd656fa1cb0eb0ac89a8db">&#9670;&nbsp;</a></span>Element_map_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt; <a class="el" href="classMDL__context__backup__manager.html#ad1d608a8901ff3bd7dd410d1c570a4f4">MDL_context_backup_key</a>, std::unique_ptr&lt;<a class="el" href="classMDL__context__backup__manager_1_1MDL__context__backup.html">MDL_context_backup</a>&gt;, std::less&lt;<a class="el" href="classMDL__context__backup__manager.html#ad1d608a8901ff3bd7dd410d1c570a4f4">MDL_context_backup_key</a>&gt;, <a class="el" href="classMalloc__allocator.html">Malloc_allocator</a>&lt;std::pair&lt;const <a class="el" href="classMDL__context__backup__manager.html#ad1d608a8901ff3bd7dd410d1c570a4f4">MDL_context_backup_key</a>, std::unique_ptr&lt;<a class="el" href="classMDL__context__backup__manager_1_1MDL__context__backup.html">MDL_context_backup</a>&gt; &gt; &gt; &gt; <a class="el" href="classMDL__context__backup__manager.html#aa72fa211ebdd656fa1cb0eb0ac89a8db">MDL_context_backup_manager::Element_map_type</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad1d608a8901ff3bd7dd410d1c570a4f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1d608a8901ff3bd7dd410d1c570a4f4">&#9670;&nbsp;</a></span>MDL_context_backup_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::basic_string&lt;<a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a>&gt; <a class="el" href="classMDL__context__backup__manager.html#ad1d608a8901ff3bd7dd410d1c570a4f4">MDL_context_backup_manager::MDL_context_backup_key</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Key for uniquely identifying MDL_context in the MDL_context_backup map. </p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a939ebbb3ad47a969e2337e1643e33d2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939ebbb3ad47a969e2337e1643e33d2c">&#9670;&nbsp;</a></span>MDL_context_backup_manager() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MDL_context_backup_manager::MDL_context_backup_manager </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__psi__abi__memory.html#ga902dd5c9fe51b8cbdd7438a30e43fdd0">PSI_memory_key</a>&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a83d02db0c94dd66aefa3580871903add"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83d02db0c94dd66aefa3580871903add">&#9670;&nbsp;</a></span>MDL_context_backup_manager() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MDL_context_backup_manager::MDL_context_backup_manager </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMDL__context__backup__manager.html">MDL_context_backup_manager</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a51d36bec11ab40b7d064ffbdd4787ab2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51d36bec11ab40b7d064ffbdd4787ab2">&#9670;&nbsp;</a></span>~MDL_context_backup_manager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MDL_context_backup_manager::~MDL_context_backup_manager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>destroy mutex and clear backup map </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a0f89cd8d4dc47933af577aa83e986950"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f89cd8d4dc47933af577aa83e986950">&#9670;&nbsp;</a></span>check_key_exist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> MDL_context_backup_manager::check_key_exist </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMDL__context__backup__manager.html#ad1d608a8901ff3bd7dd410d1c570a4f4">MDL_context_backup_key</a> &amp;&#160;</td>
          <td class="paramname"><em>key_obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check for presence of a record with specified key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key_obj</td><td>Key to identity MDL_context</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if there is a record for specified key, else false </dd></dl>

</div>
</div>
<a id="aa8e993983a5e6b83895a8422360bbfeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8e993983a5e6b83895a8422360bbfeb">&#9670;&nbsp;</a></span>create_backup() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> MDL_context_backup_manager::create_backup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMDL__context.html">MDL_context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create backup from given MDL_context by cloning all transactional locks to backup context and adds to backup context manager collection. </p>
<p>This method is used during user's session disconnect for storing MDL locks acquired by prepared XA transaction(s).</p>
<p>This function does not set error codes beyond what is set by the functions it calls.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>MDL_context from which backup is created. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Key to identity MDL_context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>Key Length</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Error, e.g. Fail to create backup object, fail to clone locks. </td></tr>
    <tr><td class="paramname">false</td><td>Success or a backup already exist for this key. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6a2fe74133cda805fb719d9e7d1ff77c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a2fe74133cda805fb719d9e7d1ff77c">&#9670;&nbsp;</a></span>create_backup() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> MDL_context_backup_manager::create_backup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mdl_8h.html#a1e6fbbe4110a5b3e32f1a8c13dd1a329">MDL_request_list</a> *&#160;</td>
          <td class="paramname"><em>mdl_requests</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create backup MDL_context, process request on it and add to backup context manager collection. </p>
<p>This method is called during server start up in order to acquire MDL locks held by prepared XA transactions existed before server shutdown.</p>
<p>This function does not set error codes beyond what is set by the functions it calls.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mdl_requests</td><td>Requests need to be processed and backed up. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Key to identity MDL_context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>Key Length</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Error, e.g. Fail to create backup object, fail to clone locks. </td></tr>
    <tr><td class="paramname">false</td><td>Success or a backup already exist for this key. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a59113a537409287bf6044787d8e8a5a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59113a537409287bf6044787d8e8a5a4">&#9670;&nbsp;</a></span>delete_backup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MDL_context_backup_manager::delete_backup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete backup context and release associated locks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Key to identity MDL_context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>Key Length </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a72180a16b1c6c68a71f6ec7fcb3ce0b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72180a16b1c6c68a71f6ec7fcb3ce0b2">&#9670;&nbsp;</a></span>destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MDL_context_backup_manager::destroy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cleanup and delete singleton object. </p>

</div>
</div>
<a id="a6c79a5b0eaa353fe4caff9be6b547c19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c79a5b0eaa353fe4caff9be6b547c19">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> MDL_context_backup_manager::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize member variables and singleton object. </p>

</div>
</div>
<a id="a3a4e2e870dddbe9d67783b07ebaa0344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a4e2e870dddbe9d67783b07ebaa0344">&#9670;&nbsp;</a></span>init_psi_keys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MDL_context_backup_manager::init_psi_keys </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="accc5f8a5cf7baf9b1c6ed0ecf618b20c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accc5f8a5cf7baf9b1c6ed0ecf618b20c">&#9670;&nbsp;</a></span>instance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMDL__context__backup__manager.html">MDL_context_backup_manager</a> &amp; MDL_context_backup_manager::instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return singleton object. </p>

</div>
</div>
<a id="af57a8de4e49a9594623802345b703a42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af57a8de4e49a9594623802345b703a42">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MDL_context_backup_manager::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMDL__context__backup__manager.html">MDL_context_backup_manager</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8bd4e4c69487cb8726cb7ccfce76e476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bd4e4c69487cb8726cb7ccfce76e476">&#9670;&nbsp;</a></span>restore_backup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> MDL_context_backup_manager::restore_backup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMDL__context.html">MDL_context</a> *&#160;</td>
          <td class="paramname"><em>mdl_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restore locks from backup to given MDL_context. </p>
<p>This function does not set error codes beyond what is set by the functions it calls.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">mdl_context</td><td>MDL_context to which backup is restored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Key to identity MDL_context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>Key Length</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Error, e.g. There is no element in the collection matching given key, fail to retore locks. </td></tr>
    <tr><td class="paramname">false</td><td>Success </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a62593edeed7ce62845c271cb933b28d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62593edeed7ce62845c271cb933b28d2">&#9670;&nbsp;</a></span>m_backup_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMDL__context__backup__manager.html#aa72fa211ebdd656fa1cb0eb0ac89a8db">Element_map_type</a> MDL_context_backup_manager::m_backup_map</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab2c06ec5324addfed734a1b3b21ef034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2c06ec5324addfed734a1b3b21ef034">&#9670;&nbsp;</a></span>m_LOCK_mdl_context_backup</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmysql__mutex__t.html">mysql_mutex_t</a> MDL_context_backup_manager::m_LOCK_mdl_context_backup</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa2001783855b60a92e205b608c07b9cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2001783855b60a92e205b608c07b9cf">&#9670;&nbsp;</a></span>m_single</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMDL__context__backup__manager.html">MDL_context_backup_manager</a> * MDL_context_backup_manager::m_single = <a class="el" href="auth__ldap__sasl__client_8cc.html#ae7bd12bd7c9e418a420087971d0a7e31">nullptr</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>sql/<a class="el" href="mdl__context__backup_8h_source.html">mdl_context_backup.h</a></li>
<li>sql/<a class="el" href="mdl__context__backup_8cc.html">mdl_context_backup.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classMDL__context__backup__manager.html">MDL_context_backup_manager</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
