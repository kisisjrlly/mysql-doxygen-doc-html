<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: log_service_imp Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classlog__service__imp.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classlog__service__imp-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">log_service_imp Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="log__service__imp_8h_source.html">log_service_imp.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ad7303872fe3363c4355f642bbc932424"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlog__service__imp.html#ad7303872fe3363c4355f642bbc932424">init</a> ()</td></tr>
<tr class="memdesc:ad7303872fe3363c4355f642bbc932424"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a loadable logging service.  <a href="#ad7303872fe3363c4355f642bbc932424">More...</a><br /></td></tr>
<tr class="separator:ad7303872fe3363c4355f642bbc932424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21fa445f4fc6e6f66b740d9b16bd6d4f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlog__service__imp.html#a21fa445f4fc6e6f66b740d9b16bd6d4f">exit</a> ()</td></tr>
<tr class="memdesc:a21fa445f4fc6e6f66b740d9b16bd6d4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">De-initialize a loadable logging service.  <a href="#a21fa445f4fc6e6f66b740d9b16bd6d4f">More...</a><br /></td></tr>
<tr class="separator:a21fa445f4fc6e6f66b740d9b16bd6d4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab77a875177d5105d6760ed9168c5e5c5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlog__service__imp.html#ab77a875177d5105d6760ed9168c5e5c5">run</a> (void *instance, <a class="el" href="log__shared_8h.html#abef61f7610a42c29cd8b3a92f391143f">log_line</a> *ll) noexcept</td></tr>
<tr class="memdesc:ab77a875177d5105d6760ed9168c5e5c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Have the service process one log line.  <a href="#ab77a875177d5105d6760ed9168c5e5c5">More...</a><br /></td></tr>
<tr class="separator:ab77a875177d5105d6760ed9168c5e5c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acce5f509be1aecf01cf1650846352732"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="log__service_8h.html#ae4871f54cbb0619a0c304c2818298685">log_service_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlog__service__imp.html#acce5f509be1aecf01cf1650846352732">flush</a> (void **instance) noexcept</td></tr>
<tr class="memdesc:acce5f509be1aecf01cf1650846352732"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush any buffers.  <a href="#acce5f509be1aecf01cf1650846352732">More...</a><br /></td></tr>
<tr class="separator:acce5f509be1aecf01cf1650846352732"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3875803623d5672e33243d9d49b97345"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="log__service_8h.html#ae4871f54cbb0619a0c304c2818298685">log_service_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlog__service__imp.html#a3875803623d5672e33243d9d49b97345">open</a> (<a class="el" href="log__shared_8h.html#abef61f7610a42c29cd8b3a92f391143f">log_line</a> *ll, void **instance) noexcept</td></tr>
<tr class="memdesc:a3875803623d5672e33243d9d49b97345"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a new instance.  <a href="#a3875803623d5672e33243d9d49b97345">More...</a><br /></td></tr>
<tr class="separator:a3875803623d5672e33243d9d49b97345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad03514bc07ae06c3586af456c10ff99b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="log__service_8h.html#ae4871f54cbb0619a0c304c2818298685">log_service_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlog__service__imp.html#ad03514bc07ae06c3586af456c10ff99b">close</a> (void **instance) noexcept</td></tr>
<tr class="memdesc:ad03514bc07ae06c3586af456c10ff99b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close and release an instance.  <a href="#ad03514bc07ae06c3586af456c10ff99b">More...</a><br /></td></tr>
<tr class="separator:ad03514bc07ae06c3586af456c10ff99b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c72bb8c155dfd878102156c3abdaeb5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlog__service__imp.html#a6c72bb8c155dfd878102156c3abdaeb5">characteristics</a> (void) noexcept</td></tr>
<tr class="memdesc:a6c72bb8c155dfd878102156c3abdaeb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get characteristics of a log-service.  <a href="#a6c72bb8c155dfd878102156c3abdaeb5">More...</a><br /></td></tr>
<tr class="separator:a6c72bb8c155dfd878102156c3abdaeb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7837cdafd2b423f6a994ae1e26a807e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="log__service_8h.html#ae4871f54cbb0619a0c304c2818298685">log_service_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlog__service__imp.html#af7837cdafd2b423f6a994ae1e26a807e">parse_log_line</a> (const char *line_start, size_t line_length) noexcept</td></tr>
<tr class="memdesc:af7837cdafd2b423f6a994ae1e26a807e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a single line in an error log of this format.  <a href="#af7837cdafd2b423f6a994ae1e26a807e">More...</a><br /></td></tr>
<tr class="separator:af7837cdafd2b423f6a994ae1e26a807e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a249b72e58ac868b1a4758ce1c79a9910"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="log__service_8h.html#ae4871f54cbb0619a0c304c2818298685">log_service_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlog__service__imp.html#a249b72e58ac868b1a4758ce1c79a9910">get_log_name</a> (void *instance, char *buf, size_t bufsize) noexcept</td></tr>
<tr class="memdesc:a249b72e58ac868b1a4758ce1c79a9910"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide the name for a log file this service would access.  <a href="#a249b72e58ac868b1a4758ce1c79a9910">More...</a><br /></td></tr>
<tr class="separator:a249b72e58ac868b1a4758ce1c79a9910"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6c72bb8c155dfd878102156c3abdaeb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c72bb8c155dfd878102156c3abdaeb5">&#9670;&nbsp;</a></span>characteristics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int log_service_imp::characteristics </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get characteristics of a log-service. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&lt;0</td><td>an error occurred </td></tr>
    <tr><td class="paramname">&gt;=0</td><td>characteristics (a set of log_service_chistics flags) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad03514bc07ae06c3586af456c10ff99b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad03514bc07ae06c3586af456c10ff99b">&#9670;&nbsp;</a></span>close()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="log__service_8h.html#ae4871f54cbb0619a0c304c2818298685">log_service_error</a> log_service_imp::close </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>instance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Close and release an instance. </p>
<p>Flushes any buffers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>State-pointer that was returned on open. If memory was allocated for this state, it should be released, and the pointer set to nullptr.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&lt;0</td><td>an error occurred </td></tr>
    <tr><td class="paramname">=0</td><td>success</td></tr>
  </table>
  </dd>
</dl>
<p>Flushes any buffers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>State-pointer that was returned on open. If memory was allocated for this state, it should be released, and the pointer set to nullptr.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">LOG_SERVICE_SUCCESS</td><td>success </td></tr>
    <tr><td class="paramname">otherwise</td><td>an error occurred</td></tr>
  </table>
  </dd>
</dl>
<p>Flushes any buffers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>State-pointer that was returned on open. If memory was allocated for this state, it should be released, and the pointer set to nullptr.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">LOG_SERVICE_SUCCESS</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a21fa445f4fc6e6f66b740d9b16bd6d4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21fa445f4fc6e6f66b740d9b16bd6d4f">&#9670;&nbsp;</a></span>exit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void log_service_imp::exit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>De-initialize a loadable logging service. </p>

</div>
</div>
<a id="acce5f509be1aecf01cf1650846352732"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acce5f509be1aecf01cf1650846352732">&#9670;&nbsp;</a></span>flush()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="log__service_8h.html#ae4871f54cbb0619a0c304c2818298685">log_service_error</a> log_service_imp::flush </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>instance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flush any buffers. </p>
<p>This function will be called by the server on FLUSH ERROR LOGS. The service may write its buffers, close and re-open any log files to work with log-rotation, etc. The flush function MUST NOT itself log anything! A service implementation may provide a nullptr if it does not wish to provide a flush function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>State-pointer that was returned on open. Value may be changed in flush.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&lt;0</td><td>an error occurred </td></tr>
    <tr><td class="paramname">=0</td><td>no work was done </td></tr>
    <tr><td class="paramname">&gt;0</td><td>flush completed without incident</td></tr>
  </table>
  </dd>
</dl>
<p>This function will be called by the server on FLUSH ERROR LOGS. The service may write its buffers, close and re-open any log files to work with log-rotation, etc. The flush function MUST NOT itself log anything! A service implementation may provide a nullptr if it does not wish to provide a flush function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>State-pointer that was returned on open. Value may be changed in flush.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">LOG_SERVICE_NOTHING_DONE</td><td>no work was done</td></tr>
  </table>
  </dd>
</dl>
<p>This function will be called by the server on FLUSH ERROR LOGS. The service may write its buffers, close and re-open any log files to work with log-rotation, etc. The flush function MUST NOT itself log anything! A service implementation may provide a nullptr if it does not wish to provide a flush function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>State-pointer that was returned on open. Value may be changed in flush.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">LOG_SERVICE_NOTHING_DONE</td><td>no work was done </td></tr>
    <tr><td class="paramname">LOG_SERVICE_SUCCESS</td><td>flush completed without incident </td></tr>
    <tr><td class="paramname">otherwise</td><td>an error occurred </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a249b72e58ac868b1a4758ce1c79a9910"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a249b72e58ac868b1a4758ce1c79a9910">&#9670;&nbsp;</a></span>get_log_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="log__service_8h.html#ae4871f54cbb0619a0c304c2818298685">log_service_error</a> log_service_imp::get_log_name </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>instance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bufsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Provide the name for a log file this service would access. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>instance info returned by open() if requesting the file-name for a specific open instance. nullptr to get the name of the default instance (even if it that log is not open). This is used to determine the name of the log-file to load on start-up. </td></tr>
    <tr><td class="paramname">buf</td><td>Address of a buffer allocated in the caller. The callee may return an extension starting with '.', in which case the path and file-name will be the system's default, except with the given extension. Alternatively, the callee may return a file-name which is assumed to be in the same directory as the default log. Values are C-strings. </td></tr>
    <tr><td class="paramname">bufsize</td><td>The size of the allocation in the caller.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">LOG_SERVICE_SUCCESS</td><td>Success </td></tr>
    <tr><td class="paramname">LOG_SERVICE_UNSUPPORTED_MODE</td><td>only default/only instances supported </td></tr>
    <tr><td class="paramname">LOG_SERVICE_BUFFER_SIZE_INSUFFICIENT</td><td></td></tr>
    <tr><td class="paramname">LOG_SERVICE_MISC_ERROR</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>instance info returned by open() if requesting the file-name for a specific open instance. nullptr to get the name of the default instance (even if it that log is not open). This is used to determine the name of the log-file to load on start-up. </td></tr>
    <tr><td class="paramname">buf</td><td>Address of a buffer allocated in the caller. The callee may return an extension starting with '.', in which case the path and file-name will be the system's default, except with the given extension. Alternatively, the callee may return a file-name which is assumed to be in the same directory as the default log. Values are C-strings. </td></tr>
    <tr><td class="paramname">bufsize</td><td>The size of the allocation in the caller.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Mode not supported (only default / only instances supported) </td></tr>
    <tr><td class="paramname">-2</td><td>Buffer not large enough </td></tr>
    <tr><td class="paramname">-3</td><td>Misc. error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad7303872fe3363c4355f642bbc932424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7303872fe3363c4355f642bbc932424">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void log_service_imp::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize a loadable logging service. </p>

</div>
</div>
<a id="a3875803623d5672e33243d9d49b97345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3875803623d5672e33243d9d49b97345">&#9670;&nbsp;</a></span>open()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="log__service_8h.html#ae4871f54cbb0619a0c304c2818298685">log_service_error</a> log_service_imp::open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="log__shared_8h.html#abef61f7610a42c29cd8b3a92f391143f">log_line</a> *&#160;</td>
          <td class="paramname"><em>ll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>instance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Open a new instance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ll</td><td>optional arguments </td></tr>
    <tr><td class="paramname">instance</td><td>If state is needed, the service may allocate and initialize it and return a pointer to it here. (This of course is particularly pertinent to components that may be opened multiple times, such as the JSON log writer.) This state is for use of the log-service component in question only and can take any layout suitable to that component's need. The state is opaque to the server/logging framework. It must be released on close.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&lt;0</td><td>a new instance could not be created </td></tr>
    <tr><td class="paramname">=0</td><td>success, returned hande is valid</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ll</td><td>optional arguments </td></tr>
    <tr><td class="paramname">instance</td><td>If state is needed, the service may allocate and initialize it and return a pointer to it here. (This of course is particularly pertinent to components that may be opened multiple times, such as the JSON log writer.) This state is for use of the log-service component in question only and can take any layout suitable to that component's need. The state is opaque to the server/logging framework. It must be released on close.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">LOG_SERVICE_SUCCESS</td><td>success, returned hande is valid </td></tr>
    <tr><td class="paramname">otherwise</td><td>a new instance could not be created </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af7837cdafd2b423f6a994ae1e26a807e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7837cdafd2b423f6a994ae1e26a807e">&#9670;&nbsp;</a></span>parse_log_line()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="log__service_8h.html#ae4871f54cbb0619a0c304c2818298685">log_service_error</a> log_service_imp::parse_log_line </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>line_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>line_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse a single line in an error log of this format. </p>
<p>(optional)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">line_start</td><td>pointer to the beginning of the line ('{') </td></tr>
    <tr><td class="paramname">line_length</td><td>length of the line</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">!=0</td><td>Failure (out of memory, malformed argument, etc.)</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">line_start</td><td>pointer to the beginning of the line ('{') </td></tr>
    <tr><td class="paramname">line_length</td><td>length of the line</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">!=0</td><td>Failure (out of memory, malformed argument, etc.) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab77a875177d5105d6760ed9168c5e5c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab77a875177d5105d6760ed9168c5e5c5">&#9670;&nbsp;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int log_service_imp::run </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>instance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="log__shared_8h.html#abef61f7610a42c29cd8b3a92f391143f">log_line</a> *&#160;</td>
          <td class="paramname"><em>ll</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Have the service process one log line. </p>
<p>services: log sinks: basic structured dump writer</p>
<p>services: log sinks: classic syslog/EventLog writer (message only) label will be ignored (one will be generated from priority by the syslogger).</p>
<p>services: log sinks: JSON structured dump writer Will write structured info to stderr/file.</p>
<p>services: log filter: basic filtering</p>
<p>If a run function wishes to itself use error logging in case of severe failure, it may do so after FIRST securing the all further calls to run() will be rejected. "log_sink_test" implements an example of this.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>State-pointer that was returned on open. </td></tr>
    <tr><td class="paramname">ll</td><td>The log_line collection of log_items.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&lt;0</td><td>an error occurred </td></tr>
    <tr><td class="paramname">=0</td><td>no work was done </td></tr>
    <tr><td class="paramname">&gt;0</td><td>number of processed entities</td></tr>
  </table>
  </dd>
</dl>
<p>The actual dragnet filtering engine is currently the default filter and therefore built-in (see components/mysql_server/log_builtins_filter.cc); this service is just a configuration language parser/compiler/decompiler; once it has set up the filter rule-set according to the user's instructions, it calls on the built-in engine to do the actual filtering.</p>
<p>Third parties could in theory write their own filtering language on top of that engine; they could also create their own filtering engine and use it instead of the provided one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ll</td><td>the log line to filter </td></tr>
    <tr><td class="paramname">instance</td><td>instance (unused in dragnet as it's not currently multi-open; we just always use log_filter_dragnet_rules)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>number of matched rules</td></tr>
  </table>
  </dd>
</dl>
<p>Binary will be escaped according to JSON rules. If you should not be able to specify a label, one will be generated for you from the line's priority field.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>instance state </td></tr>
    <tr><td class="paramname">ll</td><td>the log line to write </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;=0</td><td>number of accepted fields, if any </td></tr>
    <tr><td class="paramname">&lt;0</td><td>error</td></tr>
  </table>
  </dd>
</dl>
<p>If the message is not \0 terminated, it will be terminated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>instance's state </td></tr>
    <tr><td class="paramname">ll</td><td>the log line to write</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;=0</td><td>number of accepted fields, if any </td></tr>
    <tr><td class="paramname">LOG_SERVICE_NOT_AVAILABLE</td><td>log was not open </td></tr>
    <tr><td class="paramname">LOG_SERVICE_INVALID_ARGUMENT</td><td>could not sanitize log message </td></tr>
    <tr><td class="paramname">LOG_SERVICE_MISC_ERROR</td><td>failure not otherwise specified</td></tr>
  </table>
  </dd>
</dl>
<p>This is intended for testing and debugging, not production.</p>
<p>Writes all fields. No escaping is done. Submits various events of its own to demonstrate the availability of the error event submission interface from within external service, as well as the correct functioning of said interface.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">instance</td><td>instance </td></tr>
    <tr><td class="paramname">ll</td><td>the log line to write</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>number of accepted fields, if any </td></tr>
    <tr><td class="paramname">&lt;0</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>components/logging/<a class="el" href="log__service__imp_8h_source.html">log_service_imp.h</a></li>
<li>components/logging/<a class="el" href="log__filter__dragnet_8cc.html">log_filter_dragnet.cc</a></li>
<li>components/logging/<a class="el" href="log__sink__json_8cc.html">log_sink_json.cc</a></li>
<li>components/logging/<a class="el" href="log__sink__syseventlog_8cc.html">log_sink_syseventlog.cc</a></li>
<li>components/logging/<a class="el" href="log__sink__test_8cc.html">log_sink_test.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classlog__service__imp.html">log_service_imp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
