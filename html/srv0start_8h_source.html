<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: storage/innobase/include/srv0start.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('srv0start_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">srv0start.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="srv0start_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*****************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">Copyright (c) 1995, 2020, Oracle and/or its affiliates. All Rights Reserved.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">This program is free software; you can redistribute it and/or modify it under</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">the terms of the GNU General Public License, version 2.0, as published by the</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">Free Software Foundation.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">This program is also distributed with certain software (including but not</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">limited to OpenSSL) that is licensed under separate terms, as designated in a</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">particular file or component or in included license documentation. The authors</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">of MySQL hereby grant you an additional permission to link the program and</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">your derivative works with the separately licensed software that they have</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">included with MySQL.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">FOR A PARTICULAR PURPOSE. See the GNU General Public License, version 2.0,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">for more details.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">You should have received a copy of the GNU General Public License along with</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">this program; if not, write to the Free Software Foundation, Inc.,</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">*****************************************************************************/</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/** @file include/srv0start.h</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> Starts the Innobase database server</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> Created 10/10/1995 Heikki Tuuri</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> *******************************************************/</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#ifndef srv0start_h</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#define srv0start_h</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="log0types_8h.html">log0types.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="os0thread-create_8h.html">os0thread-create.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#ifndef UNIV_HOTBACKUP</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sync0rw_8h.html">sync0rw.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !UNIV_HOTBACKUP */</span><span class="preprocessor"></span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="trx0purge_8h.html">trx0purge.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;univ.i&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ut0byte_8h.html">ut0byte.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// Forward declaration</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">struct </span><a class="code" href="structdict__table__t.html">dict_table_t</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#ifndef UNIV_DEBUG</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#define RECOVERY_CRASH(x) \</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">  do {                    \</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">  } while (0)</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="srv0start_8h.html#a4aa67b3a34a65ddfea3b88436320d4aa">   53</a></span>&#160;<span class="preprocessor">#define RECOVERY_CRASH(x)                                  \</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">  do {                                                     \</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">    if (srv_force_recovery_crash == x) {                   \</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">      flush_error_log_messages();                          \</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">      fprintf(stderr, &quot;innodb_force_recovery_crash=%lu\n&quot;, \</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">              srv_force_recovery_crash);                   \</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">      fflush(stderr);                                      \</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">      _exit(3);                                            \</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">    }                                                      \</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">  } while (0)</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* UNIV_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/** If buffer pool is less than the size,</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">only one buffer pool instance is used. */</span></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="srv0start_8h.html#a2d3aba09919fc48a15fb44dc1454634d">   67</a></span>&#160;<span class="preprocessor">#define BUF_POOL_SIZE_THRESHOLD (1024 * 1024 * 1024)</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">/** Frees the memory allocated by srv_parse_data_file_paths_and_sizes()</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> and srv_parse_log_group_home_dirs(). */</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keywordtype">void</span> <a class="code" href="srv0start_8h.html#a37fd121f7ff04e1b78840729aeaf9207">srv_free_paths_and_sizes</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">/** Adds a slash or a backslash to the end of a string if it is missing</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> and the string is not empty.</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"> @return string which has the separator if the string is not empty */</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keywordtype">char</span> *<a class="code" href="srv0start_8h.html#a4dc22d3bd4d1aaba7d727878bf0fa9d7">srv_add_path_separator_if_needed</a>(</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">char</span> *str); <span class="comment">/*!&lt; in: null-terminated character string */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#ifndef UNIV_HOTBACKUP</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">/** Open an undo tablespace.</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">@param[in]  undo_space  Undo tablespace</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">@return DB_SUCCESS or error code */</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<a class="code" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> <a class="code" href="srv0start_8h.html#a393859f9ab32d37cdc7e4223d6d0d40d">srv_undo_tablespace_open</a>(<a class="code" href="structundo_1_1Tablespace.html">undo::Tablespace</a> &amp;undo_space);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/** Upgrade undo tablespaces by deleting the old undo tablespaces</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">referenced by the TRX_SYS page.</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">@return error code */</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<a class="code" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> <a class="code" href="srv0start_8h.html#a2c4a808bb3b77f3af31bd13cb84df565">srv_undo_tablespaces_upgrade</a>();</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">/** Start InnoDB.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">@param[in]      create_new_db           Whether to create a new database</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">@return DB_SUCCESS or error code */</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<a class="code" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> <a class="code" href="srv0start_8h.html#ac24e029a70c5fdf1f69e35835b7710f0">srv_start</a>(<span class="keywordtype">bool</span> create_new_db) MY_ATTRIBUTE((warn_unused_result));</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">/** Fix up an undo tablespace if it was in the process of being truncated</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">when the server crashed. This is the second call and is done after the DD</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">is available so now we know the space_name, file_name and previous space_id.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">@param[in]  space_name  undo tablespace name</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">@param[in]  file_name   undo tablespace file name</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">@param[in]  space_id    undo tablespace ID</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">@return error code */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<a class="code" href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a> <a class="code" href="srv0start_8h.html#a436789cc68c4b7d5e2c4ecca5196034a">srv_undo_tablespace_fixup</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *space_name, <span class="keyword">const</span> <span class="keywordtype">char</span> *file_name,</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                  <a class="code" href="api0api_8h.html#a02e9c11b4a9783f4b0b89fcf060f8f28">space_id_t</a> space_id);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">/** On a restart, initialize the remaining InnoDB subsystems so that</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">any tables (including data dictionary tables) can be accessed. */</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordtype">void</span> <a class="code" href="srv0start_8h.html#a31f9fe0b880018c599413c42ef3a2166">srv_dict_recover_on_restart</a>();</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">/** Start up the InnoDB service threads which are independent of DDL recovery</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">@param[in]      bootstrap       True if this is in bootstrap */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">void</span> <a class="code" href="srv0start_8h.html#af29292779d10f892386feb7cceac8050">srv_start_threads</a>(<span class="keywordtype">bool</span> <a class="code" href="namespacebootstrap.html">bootstrap</a>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">/** Start the remaining InnoDB service threads which must wait for</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">complete DD recovery(post the DDL recovery) */</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keywordtype">void</span> <a class="code" href="srv0start_8h.html#a5160ac284544d186fd4955c353214fe2">srv_start_threads_after_ddl_recovery</a>();</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/** Shut down all InnoDB background tasks that may look up objects in</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">the data dictionary. */</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordtype">void</span> <a class="code" href="srv0start_8h.html#a9a875389626ef516c30920d81915f234">srv_pre_dd_shutdown</a>();</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">/** Shut down the InnoDB database. */</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordtype">void</span> <a class="code" href="srv0start_8h.html#add4bf74eed933fc4ee32343e759b4305">srv_shutdown</a>();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">/** Start purge threads. During upgrade we start</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">purge threads early to apply purge. */</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keywordtype">void</span> <a class="code" href="srv0start_8h.html#a73ae8ebd2f0ccab4667aa2da5903dc19">srv_start_purge_threads</a>();</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">/** If early redo/undo log encryption processing is done.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">@return true if it&#39;s done. */</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="srv0start_8h.html#a5664c1a60e4640a454b0707d09074d81">is_early_redo_undo_encryption_done</a>();</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">/** Copy the file path component of the physical file to parameter. It will</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> copy up to and including the terminating path separator.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> @return number of bytes copied or ULINT_UNDEFINED if destination buffer</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">         is smaller than the path to be copied. */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;ulint <a class="code" href="srv0start_8h.html#ad587a85ef4b36f2e7c41cb7456dfea0b">srv_path_copy</a>(<span class="keywordtype">char</span> *dest,             <span class="comment">/*!&lt; out: destination buffer */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    ulint dest_len,         <span class="comment">/*!&lt; in: max bytes to copy */</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">char</span> *basedir,    <span class="comment">/*!&lt; in: base directory */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacerules__table__service.html#a58d8b2e690d4fb60a8d9557c8a4b5cd1">table_name</a>) <span class="comment">/*!&lt; in: source table name */</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    MY_ATTRIBUTE((warn_unused_result));</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">/** Get the encryption-data filename from the table name for a</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">single-table tablespace.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">@param[in]      table           table object</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">@param[out]     filename        filename</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">@param[in]      max_len         filename max length */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keywordtype">void</span> <a class="code" href="srv0start_8h.html#a13fa97bcad2d9635285c7a513b0645e2">srv_get_encryption_data_filename</a>(<a class="code" href="structdict__table__t.html">dict_table_t</a> *table, <span class="keywordtype">char</span> *<a class="code" href="pfs__example__component__population_8cc.html#a7efa5e9c7494c7d4586359300221aa5d">filename</a>,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                      ulint max_len);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !UNIV_HOTBACKUP */</span><span class="preprocessor"></span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">/** true if the server is being started */</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="srv0start_8h.html#ac74e6bc8616b06abaa25f9ef3c3da347">srv_is_being_started</a>;<span class="comment"></span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">/** true if SYS_TABLESPACES is available for lookups */</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="srv0start_8h.html#a980ecb4efdc45459c7024e7765ce6d41">srv_sys_tablespaces_open</a>;<span class="comment"></span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">/** true if the server is being started, before rolling back any</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">incomplete transactions */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">bool</span> <a class="code" href="srv0start_8h.html#a4f8052b23856f4944c8472188f6eb4e8">srv_startup_is_before_trx_rollback_phase</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">/** TRUE if a raw partition is in use */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">extern</span> ibool <a class="code" href="srv0start_8h.html#ab3d90e7d07cf25062df88e9820fca7c6">srv_start_raw_disk_in_use</a>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">/** Shutdown state */</span></div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8">  163</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8">srv_shutdown_t</a> {<span class="comment"></span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">  /** Database running normally. */</span></div><div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a098f81bef6335aeda3cd8cfd5cb3be60">  165</a></span>&#160;  <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a098f81bef6335aeda3cd8cfd5cb3be60">SRV_SHUTDOWN_NONE</a> = 0,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">  /** Shutdown has started. Stopping the thread responsible for rollback of</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">  recovered transactions. In case of slow shutdown, this implies waiting</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">  for completed rollback of all recovered transactions.</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">  @remarks Note that user transactions are stopped earlier, when the</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">  shutdown state is still equal to SRV_SHUTDOWN_NONE (user transactions</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">  are closed when related connections are closed in close_connections()). */</span></div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a2a0b9f431b4afb6a88d2aa8ad6497703">  173</a></span>&#160;  <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a2a0b9f431b4afb6a88d2aa8ad6497703">SRV_SHUTDOWN_RECOVERY_ROLLBACK</a>,</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">  /** Stopping threads that might use system transactions or DD objects.</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">  This is important because we need to ensure that in the next phase no</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">  undo records could be produced (we will be stopping purge threads).</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">  After next phase DD is shut down, so also no accesses to DD objects</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">  are allowed then. List of threads being stopped within this phase:</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">    - dict_stats thread,</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">    - fts_optimize thread,</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">    - ts_alter_encrypt thread.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">  The master thread exits its main loop and finishes its first phase</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">  of shutdown (in which it was allowed to touch DD objects). */</span></div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8aaed42a2e331655107964a37bcda0c042">  185</a></span>&#160;  <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8aaed42a2e331655107964a37bcda0c042">SRV_SHUTDOWN_PRE_DD_AND_SYSTEM_TRANSACTIONS</a>,</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">  /** Stopping the purge threads. Before we enter this phase, we have</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">  the guarantee that no new undo records could be produced. */</span></div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8aa56021b5a187dfed3e41a525965af636">  189</a></span>&#160;  <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8aa56021b5a187dfed3e41a525965af636">SRV_SHUTDOWN_PURGE</a>,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">  /** Shutting down the DD. */</span></div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8ab39544ec7803953cde38ee3eda3bfe51">  192</a></span>&#160;  <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8ab39544ec7803953cde38ee3eda3bfe51">SRV_SHUTDOWN_DD</a>,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">  /** Stopping remaining InnoDB background threads except:</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">    - the master thread,</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">    - redo log threads,</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">    - page cleaner threads,</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">    - archiver threads.</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">  List of threads being stopped within this phase:</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">    - lock_wait_timeout thread,</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">    - error_monitor thread,</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">    - monitor thread,</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">    - buf_dump thread,</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">    - buf_resize thread.</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">  @remarks If your thread might touch DD objects or use system transactions</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">  it must be stopped within SRV_SHUTDOWN_PRE_DD_AND_SYSTEM_TRANSACTIONS phase.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a0923073fc4387a4983caf509584c1122">  208</a></span>&#160;  <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a0923073fc4387a4983caf509584c1122">SRV_SHUTDOWN_CLEANUP</a>,</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">  /** Stopping the master thread. */</span></div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8ae6be104cc423d4fb3185902f0dde11f3">  211</a></span>&#160;  <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8ae6be104cc423d4fb3185902f0dde11f3">SRV_SHUTDOWN_MASTER_STOP</a>,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">  /** Once we enter this phase, the page cleaners can clean up the buffer pool</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">  and exit. The redo log threads write and flush the log buffer and exit after</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">  the page cleaners (and within this phase). */</span></div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8aa59998b2321a1e2001c00d7de25b69e7">  216</a></span>&#160;  <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8aa59998b2321a1e2001c00d7de25b69e7">SRV_SHUTDOWN_FLUSH_PHASE</a>,</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">  /** Last phase after ensuring that all data have been flushed to disk and</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">  the flushed_lsn has been updated in the header of system tablespace.</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">  During this phase we close all files and ensure archiver has archived all. */</span></div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a65d81d80839adad59f1e6388a73c1948">  221</a></span>&#160;  <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a65d81d80839adad59f1e6388a73c1948">SRV_SHUTDOWN_LAST_PHASE</a>,</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">  /** Exit all threads and free resources. We might reach this phase in one</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">  of two different ways:</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">    - after visiting all previous states (usual shutdown),</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">    - or during startup when we failed and we abort the startup. */</span></div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8ac99f88b0e13af150ffd71d89cd5af56a">  227</a></span>&#160;  <a class="code" href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8ac99f88b0e13af150ffd71d89cd5af56a">SRV_SHUTDOWN_EXIT_THREADS</a></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;};</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">/** At a shutdown this value climbs from SRV_SHUTDOWN_NONE</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">to SRV_SHUTDOWN_EXIT_THREADS. */</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keyword">extern</span> std::atomic&lt;enum srv_shutdown_t&gt; <a class="code" href="srv0start_8h.html#a970fd477dbaa2cf12bc8e6fa158327a1">srv_shutdown_state</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">/** Call std::quick_exit(3) */</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="keywordtype">void</span> <a class="code" href="srv0start_8h.html#ad2969c0f0b2c6d669f36ae2345133ad9">srv_fatal_error</a>() MY_ATTRIBUTE((noreturn));</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">/** Attempt to shutdown all background threads created by InnoDB.</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">NOTE: Does not guarantee they are actually shut down, only does</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">the best effort. Changes state of shutdown to SHUTDOWN_EXIT_THREADS,</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">wakes up the background threads and waits a little bit. It might be</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">used within startup phase or when fatal error is discovered during</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">some IO operation. Therefore you must not assume anything related</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">to the state in which it might be used. */</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keywordtype">void</span> <a class="code" href="srv0start_8h.html#a58a669b4aee6d5785225c41b272a5278">srv_shutdown_exit_threads</a>();</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">/** Checks if all recovered transactions are supposed to be rolled back</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">before shutdown is ended.</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">@return value of the check */</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="srv0start_8h.html#aff022a9fa9fa0996b7f1040f0af3dc4b">srv_shutdown_waits_for_rollback_of_recovered_transactions</a>();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">/** Allows to safely check value of the current shutdown state.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">Note that the current shutdown state might be changed while the</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">check is being executed, but the check is based on a single load</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">of the srv_shutdown_state (atomic global variable). */</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;template &lt;typename F&gt;</div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="srv0start_8h.html#a9f905168cec18ae52f02e1fea08865e5">  256</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="srv0start_8h.html#a9f905168cec18ae52f02e1fea08865e5">srv_shutdown_state_matches</a>(F &amp;&amp;f) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> state = srv_shutdown_state.load();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">return</span> std::forward&lt;F&gt;(f)(state);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="srv0start_8h_html_ad587a85ef4b36f2e7c41cb7456dfea0b"><div class="ttname"><a href="srv0start_8h.html#ad587a85ef4b36f2e7c41cb7456dfea0b">srv_path_copy</a></div><div class="ttdeci">ulint srv_path_copy(char *dest, ulint dest_len, const char *basedir, const char *table_name)</div><div class="ttdoc">Copy the file path component of the physical file to parameter. </div></div>
<div class="ttc" id="srv0start_8h_html_add4bf74eed933fc4ee32343e759b4305"><div class="ttname"><a href="srv0start_8h.html#add4bf74eed933fc4ee32343e759b4305">srv_shutdown</a></div><div class="ttdeci">void srv_shutdown()</div><div class="ttdoc">Shut down the InnoDB database. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:3509</div></div>
<div class="ttc" id="srv0start_8h_html_a58a669b4aee6d5785225c41b272a5278"><div class="ttname"><a href="srv0start_8h.html#a58a669b4aee6d5785225c41b272a5278">srv_shutdown_exit_threads</a></div><div class="ttdeci">void srv_shutdown_exit_threads()</div><div class="ttdoc">Attempt to shutdown all background threads created by InnoDB. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:1651</div></div>
<div class="ttc" id="srv0start_8h_html_a31f9fe0b880018c599413c42ef3a2166"><div class="ttname"><a href="srv0start_8h.html#a31f9fe0b880018c599413c42ef3a2166">srv_dict_recover_on_restart</a></div><div class="ttdeci">void srv_dict_recover_on_restart()</div><div class="ttdoc">On a restart, initialize the remaining InnoDB subsystems so that any tables (including data dictionar...</div><div class="ttdef"><b>Definition:</b> srv0start.cc:2884</div></div>
<div class="ttc" id="os0thread-create_8h_html"><div class="ttname"><a href="os0thread-create_8h.html">os0thread-create.h</a></div><div class="ttdoc">The interface to the threading wrapper. </div></div>
<div class="ttc" id="srv0start_8h_html_a4dc22d3bd4d1aaba7d727878bf0fa9d7"><div class="ttname"><a href="srv0start_8h.html#a4dc22d3bd4d1aaba7d727878bf0fa9d7">srv_add_path_separator_if_needed</a></div><div class="ttdeci">char * srv_add_path_separator_if_needed(char *str)</div><div class="ttdoc">Adds a slash or a backslash to the end of a string if it is missing and the string is not empty...</div></div>
<div class="ttc" id="structdict__table__t_html"><div class="ttname"><a href="structdict__table__t.html">dict_table_t</a></div><div class="ttdoc">Data structure for a database table. </div><div class="ttdef"><b>Definition:</b> dict0mem.h:1532</div></div>
<div class="ttc" id="srv0start_8h_html_ac24e029a70c5fdf1f69e35835b7710f0"><div class="ttname"><a href="srv0start_8h.html#ac24e029a70c5fdf1f69e35835b7710f0">srv_start</a></div><div class="ttdeci">dberr_t srv_start(bool create_new_db)</div><div class="ttdoc">Start InnoDB. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:1855</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8aa59998b2321a1e2001c00d7de25b69e7"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8aa59998b2321a1e2001c00d7de25b69e7">SRV_SHUTDOWN_FLUSH_PHASE</a></div><div class="ttdoc">Once we enter this phase, the page cleaners can clean up the buffer pool and exit. </div><div class="ttdef"><b>Definition:</b> srv0start.h:216</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8a0923073fc4387a4983caf509584c1122"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a0923073fc4387a4983caf509584c1122">SRV_SHUTDOWN_CLEANUP</a></div><div class="ttdoc">Stopping remaining InnoDB background threads except: </div><div class="ttdef"><b>Definition:</b> srv0start.h:208</div></div>
<div class="ttc" id="srv0start_8h_html_a73ae8ebd2f0ccab4667aa2da5903dc19"><div class="ttname"><a href="srv0start_8h.html#a73ae8ebd2f0ccab4667aa2da5903dc19">srv_start_purge_threads</a></div><div class="ttdeci">void srv_start_purge_threads()</div><div class="ttdoc">Start purge threads. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:2912</div></div>
<div class="ttc" id="srv0start_8h_html_a9a875389626ef516c30920d81915f234"><div class="ttname"><a href="srv0start_8h.html#a9a875389626ef516c30920d81915f234">srv_pre_dd_shutdown</a></div><div class="ttdeci">void srv_pre_dd_shutdown()</div><div class="ttdoc">Shut down all InnoDB background tasks that may look up objects in the data dictionary. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:3100</div></div>
<div class="ttc" id="srv0start_8h_html_aff022a9fa9fa0996b7f1040f0af3dc4b"><div class="ttname"><a href="srv0start_8h.html#aff022a9fa9fa0996b7f1040f0af3dc4b">srv_shutdown_waits_for_rollback_of_recovered_transactions</a></div><div class="ttdeci">bool srv_shutdown_waits_for_rollback_of_recovered_transactions()</div><div class="ttdoc">Checks if all recovered transactions are supposed to be rolled back before shutdown is ended...</div><div class="ttdef"><b>Definition:</b> srv0start.cc:3094</div></div>
<div class="ttc" id="srv0start_8h_html_af29292779d10f892386feb7cceac8050"><div class="ttname"><a href="srv0start_8h.html#af29292779d10f892386feb7cceac8050">srv_start_threads</a></div><div class="ttdeci">void srv_start_threads(bool bootstrap)</div><div class="ttdoc">Start up the InnoDB service threads which are independent of DDL recovery. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:2940</div></div>
<div class="ttc" id="srv0start_8h_html_a5664c1a60e4640a454b0707d09074d81"><div class="ttname"><a href="srv0start_8h.html#a5664c1a60e4640a454b0707d09074d81">is_early_redo_undo_encryption_done</a></div><div class="ttdeci">bool is_early_redo_undo_encryption_done()</div><div class="ttdoc">If early redo/undo log encryption processing is done. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:2904</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8aaed42a2e331655107964a37bcda0c042"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8aaed42a2e331655107964a37bcda0c042">SRV_SHUTDOWN_PRE_DD_AND_SYSTEM_TRANSACTIONS</a></div><div class="ttdoc">Stopping threads that might use system transactions or DD objects. </div><div class="ttdef"><b>Definition:</b> srv0start.h:185</div></div>
<div class="ttc" id="log0types_8h_html"><div class="ttname"><a href="log0types_8h.html">log0types.h</a></div><div class="ttdoc">Redo log types. </div></div>
<div class="ttc" id="trx0purge_8h_html"><div class="ttname"><a href="trx0purge_8h.html">trx0purge.h</a></div><div class="ttdoc">Purge old versions. </div></div>
<div class="ttc" id="srv0start_8h_html_a436789cc68c4b7d5e2c4ecca5196034a"><div class="ttname"><a href="srv0start_8h.html#a436789cc68c4b7d5e2c4ecca5196034a">srv_undo_tablespace_fixup</a></div><div class="ttdeci">dberr_t srv_undo_tablespace_fixup(const char *space_name, const char *file_name, space_id_t space_id)</div><div class="ttdoc">Fix up an undo tablespace if it was in the process of being truncated when the server crashed...</div><div class="ttdef"><b>Definition:</b> srv0start.cc:803</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8a2a0b9f431b4afb6a88d2aa8ad6497703"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a2a0b9f431b4afb6a88d2aa8ad6497703">SRV_SHUTDOWN_RECOVERY_ROLLBACK</a></div><div class="ttdoc">Shutdown has started. </div><div class="ttdef"><b>Definition:</b> srv0start.h:173</div></div>
<div class="ttc" id="sync0rw_8h_html"><div class="ttname"><a href="sync0rw_8h.html">sync0rw.h</a></div><div class="ttdoc">The read-write lock (for threads, not for database transactions) </div></div>
<div class="ttc" id="srv0start_8h_html_a2c4a808bb3b77f3af31bd13cb84df565"><div class="ttname"><a href="srv0start_8h.html#a2c4a808bb3b77f3af31bd13cb84df565">srv_undo_tablespaces_upgrade</a></div><div class="ttdeci">dberr_t srv_undo_tablespaces_upgrade()</div><div class="ttdoc">Upgrade undo tablespaces by deleting the old undo tablespaces referenced by the TRX_SYS page...</div><div class="ttdef"><b>Definition:</b> srv0start.cc:1326</div></div>
<div class="ttc" id="structundo_1_1Tablespace_html"><div class="ttname"><a href="structundo_1_1Tablespace.html">undo::Tablespace</a></div><div class="ttdoc">An undo::Tablespace object is used to easily convert between undo_space_id and undo_space_num and to ...</div><div class="ttdef"><b>Definition:</b> trx0purge.h:308</div></div>
<div class="ttc" id="srv0start_8h_html_ad2969c0f0b2c6d669f36ae2345133ad9"><div class="ttname"><a href="srv0start_8h.html#ad2969c0f0b2c6d669f36ae2345133ad9">srv_fatal_error</a></div><div class="ttdeci">void srv_fatal_error()</div><div class="ttdoc">Call std::quick_exit(3) </div><div class="ttdef"><b>Definition:</b> srv0start.cc:3682</div></div>
<div class="ttc" id="srv0start_8h_html_ab3d90e7d07cf25062df88e9820fca7c6"><div class="ttname"><a href="srv0start_8h.html#ab3d90e7d07cf25062df88e9820fca7c6">srv_start_raw_disk_in_use</a></div><div class="ttdeci">ibool srv_start_raw_disk_in_use</div><div class="ttdoc">TRUE if a raw partition is in use. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:133</div></div>
<div class="ttc" id="db0err_8h_html_a6fdd08971b32ee513b20967238f1654d"><div class="ttname"><a href="db0err_8h.html#a6fdd08971b32ee513b20967238f1654d">dberr_t</a></div><div class="ttdeci">dberr_t</div><div class="ttdef"><b>Definition:</b> db0err.h:38</div></div>
<div class="ttc" id="srv0start_8h_html_a980ecb4efdc45459c7024e7765ce6d41"><div class="ttname"><a href="srv0start_8h.html#a980ecb4efdc45459c7024e7765ce6d41">srv_sys_tablespaces_open</a></div><div class="ttdeci">bool srv_sys_tablespaces_open</div><div class="ttdoc">true if SYS_TABLESPACES is available for lookups </div><div class="ttdef"><b>Definition:</b> srv0start.cc:141</div></div>
<div class="ttc" id="srv0start_8h_html_a9f905168cec18ae52f02e1fea08865e5"><div class="ttname"><a href="srv0start_8h.html#a9f905168cec18ae52f02e1fea08865e5">srv_shutdown_state_matches</a></div><div class="ttdeci">bool srv_shutdown_state_matches(F &amp;&amp;f)</div><div class="ttdoc">Allows to safely check value of the current shutdown state. </div><div class="ttdef"><b>Definition:</b> srv0start.h:256</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8ae6be104cc423d4fb3185902f0dde11f3"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8ae6be104cc423d4fb3185902f0dde11f3">SRV_SHUTDOWN_MASTER_STOP</a></div><div class="ttdoc">Stopping the master thread. </div><div class="ttdef"><b>Definition:</b> srv0start.h:211</div></div>
<div class="ttc" id="ut0byte_8h_html"><div class="ttname"><a href="ut0byte_8h.html">ut0byte.h</a></div><div class="ttdoc">Utilities for byte operations. </div></div>
<div class="ttc" id="srv0start_8h_html_a5160ac284544d186fd4955c353214fe2"><div class="ttname"><a href="srv0start_8h.html#a5160ac284544d186fd4955c353214fe2">srv_start_threads_after_ddl_recovery</a></div><div class="ttdeci">void srv_start_threads_after_ddl_recovery()</div><div class="ttdoc">Start the remaining InnoDB service threads which must wait for complete DD recovery(post the DDL reco...</div><div class="ttdef"><b>Definition:</b> srv0start.cc:3015</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8">srv_shutdown_t</a></div><div class="ttdeci">srv_shutdown_t</div><div class="ttdoc">Shutdown state. </div><div class="ttdef"><b>Definition:</b> srv0start.h:163</div></div>
<div class="ttc" id="srv0start_8h_html_a970fd477dbaa2cf12bc8e6fa158327a1"><div class="ttname"><a href="srv0start_8h.html#a970fd477dbaa2cf12bc8e6fa158327a1">srv_shutdown_state</a></div><div class="ttdeci">std::atomic&lt; enum srv_shutdown_t &gt; srv_shutdown_state</div><div class="ttdoc">At a shutdown this value climbs from SRV_SHUTDOWN_NONE to SRV_SHUTDOWN_EXIT_THREADS. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:166</div></div>
<div class="ttc" id="api0api_8h_html_a02e9c11b4a9783f4b0b89fcf060f8f28"><div class="ttname"><a href="api0api_8h.html#a02e9c11b4a9783f4b0b89fcf060f8f28">space_id_t</a></div><div class="ttdeci">uint32 space_id_t</div><div class="ttdoc">Tablespace identifier. </div><div class="ttdef"><b>Definition:</b> api0api.h:59</div></div>
<div class="ttc" id="pfs__example__component__population_8cc_html_a7efa5e9c7494c7d4586359300221aa5d"><div class="ttname"><a href="pfs__example__component__population_8cc.html#a7efa5e9c7494c7d4586359300221aa5d">filename</a></div><div class="ttdeci">const char * filename</div><div class="ttdef"><b>Definition:</b> pfs_example_component_population.cc:64</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8aa56021b5a187dfed3e41a525965af636"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8aa56021b5a187dfed3e41a525965af636">SRV_SHUTDOWN_PURGE</a></div><div class="ttdoc">Stopping the purge threads. </div><div class="ttdef"><b>Definition:</b> srv0start.h:189</div></div>
<div class="ttc" id="srv0start_8h_html_a37fd121f7ff04e1b78840729aeaf9207"><div class="ttname"><a href="srv0start_8h.html#a37fd121f7ff04e1b78840729aeaf9207">srv_free_paths_and_sizes</a></div><div class="ttdeci">void srv_free_paths_and_sizes(void)</div><div class="ttdoc">Frees the memory allocated by srv_parse_data_file_paths_and_sizes() and srv_parse_log_group_home_dirs...</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8ac99f88b0e13af150ffd71d89cd5af56a"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8ac99f88b0e13af150ffd71d89cd5af56a">SRV_SHUTDOWN_EXIT_THREADS</a></div><div class="ttdoc">Exit all threads and free resources. </div><div class="ttdef"><b>Definition:</b> srv0start.h:227</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8ab39544ec7803953cde38ee3eda3bfe51"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8ab39544ec7803953cde38ee3eda3bfe51">SRV_SHUTDOWN_DD</a></div><div class="ttdoc">Shutting down the DD. </div><div class="ttdef"><b>Definition:</b> srv0start.h:192</div></div>
<div class="ttc" id="namespacebootstrap_html"><div class="ttname"><a href="namespacebootstrap.html">bootstrap</a></div><div class="ttdef"><b>Definition:</b> bootstrap.cc:68</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8a65d81d80839adad59f1e6388a73c1948"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a65d81d80839adad59f1e6388a73c1948">SRV_SHUTDOWN_LAST_PHASE</a></div><div class="ttdoc">Last phase after ensuring that all data have been flushed to disk and the flushed_lsn has been update...</div><div class="ttdef"><b>Definition:</b> srv0start.h:221</div></div>
<div class="ttc" id="srv0start_8h_html_ac74e6bc8616b06abaa25f9ef3c3da347"><div class="ttname"><a href="srv0start_8h.html#ac74e6bc8616b06abaa25f9ef3c3da347">srv_is_being_started</a></div><div class="ttdeci">bool srv_is_being_started</div><div class="ttdoc">true if the server is being started </div><div class="ttdef"><b>Definition:</b> srv0start.cc:139</div></div>
<div class="ttc" id="srv0start_8h_html_a13fa97bcad2d9635285c7a513b0645e2"><div class="ttname"><a href="srv0start_8h.html#a13fa97bcad2d9635285c7a513b0645e2">srv_get_encryption_data_filename</a></div><div class="ttdeci">void srv_get_encryption_data_filename(dict_table_t *table, char *filename, ulint max_len)</div><div class="ttdoc">Get the encryption-data filename from the table name for a single-table tablespace. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:3664</div></div>
<div class="ttc" id="srv0start_8h_html_ae46970a9cd65ae1a824ae3ec17848ca8a098f81bef6335aeda3cd8cfd5cb3be60"><div class="ttname"><a href="srv0start_8h.html#ae46970a9cd65ae1a824ae3ec17848ca8a098f81bef6335aeda3cd8cfd5cb3be60">SRV_SHUTDOWN_NONE</a></div><div class="ttdoc">Database running normally. </div><div class="ttdef"><b>Definition:</b> srv0start.h:165</div></div>
<div class="ttc" id="srv0start_8h_html_a4f8052b23856f4944c8472188f6eb4e8"><div class="ttname"><a href="srv0start_8h.html#a4f8052b23856f4944c8472188f6eb4e8">srv_startup_is_before_trx_rollback_phase</a></div><div class="ttdeci">bool srv_startup_is_before_trx_rollback_phase</div><div class="ttdoc">true if the server is being started, before rolling back any incomplete transactions ...</div><div class="ttdef"><b>Definition:</b> srv0start.cc:144</div></div>
<div class="ttc" id="srv0start_8h_html_a393859f9ab32d37cdc7e4223d6d0d40d"><div class="ttname"><a href="srv0start_8h.html#a393859f9ab32d37cdc7e4223d6d0d40d">srv_undo_tablespace_open</a></div><div class="ttdeci">dberr_t srv_undo_tablespace_open(undo::Tablespace &amp;undo_space)</div><div class="ttdoc">Open an undo tablespace. </div><div class="ttdef"><b>Definition:</b> srv0start.cc:866</div></div>
<div class="ttc" id="namespacerules__table__service_html_a58d8b2e690d4fb60a8d9557c8a4b5cd1"><div class="ttname"><a href="namespacerules__table__service.html#a58d8b2e690d4fb60a8d9557c8a4b5cd1">rules_table_service::table_name</a></div><div class="ttdeci">const char * table_name</div><div class="ttdef"><b>Definition:</b> rules_table_service.cc:55</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_70f20ecf11358dff00a0daf546d3147e.html">storage</a></li><li class="navelem"><a class="el" href="dir_3fec0aa9607ea05e0bb1c96aee1a8c4e.html">innobase</a></li><li class="navelem"><a class="el" href="dir_9b7ed1f29269ffabdc4c5f5522a0db25.html">include</a></li><li class="navelem"><a class="el" href="srv0start_8h.html">srv0start.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
