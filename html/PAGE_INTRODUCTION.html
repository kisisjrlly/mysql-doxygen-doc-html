<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Introduction to the MySQL Test Framework</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('PAGE_INTRODUCTION.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Introduction to the MySQL Test Framework </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>MySQL distributions include a test suite: a set of test cases and programs for running them.</p>
<p>(If you find that the test suite is not included in your distribution, look for a similar distribution with <b>-test</b> in the name and install that as well.) These tools constitute the MySQL test framework that provides a means for verifying that MySQL Server and its client programs operate according to expectations. The test cases consist mostly of SQL statements, but can also use test language constructs that control how to run tests and verify their results. Distributions also provide facilities for running unit tests and creating new unit tests.</p>
<p>This document describes the components of the MySQL test framework, how the test programs work, and the language used for writing test cases. It also provides a tutorial for developing test cases and executing them.</p>
<p>The application that runs the test suite is named <a class="el" href="PAGE_MYSQL_TEST_RUN_PL.html">mysql-test-run.pl</a>. Its location is the <b>mysql-test</b> directory, which is present both in source and binary MySQL Server distributions.</p>
<p>On platforms other than Windows, <a class="el" href="PAGE_MYSQL_TEST_RUN_PL.html">mysql-test-run.pl</a> is also available through the shortened name <b>mtr</b> in the same directory, as either a symbolic link or a copy.</p>
<p>The <a class="el" href="PAGE_MYSQL_TEST_RUN_PL.html">mysql-test-run.pl</a> application starts MySQL servers, restarts them as necessary when a specific test case needs different start arguments, and presents the test result. For each test case, <a class="el" href="PAGE_MYSQL_TEST_RUN_PL.html">mysql-test-run.pl</a> invokes the <a class="el" href="PAGE_MYSQLTEST.html">mysqltest</a> program (also referred to as the “test engine”) to read the test case file, intepret the test language constructs, and send SQL statements to the server.</p>
<p>Input for each test case is stored in a file, and the expected result from running the test is stored in another file. The actual result is compared to the expected result after running the test.</p>
<p>For a MySQL source distribution, <a class="el" href="PAGE_MYSQL_TEST_RUN_PL.html">mysql-test-run.pl</a> is located in the <b>mysql-test</b> directory, and <a class="el" href="PAGE_MYSQLTEST.html">mysqltest</a> is located in the <b>client</b> directory. The <b>mysql-test</b> and <b>client</b> directories are located in the root directory of the distribution.</p>
<p>For a MySQL binary distribution, <a class="el" href="PAGE_MYSQL_TEST_RUN_PL.html">mysql-test-run.pl</a> is located in the <b>mysql-test</b> directory, and <a class="el" href="PAGE_MYSQLTEST.html">mysqltest</a> is located in the same directory where other client programs such as <b>mysql</b> or <b>mysqladmin</b> are installed. The locations of the <b>mysql-test</b> and other directories depend on the layout used for the distribution format.</p>
<p>Within the <b>mysql-test</b> directory, test case input files and result files are stored in the <b>t</b> and <b>r</b> directories, respectively. The input and result files have the same basename, which is the test name, but have extensions of <b>.test</b> and <b>.result</b>, respectively. For example, for a test named “decimal”, the input and result files are <b>mysql-test/t/decimal.test</b> and <b>mysql-test/r/decimal.result</b>.</p>
<p>Each test file is referred to as one test case, but usually consists of a sequence of related tests. An unexpected failure of a single statement in a test case makes the test case fail.</p>
<p>There are several ways a test case can fail:</p>
<ul>
<li>
<p class="startli">The <a class="el" href="PAGE_MYSQLTEST.html">mysqltest</a> test engine checks the result codes from executing each SQL statement in the test input. If the failure is unexpected, the test case fails. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">A test case can fail if an error was expected but did not occur (for example, if an SQL statement succeeded when it should have failed). </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">The test case can fail by producing incorrect output. As a test runs, it produces output (the results from <b>SELECT</b>, <b>SHOW</b>, and other statements). This output is compared to the expected result found in the <b>mysql-test/r</b> directory (in a file with a <b>.result</b> suffix). If the expected and actual results differ, the test case fails. The actual test result is written to a file in the <b>mysql-test/var/log</b> directory with a <b>.reject</b> suffix, and the difference between the <b>.result</b> and <b>.reject</b> files is presented for evaluation. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">A test case will fail if the MySQL server dies unexpectedly during the test. If this happens, the <a class="el" href="PAGE_MYSQLTEST.html">mysqltest</a> test client will usually also report a failure due to loosing the connection. </p>
<p class="endli"></p>
</li>
<li>
Finally, the test case will fail if the error log written by the MySQL server during the test includes warnings or errors which are not filtered (suppressed). See <a class="el" href="PAGE_SUPPRESSING_ERRORS_WARNINGS.html">Suppressing Errors and Warning</a> for more about suppressing warnings.  </li>
</ul>
<p>This method of checking test results puts some restrictions on how test cases can be written. For example, the result cannot contain information that varies from run to run, such as the current time. However, if the information that varies is unimportant for test evaluation, there are ways to instruct the test engine to replace those fields in the output with fixed values.</p>
<p>Because the test cases consist mostly of SQL statements in a text file, there is no direct support for test cases that are written in C, Java, or other languages. Such tests are not within the scope of this test framework. But the framework does support executing your own scripts and initiating them with your own data. Also, a test case can execute an external program, so in some respects the test framework can be extended for uses other than testing SQL statements. Finally, it is possible to embed small pieces of Perl code within the test. This can sometimes be used to perform actions or execute logic which is beyond the capabilities of the test language or SQL. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="PAGE_TESTING_TOOLS.html">Testing Tools</a></li><li class="navelem"><a class="el" href="PAGE_MYSQL_TEST_RUN.html">The MySQL Test Framework</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
