<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: Protocol::HandshakeResponse:</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_protocol_connection_phase_packets_protocol_handshake_response.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Protocol::HandshakeResponse: </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Depending on the servers support for the CLIENT_PROTOCOL_41 capability and the clients understanding of that flag the client has to send either a <a class="el" href="page_protocol_connection_phase_packets_protocol_handshake_response.html#sect_protocol_connection_phase_packets_protocol_handshake_response320">Protocol::HandshakeResponse320</a> or <a class="el" href="page_protocol_connection_phase_packets_protocol_handshake_response.html#sect_protocol_connection_phase_packets_protocol_handshake_response41">Protocol::HandshakeResponse41</a>.</p>
<dl class="section see"><dt>See also</dt><dd>send_client_reply_packet</dd></dl>
<h1><a class="anchor" id="sect_protocol_connection_phase_packets_protocol_handshake_response320"></a>
Protocol::HandshakeResponse320</h1>
<p>Old Handshake Response Packet used by old clients or if the server doesn't support CLIENT_PROTOCOL_41 <a class="el" href="group__group__cs__capabilities__flags.html">Capabilities Flags</a> flag.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Payload</caption>
<tr>
<th>Type</th><th>Name</th><th>Description </th></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_integers.html#a_protocol_type_int2">int&lt;2&gt;</a> </td><td>client_flag </td><td><a class="el" href="group__group__cs__capabilities__flags.html">Capabilities Flags</a>, only the lower 16 bits. CLIENT_PROTOCOL_41 should never be set </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_integers.html#a_protocol_type_int3">int&lt;3&gt;</a> </td><td>max_packet_size </td><td>maximum packet size, 0xFFFFFF max </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_null">string&lt;NUL&gt;</a> </td><td>username </td><td>login user name </td></tr>
<tr>
<td colspan="3">if capabilities &amp; CLIENT_CONNECT_WITH_DB { </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_null">string&lt;NUL&gt;</a> </td><td>auth-response </td><td>Opaque authentication response data generated by Authentication Method indicated by the plugin name field. </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_null">string&lt;NUL&gt;</a> </td><td>database </td><td>initail database for the connection. This string should be interpreted using the character set indicated by character set field. </td></tr>
<tr>
<td colspan="3">} else { </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_eof">string&lt;EOF&gt;</a> </td><td>auth-response </td><td>Opaque authentication response data generated by Authentication Method indicated by the plugin name field. </td></tr>
<tr>
<td colspan="3">} </td></tr>
</table>
<h1>Example </h1>
<div class="fragment"><div class="line">11 00 00 01 85 24 00 00    00 6f 6c 64 00 47 44 53    .....$...old.GDS</div><div class="line">43 51 59 52 5f                                        CQYR_</div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>If auth-response is followed by a database field it must be NULL terminated.</dd></dl>
<h1><a class="anchor" id="sect_protocol_connection_phase_packets_protocol_handshake_response41"></a>
Protocol::HandshakeResponse41</h1>
<p>Handshake Response Packet sent by 4.1+ clients supporting CLIENT_PROTOCOL_41 <a class="el" href="group__group__cs__capabilities__flags.html">Capabilities Flags</a> flag, if the server announced it in its <a class="el" href="page_protocol_connection_phase_packets_protocol_handshake.html">Protocol::Handshake</a>. Otherwise (talking to an old server) the <a class="el" href="page_protocol_connection_phase_packets_protocol_handshake_response.html#sect_protocol_connection_phase_packets_protocol_handshake_response320">Protocol::HandshakeResponse320</a> packet must be used.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Payload</caption>
<tr>
<th>Type</th><th>Name</th><th>Description </th></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_integers.html#a_protocol_type_int4">int&lt;4&gt;</a> </td><td>client_flag </td><td><a class="el" href="group__group__cs__capabilities__flags.html">Capabilities Flags</a>, CLIENT_PROTOCOL_41 always set. </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_integers.html#a_protocol_type_int4">int&lt;4&gt;</a> </td><td>max_packet_size </td><td>maximum packet size </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_integers.html#a_protocol_type_int1">int&lt;1&gt;</a> </td><td>character_set </td><td>client charset <a class="el" href="page_protocol_basic_character_set.html#a_protocol_character_set">a_protocol_character_set</a>, only the lower 8-bits </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_fix">string[23]</a> </td><td>filler </td><td>filler to the size of the handhshake response packet. All 0s. </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_null">string&lt;NUL&gt;</a> </td><td>username </td><td>login user name </td></tr>
<tr>
<td colspan="3">if capabilities &amp; CLIENT_PLUGIN_AUTH_LENENC_CLIENT_DATA { </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_le">string&lt;length&gt;</a> </td><td>auth_response </td><td>opaque authentication response data generated by Authentication Method indicated by the plugin name field.  </td></tr>
<tr>
<td colspan="3">} else { </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_integers.html#a_protocol_type_int1">int&lt;1&gt;</a> </td><td>auth_response_length </td><td>length of auth_response </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_le">string&lt;length&gt;</a> </td><td>auth_response </td><td>opaque authentication response data generated by Authentication Method indicated by the plugin name field.  </td></tr>
<tr>
<td colspan="3">} </td></tr>
<tr>
<td colspan="3">if capabilities &amp; CLIENT_CONNECT_WITH_DB { </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_null">string&lt;NUL&gt;</a> </td><td>database </td><td>initail database for the connection. This string should be interpreted using the character set indicated by character set field. </td></tr>
<tr>
<td colspan="3">} </td></tr>
<tr>
<td colspan="3">if capabilities &amp; CLIENT_PLUGIN_AUTH { </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_null">string&lt;NUL&gt;</a> </td><td>client_plugin_name </td><td>the Authentication Method used by the client to generate auth-response value in this packet. This is an UTF-8 string.  </td></tr>
<tr>
<td colspan="3">} </td></tr>
<tr>
<td colspan="3">if capabilities &amp; CLIENT_CONNECT_ATTRS { </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_integers.html#sect_protocol_basic_dt_int_le">int&lt;lenenc&gt;</a> </td><td>length of all key-values </td><td>affected rows </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_le">string&lt;lenenc&gt;</a> </td><td>key1 </td><td>Name of the 1st client attribute </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_strings.html#sect_protocol_basic_dt_string_le">string&lt;lenenc&gt;</a> </td><td>value1 </td><td>Value of the 1st client attribute </td></tr>
<tr>
<td colspan="3">.. (if more data in length of all key-values, more keys and values parts) </td></tr>
<tr>
<td colspan="3">} </td></tr>
<tr>
<td><a class="el" href="page_protocol_basic_dt_integers.html#a_protocol_type_int1">int&lt;1&gt;</a> </td><td>zstd_compression_level </td><td>compression level for zstd compression algorithm </td></tr>
</table>
<h1>Example </h1>
<p>On MySQL 5.5.8 with CLIENT_PROTOCOL_41 CLIENT_PLUGIN_AUTH, CLIENT_SECURE_CONNECTION (removed in 8.0), and CLIENT_CONNECT_WITH_DB set, it may look like:</p>
<div class="fragment"><div class="line">54 00 00 01 8d a6 0f 00    00 00 00 01 08 00 00 00    T...............</div><div class="line">00 00 00 00 00 00 00 00    00 00 00 00 00 00 00 00    ................</div><div class="line">00 00 00 00 70 61 6d 00    14 ab 09 ee f6 bc b1 32    ....pam........2</div><div class="line">3e 61 14 38 65 c0 99 1d    95 7d 75 d4 47 74 65 73    &gt;a.8e....}u.Gtes</div><div class="line">74 00 6d 79 73 71 6c 5f    6e 61 74 69 76 65 5f 70    t.mysql_native_p</div><div class="line">61 73 73 77 6f 72 64 00                               assword.</div></div><!-- fragment --><p>Starting with MySQL 5.6.6 the client may send attributes if CLIENT_CONNECT_ATTRS is set:</p>
<div class="fragment"><div class="line">b2 00 00 01 85 a2 1e 00    00 00 00 40 08 00 00 00    ...........@....</div><div class="line">00 00 00 00 00 00 00 00    00 00 00 00 00 00 00 00    ................</div><div class="line">00 00 00 00 72 6f 6f 74    00 14 22 50 79 a2 12 d4    ....root..<span class="stringliteral">&quot;Py...</span></div><div class="line"><span class="stringliteral">e8 82 e5 b3 f4 1a 97 75    6b c8 be db 9f 80 6d 79    .......uk.....my</span></div><div class="line"><span class="stringliteral">73 71 6c 5f 6e 61 74 69    76 65 5f 70 61 73 73 77    sql_native_passw</span></div><div class="line"><span class="stringliteral">6f 72 64 00 61 03 5f 6f    73 09 64 65 62 69 61 6e    ord.a._os.debian</span></div><div class="line"><span class="stringliteral">36 2e 30 0c 5f 63 6c 69    65 6e 74 5f 6e 61 6d 65    6.0._client_name</span></div><div class="line"><span class="stringliteral">08 6c 69 62 6d 79 73 71    6c 04 5f 70 69 64 05 32    .libmysql._pid.2</span></div><div class="line"><span class="stringliteral">32 33 34 34 0f 5f 63 6c    69 65 6e 74 5f 76 65 72    2344._client_ver</span></div><div class="line"><span class="stringliteral">73 69 6f 6e 08 35 2e 36    2e 36 2d 6d 39 09 5f 70    sion.5.6.6-m9._p</span></div><div class="line"><span class="stringliteral">6c 61 74 66 6f 72 6d 06    78 38 36 5f 36 34 03 66    latform.x86_64.f</span></div><div class="line"><span class="stringliteral">6f 6f 03 62 61 72                                     oo.bar</span></div></div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>Currently, multibyte character sets such as UCS2, UTF16 and UTF32 are not supported.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If client wants to have a secure SSL connection and sets CLIENT_SSL flag it should first send the <a class="el" href="page_protocol_connection_phase_packets_protocol_ssl_request.html">Protocol::SSLRequest:</a> packet and only then, after establishing the secure connection, it should send the <a class="el" href="page_protocol_connection_phase_packets_protocol_handshake_response.html">Protocol::HandshakeResponse:</a> packet. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="PAGE_PROTOCOL.html">Client/Server Protocol</a></li><li class="navelem"><a class="el" href="page_protocol_connection_lifecycle.html">Connection Lifecycle</a></li><li class="navelem"><a class="el" href="page_protocol_connection_phase.html">Connection Phase</a></li><li class="navelem"><a class="el" href="page_protocol_connection_phase_packets.html">Connection Phase Packets</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
