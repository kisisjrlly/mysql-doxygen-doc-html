<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MySQL: sql/auth/password.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mysql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-mysql-110x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MySQL
   &#160;<span id="projectnumber">8.0.22</span>
   </div>
   <div id="projectbrief">Source Code Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('password_8cc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">password.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="string_8h_source.html">string.h</a>&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &quot;<a class="el" href="crypt__genhash__impl_8h_source.html">crypt_genhash_impl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="m__string_8h_source.html">m_string.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__inttypes_8h_source.html">my_inttypes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__macros_8h_source.html">my_macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mysql__com_8h_source.html">mysql_com.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sha1_8h_source.html">sha1.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:addfd65bbe22b55231d133e01f2ff7dde"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#addfd65bbe22b55231d133e01f2ff7dde">PVERSION41_CHAR</a>&#160;&#160;&#160;'*'</td></tr>
<tr class="separator:addfd65bbe22b55231d133e01f2ff7dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0710ad636764be96bc1b434be22b4a9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a0710ad636764be96bc1b434be22b4a9a">randominit</a> (struct <a class="el" href="structrand__struct.html">rand_struct</a> *rand_st, <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> seed1, <a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> seed2)</td></tr>
<tr class="separator:a0710ad636764be96bc1b434be22b4a9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03763bd7b8dcb07b8b0f2f60a0028272"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a03763bd7b8dcb07b8b0f2f60a0028272">hash_password</a> (<a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> *<a class="el" href="structresult.html">result</a>, const char *<a class="el" href="mysql__secure__installation_8cc.html#a59460a3ff2c12443d1022e5cc0fba85c">password</a>, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> password_len)</td></tr>
<tr class="separator:a03763bd7b8dcb07b8b0f2f60a0028272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f0cb86b51b30d8303a7d134c0ac4481"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a9f0cb86b51b30d8303a7d134c0ac4481">char_val</a> (<a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> <a class="el" href="ctype-tis620_8cc.html#a207fd5507206d307cd63f95374fcd00d">X</a>)</td></tr>
<tr class="separator:a9f0cb86b51b30d8303a7d134c0ac4481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f1a3aae9c559c8e7064af969704b90"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#ac9f1a3aae9c559c8e7064af969704b90">octet2hex</a> (char *to, const char *str, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> len)</td></tr>
<tr class="separator:ac9f1a3aae9c559c8e7064af969704b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeb75a649851a4711c29d89f9e7eba0e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#adeb75a649851a4711c29d89f9e7eba0e">hex2octet</a> (<a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *to, const char *str, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> len)</td></tr>
<tr class="separator:adeb75a649851a4711c29d89f9e7eba0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45b532d32dfcc508355028003af8ded9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a45b532d32dfcc508355028003af8ded9">my_crypt</a> (char *to, const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *s1, const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *s2, <a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> len)</td></tr>
<tr class="separator:a45b532d32dfcc508355028003af8ded9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a061d50b4055bdc199cf0b1cebdbe7a43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a061d50b4055bdc199cf0b1cebdbe7a43">my_make_scrambled_password</a> (char *to, const char *<a class="el" href="mysql__secure__installation_8cc.html#a59460a3ff2c12443d1022e5cc0fba85c">password</a>, size_t pass_len)</td></tr>
<tr class="separator:a061d50b4055bdc199cf0b1cebdbe7a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4434917cebb832973aa50b267f54b635"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a4434917cebb832973aa50b267f54b635">compute_two_stage_sha1_hash</a> (const char *<a class="el" href="mysql__secure__installation_8cc.html#a59460a3ff2c12443d1022e5cc0fba85c">password</a>, size_t pass_len, <a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *hash_stage1, <a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *hash_stage2)</td></tr>
<tr class="memdesc:a4434917cebb832973aa50b267f54b635"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute two stage SHA1 hash of the password :  <a href="#a4434917cebb832973aa50b267f54b635">More...</a><br /></td></tr>
<tr class="separator:a4434917cebb832973aa50b267f54b635"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b31d27166a22cfca4449e166be6d990"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a4b31d27166a22cfca4449e166be6d990">my_make_scrambled_password_sha1</a> (char *to, const char *<a class="el" href="mysql__secure__installation_8cc.html#a59460a3ff2c12443d1022e5cc0fba85c">password</a>, size_t pass_len)</td></tr>
<tr class="separator:a4b31d27166a22cfca4449e166be6d990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa707eb1415dfcf596f7acbcebdfccba4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#aa707eb1415dfcf596f7acbcebdfccba4">make_scrambled_password</a> (char *to, const char *<a class="el" href="mysql__secure__installation_8cc.html#a59460a3ff2c12443d1022e5cc0fba85c">password</a>)</td></tr>
<tr class="separator:aa707eb1415dfcf596f7acbcebdfccba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bc4c09a6ed0698c89d441028d76a648"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a2bc4c09a6ed0698c89d441028d76a648">scramble</a> (char *to, const char *message, const char *<a class="el" href="mysql__secure__installation_8cc.html#a59460a3ff2c12443d1022e5cc0fba85c">password</a>)</td></tr>
<tr class="memdesc:a2bc4c09a6ed0698c89d441028d76a648"><td class="mdescLeft">&#160;</td><td class="mdescRight">Produce an obscure octet sequence from password and random string, received from the server.  <a href="#a2bc4c09a6ed0698c89d441028d76a648">More...</a><br /></td></tr>
<tr class="separator:a2bc4c09a6ed0698c89d441028d76a648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cefce9106759965ddce2ec168720376"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a9cefce9106759965ddce2ec168720376">check_scramble_sha1</a> (const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *scramble_arg, const char *message, const <a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *hash_stage2)</td></tr>
<tr class="memdesc:a9cefce9106759965ddce2ec168720376"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that scrambled message corresponds to the password.  <a href="#a9cefce9106759965ddce2ec168720376">More...</a><br /></td></tr>
<tr class="separator:a9cefce9106759965ddce2ec168720376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84c9a356cbf7faf391b76d444c30bae4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a84c9a356cbf7faf391b76d444c30bae4">check_scramble</a> (const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *scramble_arg, const char *message, const <a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *hash_stage2)</td></tr>
<tr class="separator:a84c9a356cbf7faf391b76d444c30bae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5499679568ea67055a4640d88be5b17b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a5499679568ea67055a4640d88be5b17b">get_salt_from_password</a> (<a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *hash_stage2, const char *<a class="el" href="mysql__secure__installation_8cc.html#a59460a3ff2c12443d1022e5cc0fba85c">password</a>)</td></tr>
<tr class="separator:a5499679568ea67055a4640d88be5b17b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9337c1994c71787b6e395c902017a567"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="password_8cc.html#a9337c1994c71787b6e395c902017a567">make_password_from_salt</a> (char *to, const <a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *hash_stage2)</td></tr>
<tr class="memdesc:a9337c1994c71787b6e395c902017a567"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert scrambled password from binary form to asciiz hex string.  <a href="#a9337c1994c71787b6e395c902017a567">More...</a><br /></td></tr>
<tr class="separator:a9337c1994c71787b6e395c902017a567"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="addfd65bbe22b55231d133e01f2ff7dde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addfd65bbe22b55231d133e01f2ff7dde">&#9670;&nbsp;</a></span>PVERSION41_CHAR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PVERSION41_CHAR&#160;&#160;&#160;'*'</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9f0cb86b51b30d8303a7d134c0ac4481"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f0cb86b51b30d8303a7d134c0ac4481">&#9670;&nbsp;</a></span>char_val()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> char_val </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>&#160;</td>
          <td class="paramname"><em>X</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a84c9a356cbf7faf391b76d444c30bae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84c9a356cbf7faf391b76d444c30bae4">&#9670;&nbsp;</a></span>check_scramble()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> check_scramble </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *&#160;</td>
          <td class="paramname"><em>scramble_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *&#160;</td>
          <td class="paramname"><em>hash_stage2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9cefce9106759965ddce2ec168720376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cefce9106759965ddce2ec168720376">&#9670;&nbsp;</a></span>check_scramble_sha1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="innodb__memcache_2util-src_2config__parser_8c.html#abb452686968e48b67397da5f97445f5b">bool</a> check_scramble_sha1 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *&#160;</td>
          <td class="paramname"><em>scramble_arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *&#160;</td>
          <td class="paramname"><em>hash_stage2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check that scrambled message corresponds to the password. </p>
<p>The function is used by server to check that received reply is authentic. This function does not check lengths of given strings: message must be null-terminated, reply and hash_stage2 must be at least SHA1_HASH_SIZE long (if not, something fishy is going on).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scramble_arg</td><td>clients' reply, presumably produced by scramble() </td></tr>
    <tr><td class="paramname">message</td><td>original random string, previously sent to client (presumably second argument of scramble()), must be exactly SCRAMBLE_LENGTH long and NULL-terminated. </td></tr>
    <tr><td class="paramname">hash_stage2</td><td>hex2octet-decoded database entry</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>password is correct Wretval true password is invalid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4434917cebb832973aa50b267f54b635"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4434917cebb832973aa50b267f54b635">&#9670;&nbsp;</a></span>compute_two_stage_sha1_hash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void compute_two_stage_sha1_hash </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pass_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *&#160;</td>
          <td class="paramname"><em>hash_stage1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *&#160;</td>
          <td class="paramname"><em>hash_stage2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute two stage SHA1 hash of the password : </p>
<p>hash_stage1=sha1("password") hash_stage2=sha1(hash_stage1)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>Password string. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pass_len</td><td>Length of the password. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hash_stage1</td><td>sha1(password) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hash_stage2</td><td>sha1(hash_stage1) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5499679568ea67055a4640d88be5b17b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5499679568ea67055a4640d88be5b17b">&#9670;&nbsp;</a></span>get_salt_from_password()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_salt_from_password </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *&#160;</td>
          <td class="paramname"><em>hash_stage2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a03763bd7b8dcb07b8b0f2f60a0028272"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03763bd7b8dcb07b8b0f2f60a0028272">&#9670;&nbsp;</a></span>hash_password()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hash_password </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a> *&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>password_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adeb75a649851a4711c29d89f9e7eba0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeb75a649851a4711c29d89f9e7eba0e">&#9670;&nbsp;</a></span>hex2octet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void hex2octet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9337c1994c71787b6e395c902017a567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9337c1994c71787b6e395c902017a567">&#9670;&nbsp;</a></span>make_password_from_salt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_password_from_salt </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *&#160;</td>
          <td class="paramname"><em>hash_stage2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert scrambled password from binary form to asciiz hex string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">to</td><td>store resulting string here, 2*SHA1_HASH_SIZE+2 bytes </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">hash_stage2</td><td>password in salt format </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa707eb1415dfcf596f7acbcebdfccba4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa707eb1415dfcf596f7acbcebdfccba4">&#9670;&nbsp;</a></span>make_scrambled_password()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_scrambled_password </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a45b532d32dfcc508355028003af8ded9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45b532d32dfcc508355028003af8ded9">&#9670;&nbsp;</a></span>my_crypt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void my_crypt </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *&#160;</td>
          <td class="paramname"><em>s1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="my__inttypes_8h.html#a65f85814a8290f9797005d3b28e7e5fc">uchar</a> *&#160;</td>
          <td class="paramname"><em>s2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a061d50b4055bdc199cf0b1cebdbe7a43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a061d50b4055bdc199cf0b1cebdbe7a43">&#9670;&nbsp;</a></span>my_make_scrambled_password()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void my_make_scrambled_password </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pass_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4b31d27166a22cfca4449e166be6d990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b31d27166a22cfca4449e166be6d990">&#9670;&nbsp;</a></span>my_make_scrambled_password_sha1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void my_make_scrambled_password_sha1 </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pass_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac9f1a3aae9c559c8e7064af969704b90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9f1a3aae9c559c8e7064af969704b90">&#9670;&nbsp;</a></span>octet2hex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* octet2hex </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uca-dump_8cc.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0710ad636764be96bc1b434be22b4a9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0710ad636764be96bc1b434be22b4a9a">&#9670;&nbsp;</a></span>randominit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void randominit </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrand__struct.html">rand_struct</a> *&#160;</td>
          <td class="paramname"><em>rand_st</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>seed1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="my__inttypes_8h.html#a718b4eb2652c286f4d42dc18a8e71a1a">ulong</a>&#160;</td>
          <td class="paramname"><em>seed2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2bc4c09a6ed0698c89d441028d76a648"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bc4c09a6ed0698c89d441028d76a648">&#9670;&nbsp;</a></span>scramble()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scramble </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Produce an obscure octet sequence from password and random string, received from the server. </p>
<p>This sequence corresponds to the password, but password can not be easily restored from it. The sequence is then sent to the server for validation. Trailing zero is not stored in the buf as it is not needed. This function is used by client to create authenticated reply to the server's greeting.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">to</td><td>store scrambled string here. The buf must be at least SHA1_HASH_SIZE bytes long. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">message</td><td>random message, must be exactly SCRAMBLE_LENGTH long and NULL-terminated. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">password</td><td>users' password, NULL-terminated </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5bd71961b401a432086d0fb290a87f3f.html">sql</a></li><li class="navelem"><a class="el" href="dir_1a808a163d09076bb7843dcdf3f1cd1a.html">auth</a></li><li class="navelem"><a class="el" href="password_8cc.html">password.cc</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
